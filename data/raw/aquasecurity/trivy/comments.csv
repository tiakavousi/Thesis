id,pr_number,user,created_at,body
1801000254,5439,DmitriyLewen,2023-11-08T04:07:45Z,"Agree with you @knqyf263 
`purl`/`cpe` is one of the package parameters.

If the package contains `PkgIdentifier`, we can simply add it to `DetectedVulnerability`:
e.g. for alpine packages:
https://github.com/aquasecurity/trivy/blob/a1b47441a5a8eb493bc0bf8a02b3bb6b4bfd0ddc/pkg/detector/ospkg/alpine/alpine.go#L126-L136"
1801710392,5439,juan131,2023-11-08T11:35:18Z,Thanks for your comments @DmitriyLewen @knqyf263 ! I'll update the PR moving PkgIdentifier as part of the `Package` identity and generate pURL(s) at analysis.
1805286175,5439,juan131,2023-11-10T08:19:25Z,"I need advice on how to update `pkg/fanal/test/integration/testdata/goldens` data automatically to fix integration tests @knqyf263 
"
1805304512,5439,DmitriyLewen,2023-11-10T08:32:42Z,`mage test:updateGolden` command should update golden files for integration tests.
1812363760,5439,juan131,2023-11-15T11:36:16Z,I'm still finding issues with integration tests and recreating golden images (`mage test:updateGolden` threw some unauthorized errors). Could you help me with this @DmitriyLewen ?
1813802621,5439,DmitriyLewen,2023-11-16T05:15:46Z,"Hello @juan131 
I have fixed containerd tests (you may be using macOS or a non-AMD64 processor. In this case, we are skipping containerd tests - https://github.com/aquasecurity/trivy/blob/b6fafa04a28a35c91b107c7d8d29d4f217fb94ec/pkg/fanal/test/integration/containerd_test.go#L1, https://github.com/aquasecurity/trivy/blob/b6fafa04a28a35c91b107c7d8d29d4f217fb94ec/pkg/fanal/test/integration/containerd_test.go#L118)

About ClientServer tests:
you need to update `rpc` package - https://github.com/aquasecurity/trivy/blob/b6fafa04a28a35c91b107c7d8d29d4f217fb94ec/rpc/common/service.proto#L104

Looks like your changes don't work in client-server mode."
1813977725,5439,juan131,2023-11-16T08:18:06Z,"Awesome! Thanks @DmitriyLewen , as you mentioned I'm using a M1 mac and that makes total sense"
1814394912,5439,juan131,2023-11-16T13:01:22Z,I think we're ready to go @knqyf263 @DmitriyLewen 
1815729151,5439,DmitriyLewen,2023-11-17T04:25:20Z,"@juan131 I left some comments.
Also looks like we don't need to build purl for packages for SBOM formats (e.g. for cyclonedx - https://github.com/juan131/trivy/blob/b70cec904aee3bd187bce30565210feca6abdbb4/pkg/sbom/cyclonedx/marshal.go#L318C7-L318C7) now.
We can simply use `PkgIdentifier`.
Correct me, if i missed something."
1820487209,5439,DmitriyLewen,2023-11-21T08:54:31Z,Integration tests related to SBOM do not work. Can you take a look?
1833283284,5439,juan131,2023-11-30T08:08:14Z,Friendly reminder @DmitriyLewen @knqyf263 
1855338517,5439,juan131,2023-12-14T07:45:37Z,"Thanks for implementing the missing changes @DmitriyLewen ! I think with this the PR is ready, am I right?"
1855588094,5439,DmitriyLewen,2023-12-14T10:30:48Z,"This is a big PR and i realized that I’m already confusing myself 😄

I think the PR is ready. But perhaps this code requires refactoring.

I want to double check this with a clear head.
I'll do it tomorrow or Monday."
1862224776,5439,DmitriyLewen,2023-12-19T07:00:53Z,"Hello @juan131 
PR looks good.

We merged https://github.com/aquasecurity/trivy/pull/5764 
Can you merge `main` branch into this PR and update goldenfiles, please?"
1862280098,5439,juan131,2023-12-19T07:55:31Z,Thanks @DmitriyLewen !! PR was updated
1862357498,5439,DmitriyLewen,2023-12-19T08:53:53Z,"@juan131  there is conflict.
I'm also confused - GitHub marked go.mod and go.sum files as modified - https://github.com/aquasecurity/trivy/pull/5439/files#diff-33ef32bf6c23acb95f5902d7097b7a1d5128ca061167ec0716715b0b9eeaa5f6R16 "
1862369561,5439,juan131,2023-12-19T09:02:13Z,Conflict solved @DmitriyLewen 
1862377773,5439,knqyf263,2023-12-19T09:07:44Z,I'm slowly starting to work this week and will review this PR shortly.
1873724652,5439,juan131,2024-01-02T08:21:24Z,Awesome! Thanks so much @knqyf263 @DmitriyLewen 
2412031640,7732,itaysk,2024-10-14T19:12:43Z,"the release note says: ""Databases are downloaded in priority order until one is successful"". does this mean that trivy will keep cycling through list ""until one is successful""? or if it reaches the end it will error out"
2424758880,7732,itaysk,2024-10-20T09:25:16Z,"I wanted to incorporate the rate limiting mitigation steps post into the documentation, but after re-reading the docs I see that there's a growing overlap between the ""advanced netwrok scenatios"" (aka air-gap) doc, and the ""Database cofiguration"" doc. The way I thought about it is that the configuration document only describes the flags avaialble and technical usage, and the air gap doc talks more about the scenario and provides recommendations. Does this make sense to you? if so, I'll need to refactor both documents accordingly"
2444773709,7732,itaysk,2024-10-29T16:26:50Z,"I ended up reorganizing the configuration/db doc and the air-gapped doc, such that the db doc now documents everything related to trivy's databases, including purpose, requirements, and configuration options, and the air-gapped explains how to setup trivy in a network constraint environment. I also incorporated parts from the yet-to-be-published db throttling announcement into the relevant documents."
2449655307,7732,itaysk,2024-10-31T11:44:52Z,"> I think we want to add a new page for ""Self-Hosting Databases"".

I wasn't sure what would be left in the airgap doc if we move most of the content to a shared page. Also it's currently called ""Air-Gapped Environments and Self-Hosting"", so I moved the media types table based there."
2451229216,7732,knqyf263,2024-11-01T03:33:56Z,">I wasn't sure what would be left in the airgap doc if we move most of the content to a shared page.

The page on the air-gapped environment originally showed how to download and populate databases manually. Self-hosting is not directly related to the air-gapped environment, so we can just link to it from the air-gapped environment page.


```
# Air-Gapped Environments

## Manual cache population
...

## Self-Hosting
You can also use self-hosted databases. Please see [here](./self-host.md) for details.
```

```
# Self-Hosting
Self-hosting databases helps you with:

- Rate limits
- Reducing outgoing network traffic
- [Air-Gapped Environments](./air-gap.md)

## Copying databases into your registry
...

## Media types
...
```"
2457594847,7732,itaysk,2024-11-05T16:10:03Z,"I've restructured as follows:
1. configuration/db - basic information about trivy's main dbs: vulns, java, checks. no specific info on network stuff
2. network connectivity - all the information about trivy's verious network connectivity requirements and mitigation steps (including air-gap doc)
3. self-hosting - how to host the dbs and vex hub locally (may be improved in a future PR)"
2457601211,7732,itaysk,2024-11-05T16:12:40Z,"@knqyf263 actually, now that I'm reading your comment, I see you suggested a slightly different arrangement. after diving into editing I got drifted into another path, but your's make sense to me too. I'll let you review the current proposal and if we want I don't mind doing another interation that is exactly like you specified."
2488338518,7732,itaysk,2024-11-20T11:32:31Z,thanks for your review @wkoot !
708964102,679,rahul2393,2020-10-15T07:40:56Z,@knqyf263 Done
708966534,679,knqyf263,2020-10-15T07:45:45Z,@rahul2393 The linter test seems to be failing.
708970849,679,rahul2393,2020-10-15T07:54:18Z,"As I said it will fail, but once merged it will succeed
https://github.com/aquasecurity/trivy/pull/679#discussion_r505226763
@knqyf263 "
708974841,679,rahul2393,2020-10-15T08:01:31Z,Let me know what are next action items now
709069972,679,knqyf263,2020-10-15T10:04:47Z,">As I said it will fail

Could you clarify it? I don't get your point yet."
709081454,679,rahul2393,2020-10-15T10:13:13Z,"@knqyf263 see the last commit linters passed here https://github.com/aquasecurity/trivy/pull/679/commits/601d1261814185373199108ce395581f8493ab26 so once I revert it, linters will fail but once merged it will pass"
709083302,679,knqyf263,2020-10-15T10:14:40Z,"No, I meant why it needs to be rahul2393."
709093223,679,rahul2393,2020-10-15T10:19:03Z,Maybe because the workflow run my forked repo
709099567,679,knqyf263,2020-10-15T10:21:40Z,"I also thought so, but I didn't find the clue. And if so, it means PR always fails the linter test."
709102945,679,rahul2393,2020-10-15T10:22:57Z,@knqyf263 removed that config now I think its good.
709112298,679,knqyf263,2020-10-15T10:26:38Z,"We should find out what effect the option has and make sure it's okay to remove it. We have to avoid ""we don't know why it fails, but it looks good after removing it"" as much as possible."
709135290,679,rahul2393,2020-10-15T10:37:23Z,"@knqyf263 this is to grouping the import in separate lines and disabling local prefixes will not cause issue.
https://stackoverflow.com/a/59964885"
709378734,679,rahul2393,2020-10-15T14:50:48Z,"@knqyf263 Check now, added back the local-prefixes goimport and linter issues fixed"
711141268,679,knqyf263,2020-10-18T09:29:32Z,"Hmm. Please allow me to check that my understanding is correct or not. What you said as follows is not correct, right? Even after it is merged, the grouping still violates the policy, so the test will fail.
https://github.com/aquasecurity/trivy/pull/679#issuecomment-708970849

Also, can we specify `github.com/aquasecurity`, not `github.com/aquasecurity/trivy`? The repositories under `github.com/aquasecurity` are also developed by us, so we can call it local."
711867528,679,rahul2393,2020-10-19T08:48:46Z,"@knqyf263 Done, make sense to add ""github.com/aquasecurity"" as local prefix."
711872591,679,knqyf263,2020-10-19T08:53:31Z,@rahul2393 What about the first question? Is my understanding correct? I'd like to figure out what was wrong.
711875620,679,rahul2393,2020-10-19T08:56:22Z,"Yes, I was wrong before, if its merged now it will work fine because in all the files the grouping is fine, e.g
1) go internal packages
2) third party packages
3) acquasecurity libs
all 3 separated by single space, earlier I was wrong because I put forked local prefix although it was passing it was wrong because it was considering ""github.com/rahul2393"" as local prefix "
711884026,679,knqyf263,2020-10-19T09:04:26Z,It makes sense. Thanks! I'll take a look at last.
712626854,679,rahul2393,2020-10-20T06:32:59Z,@knqyf263 I tried fixing all these issues
712809652,679,knqyf263,2020-10-20T12:20:39Z,@rahul2393 Thanks.
2132845075,6781,nikpivkin,2024-05-27T07:41:19Z,Left a little comment. LGTM
2133701956,6781,simar7,2024-05-27T15:30:37Z,"> For example, if a PR is labeled backport-to-v0.51 with, it will create a PR to backport the commit to the v0.51 branch.

Is the prefix for the PR `backport-to-v0.51` or `v0.51` as the example shows?"
2133727079,6781,knqyf263,2024-05-27T15:46:10Z,"The prefix `backport-to-` is needed for the label. The branch name convention can be discussed. `backport-to-v0.51`, `backport-to-release-v0.51` or `backport-to-release/v0.51`.

>Is the prefix for the PR backport-to-v0.51 or v0.51 as the example shows?

Is there any place `v0.51` is used as an example?"
2133776527,6781,simar7,2024-05-27T16:06:32Z,"
> Is there any place `v0.51` is used as an example?

![image](https://github.com/aquasecurity/trivy/assets/1254783/cd4729f8-6891-4fab-891d-25fb9f4566ef)

I assume you're talking about the PR title?

https://github.com/knqyf263/trivy/pull/27
"
2133857663,6781,knqyf263,2024-05-27T17:22:32Z,`backport-to-` is a label. `[v0.51]` is a PR title automatically generated by [backport](https://github.com/sorenlouv/backport-github-action). But the title is no big deal. The label is the main topic here.
2133862717,6781,simar7,2024-05-27T17:28:18Z,"> `backport-to-` is a label. `[v0.51]` is a PR title automatically generated by [backport](https://github.com/sorenlouv/backport-github-action). But the title is no big deal. The label is the main topic here.

OK I understand now. I didn't see the label on that PR either so was confused. ![image](https://github.com/aquasecurity/trivy/assets/1254783/b914d538-7a38-477d-b8a4-189b6257835a)

Either way the proposal looks good to me. "
2133882834,6781,knqyf263,2024-05-27T17:51:01Z,">I didn't see the label on that PR either so was confused.

I now see why you're confused. PRs that you want to backport are labeled, while auto-generated backported PRs are not labeled.
https://github.com/knqyf263/trivy/pull/20"
2147054588,6781,DmitriyLewen,2024-06-04T09:30:41Z,"One more thing - can we automatically delete the `backport/release/<tag>/pr-<pr-number>` branches after merge backport PR (e.g. https://github.com/DmitriyLewen/trivy/pull/73)?

"
2147200855,6781,knqyf263,2024-06-04T10:37:28Z,">One more thing - can we automatically delete the backport/release/<tag>/pr-<pr-number> branches after merge backport PR (e.g. https://github.com/DmitriyLewen/trivy/pull/73)?

What if enabling this feature?
https://github.com/DmitriyLewen/trivy/settings

![CleanShot 2024-06-04 at 14 37 03](https://github.com/aquasecurity/trivy/assets/2253692/b433d71d-5a58-4255-a18e-7a1c7422c679)
"
2148789299,6781,DmitriyLewen,2024-06-05T03:33:55Z,"> What if enabling this feature?

It works good :+1: "
2149450734,6781,knqyf263,2024-06-05T10:29:41Z,"@DmitriyLewen I wrote a small script. Please take a look.
https://github.com/aquasecurity/trivy/pull/6781/commits/f330e9554758904e8d1ab8e4ab79c1bdc580dae1

It force-commits conflicts, but the PR shows a warning message about it.
https://github.com/knqyf263/trivy/pull/63

You can see https://github.com/knqyf263/trivy/pull/60 and learn how to use it. To be honest, I didn't want to create a label for each release. I switched from a label to a comment to trigger the backport. If it looks good, I'll update the document."
1828568467,5635,Octogonapus,2023-11-27T20:42:02Z,"> Can you also add tests for SPDX, CycloneDX to see how we use UUID for these formats?

Yes I would like to do this. Can you help me by pointing out where there is an example of how to do this? I looked around the code for a while but I can't figure out how to export an SBOM in code (except of course by invoking the `trivy` command)."
1829038075,5635,DmitriyLewen,2023-11-28T04:06:12Z,"take a look on `marshal_test.go` and `unmarshal_test.go` files:
CycloneDX - https://github.com/aquasecurity/trivy/tree/main/pkg/sbom/cyclonedx
SPDX - https://github.com/aquasecurity/trivy/tree/main/pkg/sbom/spdx

Integration tests for SBOM - https://github.com/aquasecurity/trivy/blob/main/integration/sbom_test.go"
1830313074,5635,Octogonapus,2023-11-28T17:06:57Z,"I pushed an SPDX test with Julia, though it currently does not pass because the SPDX marshaller is doing some sort of deduplication based on the package name. i.e. if I changed one of the `B` packages to `C`, then the test could pass. Do you know what is causing that?"
1831300486,5635,DmitriyLewen,2023-11-29T06:34:04Z,Do you mean that the packages are in random order?
1831985661,5635,Octogonapus,2023-11-29T14:19:47Z,"No, I mean that in the [SPDX marshal test I added](https://github.com/aquasecurity/trivy/pull/5635/files#diff-230de04da360ce2a4123c451af35424a21008f594cc23e58265ba5d3d11eaf2d), there are two packages named `B`, one of which (the last one) gets entirely removed during marshaling. The final SBOM contains 4 package entries instead of 5, and 4 relationships instead of 5."
1835496477,5635,DmitriyLewen,2023-12-01T05:36:52Z,"Now i understand you.
This happens because we are overwriting `hasher` function for the SPDX test:
https://github.com/aquasecurity/trivy/blob/b5874e3ad38e77ac86eedd7a65785b2933f3685f/pkg/sbom/spdx/marshal_test.go#L968-L988

Some packages (like `go binary` packages) don't have `ID`, so use that instead of `Name` here:
https://github.com/aquasecurity/trivy/blob/b5874e3ad38e77ac86eedd7a65785b2933f3685f/pkg/sbom/spdx/marshal_test.go#L974
Perphaps we can just add `Indirect` field.
wdyt?"
1836271470,5635,Octogonapus,2023-12-01T15:04:18Z,"Thanks, good idea, that worked."
1836384364,5635,Octogonapus,2023-12-01T16:16:03Z,"I pushed a CycloneDX test as well. There are a few problems with it that will require changing its marshaller:

1) There is a problem with the CycloneDX dependencies format. Only package URLs are used, so in the case of a shadowed dep, you don't know which `B` package is being referenced since there are two `pkg:julia/B@1.9.0`. Are we required to use PURLs or can we use another format? SPDX uses an arbitrary hash here and that works well.
2) I noticed this comment: https://vscode.dev/github/Octogonapus/trivy/blob/analyzer_language_julia/pkg/sbom/cyclonedx/core/cyclonedx.go#L87. Indeed this is the case as you can see in my (failing) CycloneDX test. Can this functionality be changed, or will that not conform to the CycloneDX specification? If we can't change it, Julia users should simply not use CycloneDX.
3) (applicable to SPDX as well) I have a concern about the hasher used in production, given that we use a custom hasher in tests. Should we update the default hasher rather than providing a custom one in our tests? If not, how do we know a proper hasher implementation (i.e. one which does not discard shadowed packages) will be used in production?

I guess if we really needed to, we could also change the Julia PURL spec as https://github.com/package-url/purl-spec/pull/237 has not been accepted yet. The PURLs could become `pkg:UUID@version` e.g. `pkg:edca9bc6-334e-11e9-3554-9595dbb4349c@1.9.0`."
1837808312,5635,DmitriyLewen,2023-12-04T04:08:58Z," > Only package URLs are used, so in the case of a shadowed dep, you don't know which B package is being referenced since there are two pkg:julia/B@1.9.0
 
This is a strange case. Why does Julia create duplicate dependencies?
Why can't we use existing `B` for `A`?

About PURL and BomRef - i think we can use next logic:
- create PURL as you offered 
- use pkgID (ID from julia file) for BomRef

> Can this functionality be changed

What if we update BomRef logic? if we use pkgID, we will not get a conflict, because BomRef will be unique for each julia library.

> The PURLs could become pkg:UUID@version e.g. pkg:edca9bc6-334e-11e9-3554-9595dbb4349c@1.9.0.

I don't think it's convenient. You need to read the lock file to find out the dependency name. But we can use `tag_id` for UUID (as for https://github.com/package-url/purl-spec/blob/master/PURL-TYPES.rst#swid)
wdyt?

> Should we update the default hasher rather than providing a custom one in our tests 

If I remember correctly, we added this because SPDX uses different hashes for each run(take a look this test - https://github.com/aquasecurity/trivy/blob/aedbd85d6e3f3fa26ccf47827cfa9aacf1c7c834/integration/repo_test.go#L360-L368). "
1843676898,5635,Octogonapus,2023-12-06T20:55:51Z,"> This is a strange case. Why does Julia create duplicate dependencies?
Why can't we use existing B for A?

Julia allows you to add two dependencies with the same name but different UUIDs. This is an edge case, but given that it is allowed, I think it is important to test.

Your suggestions for the PURL sounds good to me. After reviewing the spec, I can simply add a qualifier for the `uuid`. I will work on adding this to the spec and to https://github.com/package-url/packageurl-go."
1843762023,5635,Octogonapus,2023-12-06T22:03:21Z,"I added two integration tests for Julia SBOMs (SPDX and CycloneDX). I can't manage to run the tests, though:
```
cd integration
go test
package github.com/aquasecurity/trivy/integration: build constraints exclude all Go files in /home/salmon/Documents/code/trivy/integration
```

or
```
mage test:integration
No .go files marked with the mage build tag in this directory.
```

So the tests might be wrong. If admin could trigger CI, that would be helpful so I can fix the tests."
1844677084,5635,DmitriyLewen,2023-12-07T06:11:27Z,"You need to run `mage test:integration` from the root directory of the trivy repository:
```bash
➜ ls -dhl */
drwxr-xr-x  11 work  staff   352B Jul 31 09:25 brand/
drwxr-xr-x   4 work  staff   128B Aug 30 08:51 ci/
drwxr-xr-x   3 work  staff    96B Jul 31 09:25 cmd/
drwxr-xr-x  10 work  staff   320B Oct 31 12:24 contrib/
drwxr-xr-x  11 work  staff   352B Dec  7 10:47 docs/
drwxr-xr-x   4 work  staff   128B Jul 31 09:25 examples/
drwxr-xr-x   3 work  staff    96B Jul 31 09:25 helm/
drwxr-xr-x  15 work  staff   480B Dec  7 11:40 integration/
drwxr-xr-x   3 work  staff    96B Nov 30 10:08 internal/
drwxr-xr-x   5 work  staff   160B Dec  7 12:07 magefiles/
drwxr-xr-x   5 work  staff   160B Oct 31 12:24 misc/
drwxr-xr-x  43 work  staff   1.3K Nov 30 10:08 pkg/
drwxr-xr-x   5 work  staff   160B Jul 31 09:25 rpc/

➜ mage test:integration
?       github.com/aquasecurity/trivy/pkg/fanal/test/integration/docker [no test files]
...
```

> I will work on adding this to the spec and to https://github.com/package-url/packageurl-go.

Let us know about this work. It may make sense to wait for these changes before merging this PR."
1845681093,5635,Octogonapus,2023-12-07T16:44:20Z,"> You need to run mage test:integration from the root directory of the trivy repository

That is what I did.

> Let us know about this work. It may make sense to wait for these changes before merging this PR.

I've updated the spec PR. Luckily there are no changes required in `packageurl-go`."
1846504703,5635,DmitriyLewen,2023-12-08T03:43:46Z,"> That is what I did. 

hm.. this is strange.
How did you install `mage`?

Also you can copy command from mage file (e.g. https://github.com/aquasecurity/trivy/blob/01edbda3472ebbbe71f341d1741194ec35de7d69/magefiles/magefile.go#L239-L243)
and use it in bash.

Anyway i ran tests in CI/CD.
"
1847755843,5635,Octogonapus,2023-12-08T19:44:49Z,"I reinstalled mage from source and it is working now :shrug: 

I fixed the integration tests. Everything is looking good to me, now that the PURL includes the UUID."
1853382394,5635,DmitriyLewen,2023-12-13T07:15:47Z,"@Octogonapus 
Can you fix linter errors, please?"
1854051449,5635,Octogonapus,2023-12-13T14:46:07Z,Done
1857242430,5635,DmitriyLewen,2023-12-15T04:07:16Z,"Hello @Octogonapus
Test failed.
There seems to be a problem with the sorting.
Can you take a look?"
1858192052,5635,Octogonapus,2023-12-15T16:57:48Z,Yes there was a sorting issue. We need to also consider the package ID when there are two shadowed packages.
1859698085,5635,DmitriyLewen,2023-12-18T07:37:21Z,"Got it! Thanks!
I think we can compare pkgID first (as in go-dep-parser - https://github.com/aquasecurity/go-dep-parser/blob/7f61702018f9ede257edc357507560e4fcf526c7/pkg/types/types.go#L23)"
1859723350,5635,DmitriyLewen,2023-12-18T07:59:59Z,"hm... this change breaks any other tests.
okay, i [reverted](https://github.com/aquasecurity/trivy/pull/5635/commits/916610ea49c1d8c697732ae1f67af319289da112) last changes.

If necessary, we will change the sorting order in another PR."
1932383803,5635,ericphanson,2024-02-07T16:10:53Z,"I built trivy from this PR and tried running it locally. It seemed to work well on filesystems, but panic'd when I ran it on a docker image:
```julia
>trivy image --format spdx-json --output result.json my_image

2024-02-07T17:07:02.384+0100    INFO    ""--format spdx"" and ""--format spdx-json"" disable security scanning
panic: assignment to entry in nil map

goroutine 79 [running]:
github.com/BurntSushi/toml.(*MetaData).unifyMap(0x14001a9be80, {0x10ada2340?, 0x14001fd0330}, {0x10ada0ae0?, 0x14001f7d038?, 0x102e9d8ac?})
        /Users/eph/go/pkg/mod/github.com/!burnt!sushi/toml@v1.3.2/decode.go:325 +0x3d8
github.com/BurntSushi/toml.(*MetaData).unify(0x14001a9be80, {0x10ada2340, 0x14001fd0330}, {0x10ada0ae0?, 0x14001f7d038?, 0x0?})
        /Users/eph/go/pkg/mod/github.com/!burnt!sushi/toml@v1.3.2/decode.go:241 +0x270
github.com/BurntSushi/toml.(*MetaData).PrimitiveDecode(0x14001a9be80, {{0x10ada2340, 0x14001fd0330}, {0x140001e37c0, 0x2, 0x2}}, {0x10a90a5a0?, 0x14001f7d038?})
        /Users/eph/go/pkg/mod/github.com/!burnt!sushi/toml@v1.3.2/decode.go:185 +0xcc
github.com/aquasecurity/go-dep-parser/pkg/julia/manifest.decodeDependency(0x14001fd01b0, {{{0x10ada2340, 0x14001fd0330}, {0x140001e37c0, 0x2, 0x2}}, {0x14001fcc450, 0x24}, {0x0, 0x0}, ...}, ...)
        /Users/eph/go/pkg/mod/github.com/aquasecurity/go-dep-parser@v0.0.0-20231229070651-5f0903175562/pkg/julia/manifest/parse.go:151 +0x10c
github.com/aquasecurity/go-dep-parser/pkg/julia/manifest.decodeManifest(0x14001fd01b0, 0x10a9d6ae0?)
        /Users/eph/go/pkg/mod/github.com/aquasecurity/go-dep-parser@v0.0.0-20231229070651-5f0903175562/pkg/julia/manifest/parse.go:116 +0x1ec
github.com/aquasecurity/go-dep-parser/pkg/julia/manifest.(*Parser).Parse(0x10b9fc000?, {0x10ba9dec0?, 0x14001f7d028})
        /Users/eph/go/pkg/mod/github.com/aquasecurity/go-dep-parser@v0.0.0-20231229070651-5f0903175562/pkg/julia/manifest/parse.go:58 +0x264
github.com/aquasecurity/trivy/pkg/fanal/analyzer/language.Parse({0x108e89638, 0x5}, {0x14001f85300, 0x36}, {0x10b9fc000?, 0x14001f7d028?}, {0x10ba11100, 0x10f78b5e0})
        /Users/eph/trivy/pkg/fanal/analyzer/language/analyze.go:53 +0xac
github.com/aquasecurity/trivy/pkg/fanal/analyzer/language/julia/pkg.juliaAnalyzer.parseJuliaManifest(...)
        /Users/eph/trivy/pkg/fanal/analyzer/language/julia/pkg/pkg.go:101
github.com/aquasecurity/trivy/pkg/fanal/analyzer/language/julia/pkg.juliaAnalyzer.PostAnalyze.func2({0x14001f85300, 0x36}, {0x36?, 0x40?}, {0x10b9fc000?, 0x14001f7d028?})
        /Users/eph/trivy/pkg/fanal/analyzer/language/julia/pkg/pkg.go:62 +0x6c
github.com/aquasecurity/trivy/pkg/fanal/analyzer/language/julia/pkg.juliaAnalyzer.PostAnalyze.WalkDir.func3({0x14001f85300, 0x36}, {0x10bab01b0, 0x140016f9360}, {0x0?, 0x0?})
        /Users/eph/trivy/pkg/utils/fsutils/fs.go:106 +0x194
io/fs.walkDir({0x10b9fc860, 0x14002fecfa8}, {0x14001f85300, 0x36}, {0x10bab01b0, 0x140016f9360}, 0x14001a9cb78)
        /opt/homebrew/Cellar/go/1.21.4/libexec/src/io/fs/walk.go:73 +0x5c
io/fs.walkDir({0x10b9fc860, 0x14002fecfa8}, {0x14001f636e0, 0x28}, {0x10bab01b0, 0x140013561d8}, 0x14001a9cb78)
        /opt/homebrew/Cellar/go/1.21.4/libexec/src/io/fs/walk.go:95 +0x254
io/fs.walkDir({0x10b9fc860, 0x14002fecfa8}, {0x14003d44320, 0x20}, {0x10bab01b0, 0x140015141d8}, 0x14001a9cb78)
        /opt/homebrew/Cellar/go/1.21.4/libexec/src/io/fs/walk.go:95 +0x254
io/fs.walkDir({0x10b9fc860, 0x14002fecfa8}, {0x14003634460, 0x1b}, {0x10bab01b0, 0x14002f2cad8}, 0x14001a9cb78)
        /opt/homebrew/Cellar/go/1.21.4/libexec/src/io/fs/walk.go:95 +0x254
io/fs.walkDir({0x10b9fc860, 0x14002fecfa8}, {0x14000026600, 0x15}, {0x10bab01b0, 0x14002f2c898}, 0x14001a9cb78)
        /opt/homebrew/Cellar/go/1.21.4/libexec/src/io/fs/walk.go:95 +0x254
io/fs.walkDir({0x10b9fc860, 0x14002fecfa8}, {0x14002147c50, 0xf}, {0x10bab01b0, 0x14002f2c808}, 0x14001a9cb78)
        /opt/homebrew/Cellar/go/1.21.4/libexec/src/io/fs/walk.go:95 +0x254
io/fs.walkDir({0x10b9fc860, 0x14002fecfa8}, {0x14002147c30, 0x9}, {0x10bab01b0, 0x14002f2c778}, 0x14001a9cb78)
        /opt/homebrew/Cellar/go/1.21.4/libexec/src/io/fs/walk.go:95 +0x254
io/fs.walkDir({0x10b9fc860, 0x14002fecfa8}, {0x14002147c1a, 0x3}, {0x10bab01b0, 0x14002f2c6e8}, 0x14001a9cb78)
        /opt/homebrew/Cellar/go/1.21.4/libexec/src/io/fs/walk.go:95 +0x254
io/fs.walkDir({0x10b9fc860, 0x14002fecfa8}, {0x10a500428, 0x1}, {0x10baaf9b0, 0x1400359dc80}, 0x14001a9cb78)
        /opt/homebrew/Cellar/go/1.21.4/libexec/src/io/fs/walk.go:95 +0x254
io/fs.WalkDir({0x10b9fc860, 0x14002fecfa8}, {0x10a500428, 0x1}, 0x140035aab78)
        /opt/homebrew/Cellar/go/1.21.4/libexec/src/io/fs/walk.go:122 +0xc0
github.com/aquasecurity/trivy/pkg/utils/fsutils.WalkDir(...)
        /Users/eph/trivy/pkg/utils/fsutils/fs.go:93
github.com/aquasecurity/trivy/pkg/fanal/analyzer/language/julia/pkg.juliaAnalyzer.PostAnalyze({{0x10ba11100?, 0x10f78b5e0?}}, {0x1400059c0a0?, 0x10aa35040?}, {{0x10b9fc860?, 0x14002fecfa8?}, {0x38?, 0x96?}})
        /Users/eph/trivy/pkg/fanal/analyzer/language/julia/pkg/pkg.go:60 +0xc0
github.com/aquasecurity/trivy/pkg/fanal/analyzer.AnalyzerGroup.PostAnalyze({{0x14003330000, 0x1c, 0x20}, {0x14001f90400, 0x7, 0x8}, 0x140025f9740}, {0x10baaf760, 0x1400338e1e0}, 0x14001d580f0, ...)
        /Users/eph/trivy/pkg/fanal/analyzer/analyzer.go:491 +0x23c
github.com/aquasecurity/trivy/pkg/fanal/artifact/image.Artifact.inspectLayer({{0x10bad1d90, 0x140031864c0}, {0x138deacd8, 0x140024ca000}, {{{0x0, 0x0, 0x0}, {0x140031865c0, 0x3, 0x4}}, ...}, ...}, ...)
        /Users/eph/trivy/pkg/fanal/artifact/image/image.go:297 +0x530
github.com/aquasecurity/trivy/pkg/fanal/artifact/image.Artifact.inspect.func1({0x10baaf760, 0x1400338e1e0}, {0x140033c2320, 0x47})
        /Users/eph/trivy/pkg/fanal/artifact/image/image.go:214 +0x1c8
github.com/aquasecurity/trivy/pkg/parallel.(*Pipeline[...]).Do.func2()
        /Users/eph/trivy/pkg/parallel/pipeline.go:82 +0x84
golang.org/x/sync/errgroup.(*Group).Go.func1()
        /Users/eph/go/pkg/mod/golang.org/x/sync@v0.5.0/errgroup/errgroup.go:75 +0x58
created by golang.org/x/sync/errgroup.(*Group).Go in goroutine 1
        /Users/eph/go/pkg/mod/golang.org/x/sync@v0.5.0/errgroup/errgroup.go:72 +0x98
```

I am using an m1 mac, built trivy natively, but the image was built under rosetta, so maybe that's the issue?"
1933342837,5635,DmitriyLewen,2024-02-08T04:24:06Z,"Hello @ericphanson 
Can you share a test image? The problem seems to be related to the parsing of the julia toml file."
1933708693,5635,ericphanson,2024-02-08T09:49:46Z,"Sure, I can reproduce by creating a Dockerfile with just:
```dockerfile
FROM julia:latest
WORKDIR /env
RUN julia --project=. -e 'using Pkg; Pkg.add(""Example"")'
```
Then running `mwe.sh` which contains:
```sh
#!/usr/bin/env bash
set -eu

docker build . -t eph/test

# using trivy built from this PR:
/Users/eph/go/bin/trivy image --format spdx-json --output result.json eph/test:latest
```
gives me
```sh
./mwe.sh
[+] Building 1.4s (8/8) FINISHED                                                                                                                            
 => [internal] load build definition from Dockerfile                                                                                                   0.0s
 => => transferring dockerfile: 125B                                                                                                                   0.0s
 => [internal] load .dockerignore                                                                                                                      0.0s
 => => transferring context: 2B                                                                                                                        0.0s
 => [internal] load metadata for docker.io/library/julia:latest                                                                                        1.3s
 => [auth] library/julia:pull token for registry-1.docker.io                                                                                           0.0s
 => [1/3] FROM docker.io/library/julia:latest@sha256:d527affa89d0037f581be4b0547b1bafd24c076a6607f417abed6a4b032fbb3b                                  0.0s
 => CACHED [2/3] WORKDIR /env                                                                                                                          0.0s
 => CACHED [3/3] RUN julia --project=. -e 'using Pkg; Pkg.add(""Example"")'                                                                              0.0s
 => exporting to image                                                                                                                                 0.0s
 => => exporting layers                                                                                                                                0.0s
 => => writing image sha256:a053d3a5ef97d06c8cd834bb7d11b9c59c1a156817aed7e80d05d59339b0588a                                                           0.0s
 => => naming to docker.io/eph/test                                                                                                                    0.0s
2024-02-08T10:45:51.802+0100    INFO    ""--format spdx"" and ""--format spdx-json"" disable security scanning
panic: assignment to entry in nil map

goroutine 12 [running]:
github.com/BurntSushi/toml.(*MetaData).unifyMap(0x14002411d58, {0x10c565d00, 0x14002a66360}, {0x10c564380?, 0x140000fcd30?, 0x140000fcd30?})
        /Users/eph/go/pkg/mod/github.com/!burnt!sushi/toml@v1.3.2/decode.go:325 +0x3d4
github.com/BurntSushi/toml.(*MetaData).unify(0x14002411d58, {0x10c565d00, 0x14002a66360}, {0x10c564380?, 0x140000fcd30?, 0x140000fcd30?})
        /Users/eph/go/pkg/mod/github.com/!burnt!sushi/toml@v1.3.2/decode.go:241 +0x3a0
github.com/BurntSushi/toml.(*MetaData).PrimitiveDecode(0x14002411d58, {{0x10c565d00, 0x14002a66360}, {0x1400039dec0, 0x2, 0x2}}, {0x10c0cb440?, 0x140000fcd30?})
        /Users/eph/go/pkg/mod/github.com/!burnt!sushi/toml@v1.3.2/decode.go:185 +0xcc
github.com/aquasecurity/go-dep-parser/pkg/julia/manifest.decodeDependency(0x14002a661e0, {{{0x10c565d00, 0x14002a66360}, {0x1400039dec0, 0x2, 0x2}}, {0x14002a33380, 0x24}, {0x0, 0x0}, ...}, ...)
        /Users/eph/go/pkg/mod/github.com/aquasecurity/go-dep-parser@v0.0.0-20231229070651-5f0903175562/pkg/julia/manifest/parse.go:151 +0x104
github.com/aquasecurity/go-dep-parser/pkg/julia/manifest.decodeManifest(0x14002a661e0, 0x14002411d58)
        /Users/eph/go/pkg/mod/github.com/aquasecurity/go-dep-parser@v0.0.0-20231229070651-5f0903175562/pkg/julia/manifest/parse.go:116 +0x1dc
github.com/aquasecurity/go-dep-parser/pkg/julia/manifest.(*Parser).Parse(0x10d17ba60?, {0x10d21d920, 0x140000fcd20})
        /Users/eph/go/pkg/mod/github.com/aquasecurity/go-dep-parser@v0.0.0-20231229070651-5f0903175562/pkg/julia/manifest/parse.go:58 +0x270
github.com/aquasecurity/trivy/pkg/fanal/analyzer/language.Parse({0x10a5102c1, 0x5}, {0x140029e19c0, 0x36}, {0x10d17ba60?, 0x140000fcd20?}, {0x10d190b80, 0x111295f08})
        /Users/eph/trivy/pkg/fanal/analyzer/language/analyze.go:53 +0xac
github.com/aquasecurity/trivy/pkg/fanal/analyzer/language/julia/pkg.juliaAnalyzer.parseJuliaManifest(...)
        /Users/eph/trivy/pkg/fanal/analyzer/language/julia/pkg/pkg.go:101
github.com/aquasecurity/trivy/pkg/fanal/analyzer/language/julia/pkg.juliaAnalyzer.PostAnalyze.func2({0x140029e19c0, 0x36}, {0x36?, 0x4b?}, {0x10d17ba60?, 0x140000fcd20?})
        /Users/eph/trivy/pkg/fanal/analyzer/language/julia/pkg/pkg.go:62 +0x6c
github.com/aquasecurity/trivy/pkg/fanal/analyzer/language/julia/pkg.juliaAnalyzer.PostAnalyze.WalkDir.func3({0x140029e19c0, 0x36}, {0x10d22fbb0, 0x1400102aeb0}, {0x0?, 0x0?})
        /Users/eph/trivy/pkg/utils/fsutils/fs.go:106 +0x1b0
io/fs.walkDir({0x10d17c2e0, 0x1400224c300}, {0x140029e19c0, 0x36}, {0x10d22fbb0, 0x1400102aeb0}, 0x14002412bd0)
        /usr/local/go/src/io/fs/walk.go:73 +0x5c
io/fs.walkDir({0x10d17c2e0, 0x1400224c300}, {0x140029bb140, 0x28}, {0x10d22fbb0, 0x14001d5a928}, 0x14002412bd0)
        /usr/local/go/src/io/fs/walk.go:95 +0x24c
io/fs.walkDir({0x10d17c2e0, 0x1400224c300}, {0x14003f9bfe0, 0x20}, {0x10d22fbb0, 0x14001c80b68}, 0x14002412bd0)
        /usr/local/go/src/io/fs/walk.go:95 +0x24c
io/fs.walkDir({0x10d17c2e0, 0x1400224c300}, {0x14004107d00, 0x1b}, {0x10d22fbb0, 0x140018662f8}, 0x14002412bd0)
        /usr/local/go/src/io/fs/walk.go:95 +0x24c
io/fs.walkDir({0x10d17c2e0, 0x1400224c300}, {0x1400214f788, 0x15}, {0x10d22fbb0, 0x14001866268}, 0x14002412bd0)
        /usr/local/go/src/io/fs/walk.go:95 +0x24c
io/fs.walkDir({0x10d17c2e0, 0x1400224c300}, {0x140031a4b90, 0xf}, {0x10d22fbb0, 0x140018661d8}, 0x14002412bd0)
        /usr/local/go/src/io/fs/walk.go:95 +0x24c
io/fs.walkDir({0x10d17c2e0, 0x1400224c300}, {0x140031a4b70, 0x9}, {0x10d22fbb0, 0x14001866148}, 0x14002412bd0)
        /usr/local/go/src/io/fs/walk.go:95 +0x24c
io/fs.walkDir({0x10d17c2e0, 0x1400224c300}, {0x140031a4b60, 0x3}, {0x10d22fbb0, 0x140018660b8}, 0x14002412bd0)
        /usr/local/go/src/io/fs/walk.go:95 +0x24c
io/fs.walkDir({0x10d17c2e0, 0x1400224c300}, {0x10bcb3cb0, 0x1}, {0x10d22f410, 0x14003c13d50}, 0x14002412bd0)
        /usr/local/go/src/io/fs/walk.go:95 +0x24c
io/fs.WalkDir({0x10d17c2e0, 0x1400224c300}, {0x10bcb3cb0, 0x1}, 0x14002d1abd0)
        /usr/local/go/src/io/fs/walk.go:122 +0x8c
github.com/aquasecurity/trivy/pkg/utils/fsutils.WalkDir(...)
        /Users/eph/trivy/pkg/utils/fsutils/fs.go:93
github.com/aquasecurity/trivy/pkg/fanal/analyzer/language/julia/pkg.juliaAnalyzer.PostAnalyze({{0x10d190b80?, 0x111295f08?}}, {0x140003f2260?, 0x10c1f63c0?}, {{0x10d17c2e0?, 0x1400224c300?}, {0xc1?, 0x2?}})
        /Users/eph/trivy/pkg/fanal/analyzer/language/julia/pkg/pkg.go:60 +0xc0
github.com/aquasecurity/trivy/pkg/fanal/analyzer.AnalyzerGroup.PostAnalyze({{0x14001468400, 0x1c, 0x20}, {0x140020fc780, 0x7, 0x8}, 0x14003c15aa0}, {0x10d22f1c0, 0x14002222d20}, 0x14002d320f0, ...)
        /Users/eph/trivy/pkg/fanal/analyzer/analyzer.go:491 +0x224
github.com/aquasecurity/trivy/pkg/fanal/artifact/image.Artifact.inspectLayer({{0x10d255810, 0x14000163080}, {0x11af9e568, 0x14001b09490}, {{{0x0, 0x0, 0x0}, {0x1400223f680, 0x3, 0x4}}, ...}, ...}, ...)
        /Users/eph/trivy/pkg/fanal/artifact/image/image.go:297 +0x52c
github.com/aquasecurity/trivy/pkg/fanal/artifact/image.Artifact.inspect.func1({0x10d22f1c0, 0x14002222d20}, {0x140024ed770, 0x47})
        /Users/eph/trivy/pkg/fanal/artifact/image/image.go:214 +0x1c8
github.com/aquasecurity/trivy/pkg/parallel.(*Pipeline[...]).Do.func2()
        /Users/eph/trivy/pkg/parallel/pipeline.go:82 +0x84
golang.org/x/sync/errgroup.(*Group).Go.func1()
        /Users/eph/go/pkg/mod/golang.org/x/sync@v0.5.0/errgroup/errgroup.go:75 +0x58
created by golang.org/x/sync/errgroup.(*Group).Go in goroutine 1
        /Users/eph/go/pkg/mod/golang.org/x/sync@v0.5.0/errgroup/errgroup.go:72 +0x98
```

We can also look at the TOMLs:
```toml
❯ docker run -it --rm eph/test cat /env/Manifest.toml
# This file is machine-generated - editing it directly is not advised

julia_version = ""1.10.0""
manifest_format = ""2.0""
project_hash = ""2ca1c6c58cb30e79e021fb54e5626c96d05d5fdc""

[[deps.Example]]
git-tree-sha1 = ""46e44e869b4d90b96bd8ed1fdcf32244fddfb6cc""
uuid = ""7876af07-990d-54b4-ab0e-23690620f79a""
version = ""0.5.3""
```
and 
```toml
❯ docker run -it --rm eph/test cat /env/Project.toml
[deps]
Example = ""7876af07-990d-54b4-ab0e-23690620f79a""
```

(Now I don't think it's a rosetta thing, since I built and ran this both on `arm64`)"
1934790994,5635,Octogonapus,2024-02-08T19:20:24Z,"I copied your given project and manifest files into a test case, and it is correctly parsed into this object:
```go
Applications: []types.Application{
	{
		Type:     types.Julia,
		FilePath: ""Manifest.toml"",
		Libraries: []types.Package{
			{
				ID:        ""7876af07-990d-54b4-ab0e-23690620f79a"",
				Name:      ""Example"",
				Version:   ""0.5.3"",
				Indirect:  false,
				Locations: []types.Location{{StartLine: 7, EndLine: 10}},
				DependsOn: nil,
			},
		},
	},
},
```

So this PR looks okay from that perspective."
1934969625,5635,ericphanson,2024-02-08T21:34:59Z,"I do think there is some issue here, because if I install release trivy (`brew install trivy`) and change my shell script invoke that one, then there's no panic and it produces a result."
1935341046,5635,DmitriyLewen,2024-02-09T05:08:49Z,"@Octogonapus I found broken file:
```
➜  5635 docker run -it --rm 5635 cat /usr/local/julia/share/julia/test/project/Manifest.toml  
[[Foo]]
deps = [""Bar"", ""Baz"", ""Qux""]
uuid = ""767738be-2f1f-45a9-b806-0234f3164144""
git-tree-sha1 = ""7c626031568a5e432112a74009c3763f9b851e3e""
path = ""deps/Foo1""

[[Foo]]
deps = [""Qux""]
uuid = ""6f418443-bd2e-4783-b551-cdbac608adf2""
path = ""deps/Foo2.jl""

[[Bar]]
uuid = ""2a550a13-6bab-4a91-a4ee-dff34d6b99d0""
path = ""deps/Bar""
    [Bar.deps]
    Baz = ""6801f525-dc68-44e8-a4e8-cabd286279e7""
    Foo = ""6f418443-bd2e-4783-b551-cdbac608adf2""

[[Baz]]
uuid = ""6801f525-dc68-44e8-a4e8-cabd286279e7""
git-tree-sha1 = ""efc7e24c53d6a328011975294a2c75fed2f9800a""
    [Baz.deps]
    Foo = ""6f418443-bd2e-4783-b551-cdbac608adf2""
    Qux = ""b5ec9b9c-e354-47fd-b367-a348bdc8f909""

[[Qux]]
uuid = ""b5ec9b9c-e354-47fd-b367-a348bdc8f909""
path = ""deps/Qux.jl""
```

Can you take a look?"
1936307142,5635,Octogonapus,2024-02-09T17:23:24Z,Will be fixed by https://github.com/aquasecurity/go-dep-parser/pull/292
2103821989,5635,Octogonapus,2024-05-10T04:06:11Z,I'm still trying to keep this PR up to date... though it can be hard with how many refactors happen on main
1156868203,2333,CLAassistant,2022-06-15T19:55:01Z,"[![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=2333) <br/>Thank you for your submission! We really appreciate it. Like many open source projects, we ask that you all sign our [Contributor License Agreement](https://cla-assistant.io/aquasecurity/trivy?pullRequest=2333) before we can accept your contribution.<br/>**2** out of **3** committers have signed the CLA.<br/><br/>:white_check_mark: AnaisUrlichs<br/>:white_check_mark: knqyf263<br/>:x: Anais Urlichs<br/><hr/>**Anais Urlichs** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account, please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/aquasecurity/trivy?pullRequest=2333) it.</sub>"
1173595317,2333,AnaisUrlichs,2022-07-04T09:41:02Z,@itaysk @knqyf263 could you please check the PR again? 
1195580484,2333,AnaisUrlichs,2022-07-26T14:47:00Z,@knqyf263 could you please review and merge the docs with the next release or similar? 
1195702891,2333,knqyf263,2022-07-26T16:24:38Z,I don't have a strong opinion. I'm ok if Itay approves it. One thing to note is that we added some updates on our doc such as [SBOM attestation](https://aquasecurity.github.io/trivy/v0.30.3/docs/attestation/sbom/). We need to make sure all the changes are reflected to this PR.
1196392906,2333,AnaisUrlichs,2022-07-27T08:01:49Z,@knqyf263 I've merged the main branch into this one in one of my last commits
1203888458,2333,AnaisUrlichs,2022-08-03T12:32:10Z,@knqyf263 just merged main into it
1203964991,2333,knqyf263,2022-08-03T13:39:36Z,"@AnaisUrlichs Thanks.
@itaysk Would you review this PR?"
1214380772,2333,AnaisUrlichs,2022-08-14T13:41:53Z,"@itaysk @knqyf263 I made several changes based on your comments
- removed the Kubernetes tutorial from the tutorials section and added it to the community tutorials
- made it clearer what community tutorials are and where they go in the docs
- clarified what CKS stands for with a link
- merged in latest changes from main"
1214904119,2333,itaysk,2022-08-15T11:22:21Z,consider adding tekton tutorial: https://www.redhat.com/architect/cicd-pipeline-openshift-tekton
1236797164,2333,AnaisUrlichs,2022-09-05T10:03:57Z,@knqyf263 could you please have another look 🙃 
1245293681,2333,knqyf263,2022-09-13T11:44:15Z,@AnaisUrlichs Would you resolve conflicts and merge the main branch? Then I hope we can merge this PR🤞
1246552782,2333,AnaisUrlichs,2022-09-14T10:19:35Z,@knqyf263 merged main and resolved conflicts
1247636089,2333,knqyf263,2022-09-15T06:24:58Z,"I saw several rendering errors and fixed them. Also, I added some small changes."
1247694265,2333,knqyf263,2022-09-15T07:30:42Z,"@AnaisUrlichs Do you have two accounts? Looks like one of them has not signed CLA yet.
https://github.com/aquasecurity/trivy/pull/2333#issuecomment-1156868203"
2123825738,6234,simar7,2024-05-22T04:04:49Z,"@AnaisUrlichs I updated the PR with some more changes around reference the checks repo, if you are done with pushing updates to it, I think we can merge this. "
2538605709,8080,nikpivkin,2024-12-12T11:19:52Z,"@knqyf263 @DmitriyLewen Many package managers are now moving towards [PEP-735](https://peps.python.org/pep-0735/) support, which introduces the concept of dependency groups, and uv is no exception. I have now implemented skipping all groups except from the [dependencies](https://docs.astral.sh/uv/concepts/projects/dependencies/#project-dependencies) field, as groups can include dependencies for testing, linting or building documentation. Here's what it might look like:
```toml
[dependency-groups]
test = [""pytest"", ""coverage""]
docs = [""sphinx"", ""sphinx-rtd-theme""]
typing = [""mypy"", ""types-requests""]
```
The uv documentation mentions dev dependencies separately from dependency groups, but dev dependencies just belong to a `dev` group. It also says: 
> Eventually, the [dev-dependencies](https://docs.astral.sh/uv/concepts/projects/dependencies/#legacy-dev-dependencies) field will be deprecated and removed.

Is it worth skipping the dev group exclusively?

BTW, I did some tests with poetry (1.8.5). I added a dev dependency `poetry add pytest --dev` which added to the dev group:
```toml
[tool.poetry.group.dev.dependencies]
pytest = ""^8.3.4""
```
But Trivy didn't skip it because now the package in the lockfile doesn't contain the `category` field as before, based on which Trivy determines the dev dependencies. This is unusual because the lock version remains unchanged and matches the one used in our tests: `lock-version = '2.0'`.

````bash
❯ trivy fs . -f json --list-all-pkgs | grep pytest
2024-12-12-12T17:03:28+06:00 INFO [vuln] Vulnerability scanning is enabled
2024-12-12-12T17:03:28+06:00 INFO [secret] Secret scanning is enabled
2024-12-12-12T17:03:28+06:00 INFO [secret] INFO [secret] If your scanning is slow, please try '--scanners vuln' to disable secret scanning
2024-12-12-12T17:03:28+06:00 INFO [secret] Please see also https://aquasecurity.github.io/trivy/v0.58/docs/scanner/secret#recommendation for faster secret detection
2024-12-12-12T17:03:03:28+06:00 INFO Number of language-specific files num=1
2024-12-12-12T17:03:28+06:00 INFO [poetry] Detecting vulnerabilities...
          “ID"": ‘pytest@8.3.4’,
          “Name"": ‘pytest’,
            “PURL"": ‘pkg:pypi/pytest@8.3.4’,
```"
2541112750,8080,nikpivkin,2024-12-13T10:27:16Z,"> Create new issue for this case. please

Created https://github.com/aquasecurity/trivy/issues/8096"
2544685915,8080,nikpivkin,2024-12-16T06:08:13Z,"> I think we also need to skip `dev` group.

The `dev` group is already skipped. I wanted to discuss what to do with other groups such as `test` or `docs` that inherently contain dev dependencies?"
2545137944,8080,DmitriyLewen,2024-12-16T10:03:40Z,"> The dev group is already skipped. I wanted to discuss what to do with other groups such as test or docs that inherently contain dev dependencies?

Does the `dependencies` field contain these dependencies?
If so, is there a `marker` for them"
2545148187,8080,nikpivkin,2024-12-16T10:07:59Z,"`dependencies` does not contain these dependencies. 

Here's an example:
```
[dependency-groups]
test = [""pytest"", ""coverage""]
docs = [""sphinx"", ""sphinx-rtd-theme""]
typing = [""mypy"", ""types-requests""]
```"
2545185981,8080,DmitriyLewen,2024-12-16T10:24:48Z,"IIUC your logic skips these (doc, test, development etc) dependencies . 
I think we can leave this logic and wait for feedback from users and then think about it if users need these dependencies."
2551920969,8080,knqyf263,2024-12-18T17:41:46Z,"> > I think we also need to skip `dev` group.
> 
> The `dev` group is already skipped. I wanted to discuss what to do with other groups such as `test` or `docs` that inherently contain dev dependencies?

Is this about `pyproject.toml`, not `uv.lock`? I didn't find the code parsing `pyproject.toml` in this PR. What am I missing? I'm sorry I was not following the discussion."
2552818190,8080,nikpivkin,2024-12-19T05:26:47Z,"@knqyf263 This is about `uv.lock`. It contains information about all dependencies and groups of the root package. Example:
```toml
[package.dev-dependencies]
docs = [
    { name = ""mkdocs"" },
]
test = [
    { name = ""pytest"" },
]
```

For `uv` we only need to parse the lockfile, since it contains all the information we need."
2552827646,8080,knqyf263,2024-12-19T05:36:04Z,"Isn't `dependency-groups` you mentioned above about `pyproject.toml`?
https://github.com/aquasecurity/trivy/pull/8080#issuecomment-2538605709

Does it mean `dependency-groups` are copied into `uv.lock`?"
2552831464,8080,nikpivkin,2024-12-19T05:39:39Z,"That's right, it's the same dependency groups"
2552845738,8080,knqyf263,2024-12-19T05:53:37Z,"Thanks for clarifying. Is it possible to identify the dependency graph for development dependencies? We can do that in another PR, though.
https://github.com/aquasecurity/trivy/pull/8080#discussion_r1890606062"
2552850781,8080,nikpivkin,2024-12-19T05:56:29Z,"Yes, I've already started working on this so we can implement support in this PR."
2552854505,8080,knqyf263,2024-12-19T05:59:18Z,It's better to keep the PR small. Please let me merge this one.
2552856457,8080,nikpivkin,2024-12-19T06:01:01Z,@knqyf263 OK
2561809380,8177,knqyf263,2024-12-25T10:16:15Z,"@DmitriyLewen @nikpivkin Before further development, I'd like to hear your thoughts."
2562233897,8177,DmitriyLewen,2024-12-26T07:06:30Z,"> Aggregated Results for Individual Files
Proposal: Address this enhancement in a separate PR to keep the current changes focused

I agree with you. I think we need to discuss this. Initially (I may be wrong) Trivy was crippled by aggregating individual packages to avoid having too many tables in a report.
After adding summary table, we can consider removing the logic for aggregating packages entirely. This will simplify the code more and avoid difficulties when converting reports between formats.

> Current implementation shows separate rows for different finding types (e.g., vulnerabilities and secrets) in the same file
This PR maintains the current separation to keep the implementation straightforward

It seems that having multiple types for a single file is rare, so I suggest using this logic and waiting for feedback from users.

> Proposal: Enable summary table by default with an opt-out flag (e.g. --no-summary-table)

I prefer this way.

I also have one idea - some users don't need to see vulnerability/misconfiguration numbers (CVE etc). So we can hide other tables by default and show them only when using a new flag (`--show-report-tables` or something like that). Or vice versa hide them by flag if users only need summary numbers.
But I think we need to ask users about it.


____

As a future update:
- What if we check the enabled scanners and show only the required columns?
eg by default the summary table will only include the vulnerability and secret columns.
or for `misconfig` mode only the `misconfigutation` column."
2562395978,8177,nikpivkin,2024-12-26T10:07:53Z,"I like the idea, the summary table looks good. Should the results be sorted by file name or scan type? 

I noticed that terraform scan results contain directories that we should get rid of."
2562405419,8177,knqyf263,2024-12-26T10:17:32Z,">After adding summary table, we can consider removing the logic for aggregating packages entirely. This will simplify the code more and avoid difficulties when converting reports between formats.

Exactly. It will simplify our logic. However, it will probably break something. We should carefully announce it. That's why I didn't want to add the change into this PR.

>What if we check the enabled scanners and show only the required columns?

I already implemented it in this PR unless I'm making a mistake. In the screenshot, `Vulnerabilities`, `Misconfigurations` and `Secrets` are shown because `--scanners vuln,misconfig,secret` is specified."
2562408011,8177,knqyf263,2024-12-26T10:20:00Z,"> Should the results be sorted by file name or scan type?

The current summary table is ordered by scanners, vulnerabilities -> misconfigurations -> secrets -> licenses. Do you want to sort by sub-scanners, such as terraform?

>I noticed that terraform scan results contain directories that we should get rid of.

Yes, I actually saw `.` was detected as `terraform-plan`."
2562416716,8177,DmitriyLewen,2024-12-26T10:29:31Z,"> I already implemented it in this PR unless I'm making a mistake. In the screenshot, Vulnerabilities, Misconfigurations and Secrets are shown because --scanners vuln,misconfig,secret is specified.

 Great!"
2565545275,8177,itaysk,2024-12-30T14:21:15Z,"looks great. this is very similar to the k8s summary report. Do you think we should consider reusing the experience, code or flags? (either way, new, existing or something in between)

![image](https://github.com/user-attachments/assets/18c3e729-7e8e-4d95-a544-ee8090a39491)

"
2568409768,8177,simar7,2025-01-02T21:35:37Z,"Looks nice. What's the difference between a `-` and a `0`? 

I think I understand it as `not evaluated` and `evaluated but nothing found` respectively but I think we should make it explicit. 

> looks great. this is very similar to the k8s summary report. Do you think we should consider reusing the experience, code or flags? (either way, new, existing or something in between) 

I think we should change k8s summary output to be more simpler rather than the other way around. To me the k8s summary output is a bit too much especially with so many numbers that it isn't very helpful."
2572403871,8177,knqyf263,2025-01-06T06:41:54Z,">Do you think we should consider reusing the experience, code or flags? (either way, new, existing or something in between)

I actually considered reusing the K8s summary table, but ultimately decided to keep them separate for several reasons:

First, as @simar7 pointed out, the K8s summary table contains much information. This isn't necessarily a negative aspect - it's designed this way because K8s doesn't display details in the summary table by default (requires `--report all` flag for detailed view). However, the approach is different for image and filesystem scans: we show a simple summary table first, followed by detailed result tables. Therefore, I believe the summary table should be kept as simple as possible. This represents a slightly different purpose from the K8s use case.

Second, since we plan to make a separate plugin for the K8s cluster scan similar to [AWS account scanning](https://github.com/aquasecurity/trivy-aws), I wanted to avoid core dependencies on K8s. If we were to share code, having the dependency direction flow from K8s to core would be preferable, not the other way around. However, given the different purposes mentioned above, whether we should standardize these tables at all requires further discussion.

> I think I understand it as `not evaluated` and `evaluated but nothing found` respectively but I think we should make it explicit.

Yes, that's correct. I made this distinction because we frequently receive user feedback asking to clarify whether something wasn't scanned at all or was scanned but returned zero findings. I'll add a note beneath the table to clarify this distinction."
2603670843,8177,DmitriyLewen,2025-01-21T05:10:55Z,"I have 1 more question:
for case when Report doesn't include Results (e.g. scanned only wrong file).

Do we need to show empty table?
```bash
➜  ./trivy -q fs ./pkg/fanal/analyzer/language/nodejs/npm/testdata/sad        

Report Summary

┌────────┬──────┬─────────────────┬─────────┐
│ Target │ Type │ Vulnerabilities │ Secrets │
└────────┴──────┴─────────────────┴─────────┘

```
Or we can hide table and write Info/warn log or something else."
2620537253,8177,knqyf263,2025-01-29T03:11:14Z,Showing only the header is probably unclear for users. I'd opt for log messages.
2621317849,8177,DmitriyLewen,2025-01-29T11:00:21Z,"> Showing only the header is probably unclear for users. I'd opt for log messages.

Added log in  https://github.com/aquasecurity/trivy/pull/8177/commits/5f61893c4a1597c8fbc4a305b97086e37ea6c0ad + https://github.com/aquasecurity/trivy/pull/8177/commits/0166a455e483fc26658f47e250c3e970a16bd9d7"
2635837224,8177,DmitriyLewen,2025-02-05T06:51:54Z,"> For empty results, what if showing - in all cells in addition to warnings?

I like that.
Added in https://github.com/aquasecurity/trivy/pull/8177/commits/9c3e8ce12ea4f663a4f47575a8bf34657543b367"
2696705901,8177,knqyf263,2025-03-04T09:00:31Z,The rest looks good to me. @DmitriyLewen Feel free to merge this PR whenever you're ready (I cannot approve my PR).
515108628,99,pascalandy,2019-07-25T16:15:45Z,"I have this nasty warning (it was there before this PR) `fatal: not a git repository (or any of the parent directories): .git`. I think we should fix this.

```
Step 4/15 : RUN apk --no-cache add git upx
 ---> Using cache
 ---> 86f02bc19edc
Step 5/15 : RUN go mod download
 ---> Using cache
 ---> f2d76dc0fac6
Step 6/15 : ADD . /app/
 ---> 372bbdbe9449
Step 7/15 : RUN CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags ""-X main.version=$(git describe --tags --abbrev=0)"" -a -o /trivy cmd/trivy/main.go
 ---> Running in bf59db3ec438
fatal: not a git repository (or any of the parent directories): .git
Removing intermediate container bf59db3ec438
 ---> 9580812053d6
Step 8/15 : FROM alpine:3.9 AS compress
```

"
515315032,99,knqyf263,2019-07-26T05:31:49Z,"@pascalandy Thank you. 

I have one question. Why does it need compress stage? Is it impossible to compress the binary in the builder stage?"
515467213,99,pascalandy,2019-07-26T14:05:35Z,"**EDIT** (2019-07-27_22h21): Also, with the new `docker buildx` feature in docker v19.03, stage are built-in parallel which encourages separations of concern at every stage.

It is possible.
>  Is it impossible to compress the binary in the builder stage?

The advantage of having a dedicated stage:
- makes it easy to debug stuff
- makes it easy to re-use to other projets
- when developing, it's easy to bypass the compress stage
"
515703923,99,pascalandy,2019-07-27T18:23:15Z,Made two updates. Let me know.
516186483,99,pascalandy,2019-07-29T22:29:31Z,Anything else?
523096346,99,CLAassistant,2019-08-20T16:39:48Z,[![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=99) <br/>All committers have signed the CLA.
571213138,99,colin-nolan,2020-01-06T16:43:43Z,"It would be great to see this merged! @pascalandy are you able to sign the CLA so this can move forwards (unfortunately, it looks like a requirement: https://github.com/aquasecurity/trivy/pull/99#issuecomment-523096346)?"
571345079,99,pascalandy,2020-01-06T22:32:54Z,"Oh, didn't saw it. Just signed it @colin-nolan :)"
572816878,99,colin-nolan,2020-01-10T00:19:50Z,"Hi @knqyf263, @masahiro331. This is a great piece of work by @pascalandy, which is really useful for anyone wishing to use trivy inside of Docker. Please may you give an indication as to what your appetite for getting this merged is?"
579197297,99,tnir,2020-01-28T11:15:19Z,"@colin-nolan @pascalandy  
What is the main purpose of this PR? The [current Dockerfile](https://github.com/aquasecurity/trivy/blob/0629e1d7312b1f780bc33ee17215fc95d8f25bb5/Dockerfile) looks far from this change.

How can we reduce trivy Docker image with UPX? [aquasec/trivy:0.4.3
](https://hub.docker.com/layers/aquasec/trivy/0.4.3/images/sha256-7df024444e95cf3c42f4e5bce027bf760042b3edbcf165548d542dbe368aa01c) is 22.22 MB."
579256362,99,colin-nolan,2020-01-28T13:54:43Z,"@tnir the current Dockerfile expects the `trivy` executable to be build outside of Docker and to then be present in the build context:
https://github.com/aquasecurity/trivy/blob/0629e1d7312b1f780bc33ee17215fc95d8f25bb5/Dockerfile#L3

The main purpose of this PR is to incorporate the building of this executable into the Dockerfile. This allows people to use the Docker image without needing to know how to compile trivy (and to have the environment necessary to do so). Instead, a standard image build process can be used to get access to the software in a container:
```
docker build -t trivy .
docker run --rm -it trivy
```
It could also help the project developers, for example, by allowing the use of DockerHub's automated builds: https://docs.docker.com/docker-hub/builds/.

I can't comment on the UPX business - I don't know about this practice and am not personally concerned with the image size. I also don't know about the LABELing but it seems like good practice.
"
579258323,99,knqyf263,2020-01-28T13:59:17Z,"@colin-nolan Now, we're using `goreleaser` to build the image. It supports labels and multiple registries.
https://goreleaser.com/docker/

`goreleaser` builds the binary automatically, so we don't have to care about it."
579268094,99,pascalandy,2020-01-28T14:21:20Z,"Hello folks. I'm still listening! Just let me know who is in charge an I'll be glad to answer questions :)

Overall, https://github.com/aquasecurity/trivy/pull/99#issuecomment-579256362 is right. Also, this PR makes the image smaller by using multi-stage builds + UPX (which compress the binary)."
579277002,99,colin-nolan,2020-01-28T14:40:22Z,"The use-case that brought me here originally was that I wanted to use trivy on a machine with a non-amd64 architecture (as far as I'm aware, such images are not available through DockerHub). At this point, in the ideal world, I would have simply built one:
```
docker build --build-arg ARCH=""${ARCH}"" -t trivy .
```
However, given this is not an all too common use-case, I was anticipating having to patch the GOARCH argument in the Dockerfile. As we've discussed though, the Dockerfile doesn't take responsibility for building trivy (this is perhaps a little non-standard), which unfortunately means I then have to care about generating the binary.

Thanks to this PR, I didn't have to install things onto my target machine and work out what flags were need to compile the binary and then build the image.

A different use-case is that, in a security conscious environment, one would want to know the provenance of a Docker image before using it. Hence a local build would be necessary too.
"
714175205,99,pascalandy,2020-10-22T02:08:00Z,"> @colin-nolan @pascalandy
> What is the main purpose of this PR? The [current Dockerfile](https://github.com/aquasecurity/trivy/blob/0629e1d7312b1f780bc33ee17215fc95d8f25bb5/Dockerfile) looks far from this change.

The purpose is to build **Trivy from source** (best practice) instead of copying the binary into the Docker image. Since the maintainers didn't follow up on this, I think this PR is dead."
714201392,99,knqyf263,2020-10-22T03:41:45Z,"Thanks for your contribution.

We use `goreleaser` for the official image and `trivy` binary is built outside of the Dockerfile.
https://github.com/aquasecurity/trivy/blob/master/goreleaser.yml#L84-L103

It means the `builder` image is not needed. If we apply `upx`, we need to follow the instruction as follows.
https://goreleaser.com/customization/build/#build-hooks

Also, labels are already applied here.
https://github.com/aquasecurity/trivy/blob/master/goreleaser.yml#L93-L100"
714508361,99,pascalandy,2020-10-22T13:50:36Z,I guess I'll close the PR. Thanks
714582556,99,pascalandy,2020-10-22T15:42:48Z,"I'll leave my Dockerfile proposition here in case you change your mind:

```
# LAYER builder — — — — — — — — — — — — — — — — — — — — — — —
FROM golang:1.15-alpine AS builder
ADD go.mod go.sum /app/
WORKDIR /app/
RUN apk --no-cache add git upx
RUN go mod download
ADD . /app/
RUN CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags ""-X main.version=$(git describe --tags --abbrev=0)"" -a -o /trivy cmd/trivy/main.go


# LAYER compress — — — — — — — — — — — — — — — — — — — — — — —
FROM alpine:3.12 AS compress
COPY --from=builder /trivy /usr/local/bin/trivy

RUN set -eux && apk --update --no-cache add \
    upx && \
    upx --lzma --best /usr/local/bin/trivy && \
# unit test
    upx -t /usr/local/bin/trivy && \
    trivy --version


# LAYER final — — — — — — — — — — — — — — — — — — — — — — — —
FROM alpine:3.12 AS final
COPY --from=compress /usr/local/bin/trivy /usr/local/bin/trivy

RUN set -eux && apk --update --no-cache add \
    ca-certificates git && \
    chmod +x /usr/local/bin/trivy

# best practice credit: https://github.com/opencontainers/image-spec/blob/master/annotations.md
LABEL org.opencontainers.image.authors=""Author""                                         \
      org.opencontainers.image.vendors=""Vendor""                                         \
      org.opencontainers.image.created=""${CREATED_DATE}""                                \
      org.opencontainers.image.revision=""${SOURCE_COMMIT}""                              \
      org.opencontainers.image.title=""Trivy""                                            \
      org.opencontainers.image.description=""Docker image for Trivy""                     \
      org.opencontainers.image.url=""https://hub.docker.com/r/0o0o/0o0o/tags/""           \
      org.opencontainers.image.source=""https://github.com/0o0o/0o0o""                    \
      org.opencontainers.image.licenses=""https://github.com/0o0o/0o0o/LICENSE.md""       \
      org.example.image.user=""root""                                                     \
      org.example.image.alpineversion=""3.9""                                             \
      org.example.image.schemaversion=""1.0""

ENTRYPOINT [ ""trivy"" ]
CMD [ ""-help"" ]
```"
603589679,433,simar7,2020-03-25T01:28:07Z,"Hey @knqyf263  the current integration tests seem to be failing because currently we don't add a type here https://github.com/aquasecurity/trivy/blob/aca31dffb36328d17f6d3a3bd1184cfcd36ffc07/pkg/rpc/convert.go#L141-L144 

Would you happen to know how I can add a new field here https://github.com/aquasecurity/trivy/blob/18b80e3781a8c8d1f4365071a3d0866e3ec5e81d/rpc/scanner/service.proto#L30-L33 and regen the protobuf files? 

When I try to run `make protoc` from the top level project directory, I get this:
```
➜  trivy git:(vendor-score-priority) ✗ make protoc
find ./rpc/ -name ""*.proto"" -type f -exec protoc --proto_path=/Users/simar/go/src:. --twirp_out=. --go_out=. {} \;
github.com/aquasecurity/trivy/rpc/common/service.proto: File not found.
rpc/cache/service.proto:7:1: Import ""github.com/aquasecurity/trivy/rpc/common/service.proto"" was not found or had errors.
rpc/cache/service.proto:22:12: ""common.Package"" is not defined.
rpc/cache/service.proto:32:3: ""common.OS"" is not defined.
rpc/cache/service.proto:33:12: ""common.PackageInfo"" is not defined.
rpc/cache/service.proto:34:12: ""common.Application"" is not defined.
rpc/cache/service.proto:46:3: ""common.OS"" is not defined.
github.com/aquasecurity/trivy/rpc/common/service.proto: File not found.
rpc/detector/service.proto:9:1: Import ""github.com/aquasecurity/trivy/rpc/common/service.proto"" was not found or had errors.
rpc/detector/service.proto:18:12: ""common.Package"" is not defined.
rpc/detector/service.proto:24:12: ""common.Vulnerability"" is not defined.
rpc/detector/service.proto:34:12: ""common.Library"" is not defined.
github.com/aquasecurity/trivy/rpc/common/service.proto: File not found.
rpc/scanner/service.proto:6:1: Import ""github.com/aquasecurity/trivy/rpc/common/service.proto"" was not found or had errors.
rpc/scanner/service.proto:24:3: ""common.OS"" is not defined.
rpc/scanner/service.proto:32:12: ""common.Vulnerability"" is not defined.
```"
603828247,433,knqyf263,2020-03-25T13:07:45Z,"@simar7 As for `protoc`, would you make sure there is `rpc/common/service.proto` in your local machine?
https://github.com/aquasecurity/trivy/tree/master/rpc/common

 It works in my environment.

```
$ git co vendor-score-priority
$ make protoc
find ./rpc/ -name ""*.proto"" -type f -exec protoc --proto_path=/Users/teppei/src:. --twirp_out=. --go_out=. {} \;
```"
612057476,433,knqyf263,2020-04-10T14:38:41Z,"CentOS doesn't seem to work. Would you try scanning `centos:7`? Also, would you try scanning some images based on different OSes? In addition, we need to insert `VendorSeverity` into the database for testing somehow. Maybe we have to provide a new way to build a database for testing.
https://github.com/aquasecurity/trivy/blob/master/integration/testdata/trivy.db.gz"
613141172,433,simar7,2020-04-13T23:12:14Z,"> CentOS doesn't seem to work. Would you try scanning `centos:7`? Also, would you try scanning some images based on different OSes? In addition, we need to insert `VendorSeverity` into the database for testing somehow. Maybe we have to provide a new way to build a database for testing.
> https://github.com/aquasecurity/trivy/blob/master/integration/testdata/trivy.db.gz

Does centOS provide any vendor vulnerability information? Currently https://github.com/aquasecurity/vuln-list doesn't have any such info. This is why in its case always NVD get used."
613236575,433,simar7,2020-04-14T05:40:02Z,"I updated the test db. It now uses a full db. I think this tradeoff is reasonable to have for slightly more space to store the DB here rather than maintain a handcrafted DB every time we have to make a change. Accordingly, I updated the tests files too: https://github.com/aquasecurity/trivy/pull/433/commits/a588b55246ef5b212e0b8d3f30ad05a1113c271d
"
613708367,433,simar7,2020-04-14T22:15:57Z,"> CentOS doesn't seem to work. Would you try scanning `centos:7`?

I added support for CentOS to use RHEL scores. https://github.com/aquasecurity/trivy/pull/433/commits/d93cf268cafb8ec40cc8c5ecd68d08bd57dbd140"
614627645,433,knqyf263,2020-04-16T12:40:56Z,"Vulnerabilities usually increase, but not decrease without updating the package versions. So in this case, all vulnerabilities which were scored as critical based on NVD are not critical based on vendor now, are they? Our image for testing is old, so there should be some critical vulnerabilities. I'd like to make sure there is really no critical vulnerability for Red Hat in the last few months. I'm worried that this version doesn't show any critical vulnerability for RHEL/CentOS. Or,  it's ok if there is actually no critical one by chance."
614957151,433,simar7,2020-04-16T23:56:32Z,"> The source code looks good to me. The remaining task is to make sure there is really no critical vulnerability with centos:7. I think we can list vulnerabilities running trivy and check the actual severities of them to go to Red Hat website. Also, you can pick up some critical vulnerabilities and install the vulnerable version to centos image. Then, we should confirm the critical vulnerability is detected.

So here are the critical vulnerabilities as detected on current master:
```
 docker run aquasec/trivy:latest -q --severity=CRITICAL centos:7

centos:7 (centos 7.7.1908)
==========================
Total: 3 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 3)

+----------------+------------------+----------+-------------------+---------------+--------------------------------+
|    LIBRARY     | VULNERABILITY ID | SEVERITY | INSTALLED VERSION | FIXED VERSION |             TITLE              |
+----------------+------------------+----------+-------------------+---------------+--------------------------------+
| glib2          | CVE-2015-8391    | CRITICAL | 2.56.1-5.el7      |               | pcre: inefficient posix        |
|                |                  |          |                   |               | character class syntax check   |
|                |                  |          |                   |               | (8.38/16)                      |
+----------------+------------------+          +-------------------+---------------+--------------------------------+
| libxml2        | CVE-2016-4658    |          | 2.9.1-6.el7_2.3   |               | libxml2: Use after free via    |
|                |                  |          |                   |               | namespace node in XPointer     |
|                |                  |          |                   |               | ranges                         |
+----------------+                  +          +                   +---------------+                                +
| libxml2-python |                  |          |                   |               |                                |
|                |                  |          |                   |               |                                |
|                |                  |          |                   |               |                                |
+----------------+------------------+----------+-------------------+---------------+--------------------------------+
```

You can check the current RHEL database, they're both marked as `MODERATE`. https://access.redhat.com/security/cve/cve-2016-4658 and https://access.redhat.com/security/cve/cve-2015-8391"
616083166,433,knqyf263,2020-04-19T09:16:07Z,">Also, you can pick up some critical vulnerabilities and install the vulnerable version to centos image. Then, we should confirm the critical vulnerability is detected.

Did you try that before merging the PR? You can see that there are no false positives by making sure the current results are correct, but we should check false negatives as well. I'd like to make sure a critical vulnerability is detected properly."
616294072,433,mozillazg,2020-04-20T03:55:34Z,"@simar7 

> You can check the current RHEL database, they're both marked as MODERATE. https://access.redhat.com/security/cve/cve-2016-4658 and https://access.redhat.com/security/cve/cve-2015-8391

Sorry, but i have a question: If they are both marked as `MODERATE`, why they not be marked as `MEDIUM` instead of `CRITICAL` in trivy report (the `CVSS v2 Base Score` of these cve at redhat are medium value:

* https://access.redhat.com/security/cve/cve-2016-4658#cve-cvss-v2  (4.3)
* https://access.redhat.com/security/cve/cve-2015-8391#cve-cvss-v2  (4.3)
* https://access.redhat.com/security/updates/classification/ (what `MODERATE` mean)
"
1507037798,4058,CLAassistant,2023-04-13T14:08:32Z,[![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=4058) <br/>All committers have signed the CLA.
1510393460,4058,FrimIdan,2023-04-16T14:13:18Z,"Hi @knqyf263 , I needed to update tingo version to fetch reflect Value.IsZero support (exist only in 0.27.0)
The test actions failed on
```
time=""2023-04-16T05:54:41Z"" level=info msg=""download and unarchive the package"" aqua_version=1.25.0 env=darwin/amd64 exe_name=tinygo exe_path=/Users/runner/.local/share/aquaproj-aqua/pkgs/github_release/github.com/tinygo-org/tinygo/v0.27.0/tinygo0.27.0.darwin-amd64.tar.gz/tinygo/bin/tinygo package=tinygo-org/tinygo package_name=tinygo-org/tinygo package_version=v0.27.0 program=aqua registry=standard
error: could not find wasm-opt, set the WASMOPT environment variable to override
pkg/module/testdata/analyzer/analyzer.go:1: running ""tinygo"": exit status 1
Error: running ""go generate pkg/module/testdata/analyzer/analyzer.go"" failed with exit code 1
```

I'm not familiar with the aque installer flow, can you please assist?"
1510948702,4058,knqyf263,2023-04-17T08:48:56Z,"Seems like we need to install binaryen on macOS.
https://github.com/tinygo-org/tinygo/issues/2319

I'm guessing it starts from the following commit in [v0.27.0](https://github.com/tinygo-org/tinygo/releases/tag/v0.27.0).

>wasm: always run wasm-opt even with -scheduler=none

I created a PR in aqua-registry.
https://github.com/aquaproj/aqua-registry/pull/11604"
1510954066,4058,FrimIdan,2023-04-17T08:52:48Z,"@knqyf263 Thanks for the help!
Other then that, does the PR looks good to you or did I missed something?"
1511100551,4058,FrimIdan,2023-04-17T10:35:46Z,"@knqyf263 I see https://github.com/aquaproj/aqua-registry/pull/11604 was merged 🎉  
Should I just add `- name: WebAssembly/binaryen@version_112` and update the regisrty version?
```
registries:
- type: standard
  ref: v3.157.0 # renovate: depName=aquaproj/aqua-registry
```
"
1511125563,4058,knqyf263,2023-04-17T10:57:14Z,">Should I just add - name: WebAssembly/binaryen@version_112 and update the regisrty version?

I hope so 🤞 "
1511146564,4058,knqyf263,2023-04-17T11:11:43Z,"Hmm... It failed on Windows...

>C:\Users\runneradmin\AppData\Local\aquaproj-aqua\bat\wasm-opt.bat: incompatible wasm-opt (need 102 or newer)"
1511149692,4058,FrimIdan,2023-04-17T11:14:12Z,"> Hmm... It failed on Windows...
> 
> > C:\Users\runneradmin\AppData\Local\aquaproj-aqua\bat\wasm-opt.bat: incompatible wasm-opt (need 102 or newer)

Is there a way to maintain different `aqua.yaml` files for different OS?
I assume we only need `WebAssembly/binaryen@version_112` on mac 😞 "
1511154425,4058,knqyf263,2023-04-17T11:16:53Z,It's weird as we obviously install wasm-opt newer than 102.
1511162798,4058,FrimIdan,2023-04-17T11:23:49Z,"


> It's weird as we obviously install wasm-opt newer than 102.

Maybe in https://github.com/aquaproj/aqua-registry/pull/11604/files under `pkgs/WebAssembly/binaryen/registry.yaml` the windows files are missing?"
1511172620,4058,suzuki-shunsuke,2023-04-17T11:32:42Z,"> Maybe in https://github.com/aquaproj/aqua-registry/pull/11604/files under `pkgs/WebAssembly/binaryen/registry.yaml` the windows files are missing?

I don't think so.

I've confirmed wasm-opt installed by aqua works on Windows.

https://github.com/suzuki-shunsuke/test-github-action/actions/runs/4720615001/jobs/8372869933"
1511191071,4058,suzuki-shunsuke,2023-04-17T11:47:11Z,"📝 https://github.com/tinygo-org/tinygo/blob/0d56dee00f49bd50eb373c02c30062a75ec28f10/goenv/goenv.go#L164-L185

```console
$ wasm-opt --version
wasm-opt version 112 (version_112)
```"
1511202860,4058,knqyf263,2023-04-17T11:57:11Z,"Yeah, it should work.
https://go.dev/play/p/jmer_icLwFr"
1511226148,4058,knqyf263,2023-04-17T12:12:35Z,"Bash returns the version correctly, but PowerShell returns an error in my environment.

```
PS C:\Users\Administrator> wasm-opt --version
FATA[0000] aqua failed                                   aqua_version=2.3.5 doc=""https://aquaproj.github.io/docs/reference/codes/004"" env=windows/amd64 error=""command is not found"" exe_name=wasm-opt program=aqua
```

I ran `wasm-opt` outside the directory where aqua.yaml is present. It might be a cause.
https://aquaproj.github.io/docs/reference/codes/004/"
1511235570,4058,knqyf263,2023-04-17T12:19:33Z,"Sorry for confusing you guys. I moved the `aqua.yaml` dir, and it worked even on PowerShell.

```
PS C:\Users\Administrator\AppData\Local\Temp\2> wasm-opt --version
wasm-opt version 112 (version_112)
```"
1511250055,4058,knqyf263,2023-04-17T12:30:45Z,"Oh, are the installation messages written to stdout?

```
$ wasm-opt --version 2> /dev/null
INFO[0000] download and unarchive the package            aqua_version=2.3.5 env=windows/amd64 exe_name=wasm-opt package=WebAssembly/binaryen package_name=WebAssembly/binaryen package_version=version_112 program=aqua registry=standard
wasm-opt version 112 (version_112)
```"
1511253739,4058,knqyf263,2023-04-17T12:33:08Z,"I suspect the messages break the version parsing.
https://go.dev/play/p/K9bXj8e9w7O"
1511258255,4058,suzuki-shunsuke,2023-04-17T12:36:21Z,"I see.
aqua uses [logrus](https://github.com/sirupsen/logrus). I'll take a look."
1511261169,4058,suzuki-shunsuke,2023-04-17T12:38:30Z,The workaround is to change the log level using the environment variable `AQUA_LOG_LEVEL` to suppress the info log.
1511262942,4058,knqyf263,2023-04-17T12:39:48Z,"I think we can remove the `-l` option since log messages are useful for debugging. Which do you recommend?
https://aquaproj.github.io/docs/products/aqua-installer/"
1511265188,4058,suzuki-shunsuke,2023-04-17T12:41:28Z,"Installing wasm-opt in advance would solve the issue.

1. Run `wasm-opt` explicitly in advance

```
wasm-opt -v
```

2. Set aqua_opts

```yaml
- uses: aquaproj/aqua-installer@v2.1.1
  with:
    aqua_version: v2.3.1
    aqua_opts: """"
```"
1511266480,4058,suzuki-shunsuke,2023-04-17T12:42:33Z,"> I think we can remove the `-l` option since log messages are useful for debugging. Which do you recommend? https://aquaproj.github.io/docs/products/aqua-installer/

Yeah, I agree.
I recommend removing `-l` option."
1511268485,4058,knqyf263,2023-04-17T12:44:05Z,It's funny that [my debugging commit](https://github.com/aquasecurity/trivy/pull/4058/commits/60b382a6564fa74b6879e564cf5e1c0e72ccefb8) addressed the error unintentionally 😄 
1511274846,4058,knqyf263,2023-04-17T12:48:12Z,"We would work around it, but I'd recommend writing log messages to stderr. It is surprising that `cmdname --help` changes the behavior."
1511276103,4058,knqyf263,2023-04-17T12:49:07Z,"> @knqyf263 Thanks for the help! Other then that, does the PR looks good to you or did I missed something?

I've started reviewing now!"
1511319384,4058,knqyf263,2023-04-17T13:12:53Z,"Passed! Thanks for your help! @suzuki-shunsuke 
https://github.com/aquasecurity/trivy/actions/runs/4721312265/jobs/8374443130?pr=4058"
1511347209,4058,suzuki-shunsuke,2023-04-17T13:26:03Z,"I've fixed the bug and released aqua v2.3.6.
Thank you for your help!
https://github.com/aquaproj/aqua/releases/tag/v2.3.6"
1512674639,4058,FrimIdan,2023-04-18T08:29:06Z,"@knqyf263 can you please re-review, I hope I addressed all your comments."
1514235470,4058,knqyf263,2023-04-19T07:08:10Z,You need to run `go mod tidy`.
1514578893,4058,FrimIdan,2023-04-19T11:36:26Z,"> You need to run `go mod tidy`.

🤦 @knqyf263 done  "
1516299697,4058,FrimIdan,2023-04-20T13:08:54Z,"@knqyf263 failed on 
```
=== RUN   TestTar/fluentd_with_RubyGems
panic: test timed out after 10m0s

goroutine 155527 [running]:
testing.(*M).startAlarm.func1()
	/opt/hostedtoolcache/go/1.19.8/x64/src/testing/testing.go:2036 +0x8e
created by time.goFunc
	/opt/hostedtoolcache/go/1.19.8/x64/src/time/sleep.go:176 +0x32
```

😞 not sure if/how it's related to my changes"
1519119409,4058,FrimIdan,2023-04-23T17:46:36Z,"> LGTM. Thanks! BTW, this PR bumps the SPDX version. I feel like this is a feature enhancement adding support for SPDX 2.3. What do you think? Can we change the title to `feat(spdx): add support for SPDX 2.3`?

Done! Thanks for reviewing."
1519150887,4058,knqyf263,2023-04-23T20:36:12Z,Thanks again for your great help!
1521383931,4058,AnaisUrlichs,2023-04-25T08:26:55Z,"Hi @FrimIdan, we would like to make you our contributor of the month as part of our Aqua Stars Program, could you please send me a DM on our Slack?
https://github.com/aquasecurity/community/tree/main/aquastars
https://join.slack.com/t/aquasecurity/shared_invite/zt-1tsoo7rja-_GSlLtUS9ry0xPFu2XKyWg"
648091569,542,knqyf263,2020-06-23T11:39:57Z,"I think #346 is talking about Prometheus metrics, not log messages."
648111599,542,yashvardhan-kukreja,2020-06-23T12:25:09Z,"Ohh, I might have gotten confused. I have a few basic doubts with the issue which I have mentioned in the thread of the issue, please clarify them"
648126617,542,knqyf263,2020-06-23T12:55:10Z,OK. Let's wait for @computeralex92's answer.
651109678,542,yashvardhan-kukreja,2020-06-29T13:09:18Z,"Hi @knqyf263, @computeralex92! I added prometheus metrics endpoint support and if you go to `GET /metrics`, you'd get the following output:

**_\# HELP trivy Gauge Metrics associated with trivy - Last DB Update, Last DB Update Attempt ...
\# TYPE trivy gauge
trivy{action=""last_db_update""} 1.593432599e+09
trivy{action=""last_db_update_attempt""} 1.593432599e+09_**

The timestamps, here, are being stored as Unix Timestamps (float64) because that's what the prometheus Gauge expects.
Also, here, I used prometheus Gauge for storing the values (timestamps) for these labels because the prometheus Counters were restrictive and rough. 

I hope this seems good and if it does then, we can go on and implement the remaining three metrics suggested by @computeralex92."
651124510,542,computeralex92,2020-06-29T13:34:59Z,"> Hi @knqyf263, @computeralex92! I added prometheus metrics endpoint support and if you go to `GET /metrics`, you'd get the following output:
> 
> **_# HELP trivy Gauge Metrics associated with trivy - Last DB Update, Last DB Update Attempt ... # TYPE trivy gauge trivy{action=""last_db_update""} 1.593432599e+09 trivy{action=""last_db_update_attempt""} 1.593432599e+09_**
> 
> The timestamps, here, are being stored as Unix Timestamps (float64) because that's what the prometheus Gauge expects.
> Also, here, I used prometheus Gauge for storing the values (timestamps) for these labels because the prometheus Counters were restrictive and rough.
> 
> I hope this seems good and if it does then, we can go on and implement the remaining three metrics suggested by @computeralex92.

Looks great; I looking forward to use this metrics ;-)

"
655872819,542,yashvardhan-kukreja,2020-07-09T03:15:51Z,"hi @simar7 , can u please review my PR"
658558372,542,CLAassistant,2020-07-15T05:44:05Z,"[![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=542) <br/>Thank you for your submission! We really appreciate it. Like many open source projects, we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/aquasecurity/trivy?pullRequest=542) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/aquasecurity/trivy?pullRequest=542) it.</sub>"
662984591,542,yashvardhan-kukreja,2020-07-23T12:43:13Z,"> So @simar7 , if such kind of situation happens, then should I programme the code to panic and exit with status 1. Or should I just programme it to log in the terminal ""GaugeMetric not initialised"" but still **not** make the code exit and hence, allow the user to use the existing session for other functionalities, if they want?

@simar7 , I am done with rest of all the issues you mentioned above, so, as soon as the above quoted doubt gets clarified, I'll push all the new changes to this PR :smile: "
666865252,542,simar7,2020-07-31T01:45:36Z,@yashvardhan-kukreja can you try to rebase this on the latest master and resolve the git conflicts?
668862819,542,simar7,2020-08-04T22:48:59Z,"@yashvardhan-kukreja I'm still seeing a diff that shouldn't be there in the Dockerfile. See below:

<img width=""1271"" alt=""image"" src=""https://user-images.githubusercontent.com/1254783/89352799-e2035200-d669-11ea-87dd-a93e82c74055.png"">

Can you also try to run `go mod tidy` and re-commit the `go.mod` and `go.sum` files again if there are any changes?"
669727420,542,knqyf263,2020-08-06T06:21:01Z,"@simar7 Yes, I'll take a look, but do you know why codecov is failing?"
670728291,542,simar7,2020-08-07T21:56:03Z,"> @simar7 Yes, I'll take a look, but do you know why codecov is failing?

I tried looking but I'm not sure. The failure doesn't make sense. Maybe it's a bug: https://docs.codecov.io/docs/unexpected-coverage-changes#think-its-codecovs-fault We shouldn't wait for that in this PR though. We can take a look it in a separate discussion."
671398343,542,yashvardhan-kukreja,2020-08-10T14:43:27Z,"@simar7 @knqyf263 , if the PR is at a merge-able point, should I go on squash all the above commits?"
671762076,542,knqyf263,2020-08-11T06:46:57Z,"@yashvardhan-kukreja Basically, we merge PR with squash commits on GitHub, so you don't have to do that. But we probably should do that this time in order to resolve the error from codecov."
671763011,542,yashvardhan-kukreja,2020-08-11T06:49:28Z,"cool, makes sense. I ll squash them then :)"
672862139,542,yashvardhan-kukreja,2020-08-12T13:13:02Z,"@simar7 , @knqyf263 , the codecov issue doesn't persist anymore, so I guess you can go on squash and merge the PR 😄 "
673304007,542,knqyf263,2020-08-13T07:09:50Z,"@yashvardhan-kukreja Thanks. I'll review this PR. Just a moment, please."
694740458,542,yashvardhan-kukreja,2020-09-18T08:44:16Z,"Went off the grid for a while, hence, the changes took a bit of time. sorry for that pause. 
@knqyf263 - can u please review the changes"
695076037,542,simar7,2020-09-18T20:41:09Z,"> Went off the grid for a while, hence, the changes took a bit of time. sorry for that pause.
> @knqyf263 - can u please review the changes

hi @yashvardhan-kukreja – @knqyf263 is out this week. I'll take a look at your new changes in the meantime. "
695132623,542,yashvardhan-kukreja,2020-09-19T00:00:39Z,"@simar7 , no worries. And thanks for reviewing this meanwhile :)
PS: I have applied the changes as suggested"
728685766,542,yashvardhan-kukreja,2020-11-17T04:56:28Z,"@knqyf263 @simar7 , any heads up/updates regarding this? Been a while 😅"
749547634,542,yashvardhan-kukreja,2020-12-22T13:46:15Z,"@knqyf263 @simar7   I applied all the suggested changes, rebased them with the main branch and all the tests are successfully running.
Please review the above PR."
760512239,542,yashvardhan-kukreja,2021-01-14T22:20:08Z,ping @knqyf263 
803602582,542,krol3,2021-03-21T15:21:57Z,"@yashvardhan-kukreja, could you review the conflicting files?"
808070285,542,yashvardhan-kukreja,2021-03-26T09:31:46Z,"> @yashvardhan-kukreja, could you review the conflicting files?

I have rebased this PR with the latest state main. Sorry that it took some time. Was a little swamped and the conflicts were pretty major with respect to the new state of main branch :P"
808170970,542,yashvardhan-kukreja,2021-03-26T12:17:07Z,"Also, I have added unit tests around the ""extended config"" structs as well for the sake of testing the Prometheus MetricsRegistry Setup as well"
812991737,542,yashvardhan-kukreja,2021-04-04T07:59:42Z,is this being reviewed @krol3 @knqyf263 ?
814013399,542,krol3,2021-04-06T10:31:57Z,@simar7 @knqyf263 could you take a look on this PR? 
817258060,542,knqyf263,2021-04-11T06:34:07Z,"I'm sorry for the late reply. I'm busy on a new feature scanning config files now. After wrapping up it, I'll review it."
1303627109,542,jc16180,2022-11-04T14:20:45Z,Is anyone working on this?
1712833305,542,knqyf263,2023-09-10T14:44:19Z,"Instead, we've added `/version` endpoint.
https://github.com/aquasecurity/trivy/pull/4869"
714205275,709,knqyf263,2020-10-22T03:56:42Z,It looks fine so far. Are you planning to support JSON and Table as well in this PR? Or will it be done in another PR?
714818419,709,simar7,2020-10-22T23:34:28Z,"> It looks fine so far. Are you planning to support JSON and Table as well in this PR? Or will it be done in another PR?

I was going to but then realized that adding to JSON means we will need to add it to everywhere (including client/server) in order to keep parity (recall the case with VendorVectors and CWE?). 

I think we need to rethink the integration tests here as they are enforcing this limitation (since we want to have common golden files). Keeping feature parity across different modes is a good idea but the development shouldn't be limited by how tests are structured. 

Thoughts? ~~I don't have a hard preference to do it with this PR or another one. Which ever feels comfortable to you when it comes to reviewing it, is fine by me.~~

I think it's better to do JSON in a separate PR since it will be a big change (in terms of files changed). I will add it to the Table output shortly."
729884858,709,simar7,2020-11-18T18:53:48Z,"> I'm sorry, but I came up with a better idea.

The new approach seems a bit over engineered to me. Although I can see why we can add it to references, I’m not convinced AVD info should be. It’s a first class citizen as it’s our own service. IMO references are better left for things that are outside our realm. 

IMHO, the current model seems easy enough to understand. 

Thoughts?"
729927222,709,knqyf263,2020-11-18T20:14:17Z,"There are three places to generate an AVD link now. All other details are filled in `FillInfo`, but only AVD link is generated in many places. I think it is not DRYed and difficult to track where it is generated. For example, if we want to fix the AVD link stuff for client/server mode, we probably first look into `FillInfo`, but it doesn't exist there. Next, we'll check the server code because the server stores the vulnerability database and should have all the vulnerability information. But it is actually in `convert.go` on the client-side. IMHO, the logic regarding vulnerability detail should be in one place.
However, I understand that AVD is a first class citizen as you said. if you have any better ideas to aggregate scattered logic, it is worth considering."
729983951,709,simar7,2020-11-18T22:01:28Z,"> There are three places to generate an AVD link now. All other details are filled in `FillInfo`, but only AVD link is generated in many places. I think it is not DRYed and difficult to track where it is generated. For example, if we want to fix the AVD link stuff for client/server mode, we probably first look into `FillInfo`, but it doesn't exist there. Next, we'll check the server code because the server stores the vulnerability database and should have all the vulnerability information. But it is actually in `convert.go` on the client-side. IMHO, the logic regarding vulnerability detail should be in one place.
> However, I understand that AVD is a first class citizen as you said. if you have any better ideas to aggregate scattered logic, it is worth considering.

I still think when the time arises to make that AVD link change, we should reconsider and refactor. Without actually having that as a problem I think it's difficult to suggest any improvements. 

Besides if the link was going to change we have this https://github.com/aquasecurity/trivy/pull/709/commits/f7966ebb8c4c74538e4e259f2a59640b2984ef52#diff-81ddbadfb415ccbb9c7af84f11668d1aa5e53c34025bf86d4702f16b4e42f045 single place to update it."
730144502,709,knqyf263,2020-11-19T05:46:04Z,"Hmm. I'd like to know why putting logic in multiple places is better rather than putting it in one place. It will be a problem later and will probably be put together in one place. It doesn't mean I disagree with you, but I'm just curious about the advantage of the current model. Generating the link in multiple places does not seem to make the code easier to understand. Like other data, it looks easier to process the link in the same place. If you still want to put AVD links separate from other references, you can define `URL` here, generate it in `FillInfo`, and use it as is without filtering.
https://github.com/aquasecurity/trivy-db/blob/master/pkg/types/types.go#L119-L129

Also, we can add another logic there to select the primary link for non CVE-ID. For example, if it starts with `RHSA-`, we can store the RHSA link like https://access.redhat.com/errata/RHSA-2019:2925 as the primary link.

Even if it is processed in the function, it is simpler to call the function once rather than three times in three places. I'm sorry I might be missing something. If I understand the benefit of the current model properly, I'll accept it."
732311303,709,lizrice,2020-11-23T17:31:37Z,"At the moment there should be a page in AVD for every known CVE that Trivy can report, and it's a simple conversion from the CVE ID to the AVD URL. I can imagine in future we might want to be able to link from vulnerabilities that have other (non-CVE) identifiers, and maybe adding the AVD link as an additional reference field in the database, but I don't think it's necessary in the short term - and I'd really like to see this feature released sooner rather than later. Pragmatically, it seems reasonable to me to just do that as output formatting as part of the client. That way we can start getting user feedback on whether they find the AVD useful, before we go even further down the road of building more and more different types of pages for it. Wdyt @knqyf263?  "
732361471,709,knqyf263,2020-11-23T19:01:09Z,"I agree that we will support only the AVD link at first. For now, all other vulnerability information including references is filled in a single place, but only the AVD link is generated in the other three places for standalone, client/server, and template. It means we have to maintain those three types separately forever. I just suggested the AVD link should be handled like other information. If we generate only the AVD link in different three places from other information, it will make it harder to maintain and understand. So, I'd like to know why the current model is better in terms of concise source code.
It might be difficult to understand the difference between them verbally. I should probably write a PoC."
734492389,709,simar7,2020-11-26T22:07:06Z,Closing in favour of https://github.com/aquasecurity/trivy/pull/752
1968118920,6217,CLAassistant,2024-02-28T03:13:29Z,[![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=6217) <br/>All committers have signed the CLA.
2013956673,6217,knrc,2024-03-21T22:25:03Z,"@DmitriyLewen I ran into another problem, it turns out the registry code (at least in 0.49.1) is broken.  The three registries (google, azure and ECR) are invoked concurrently, which means their state gets overwritten each time while still being used.

I have some fixes for that, I'll check with 0.50.0 and push up another version of this PR some time next week."
2020606882,6217,knrc,2024-03-26T14:36:21Z,"@DmitriyLewen I pushed up the changes so you can see the difference, I'm just about to test them on 0.50.0.  I'll rebase the PR on the latest once I've validated it."
2021456838,6217,knrc,2024-03-26T20:55:19Z,"@DmitriyLewen I've tested and rebased the PR, it's ready again"
2022342942,6217,DmitriyLewen,2024-03-27T09:51:33Z,"Hello @knrc 

>  The three registries (google, azure and ECR) are invoked concurrently, which means their state gets overwritten each time while still being used.

I'm a little confused

Trivy checks registries sequentially: https://github.com/aquasecurity/trivy/blob/5f69937cc6986912925a8a1b0801810ea850ba79/pkg/fanal/image/registry/token.go#L36-L52

Which field is overwritten?"
2022864266,6217,knrc,2024-03-27T14:07:37Z,"> I'm a little confused
> 
> Trivy checks registries sequentially:

It does, within GetToken, however GetToken is called concurrently.

> Which field is overwritten?

Line 37 calls `CheckOptions`, which will create client resources in the singleton registry based on the domain.  This client is then used later within `GetCredentials`.  Since the singletons are being accessed concurrently the client is not guaranteed to be the one created within the previous call to `CheckOptions` in the loop.

"
2024459546,6217,DmitriyLewen,2024-03-28T05:56:59Z,"I think I understand your logic.

But I don't see any place where we use `GetToken` function (or upper function) using goroutines.
We also use 1 image. Therefore, if we overwrite `ECRClient` -> it will be a new `ECRClient` but with the same settings.

But i can missing something. Will be great if you can show some example.

Anyway, I think these changes should be made in another PR.
Can you undo the last changes and create a new PR with those changes and the example in the new PR?
"
2035241108,6217,knrc,2024-04-03T17:53:46Z,"> But I don't see any place where we use `GetToken` function (or upper function) using goroutines. We also use 1 image. Therefore, if we overwrite `ECRClient` -> it will be a new `ECRClient` but with the same settings.
> 
> But i can missing something. Will be great if you can show some example.

The artifacts are scanned by different workers in parallel, see

https://github.com/aquasecurity/trivy/blob/e98c873ed0f710f4569a06d2b38220d9e2c47630/pkg/k8s/scanner/scanner.go#L141-L142
"
2063796520,6217,knrc,2024-04-18T12:52:10Z,"> @knrc sorry for the wait for an answer.

No worries, we all have our day jobs.

> > The artifacts are scanned by different workers in parallel, see
> 
> Thank you for showing me this. I'm currently seeing this problem!

:)
 
> Your changes look correct for this case.
> 
> I left 1 comment about google test.

Sounds good, I'll take a look.  I'm at Open Source Summit this week, but will try to get to this as quickly as I can."
2063887356,6217,knrc,2024-04-18T13:36:17Z,"> Sounds good, I'll take a look. I'm at Open Source Summit this week, but will try to get to this as quickly as I can.

@DmitriyLewen I rebased and updated the PR for your comment, can you take another look?"
2065792022,6217,DmitriyLewen,2024-04-19T05:32:03Z,@knrc can you fix linter error?
2067002093,6217,knrc,2024-04-19T17:31:55Z,"> @knrc can you fix linter error?

Yes, I can add that to the list since I'm in those files anyway."
2067038154,6217,knrc,2024-04-19T17:51:17Z,@DmitriyLewen try now
2181919511,6217,knqyf263,2024-06-21T03:16:23Z,Thanks for the contribution. This PR needs to resolve conflicts now.
2302255081,6217,knrc,2024-08-21T14:53:54Z,I'll take a look at this over the next few days
2321373050,6217,knrc,2024-08-30T14:05:28Z,"The integration tests appear to be hitting a limit
```=== NAME  TestFanal_Library_DockerLessMode/happy_path,_opensuse_tumbleweed
    library_test.go:165: 
        	Error Trace:	/home/runner/work/trivy/trivy/pkg/fanal/test/integration/library_test.go:165
        	Error:      	Received unexpected error:
        	            	unable to find the specified image ""ghcr.io/aquasecurity/trivy-test-images:opensuse-tumbleweed"" in [""remote""]:
        	            	    github.com/aquasecurity/trivy/pkg/fanal/image.NewContainerImage
        	            	        /home/runner/work/trivy/trivy/pkg/fanal/image/image.go:58
        	            	  - 1 error occurred:
        	            		* remote error: GET https://ghcr.io/v2/aquasecurity/trivy-test-images/manifests/opensuse-tumbleweed: TOOMANYREQUESTS: retry-after: 750.362µs, allowed: 44000/minute
```"
2321391038,6217,knrc,2024-08-30T14:11:25Z,The test does run successfully when executed locally
2323803312,6217,DmitriyLewen,2024-09-02T04:43:49Z,"Hello @knrc 
Looks like it was bug in CI/CD.

PR has been merged."
987488657,1437,knqyf263,2021-12-07T01:39:00Z,"Note that we have to remove unused functions here.
https://github.com/aquasecurity/trivy/blob/9d427f187b9e0be8ef27c66dce9be5a568055367/pkg/report/template.go#L31-L92"
989880263,1437,afdesk,2021-12-09T14:02:17Z,@knqyf263 there is a question about backward compatibility the `trivy` sarif templates. should we support it?
995047238,1437,knqyf263,2021-12-15T18:19:18Z,">@knqyf263 there is a question about backward compatibility the trivy sarif templates. should we support it?

We will keep sarif.tpl for a while and announce that users need to migrate `--template sarif.tpl` to `--format sarif`."
997426862,1437,afdesk,2021-12-19T17:08:14Z,"> > @knqyf263 there is a question about backward compatibility the trivy sarif templates. should we support it?
> 
> We will keep sarif.tpl for a while and announce that users need to migrate `--template sarif.tpl` to `--format sarif`.

ok, it means i have to restore several necessary functions for template."
997434388,1437,knqyf263,2021-12-19T17:58:19Z,"Or, we might be able to call the Go SARIF function actually when `sarif.tpl` is specified. And we will show a warning message for this deprecation. We can remove some functions and `sarif.tpl` then. Any thought?"
1633955486,4652,nikpivkin,2023-07-13T10:11:03Z,"@DmitriyLewen yarn has only 1 `node_modules/.yarn` folder in the root of the project, so all the dependencies of the workspaces are there."
1633964276,4652,DmitriyLewen,2023-07-13T10:17:15Z,"ok, thanks for the clarification!"
1647223002,4652,DmitriyLewen,2023-07-24T05:15:49Z,"@nikpivkin Rebase this PR, please."
2066287297,6524,CLAassistant,2024-04-19T10:29:03Z,"[![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=6524) <br/>Thank you for your submission! We really appreciate it. Like many open source projects, we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/aquasecurity/trivy?pullRequest=6524) before we can accept your contribution.<br/><hr/>**Levente Kovacs** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account, please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/aquasecurity/trivy?pullRequest=6524) it.</sub>"
2066505891,6524,kovacs-levent,2024-04-19T12:47:52Z,"I signed the cla... Not sure why it's not triggering as signed. On my forked branch, every test passed, so if you trigger the tests it should be good."
2066598290,6524,kovacs-levent,2024-04-19T13:32:30Z,"Hmm, while all tests are passing, I do not see the new binary results when I build the trivy from source and run the same experiment as in https://github.com/aquasecurity/trivy/discussions/6457, I'm not sure why that is the case.

EDIT: Guess I realized that I not only need to implement the parsing, but the analyzer logic as part of fanal. I'll try that."
2067502527,6524,kovacs-levent,2024-04-20T01:32:37Z,"I have spent some time with this. Now python version is detected correctly by trivy and added into the sbom in a way that xeol detects it properly according to my use case.

I looked into implementing vulnerability scanning as well for standalone binaries, but I think at first only having it part of sboms is a step forward.

There are a few problems regarding implementing this with standalone binaries:

1. It's not an OS package, hence the whole PR. But that also means I can't implement the vuln scanning as part of the ospkg detector library. When I tried that, trivy started to correctly detect the vulns in the binaries, but it also discarded everything else due to conflicting OS versions (if I implement it as ospkg detector driver, then I just lost all dpkg vulns for example).
2. It's also not really a langpkg. but this could be solved with some extra code as part of the driver logic and without messing more with the core. However, none of the ecosystems in trivy-db are really fit for querying vulnerabilities in these standalone binaries. The best bet would be NVD I thought.
3. BUT NVD does not have an interface to query it in [trivy-db](https://github.com/aquasecurity/trivy-db/blob/main/pkg/vulnsrc/nvd/nvd.go). This means that I can't query NVD's information about the standalone binary, neither OS package sources.
4. A Get function could be implemented for NVD, but I suspect that the best way to query it is through CPE2.3 vectors. For standalone-binaries, this is easy to generate correctly I think, but afaik, trivy does not support CPE for complexity reasons (it's also not in the SBOMs).

The only way I see to implement this nicely is by adding CPE support and also putting together a Get function for the NVD vulnsrc linked in 3rd point. Other way: just hack together an NVD get interface since it'd be used only for the scanner as a fallback in case of generic binary is detected, not for regular vulnerability scanning.

Now that I know how to implement these things, I think I can put together the remaining parts (Java, PHP, NodeJS binary as part of package detection and SBOMs) in the upcoming days and the PR would be ready."
2067637385,6524,kovacs-levent,2024-04-20T10:54:55Z,"I have added support for PHP and Nodejs standalone binaries and it works like a charm with the sboms. I'm dropping support for Java because I found that it's harder to correctly determine the package type (JRE vs. JDK), and I won't go down the rabbithole since it's not part of my usecase.

Only issue I discovered yesterday is that this will break lots of integration tests which I'll have to adjust those accordingly. After I'll adjust integration tests, I think this PR can be merged."
2080444721,6524,kovacs-levent,2024-04-27T10:27:52Z,"Thanks for the feedback, I will make the changes when I have the time, this week’s been busy, but I’ll try to make progress when I have the time."
2144774023,6524,kovacs-levent,2024-06-03T09:54:20Z,"As you can see, I finally got to finish up this PR. I'm going to work some more on this in the upcoming days, so that all the comments are reflected in the changes.

I did refactor the code to have the proposed structure."
2145162449,6524,kovacs-levent,2024-06-03T13:08:14Z,"I had some troubles with rebasing, probably shouldn't have waited so long with that 😓 I had to force push, because other people's commits started appearing here, so I did a hard reset. Sorry for the ugly commit history 🤷 "
2147409610,6524,kovacs-levent,2024-06-04T12:26:39Z,"I have encountered a weird issue now... I found that if Rekor sbom source is not specificed, then ExecutableAnalyzer is getting disabled. https://github.com/aquasecurity/trivy/blob/main/pkg/commands/artifact/run.go#L514 Can someone shed some light on why is that? The commit message contains a PR... Seems like completely unrelated issue: https://github.com/aquasecurity/trivy/pull/6163

For some reason, the whole executable analyzer was disabled, instead of only disabling Rekor queries based on the executables. Can you please provide some insight on whether it's fine to remove this, and how could I go about it to disable Rekor queries instead? @DmitriyLewen "
2147415108,6524,kovacs-levent,2024-06-04T12:29:20Z,"Problem is that, with Rekor enabled, it works fine for me, but it takes significantly longer to scan with Rekor, even though I'm not interested in that information."
2147686446,6524,kovacs-levent,2024-06-04T14:29:26Z,"> I have encountered a weird issue now... I found that if Rekor sbom source is not specificed, then ExecutableAnalyzer is getting disabled. https://github.com/aquasecurity/trivy/blob/main/pkg/commands/artifact/run.go#L514 Can someone shed some light on why is that? The commit message contains a PR... Seems like completely unrelated issue: #6163
> 
> For some reason, the whole executable analyzer was disabled, instead of only disabling Rekor queries based on the executables. Can you please provide some insight on whether it's fine to remove this, and how could I go about it to disable Rekor queries instead? @DmitriyLewen

I fixed this issue in the following commit. Now if the Rekor flag isn't enabled, it only skips the ""unpackaged"" hook, so Rekor queries are only made if the Rekor is actually specified, but executable analysis still happens regardless."
2148812966,6524,DmitriyLewen,2024-06-05T04:05:33Z,"Hello @kovacs-levent 
Thanks for your work!

I'm working on other priority tasks.
I will consider this PR when I have time for it

Regards, Dmitriy"
2202361522,6524,kovacs-levent,2024-07-02T08:50:46Z,@DmitriyLewen Any update regarding when this PR can get reviewed?
2209436683,6524,itaysk,2024-07-04T18:25:36Z,"@kovacs-levent Binray identification is already implemented in the commercial scanner of Aqua as described here: https://github.com/aquasecurity/resources/blob/main/trivy-aqua.md#vulnerability-scanning (this doc is linked from the contribution guide, but regardless we should have let you know earlier). I'm really sorry it took us long time to realize this, it is always best to start a discussion/issue before starting to work. Thanks again for your spirit of contribution.

@DmitriyLewen "
2210098509,6524,DmitriyLewen,2024-07-05T04:12:32Z,"@itaysk Thanks for the clarification!

@kovacs-levent Sorry to waste your time, I missed that a commercial scanner supports this..."
2210304709,6524,kovacs-levent,2024-07-05T06:56:17Z,"Let me get this straight, so just to make sure I'm not getting punked right now...

I've created a discussion thread months ago about this topic https://github.com/aquasecurity/trivy/discussions/6457, in which @DmitriyLewen explicitly told me to ""We are always happy to receive new contributions! If you have time and understanding, it will be very cool if you make a PR with the addition of support for Python binaries."".

I've created the PR, then you @itaysk now randomly come after 3 months of 0 contribution to this the topic. Now you claim that I did not do proper discussion before starting work on this feature, and that you are now gatekeeping this feature from the open source project, because you built this into your commercial offering.

To be frankly honest, I don't care about the commercial offering of aquasec, I'd like this feature to be present in trivy, the open source version, hence I started contributing to this open source project, which I believed to be community-driven. Not just a tool for aquasec to use and gatekeep features as they see fit. I have never seen such practices in open source projects."
2210327702,6524,kovacs-levent,2024-07-05T07:14:27Z,"If anyone is actually interested in using such a feature in trivy, feel free to pull the changes from my forked repository:

https://github.com/kovacs-levent/trivy/tree/parse-binary-versions

I'm going to stop contributing I guess then, because you don't like open source community contributing to your project..."
2218454119,6524,itaysk,2024-07-09T19:12:23Z,"Yes Trivy is an open source project but I wouldn't say it's ""community-driven"" like you put it - Aqua invests heavility into this project and Aqua employees do the overwhelming majority of the work on it, for the benefit of the community. We do encourage community contribution and we are proud to have had many many examples of this, and also community-driven initiatives as long as ithey fall within the project's scope as defined in the contribution guidelines (which every mature oss project should have). I hope this clarifies the situation and guidelines."
2219698422,6524,kovacs-levent,2024-07-10T06:52:14Z,"@itaysk If your contribution guidelines are so mature, and explicitly mention what you're talking about, then why did it take you 3 months to realize that my feature request is out of scope? @DmitriyLewen also seemed to be completely unaware of such constraints, otherwise, I'm pretty sure he'd have mentioned it...

You're just trying to save face now by saying all of that about your guidelines, but your contribution guidelines do not say anything about such features being out of scope... https://aquasecurity.github.io/trivy/v0.53/community/principles/

You only mention that runtime security, intentional attacks, and user interface is out of scope. My feature which I implemented does not fall into any of these categories. So your ""mature oss project"", has such a great contribution guidelines documented that not only me, but also your maintainers are unaware of what's in it then 😅 

Also, whatever you linked previously, does not mention the fact that ""do not work on such features"", it's just a table to mention which feature is in which offering... You only mention in the guidelines that
""Aqua Security offers a premium version with several features not available in the open-source Trivy project.""

Which is all good, but nowhere do you actually say that these features CANNOT BE IMPLEMENTED in the open source version. Even if it's under ""Out of scope features"" section, this is not meaning what you're saying... You just mention categories which are not included, nowhere is it coherent enough to mention that such features are all out of scope. It is very vague..."
2219702702,6524,kovacs-levent,2024-07-10T06:54:34Z,"I don't think I need to spell it out how bad Trivy looks when you're scanning a distroless python image with it for example, and Trivy is completely unaware that Python binary is actually part of the image and it's not part of SBOM, vuln scans, or anything.

You'd rather keep this behavior in Trivy than to mitigate a serious blindspot, causing (probably) thousands of missed vulnerabilties over time. You value your business over making the tool better, and mitigating serious blindspots in it."
2220272897,6524,itaysk,2024-07-10T11:29:16Z,"The table I referenced is linked from the trivy documentation under ""Out of Scope Features"". The table includes a section titled ""Compiled binaries"" which puts ""identifies popular applications by huristics"" as a commercial feature. We could improve the wording to be more clear about it.

Even though this case is pretty obvious, the doc is not meant to be a definitive and comprehansive policy. We can't forsee all potential future suggestions and decide in advance what will be in/out of scope. It's possible that a feature suggestion will be rejected based on maintainer's discretion.

You have made your point clear about the necessity of this feature, thanks for the feedback. We will consider it in the future as we re-evaluate the scope guidelines."
2533804604,8077,DmitriyLewen,2024-12-11T07:03:37Z,"@goneall I created this PR to use the `hasExtractedLicensingInfos` field (as you wrote in #7716).
It would be great if you took a look if you have time"
2616160775,8077,goneall,2025-01-27T16:02:25Z,Thanks @DmitriyLewen @knqyf263 - I'll try out the fix
550495630,253,simar7,2019-11-06T20:53:16Z,This PR is excruciatingly long to review. Maybe next time we could break it down to more manageable chunks? You could look into stacking PRs https://graysonkoonce.com/stacked-pull-requests-keeping-github-diffs-small/
550507583,253,knqyf263,2019-11-06T21:26:36Z,"@simar7 Yes, I know. I always try to keep PR small, but I needed to fix many points at the same time. I'll take a look at your URL. Thanks."
1279452584,3015,simar7,2022-10-14T20:50:29Z,"## AWS Scanning results

### With new policies fetched
```
./trivy --debug aws  --region us-west-2 --service iam  
2022-10-14T13:43:41.847-0700    DEBUG   Severities: [""UNKNOWN"" ""LOW"" ""MEDIUM"" ""HIGH"" ""CRITICAL""]
2022-10-14T13:43:41.847-0700    DEBUG   Timeout is set to less than 1 hour - upgrading to 1 hour for this command.
2022-10-14T13:43:41.847-0700    DEBUG   Looking for AWS credentials provider...
2022-10-14T13:43:41.848-0700    DEBUG   Looking up AWS caller identity...
2022-10-14T13:43:42.210-0700    DEBUG   Verified AWS credentials for account <snip>!
2022-10-14T13:43:42.210-0700    DEBUG   Specific services were requested: [iam]...
2022-10-14T13:43:42.257-0700    INFO    Need to update the built-in policies
2022-10-14T13:43:42.257-0700    INFO    Downloading the built-in policies...
27.91 KiB / 27.91 KiB [------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------] 100.00% ? p/s 0s
2022-10-14T13:43:42.371-0700    DEBUG   Digest of the built-in policies: sha256:1c0e92b551826f6de6d9ec92c7ccdbaf490b685e1bbc1b56544f8f41c8701bcd
2022-10-14T13:43:42.371-0700    DEBUG   Policies successfully downloaded
2022-10-14T13:43:42.462-0700    DEBUG   [defsec] 43:42.462148000 aws-api.scanner                  Found 1 results for AVD-AWS-0056
2022-10-14T13:43:42.462-0700    DEBUG   [defsec] 43:42.462233000 aws-api.scanner                  Found 6 results for AVD-AWS-0143
2022-10-14T13:43:42.462-0700    DEBUG   [defsec] 43:42.462243000 aws-api.scanner                  Found 1 results for AVD-AWS-0058
2022-10-14T13:43:42.462-0700    DEBUG   [defsec] 43:42.462248000 aws-api.scanner                  Found 1 results for AVD-AWS-0059
2022-10-14T13:43:42.462-0700    DEBUG   [defsec] 43:42.462259000 aws-api.scanner                  Found 1 results for AVD-AWS-0060
2022-10-14T13:43:42.462-0700    DEBUG   [defsec] 43:42.462264000 aws-api.scanner                  Found 1 results for AVD-AWS-0061
2022-10-14T13:43:42.462-0700    DEBUG   [defsec] 43:42.462270000 aws-api.scanner                  Found 1 results for AVD-AWS-0062
2022-10-14T13:43:42.462-0700    DEBUG   [defsec] 43:42.462275000 aws-api.scanner                  Found 1 results for AVD-AWS-0063
2022-10-14T13:43:42.462-0700    DEBUG   [defsec] 43:42.462521000 aws-api.scanner                  Found 6 results for AVD-AWS-0144
2022-10-14T13:43:42.462-0700    DEBUG   [defsec] 43:42.462547000 aws-api.scanner                  Found 6 results for AVD-AWS-0145
2022-10-14T13:43:42.462-0700    DEBUG   [defsec] 43:42.462562000 aws-api.scanner                  Found 8 results for AVD-AWS-0146
2022-10-14T13:43:42.494-0700    DEBUG   [defsec] 43:42.494572000 aws-api.scanner.rego             Loaded 119 policies from disk.
2022-10-14T13:43:42.639-0700    DEBUG   [defsec] 43:42.639434000 aws-api.scanner.rego             Scanning 1 inputs...
2022-10-14T13:43:42.715-0700    DEBUG   Writing report to output...

Resource Summary for Service 'iam' (AWS Account <snip>)
┌───────────────────────────────────────────────────┬──────────────────────────────────────────┐
│                                                   │            Misconfigurations             │
│                                                   ├──────────┬──────┬────────┬─────┬─────────┤
│ Resource                                          │ Critical │ High │ Medium │ Low │ Unknown │
├───────────────────────────────────────────────────┼──────────┼──────┼────────┼─────┼─────────┤
<snipped>
└───────────────────────────────────────────────────┴──────────┴──────┴────────┴─────┴─────────┘

```

### With `--skip-policy-update`:
```
./trivy --debug aws --skip-policy-update --region us-west-2 --service iam 
2022-10-14T13:46:19.963-0700    DEBUG   Severities: [""UNKNOWN"" ""LOW"" ""MEDIUM"" ""HIGH"" ""CRITICAL""]
2022-10-14T13:46:19.963-0700    DEBUG   Timeout is set to less than 1 hour - upgrading to 1 hour for this command.
2022-10-14T13:46:19.963-0700    DEBUG   Looking for AWS credentials provider...
2022-10-14T13:46:19.963-0700    DEBUG   Looking up AWS caller identity...
2022-10-14T13:46:20.090-0700    DEBUG   Verified AWS credentials for account <snip>!
2022-10-14T13:46:20.090-0700    DEBUG   Specific services were requested: [iam]...
2022-10-14T13:46:20.205-0700    DEBUG   [defsec] 46:20.205503000 aws-api.scanner                  Found 1 results for AVD-AWS-0056
2022-10-14T13:46:20.205-0700    DEBUG   [defsec] 46:20.205565000 aws-api.scanner                  Found 6 results for AVD-AWS-0143
2022-10-14T13:46:20.205-0700    DEBUG   [defsec] 46:20.205573000 aws-api.scanner                  Found 1 results for AVD-AWS-0058
2022-10-14T13:46:20.205-0700    DEBUG   [defsec] 46:20.205577000 aws-api.scanner                  Found 1 results for AVD-AWS-0059
2022-10-14T13:46:20.205-0700    DEBUG   [defsec] 46:20.205582000 aws-api.scanner                  Found 1 results for AVD-AWS-0060
2022-10-14T13:46:20.205-0700    DEBUG   [defsec] 46:20.205586000 aws-api.scanner                  Found 1 results for AVD-AWS-0061
2022-10-14T13:46:20.205-0700    DEBUG   [defsec] 46:20.205590000 aws-api.scanner                  Found 1 results for AVD-AWS-0062
2022-10-14T13:46:20.205-0700    DEBUG   [defsec] 46:20.205595000 aws-api.scanner                  Found 1 results for AVD-AWS-0063
2022-10-14T13:46:20.205-0700    DEBUG   [defsec] 46:20.205789000 aws-api.scanner                  Found 6 results for AVD-AWS-0144
2022-10-14T13:46:20.205-0700    DEBUG   [defsec] 46:20.205805000 aws-api.scanner                  Found 6 results for AVD-AWS-0145
2022-10-14T13:46:20.205-0700    DEBUG   [defsec] 46:20.205818000 aws-api.scanner                  Found 8 results for AVD-AWS-0146
2022-10-14T13:46:20.211-0700    DEBUG   [defsec] 46:20.211510000 aws-api.scanner.rego             Scanning 1 inputs...
2022-10-14T13:46:20.211-0700    DEBUG   Writing report to output...

Resource Summary for Service 'iam' (AWS Account <snip>)
┌───────────────────────────────────────────────────┬──────────────────────────────────────────┐
│                                                   │            Misconfigurations             │
│                                                   ├──────────┬──────┬────────┬─────┬─────────┤
│ Resource                                          │ Critical │ High │ Medium │ Low │ Unknown │
├───────────────────────────────────────────────────┼──────────┼──────┼────────┼─────┼─────────┤
<snip>
└───────────────────────────────────────────────────┴──────────┴──────┴────────┴─────┴─────────┘

```"
1279458972,3015,simar7,2022-10-14T20:58:16Z,"## Misconfiguration scan

## With new policies fetched
```
./trivy --debug conf  /Users/simar/repos/defsec/test/testdata/dockerfile/DS005 

2022-10-14T13:56:15.734-0700    DEBUG   Severities: [""UNKNOWN"" ""LOW"" ""MEDIUM"" ""HIGH"" ""CRITICAL""]
2022-10-14T13:56:15.811-0700    DEBUG   cache dir:  /Users/simar/Library/Caches/trivy
2022-10-14T13:56:15.811-0700    INFO    Need to update the built-in policies
2022-10-14T13:56:15.811-0700    INFO    Downloading the built-in policies...
27.91 KiB / 27.91 KiB [-----------------------------------------------------------------------------------------------------------------------------------------------------] 100.00% ? p/s 0s
2022-10-14T13:56:15.963-0700    DEBUG   Digest of the built-in policies: sha256:1c0e92b551826f6de6d9ec92c7ccdbaf490b685e1bbc1b56544f8f41c8701bcd
2022-10-14T13:56:15.963-0700    DEBUG   Policies successfully downloaded
2022-10-14T13:56:15.963-0700    INFO    Misconfiguration scanning is enabled
2022-10-14T13:56:16.438-0700    DEBUG   OS is not detected.
2022-10-14T13:56:16.438-0700    INFO    Detected config files: 2
2022-10-14T13:56:16.438-0700    DEBUG   Scanned config file: Dockerfile.allowed
2022-10-14T13:56:16.438-0700    DEBUG   Scanned config file: Dockerfile.denied

Dockerfile.denied (dockerfile)

Tests: 22 (SUCCESSES: 21, FAILURES: 1, EXCEPTIONS: 0)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

LOW: Consider using 'COPY ""/target/app.jar"" ""app.jar""' command instead of 'ADD ""/target/app.jar"" ""app.jar""'
══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
You should use COPY instead of ADD unless you want to extract a tar file. Note that an ADD command will extract a tar file, which adds the risk of Zip-based vulnerabilities. Accordingly, it is advised to use a COPY command, which does not extract tar files.

See https://avd.aquasec.com/misconfig/ds005
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Dockerfile.denied:4
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   4 [ ADD ""/target/app.jar"" ""app.jar""
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

```

## With `--skip-policy-update`
```
./trivy --debug conf --skip-policy-update /Users/simar/repos/defsec/test/testdata/dockerfile/DS005

2022-10-14T13:52:14.123-0700    DEBUG   Severities: [""UNKNOWN"" ""LOW"" ""MEDIUM"" ""HIGH"" ""CRITICAL""]
2022-10-14T13:52:14.179-0700    DEBUG   cache dir:  /Users/simar/Library/Caches/trivy
2022-10-14T13:52:14.179-0700    INFO    Misconfiguration scanning is enabled
2022-10-14T13:52:14.615-0700    DEBUG   OS is not detected.
2022-10-14T13:52:14.615-0700    INFO    Detected config files: 2
2022-10-14T13:52:14.615-0700    DEBUG   Scanned config file: Dockerfile.allowed
2022-10-14T13:52:14.615-0700    DEBUG   Scanned config file: Dockerfile.denied

Dockerfile.denied (dockerfile)

Tests: 22 (SUCCESSES: 21, FAILURES: 1, EXCEPTIONS: 0)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

LOW: Consider using 'COPY ""/target/app.jar"" ""app.jar""' command instead of 'ADD ""/target/app.jar"" ""app.jar""'
══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
You should use COPY instead of ADD unless you want to extract a tar file. Note that an ADD command will extract a tar file, which adds the risk of Zip-based vulnerabilities. Accordingly, it is advised to use a COPY command, which does not extract tar files.

See https://avd.aquasec.com/misconfig/ds005
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Dockerfile.denied:4
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   4 [ ADD ""/target/app.jar"" ""app.jar""
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

```"
1289831609,3015,simar7,2022-10-25T00:48:51Z,Thanks for the review @liamg - just waiting for this to be approved and merged https://github.com/aquasecurity/defsec/pull/1012 - could you help with that or give me the permission on the defsec repo to merge?
1290249683,3015,liamg,2022-10-25T09:21:51Z,@simar7 I've merged it and tagged `v0.82.0` of defsec :+1: 
1297864271,3015,simar7,2022-11-01T00:47:55Z,"> @simar7 I've merged it and tagged `v0.82.0` of defsec 👍

thanks - I just rebased this and all checks are passing. can we merge this in now?"
1322814541,3015,simar7,2022-11-21T23:57:48Z,hey @knqyf263 - I'm sure you are getting to this PR to review :)
1323274614,3015,knqyf263,2022-11-22T08:16:18Z,"Yes, but please let me wrap up VM scanning first. It has a deadline."
1376272409,3015,simar7,2023-01-09T20:25:02Z,"@knqyf263 - I've updated the logic as desired. For some unrelated reason, tests on Windows are failing. I'm unclear why that is as it isn't related to this PR. Is there a known issue with Windows unit tests?"
1377005264,3015,knqyf263,2023-01-10T10:01:10Z,@simar7 I think missing file close causes it.
1377860409,3015,simar7,2023-01-10T21:10:52Z,"> @simar7 I think missing file close causes it.

thanks, you're right on. That seems to be it, appreciate the second look. "
733037254,751,CLAassistant,2020-11-24T15:12:37Z,[![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=751) <br/>All committers have signed the CLA.
733060748,751,knqyf263,2020-11-24T15:47:55Z,"@czunker Thanks for your great contribution!
@danielpacak Could you help me with the review? It should be easy to integrate into Starboard."
736243028,751,czunker,2020-12-01T06:02:45Z,"Hi @danielpacak ,

hope I didn't miss a comment this time."
739488678,751,knqyf263,2020-12-06T11:21:45Z,Thanks for the great contribution! @czunker 
1113997114,2065,knqyf263,2022-04-30T14:22:51Z,"I'm curious why we needed another PR.
https://github.com/aquasecurity/trivy/pull/2055"
1114200910,2065,josedonizetti,2022-05-01T10:56:48Z,"@knqyf263 Sorry, I was working on my fork, endup branching from you and creating a new branch in case I broke something on your branch and forgot about your PR. I'll close this PR and push my changes to your branch/PR."
1114526179,2065,knqyf263,2022-05-02T06:07:07Z,">@knqyf263 Sorry, I was working on my fork, endup branching from you and creating a new branch in case I broke something on your branch and forgot about your PR. I'll close this PR and push my changes to your branch/PR.

I'll close my PR then. I just wanted to know why we needed two PRs. If it is just a mistake, it is ok👍 "
1121669456,2065,josedonizetti,2022-05-09T23:07:27Z,"@chen-keinan @knqyf263 Can you review? This is a first version of the command, limited features, so we can release something working for kubecon, then I follow up with other PRs to improve things. 

Things TODO:

1 - Add more formats, for now the only format is json.
2 - Better performance, for now we are doing one scan per time, no concurrency.
3 - Better unit tests
3 - Flags (--ignore-namespaces, --context, etc) 
4 - Scan secrets
5 - Use memory FS instead of writing resources to files
6 - Reports (summary, others?)
7 - Individual resources scan `trivy k8s deployment/orion`

Let me know what you think is a blocker on your review, and what I can fix on a following PR please. "
1122305711,2065,knqyf263,2022-05-10T12:09:16Z,Could you also update the documentation? I'm a bit confused with usage.
2217965768,7131,CLAassistant,2024-07-09T15:04:14Z,[![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=7131) <br/>All committers have signed the CLA.
2217965801,7131,CLAassistant,2024-07-09T15:04:14Z,"[![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=7131) <br/>Thank you for your submission! We really appreciate it. Like many open source projects, we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/aquasecurity/trivy?pullRequest=7131) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/aquasecurity/trivy?pullRequest=7131) it.</sub>"
1179744539,2490,CLAassistant,2022-07-10T15:01:05Z,[![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=2490) <br/>All committers have signed the CLA.
1183112000,2490,mxab,2022-07-13T11:37:30Z,"Hi @DmitriyLewen after going a bit a forth, I'm a bit undecided what makes sense

I created now three different hooks one
that does exactly 
`trivy fs --exit-code 1 .`
`trivy fs --exit-code 1` configure the rest via `args`
`trivy` configure everything via `args`

I create a showcase for those 3 use cases in this repo here:

https://github.com/mxab/trivy-pre-commit-demo
not sure which one makes the most sense, any thoughts"
1184297984,2490,DmitriyLewen,2022-07-14T10:53:02Z,"I think 3 hooks is overkill.
I think only the `fs` subcommand will be used. It is also always necessary to use `--exit-code 1`.
We can only use one flag with `entry: trivy fs --exit-code 1 .`.
If the user needs to exclude some directories, he can use the `-skip-dirs` and `--skip-files` flags.

If many users need a different subcommand or selection of directories to scan, we can always add/change a hook.

"
1184319447,2490,mxab,2022-07-14T11:14:26Z,Ok now there is only `trivyfs` which allows configuration and `trivyfsall` for a simple setup
1184421857,2490,DmitriyLewen,2022-07-14T13:02:47Z,@knqyf263 PR looks good. But what do you think about using 2 hooks?
1184431177,2490,mxab,2022-07-14T13:11:36Z,"@DmitriyLewen I can remove the `trivyfsall` hook. The idea was just to have one simple hook with a basic config.
It is not really configurable as it has the `.` at the end and from how I understand trivy fs cli interface the path is the final argument therefore you cannot mixin any futher `args`"
1184444192,2490,DmitriyLewen,2022-07-14T13:23:05Z,"@mxab 
I checked this config:
``` yaml
repos:
  - repo: https://github.com/mxab/trivy
    rev: eb31ef229cbd1ed76b7e2becc6bec0614240e389
    hooks:
    - id: trivyfsall
      args:
        - --severity=HIGH
```

I don't know how it works, but it works correctly(report contains only `HIGH` vulnerabilities) "
1184473722,2490,mxab,2022-07-14T13:49:49Z,"Ok, yeah just noticed as well... but why?!"
1184870995,2490,mxab,2022-07-14T20:32:43Z,"I toyed arround with pre-commit and I still really don't understand why this works. There must be something different when between the bash/zsh and python subprocess module

I went through the pre-commit code and added some logging right before shoves it into the `subprocess.Popen(cmd,**kwargs)`
The `cmd` array contains still `'trivy', 'fs', '--exit-code', '1', '.', '--skip-dirs=.git/'`
Maybe cobra does some magic there.

If you want to only have one hook I now would vote to drop the trivyfsall as this want allow to set the path part. if you add another `.` in the args in the trivyfsall it will fail"
1185157244,2490,DmitriyLewen,2022-07-15T04:19:32Z,"ok, let's remove `trivyfsall`.
Also, when you will correct docs, you can check docs with `make mkdocs-serve`?
If I'm not mistaken, one more empty line is needed [here](https://github.com/aquasecurity/trivy/pull/2490/commits/eb31ef229cbd1ed76b7e2becc6bec0614240e389#diff-6828264893dbf2a68733af90bf5996b5b8afec681e5d6f216edca2ec9c8d1fa5R258-R259).
"
1185229939,2490,mxab,2022-07-15T06:44:49Z,"Ok, removed it and updated the docs"
1190581095,2490,mxab,2022-07-20T17:53:28Z,@DmitriyLewen should I rebase my branch?
1190992341,2490,DmitriyLewen,2022-07-21T03:19:37Z,"@mxab , yes, please"
1192279752,2490,mxab,2022-07-22T07:39:36Z,@DmitriyLewen done
1230025879,2490,mxab,2022-08-29T09:37:53Z,@DmitriyLewen is there anything else you require? I think rebasing it makes only sense when you really going to merge it :)
1230034127,2490,DmitriyLewen,2022-08-29T09:45:27Z,"Hello @mxab . 

> is there anything else you require? 

No, thanks. 
We need to get approval from @knqyf263.

@knqyf263 I approved this PR. Could you take a look when you have time, please.
"
1241407886,2490,tspearconquest,2022-09-09T01:47:43Z,"Hey, thanks for making this. I apologize as I haven't had proper time to work on this after all. This looks good to me, however I'm not a maintainer so I can't merge it. I would be interested in seeing a trivy-docker hook to run trivy from a docker image, and that was what I had planned to contribute. If you can make it, I'll definitely use it, and if not, then I'll open up a new pull request when I've got time to work on it.

Thanks again!"
1253948098,2490,natefive,2022-09-21T16:30:05Z,@mxab can you rebase this? @knqyf263 is there any reason why this stalled thanks :)
1254101125,2490,mxab,2022-09-21T18:53:43Z,@natefive done
1276945210,2490,proinsias,2022-10-13T02:27:47Z,@mxab – thanks for this!
1288190045,2490,mxab,2022-10-23T20:06:25Z,"@tspearconquest great idea,
I updated the pre-commit hooks to run in two modes `trivy-go` and `trivy-docker`

@DmitriyLewen does this make sense to you"
1288202149,2490,tspearconquest,2022-10-23T21:11:21Z,"This looks good. I would only suggest one change, to use the `--severity` flag so that we only fail for medium and higher vulnerabilities."
1288206785,2490,mxab,2022-10-23T21:37:24Z,"@tspearconquest you can add such flags via the `args` field when using it
```
    hooks:
    -   id: trivyfs-go # or trivy-docker
        args:
          - --severity
          - ...
```"
1288222715,2490,tspearconquest,2022-10-23T23:03:45Z,LGTM
1288238694,2490,tspearconquest,2022-10-24T00:07:04Z,"I have some ideas for how to enhance this later on when I have more time to come back to it.

It would be great, as one idea, to be able to have a script pre-process the file inputs from pre-commit.

I could foresee a use case of building an in-repo Dockerfile into an image and then running a scan on the image, and another use case to perform secrets or sbom scanning only, without doing the full fs scan. But it's definitely a topic for a separate PR. This satisfies my original plan and I want to take a moment to give a shout out to @mxab for his dedication towards getting this merged.

Hope knqyf263 will approve it soon."
1288343195,2490,DmitriyLewen,2022-10-24T02:54:25Z,"Hey @mxab 

I thinks it is good idea!
Thanks for your work."
1288569741,2490,mxab,2022-10-24T07:53:28Z,"Maybe someone could reach out to @knqyf263 , the PR is open for quite a while now :)"
1294176217,2490,matthewflannery,2022-10-27T22:21:55Z,"+1 on this, please can we get this PR over the line @knqyf263 - Trivy is quickly becoming an outstanding tool and being able to integrate this as early as possible, as easily as possible into a developers workflow would be amazing. @simar7 @DmitriyLewen @afdesk @behara "
1297109343,2490,electriquo,2022-10-31T13:41:15Z,"reaching out for @knqyf263 
please help in reviewing the PR and assist in merging it"
1311058430,2490,urbanadventurer,2022-11-11T00:02:12Z,+1 LGTM
1313682146,2490,knqyf263,2022-11-14T13:16:35Z,"Sorry for the late reply. Trivy has many features now and we are cautious about putting new integrations upstream because we need to maintain that for the long term. You might feel this change is small, but small things make a big difference.

We will probably merge this PR in the future, but if you need the pre-commit shortly, I'd recommend creating your repository and open a PR to add the repository link here.
https://aquasecurity.github.io/trivy/v0.34/ecosystem/tools/#community-tools "
1320862965,2490,mxab,2022-11-19T11:21:05Z,"Not the answer I was looking for after half a year 🥲, but here we go:
https://github.com/aquasecurity/trivy/pull/3203

The downside of the external version is that I can only use the docker container based approach
In the first version it only uses the latest trivy image

If you maybe want to merge this PR in the future, I would leave it open"
1483814087,2490,jmreicha,2023-03-25T12:38:45Z,"I would be curious to know what the thought is about the downsides of maintaining this integration. Not enough help? Time? Something else? It would be great to have an ""official"" pre-commit hook, it may even drive greater adoption."
1483879768,2490,itaysk,2023-03-25T17:38:10Z,"Trivy is very popular and many integrations are requested/suggested every day. The core team doesn't have the capacity nor the knowledge to properly maintain and support every single integration and target ecosystem. Moreover, there can be different legitimate implementations for same scenarios or different opinions around how to integrate Trivy, and we don't want to be the judges of that. We want to encourage the community (e.g author of this PR) to create and share their solutions with Trivy. The  only think Trivy is a project can do is to make all of those integrations discoverable in one place. That's why we created the ""Ecosystem"" section in the documentation which lists (with your help) all of Trivy's different plugins/integrations/use cases in one place (if you have any feedback about that, please feel free to share, probably not in this PR though).

I'm going to close this PR since the pre-commit hook is now [included in the Ecosystem](https://github.com/aquasecurity/trivy/pull/3203) list. Thanks so much to @mxab and other contributors."
2286183303,7336,afdesk,2024-08-13T12:48:16Z,"@knqyf263 i think it's ready for review.
please, take a look when you have time. thanks!"
2287763093,7336,knqyf263,2024-08-14T03:23:45Z,Is there a way to distinguish between the license name and the license text?
2287841833,7336,afdesk,2024-08-14T04:40:46Z,"> Is there a way to distinguish between the license name and the license text?

Right now, I'm not sure.
but I'll take a look and will show the cases. "
2287865643,7336,knqyf263,2024-08-14T05:07:21Z,"I want to show ""unknown"" for the license text."
2287972887,7336,afdesk,2024-08-14T06:43:06Z,"My concern is next.
Python deb packages can contain the license text inside `license` field:
```sh
cat /usr/share/doc/python3.9-minimal/copyright
```
![image](https://github.com/user-attachments/assets/c57588c0-95cc-46fa-94c8-599457069a0e)

but if I understand correctly it's a mistake.
[the docs](https://www.debian.org/doc/packaging-manuals/copyright-format/1.0/#license-field):  First line (synopsis): an abbreviated name for the license."
2287977890,7336,afdesk,2024-08-14T06:47:03Z,"My concern is that there is no a correct way to distinguish between incorrect `Permission to use, copy, modify, and distribute this software and its` and correct license synopsis `TinySCHEME` or `permissive` for `gpgv` package."
2288019345,7336,afdesk,2024-08-14T07:14:51Z,"the same situation is with `License` field inside `*.dist-info.METADATA`.

some packages contain a correct license name (eg. `Pympler`): `Apache License, Version 2.0`.
some undefined license (eg `zope`):  `ZPL 2.1`.
some packages contain the license text (eg `menuinst`): 
![image](https://github.com/user-attachments/assets/22877708-9a8d-4bca-8366-a4cf3b5a9d3f)

"
2288201415,7336,afdesk,2024-08-14T08:47:20Z,@knqyf263 I have an idea. trying 
2288219670,7336,afdesk,2024-08-14T08:56:26Z,"> I want to show ""unknown"" for the license text.

@knqyf263  Could you confirm that I understand correctly this requirement? thanks
![image](https://github.com/user-attachments/assets/ad811c60-455d-4443-9658-dd7ef23a5ae1)
"
2292798013,7336,knqyf263,2024-08-16T04:45:07Z,"I know it's not ideal, but what if checking the length and the number of newlines?

```
func isLicenseName(license string) bool {
	// Check text length
	if len(license) < 100 {
		return true
	}

	// Count newlines
	if strings.Count(license, ""\n"") > 3 {
		return false
	}
        ...
```"
2292801913,7336,knqyf263,2024-08-16T04:49:54Z,"> > I want to show ""unknown"" for the license text.
> 
> @knqyf263 Could you confirm that I understand correctly this requirement? thanks ![image](https://private-user-images.githubusercontent.com/19297627/357746378-ad811c60-455d-4443-9658-dd7ef23a5ae1.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MjM3ODMzODYsIm5iZiI6MTcyMzc4MzA4NiwicGF0aCI6Ii8xOTI5NzYyNy8zNTc3NDYzNzgtYWQ4MTFjNjAtNDU1ZC00NDQzLTk2NTgtZGQ3ZWYyM2E1YWUxLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA4MTYlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwODE2VDA0MzgwNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTg2YzQ2YzBiYWE3NjdmN2ZjZTAzZjdhNWMwNjAzMmNlMjI1M2MxMzA3ZTI3ZmYzZWQxNjMyZGM5YzEyNGE1NWImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.yPsLRfAoLDDU2oID72M98cbLkfkbsKTTGofnuYcVyak)

I don't want to show the license text there as it's too long. I thought we would show ""UNKNOWN"", but we know a license text. We just don't know the short name. How about ""Custom""? Then, the license text can be stored in another field."
2295666991,7336,afdesk,2024-08-19T04:54:15Z,"> I know it's not ideal, but what if checking the length and the number of newlines?
> 
> ```
> func isLicenseName(license string) bool {
> 	// Check text length
> 	if len(license) < 100 {
> 		return true
> 	}
> 
> 	// Count newlines
> 	if strings.Count(license, ""\n"") > 3 {
> 		return false
> 	}
>         ...
> ```

@knqyf263  I tried this way, you're right, it's not ideal.

Counting new lines don't affect on the output, because Trivy reads only one line from license in dpkg, python packages also contain a long single line license... so this check is always true.

About check text length. It works for long linceses in python. 
but dpkg's  licenses are still shown incorrectly.
 
i thought it's a long text, but actually it's a few first rows of several licenses:
<img width=""782"" alt=""изображение"" src=""https://github.com/user-attachments/assets/587241fd-a0b8-4b13-9449-f74014b156fd"">
```sh
License: Redistribution and use in source and binary forms, with or without
License: By obtaining, using, and/or copying this software and/or its
License: Permission to use, copy, modify, and distribute this software and
License: Redistribution and use in source and binary forms, with or without
License: This software is provided 'as-is', without any express or implied
License: Permission to use, copy, modify, and distribute this software and
License: Permission  is  hereby granted,  free  of charge,  to  any person
License: This software is provided 'as-is', without any express or implied
License: Permission is hereby granted, free of charge, to any person obtaining
   under the terms of the GNU General Public License as published by the
   section entitled ``GNU General Public License''.
License: Permission to use, copy, modify, and distribute this software and its
License: Permission to use, copy, modify, and distribute this software and its
License: This software is provided 'as-is', without any express or implied
License: Permission is hereby granted, free of charge, to any person obtaining
License: Redistribution and use in source and binary forms, with or without
License: This software is provided as-is, without express or implied
License: Permission to use, copy, modify, and distribute this software for any
License: Permission to use, copy, modify, and distribute this software and its
License:
License:  * Permission to use this software in any way is granted without
License: Permission to use, copy, modify, and distribute this software and its
```"
2295681603,7336,afdesk,2024-08-19T05:09:57Z,"Right now, I can't see a good solution, but there are several options:

1. We just check text lengths, and don't update output for dpkg licenses, because it's a python's fault.

2. We keep a list of known licenses, and check every splited part. 
if there is no matching, we print a license text.

3. We keep some **keywords**, and if we can find them inside a string, it'll mean a license text (or a part).
for example: `as-is`, `redistribution`, `permission`, `using`, `use`, `@`, `http` etc.

@knqyf263 wdyt?

"
2295688652,7336,afdesk,2024-08-19T05:17:31Z,"> > > I want to show ""unknown"" for the license text.
> I don't want to show the license text there as it's too long. I thought we would show ""UNKNOWN"", but we know a license text. We just don't know the short name. How about ""Custom""? Then, the license text can be stored in another field.

You mean we should print `CUSTOM license` instead of a long license text for table output, and keep another field (ex `licenseText`) for JSON, right? 
IMHO, It makes sense. 
also I'd add a few words from license )  "
2295730011,7336,DmitriyLewen,2024-08-19T06:00:56Z,"> i thought it's a long text, but actually it's a few first rows of several licenses:

What if we add one more check for `copyright` files:
if number of `License: *` fields more then one - split each line:
- if 2 or more licenses are found in field - it is text license
- if only 1 license is found in field - this is license name

e.g.
line 1 - text, line 2 - license name:
```
License: Redistribution and use in source and binary forms, with or without
License: BSD-3-Clause
```

My logic is as follows:
if you use multiple licenses separarted by `and`/`or` - you will use only one `License: *` field.
But if you use multiple `License: *` fields:
- you will use one license for each `License: *` field.
  e.g.:
  ```
  License: MIT
  License: BSD-3-Clause
  ```
- in other cases it is license text."
2295752678,7336,afdesk,2024-08-19T06:19:34Z,"@DmitriyLewen that's an interesting idea.

there are next cases for perl and python packages:

perl:
```sh
License: GPL-1+ or Artistic or Artistic-dist
``` 
python3.9:
```sh
License: This software is provided 'as-is', without any express or implied
```
i'm not sure we can separate these cases, but maybe if we also will check string length...

a long string with a few splited licenses is a text. 
what is long? I think it about 50 chars.
wdyt? "
2295832910,7336,DmitriyLewen,2024-08-19T07:15:33Z,"> but maybe if we also will check string length...

Yeah. That's what I thought
if there's only one field - we check the length and number of lines.

> I think it about 50 chars.

What if use 30 characters + no [saved licenses](https://github.com/aquasecurity/trivy/blob/0c6687d5ba0df5de2632aad26c21ea99565bd9e1/pkg/licensing/normalize.go#L8) found"
2300426548,7336,knqyf263,2024-08-21T02:56:40Z,">You mean we should print CUSTOM license instead of a long license text for table output, and keep another field (ex licenseText) for JSON, right?

Exactly"
2306187192,7336,afdesk,2024-08-23T04:19:32Z,"@knqyf263 @DmitriyLewen 
I tried severel ways to separate a long license text from a license name, and the best result for me is a detection by keywords. 

There were selected a few obvious words, that can appear inside license texts only.

Please, take a look at this suggestion when you have free time. thanks!  "
2306456509,7336,afdesk,2024-08-23T07:21:07Z,"> > I tried severel ways to separate a long license text from a license name, and the best result for me is a detection by keywords.
> 
> Can you give examples of problems for other methods to save time if we need to come back to this question?

The main problem is to separate a license name and a license text. 
Some developers put a full license text inside a license field, where should be a license name (or a license ID).

Checking the length doesn't work because there are correct long lincenses (it's already added to test cases):
```
Common Development and Distribution License 1.0 (CDDL-1.0)
```

the number of newlines doesn't work too, because we read only one line from copyright or license files. 

the number of spaces doesn't work, because there are too long correct license names (ex CDDL-1.0).

`saisk026/conda-test:v1` is a good image for license testing. "
2326045936,7336,knqyf263,2024-09-03T09:29:39Z,">I tried severel ways to separate a long license text from a license name, and the best result for me is a detection by keywords.

OK, we don't have an easy way. Let's see how it goes."
2326143285,7336,afdesk,2024-09-03T10:16:03Z,"> > I tried severel ways to separate a long license text from a license name, and the best result for me is a detection by keywords.
> 
> OK, we don't have an easy way. Let's see how it goes.

Should i fix something to add this PR in 0.55?"
2326190964,7336,knqyf263,2024-09-03T10:38:22Z,">Should i fix something to add this PR in 0.55?

I'm reviewing the changes now. I'll update you soon.
If we don't make it for v0.55.0, we can include it in v0.55.1."
2328436731,7336,afdesk,2024-09-04T10:02:48Z,"> but realized there was no test. I'm not sure my changes work as expected. @afdesk Could you add a test for license texts?

yeh, sure. the test is added"
2185726896,6993,knqyf263,2024-06-24T06:39:49Z,">2024-06-24T11:18:41+06:00       ERROR   ""--reset"" was removed. Use ""trivy clean --all"" instead.
>2024-06-24T11:18:41+06:00       FATAL   Fatal error     flag error: db flag error: unable to parse flag: ""--reset"" was removed

I returned `Use ""trivy clean --all"" instead` as an error, but it appears at the end of the log message and is therefore difficult to find as below.

>2024-06-24T11:18:41+06:00       FATAL   Fatal error     flag error: db flag error: unable to parse flag: ""--reset"" was removed. 
use ""trivy clean --all"" instead.

I eventually separated the error message. In short, it's intended.

If you don't like `""--reset"" was removed. ` is displayed twice, I can change the error message."
2185752811,6993,DmitriyLewen,2024-06-24T06:58:06Z,"> I eventually separated the error message. In short, it's intended.

Got it :smile: 
Then no problem :+1: "
2185822726,6993,knqyf263,2024-06-24T07:40:58Z,"@DmitriyLewen I change the message slightly.
https://github.com/aquasecurity/trivy/pull/6993/commits/5a989d4fc203a5cc14ab27a2ef3877a6d871f6c0"
2185830032,6993,knqyf263,2024-06-24T07:45:20Z,"@simar7 @nikpivkin According to the discussion in https://github.com/aquasecurity/trivy/issues/6992, I didn't add `--terraform-module` flag. If you want to move the cache under the Trivy cache directory and let Trivy delete the cache, please feel free to open a new PR. I don't think it's a blocker of this PR."
2186095705,6993,DmitriyLewen,2024-06-24T09:55:57Z,"@knqyf263 
I understand that didn't write about comments for `--reset-checks-bundle` flag.
Added in https://github.com/aquasecurity/trivy/pull/6993/commits/8995644c6690425982c6c0a55d60864effc7147f"
2186210053,6993,knqyf263,2024-06-24T10:24:28Z,@DmitriyLewen Thanks! It's my bad.
2186479357,6993,knqyf263,2024-06-24T12:36:14Z,"@chen-keinan @simar7 @nikpivkin Since it's a breaking change, I'd wait for you guys."
2188551323,6993,knqyf263,2024-06-25T10:28:58Z,Announced https://github.com/aquasecurity/trivy/discussions/7010
2222189080,6993,simar7,2024-07-11T07:04:06Z,"I didn't know but we seemed to have supported `TRIVY_RESET` as an environment variable to clean the cache in the past. This came up now because some users used to use this environment variable in their CI runs to clean the cache prior to running trivy-action. See [this](https://github.com/aquasecurity/trivy-action/issues/372) for an example.

It seems at some point, we have dropped support for this environment variable (and maybe other `TRIVY_*` envvars?) but I wasn't able to find that change. 

In any case, if we no longer support that environment variable, we have to implement a way in trivy-action to be able to support such a use case. Please correct me if I missed something."
2222264578,6993,knqyf263,2024-07-11T07:48:51Z,"`TRIVY_RESET` was removed, but envs for new flags are still supported.

```
$ TRIVY_ALL=true trivy clean
2024-07-11T11:47:57+04:00       INFO    Removing all caches...

$ TRIVY_SCAN_CACHE=true trivy clean
2024-07-11T11:48:32+04:00       INFO    Removing scan cache...
```"
2223120501,6993,simar7,2024-07-11T14:41:46Z,@knqyf263 OK looks like in that case we will need to add support for this in the action as currently I don't see anyway to clean the cache from the action.
2357801466,7526,afdesk,2024-09-18T08:14:04Z,"> > Trivy publishes a new Helm Chart only for major versions (ex 0.55.0).
> 
> I didn't find conditions for that.

This condition works only for major version, because `backport` branch usually doesn't contain a Helm Chart update.

https://github.com/aquasecurity/trivy/blob/aeb7039d7ce090e243d29f0bf16c9e4e24252a01/.github/workflows/publish-chart.yaml#L51-L52"
2360281590,7526,DmitriyLewen,2024-09-19T08:08:19Z,"> This condition works only for major version, because backport branch usually doesn't contain a Helm Chart update.

Oh... You said current behavior. I thought it was new logic.
then I have no questions about it"
2360300686,7526,DmitriyLewen,2024-09-19T08:17:20Z,"> a new PR: https://github.com/afdesk/trivy/pull/72

IIUC author of PR should be `aqua-bot` (as for backport (e.g. https://github.com/aquasecurity/trivy/pull/7521))

"
2360533230,7526,afdesk,2024-09-19T09:51:52Z,"> > a new PR: [afdesk#72](https://github.com/afdesk/trivy/pull/72)
> 
> IIUC author of PR should be `aqua-bot` (as for backport (e.g. #7521))

it seems it depends on token owner, because I tried to keep the same workflow:
https://github.com/aquasecurity/trivy/blob/5dd94ebc1ffe3f1df511dee6381f92a5daefadf2/.github/workflows/backport.yaml#L48-L58"
2360573892,7526,afdesk,2024-09-19T10:10:38Z,"I had concerns about `label` (`lifecycle/active`) and about `versions` (that chart version is equal trivy version now).

@itaysk @knqyf263 wdyt? thanks"
2360576340,7526,DmitriyLewen,2024-09-19T10:11:47Z,"> it seems it depends on token owner

you said this and I realized that most likely you are right and I have already encountered this 👍 "
2367297761,7526,knqyf263,2024-09-23T06:03:52Z,">label (lifecycle/active)

Do we need a label?

> about versions (that chart version is equal trivy version now).

They should be different; otherwise, we can't update the chart version when we fix the Helm chart itself."
2419494569,7526,afdesk,2024-10-17T13:04:54Z,"@knqyf263 @DmitriyLewen I've updated a version changing. 
Could you take a look at this PR again when you have time?
thanks a lot!"
2434369297,7526,afdesk,2024-10-24T06:00:03Z,@DmitriyLewen Could take another look at this PR? thank
1698598397,5062,juan131,2023-08-30T06:53:40Z,"@knqyf263 is there anyway I can for Trivy to use a local `trivy-db` that includes the `bitnami/vulndb` info?
```
2023-08-29T14:10:09.853+0200	INFO	DB Repository: ghcr.io/aquasecurity/trivy-db
2023-08-29T14:10:09.853+0200	INFO	Downloading DB...
39.00 MiB / 39.00 MiB [--------------------------------------------------------------------------------------] 100.00% 3.43 MiB p/s 12s
2023-08-29T14:10:23.096+0200	DEBUG	Updating database metadata...
2023-08-29T14:10:23.098+0200	DEBUG	DB Schema: 2, UpdatedAt: 2023-08-29 10:22:34.052452258 +0000 UTC, NextUpdate: 2023-08-29 16:22:34.052451658 +0000 UTC, DownloadedAt: 2023-08-29 12:10:23.097172 +0000 UTC
```"
1698604879,5062,knqyf263,2023-08-30T06:59:36Z,"There are two ways:

1. Use the local database
    - Build Trivy DB locally and move it to the cache directory (see the default value of `--cache-dir`)
    - Note that metadata.json must be located next to the database as Trivy tries to download the latest database if the last updated at is old
2. Use your own repository
    - Build Trivy DB and push it to your repository (e.g. ghcr.io/juan131/trivy-db)
    - Pass the repository with `--db-repository`"
1700451004,5062,juan131,2023-08-31T06:40:26Z,@knqyf263 I updated the PR including a more recent SPDX example for ElasticSearch
1701295236,5062,knqyf263,2023-08-31T15:48:30Z,"@juan131 It seems like the Bitnami database takes the affected versions from NVD, but we're seeing many mistakes in NVD.

For example, there is no fixed version for v1.13.x and v1.14.x in the Bitnami database.
https://github.com/bitnami/vulndb/blob/c75104a0d9649e32a458c69cbb71f2c782696ce8/data/envoy/BIT-2020-12603.json

NVD also doesn't have the fixed versions.
https://nvd.nist.gov/vuln/detail/CVE-2020-12603

However, the vulnerability should be fixed by 1.14.3 and 1.13.3.
https://github.com/envoyproxy/envoy/security/advisories/GHSA-pc38-4q6c-85p6
https://groups.google.com/g/envoy-announce/c/qrrF8klFl-I/m/nz12XtqmAAAJ?pli=1

Then, it leads to false positives. I'm sure users will open issues about the false positives in Trivy.

There are many examples.
https://github.com/bitnami/vulndb/blob/1ad3c6931ca5bfc4f3ed5c9321ec8facdb8ecc12/data/postgresql/BIT-2021-23214.json#L77-L84
https://github.com/bitnami/vulndb/blob/c75104a0d9649e32a458c69cbb71f2c782696ce8/data/prestashop/BIT-2023-39527.json#L45-L51

I don't think this problem blocks this PR. We can discuss how to improve that in `bitnami/vulndb` issues."
1702209376,5062,juan131,2023-09-01T05:59:29Z,"Thanks so much @knqyf263 ! I really appreciate your guidance during this whole process.

Is it too much to ask to open an issue (or a series of issues) at https://github.com/bitnami/vulndb/issues where we can discuss and address all these mistakes you observed? Otherwise, I can open them for you."
1702244800,5062,knqyf263,2023-09-01T06:38:31Z,">Is it too much to ask to open an issue (or a series of issues) at https://github.com/bitnami/vulndb/issues where we can discuss and address all these mistakes you observed? 

It is hard for us to review all advisories. I think we can categorize the problems. I'll open a first issue."
1702252785,5062,knqyf263,2023-09-01T06:46:39Z,"Done
https://github.com/bitnami/vulndb/issues/133"
494820661,50,DanCech,2019-05-22T14:12:45Z,"This seems like a neat idea, I'd like to see it support multiple comma-separated types and ideally the ability to specify the os family(ies) to control which vuln dbs are updated at startup as the vuln db update is the largest part of the time it takes to run a scan."
494889735,50,Mallear,2019-05-22T17:07:40Z,"Working on multiple comma-separated types.
Specific db updates will be managed by #43 "
494903039,50,Mallear,2019-05-22T17:52:55Z,Multiple comma-separated types is working.
495212612,50,DanCech,2019-05-23T13:13:13Z,Nice work @Mallear 👍 
495468046,50,knqyf263,2019-05-24T04:27:39Z,Thanks! I'm sorry for my late reply. I'll check it in a few days.
495623789,50,Mallear,2019-05-24T13:18:07Z,Rebased master into my dev branch to fix merge conflicts.
498658365,50,Mallear,2019-06-04T12:52:12Z,"Hi @knqyf263 , 
When can I expect this request to be merged ?  I would like to migrate quickly from Anchore to trivy but I need this feature 😄 "
498664765,50,knqyf263,2019-06-04T13:10:16Z,@Mallear I'm sorry for my late response. I'll test it tomorrow.
498671705,50,Mallear,2019-06-04T13:28:37Z,Thank you 😃 
499361555,50,Mallear,2019-06-06T06:07:33Z,"I agree with that. I have deleted language type filter and changed `packages` keyword for `library` as it is more accurate.
"
499372060,50,Mallear,2019-06-06T06:51:33Z,"I rebased master into my branch, it seems I messed with commit .."
499908935,50,knqyf263,2019-06-07T14:34:30Z,Thanks a lot!
516766804,50,knqyf263,2019-07-31T09:12:15Z,"@Mallear Thank you for contributing to Trivy. I have not prepared the Contribution License Agreement (CLA), but finally prepared it.

I would like you to sign CLA if possible. I apologize the inconvenience I have caused.
https://portal.helloworks.com/link/wvhTF78a4A9hICrm

If you have any questions, please let me know. Thanks again for your kind cooperation."
1909832162,5999,Maxim-Durand,2024-01-25T10:17:18Z,"> Please add the associated Issue link in the PR description.

But 

> Issues created by non-maintainers will be immediately closed.

> If maintainers decide to accept a new feature or confirm that it is a bug, they will close the discussion and create a [GitHub Issue](https://github.com/aquasecurity/trivy/issues) associated with that discussion.

So can a maintainer [checks out the discussion](https://github.com/aquasecurity/trivy/discussions/5998) and validate this is a bug/feature, then create the associated Issue so I can reference it in this PR ?"
1921326679,5999,RichardoC,2024-02-01T13:29:07Z,"This will be very handy, to give an example I do nightly scans of ""nightly"" containers, and the most recently release of my project [kube-audit-rest](https://github.com/RichardoC/kube-audit-rest)  and it's not possible to tell them apart which means I'm not sure if something's a regression or not

Given https://github.com/aquasecurity/trivy-action/issues/279#issuecomment-1917974964 I think it should also include the digest e.g. example.com/my-image:my-tag@sha256-fake-hash so that it's possible to tell which version of an image was scanned, as the image could have been retagged

Below is an example screenshot showing how it's not possible to tell them apart currently
![Screenshot 2024-02-01 at 13 27 26](https://github.com/aquasecurity/trivy/assets/11242848/f1479a6d-4749-4ea5-b64f-82b21cd1519b)
"
2048947517,6476,simar7,2024-04-11T05:23:25Z,We probably have to update these flags as well: https://github.com/aquasecurity/trivy/blob/main/pkg/flag/rego_flags.go#L10-L44
2063108311,6476,nikpivkin,2024-04-18T06:39:36Z,"@simar7 I opened [PR](https://github.com/aquasecurity/testdocker/pull/15) in `testodcker`.

@knqyf263 Can you take a look?"
2065552757,6476,simar7,2024-04-19T00:48:21Z,Note: tests are failing as [this](https://github.com/aquasecurity/testdocker/pull/15) will fix them.
2087757285,6476,simar7,2024-05-01T00:18:26Z,I'd like @nikpivkin to review once again when he's back. 
2098035478,6633,knqyf263,2024-05-07T10:37:37Z,@DmitriyLewen I've addressed your comments.
2098276169,6633,knqyf263,2024-05-07T12:19:24Z,Thanks!
2227731055,7160,nikpivkin,2024-07-15T05:36:18Z,"1. The checks bundle is distributed as an OCI artifacts and retrieved from the Artifact registry. Authentication methods are described [here](https://aquasecurity.github.io/trivy/v0.53/docs/advanced/private-registries/#credential).

"
2228459457,7160,itaysk,2024-07-15T13:04:46Z,"> The checks bundle is distributed as an OCI artifacts and retrieved from the Artifact registry. Authentication methods are described [here](https://aquasecurity.github.io/trivy/v0.53/docs/advanced/private-registries/#credential).

@nikpivkin , @knqyf263 just [said](https://github.com/aquasecurity/trivy/pull/7160#discussion_r1677319315) that the vuln DBs support only docker login, they don't support user/pass. is it the same for checks bundle as well? or checks bundle does support user/pass unlike vuln scanner?"
2228467747,7160,nikpivkin,2024-07-15T13:08:41Z,@itaysk supports login and password
2230124897,7160,itaysk,2024-07-16T06:32:03Z,@knqyf263 wdyt about removing the manual cache manipulation guide? it seems very internal and i think using the flag is better
2230128057,7160,knqyf263,2024-07-16T06:34:21Z,@itaysk We discussed it in https://github.com/aquasecurity/trivy/issues/7029 and agreed not to add flags.
2230129372,7160,knqyf263,2024-07-16T06:35:20Z,"Or do you mean we should force users to upload DB to their OCI registry? In any case, users need to manually download the DB and copy it to the environment running Trivy, so copying it under the cache directory is not a big problem."
2230373452,7160,itaysk,2024-07-16T08:55:52Z,"I meant the latter. not saying it's a big problem, just seems redundant and makeshift to me. ok i'll keep it, but then I want to confirm what is the procedure for misconfig checks (@simar7 @nikpivkin )?"
2230662106,7160,itaysk,2024-07-16T11:29:58Z,"Added another node about loading config from directory using `--config-check` flag. Also found many outdated references to this flag which I fixed in the same commit. FTR, also adding this to the list of inconsistencies (checks vs check) @simar7 can you please review"
2232391549,7160,simar7,2024-07-17T04:33:49Z,"> I meant the latter. not saying it's a big problem, just seems redundant and makeshift to me. ok i'll keep it, but then I want to confirm what is the procedure for misconfig checks (@simar7 @nikpivkin )?

The process would be the same as trivy-db, the users have to navigate Trivy's cache to place the checks in the right place in case of an air gap solution.

Maybe we should document this cache structure in more detail as a whole as it is a common place for all scanners?"
2273348660,7160,itaysk,2024-08-07T12:24:32Z,"@knqyf263 I've addressed vex hub in air gapped env, let me know if it's ok https://github.com/aquasecurity/trivy/pull/7160/commits/2327c5f4c56b28d8734362e6c47b1cbd91988d58"
2381313076,7605,knqyf263,2024-09-29T11:03:38Z,I'll review it tomorrow.
2399153321,7605,stewartcampbell,2024-10-08T08:10:40Z,"If I add a typo to the first URL, it fails to try the second. Is that expected?

```
trivy --version
Version: 0.56.1
```

```
trivy image alpine:3.19 --db-repository ""ghcrx.io/aquasecuridty/trivy-db:2"",""public.ecr.aws/aquasecurity/trivy-db:2"" --debug
2024-10-08T09:07:29+01:00       DEBUG   No plugins loaded
2024-10-08T09:07:29+01:00       DEBUG   Default config file ""file_path=trivy.yaml"" not found, using built in values
2024-10-08T09:07:29+01:00       DEBUG   Cache dir       dir=""/home/stewart/.cache/trivy""
2024-10-08T09:07:29+01:00       DEBUG   Cache dir       dir=""/home/stewart/.cache/trivy""
2024-10-08T09:07:30+01:00       DEBUG   Parsed severities       severities=[UNKNOWN LOW MEDIUM HIGH CRITICAL]
2024-10-08T09:07:30+01:00       DEBUG   Ignore statuses statuses=[]
2024-10-08T09:07:30+01:00       DEBUG   [vulndb] There is no valid metadata file        err=""unable to open a file: open /home/stewart/.cache/trivy/db/metadata.json: no such file or directory""
2024-10-08T09:07:30+01:00       INFO    [vulndb] Need to update DB
2024-10-08T09:07:30+01:00       DEBUG   [vulndb] No metadata file
2024-10-08T09:07:30+01:00       INFO    [vulndb] Downloading vulnerability DB...
2024-10-08T09:07:30+01:00       INFO    [vulndb] Downloading artifact...        repo=""ghcrx.io/aquasecuridty/trivy-db:2""
2024-10-08T09:07:30+01:00       FATAL   Fatal error
  - init error:
    github.com/aquasecurity/trivy/pkg/commands/artifact.Run
        /home/runner/work/trivy/trivy/pkg/commands/artifact/run.go:367
  - DB error:
    github.com/aquasecurity/trivy/pkg/commands/artifact.NewRunner
        /home/runner/work/trivy/trivy/pkg/commands/artifact/run.go:119
  - failed to download vulnerability DB:
    github.com/aquasecurity/trivy/pkg/commands/operation.DownloadDB
        /home/runner/work/trivy/trivy/pkg/commands/operation/operation.go:40
  - OCI artifact error:
    github.com/aquasecurity/trivy/pkg/db.(*Client).Download
        /home/runner/work/trivy/trivy/pkg/db/db.go:158
  - failed to download vulnerability DB:
    github.com/aquasecurity/trivy/pkg/db.(*Client).downloadDB
        /home/runner/work/trivy/trivy/pkg/db/db.go:207
  - failed to download artifact from ghcrx.io/aquasecuridty/trivy-db:2:
    github.com/aquasecurity/trivy/pkg/oci.Artifacts.Download
        /home/runner/work/trivy/trivy/pkg/oci/artifact.go:236
  - OCI repository error:
    github.com/aquasecurity/trivy/pkg/oci.(*Artifact).populate
        /home/runner/work/trivy/trivy/pkg/oci/artifact.go:96
  - 1 error occurred:
        * Get ""https://ghcrx.io/v2/"": dial tcp: lookup ghcrx.io on 10.255.255.254:53: no such host
```

```
trivy image alpine:3.19 --db-repository ghcrx.io/aquasecurity/trivy-db:2 --db-repository public.ecr.aws/aquasecurity/trivy-db:2 --debug
2024-10-08T09:10:02+01:00       DEBUG   No plugins loaded
2024-10-08T09:10:02+01:00       DEBUG   Default config file ""file_path=trivy.yaml"" not found, using built in values
2024-10-08T09:10:02+01:00       DEBUG   Cache dir       dir=""/home/stewart/.cache/trivy""
2024-10-08T09:10:02+01:00       DEBUG   Cache dir       dir=""/home/stewart/.cache/trivy""
2024-10-08T09:10:02+01:00       DEBUG   Parsed severities       severities=[UNKNOWN LOW MEDIUM HIGH CRITICAL]
2024-10-08T09:10:02+01:00       DEBUG   Ignore statuses statuses=[]
2024-10-08T09:10:02+01:00       DEBUG   [vulndb] There is no valid metadata file        err=""unable to open a file: open /home/stewart/.cache/trivy/db/metadata.json: no such file or directory""
2024-10-08T09:10:02+01:00       INFO    [vulndb] Need to update DB
2024-10-08T09:10:02+01:00       DEBUG   [vulndb] No metadata file
2024-10-08T09:10:02+01:00       INFO    [vulndb] Downloading vulnerability DB...
2024-10-08T09:10:02+01:00       INFO    [vulndb] Downloading artifact...        repo=""ghcrx.io/aquasecurity/trivy-db:2""
2024-10-08T09:10:02+01:00       FATAL   Fatal error
  - init error:
    github.com/aquasecurity/trivy/pkg/commands/artifact.Run
        /home/runner/work/trivy/trivy/pkg/commands/artifact/run.go:367
  - DB error:
    github.com/aquasecurity/trivy/pkg/commands/artifact.NewRunner
        /home/runner/work/trivy/trivy/pkg/commands/artifact/run.go:119
  - failed to download vulnerability DB:
    github.com/aquasecurity/trivy/pkg/commands/operation.DownloadDB
        /home/runner/work/trivy/trivy/pkg/commands/operation/operation.go:40
  - OCI artifact error:
    github.com/aquasecurity/trivy/pkg/db.(*Client).Download
        /home/runner/work/trivy/trivy/pkg/db/db.go:158
  - failed to download vulnerability DB:
    github.com/aquasecurity/trivy/pkg/db.(*Client).downloadDB
        /home/runner/work/trivy/trivy/pkg/db/db.go:207
  - failed to download artifact from ghcrx.io/aquasecurity/trivy-db:2:
    github.com/aquasecurity/trivy/pkg/oci.Artifacts.Download
        /home/runner/work/trivy/trivy/pkg/oci/artifact.go:236
  - OCI repository error:
    github.com/aquasecurity/trivy/pkg/oci.(*Artifact).populate
        /home/runner/work/trivy/trivy/pkg/oci/artifact.go:96
  - 1 error occurred:
        * Get ""https://ghcrx.io/v2/"": dial tcp: lookup ghcrx.io on 10.255.255.254:53: no such host
```"
2399252392,7605,DmitriyLewen,2024-10-08T08:52:16Z,"Hello @stewartcampbell 
This is expected behavior.
We only skip the repository for `429` and `5xx` errors - https://github.com/aquasecurity/trivy/pull/7605#discussion_r1780802178"
2399268040,7605,stewartcampbell,2024-10-08T08:58:58Z,"Thanks @DmitriyLewen 
"
816804438,935,CLAassistant,2021-04-09T16:32:48Z,[![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=935) <br/>All committers have signed the CLA.
819639044,935,eddynaka,2021-04-14T16:10:59Z,"@simar7 , can you review it, please?"
819642281,935,simar7,2021-04-14T16:15:42Z,I've assigned it to myself already. I will get to it soon. Thanks for your patience. 
1031772934,1638,afdesk,2022-02-07T18:18:14Z,we have to pull `main` branch to this PR.
1032262836,1638,DmitriyLewen,2022-02-08T06:41:01Z,Done
1087431108,1638,knqyf263,2022-04-04T11:19:36Z,@AndreyLevchenko @DmitriyLewen Any progress on reusable workflows?
1742011976,5285,CLAassistant,2023-10-01T08:57:01Z,[![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=5285) <br/>All committers have signed the CLA.
1774919483,5285,anfedotoff,2023-10-23T10:43:54Z,"@DmitriyLewen, sorry for too long, but I'm done with fixes. Please, have a look, if you have time:)."
1774922697,5285,DmitriyLewen,2023-10-23T10:45:59Z,"Good!
Resolve conflict, please."
1809612703,5285,DmitriyLewen,2023-11-14T06:21:51Z,@anfedotoff Can you take a look on test errors (windows tests are broken)?
1817058416,5285,anfedotoff,2023-11-17T20:28:17Z,"> @anfedotoff Can you take a look on test errors (windows tests are broken)?

Hmm, honestly, I don't understand why  this is happened. Maybe that test is flaky? Could you restart it, please?"
1818049501,5285,knqyf263,2023-11-20T00:52:42Z,">2023-11-14T06:17:47.684Z	WARN	Unable to parse ""member\\Cargo.toml"": file open error: stat member\Cargo.toml: invalid argument

I don't think it's flaky. It shows a file open error."
1909615156,5285,DmitriyLewen,2024-01-25T08:12:14Z,"@knqyf263 I fixed Windows tests and did some small refactoring for this PR.
Can you look it when you have time please."
2599268903,8254,CLAassistant,2025-01-17T21:46:45Z,[![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=8254) <br/>All committers have signed the CLA.
2614882110,8254,knqyf263,2025-01-27T05:33:33Z,Thanks for your contribution. [The next release](https://github.com/aquasecurity/trivy/milestone/42) is coming soon. We hope to add this feature in v0.60.0.
2646112720,8254,RingoDev,2025-02-09T07:51:39Z,"> Thanks for your contribution. [The next release](https://github.com/aquasecurity/trivy/milestone/42) is coming soon. We hope to add this feature in v0.60.0.

Sounds great, linting issues and co. should be gone by now 👍 "
2662599900,8254,RingoDev,2025-02-17T09:55:55Z,Any chance this still makes it into [0.60](https://github.com/aquasecurity/trivy/milestone/43) @nikpivkin @knqyf263?
2667395738,8254,knqyf263,2025-02-19T03:00:55Z,I'll take a look this week.
1510278436,4047,knqyf263,2023-04-16T10:31:17Z,"@DmitriyLewen I think we may want to replace [your PR](https://github.com/aquasecurity/trivy/pull/4015) with this approach. Can you take a look?

Also, I suggested as below.
https://github.com/aquasecurity/trivy/issues/3049#issuecomment-1506349642"
1516329579,4047,pmengelbert,2023-04-20T13:27:08Z,"> LGTM I added some comments.
> 
> Take a look, please.
> 
> Also i think we need add some information about this in docs - https://github.com/aquasecurity/trivy/blob/main/docs/docs/target/container_image.md#supported i mean default value, priority, etc...

I added some docs in `container_image.md`:
```diff
diff --git a/docs/docs/target/container_image.md b/docs/docs/target/container_image.md
index 7350a6a93..108c667a9 100644
--- a/docs/docs/target/container_image.md
+++ b/docs/docs/target/container_image.md
@@ -224,6 +224,23 @@ GitHub Personal Access Token
     You can see environment variables with `docker inspect`.
 
 ## Supported
+
+Trivy will look for the specified image in a series of locations. By default, it
+will first look in the local Docker Engine, then Containerd, Podman, and
+finally container registry.
+
+This behavior can be modified with the `--runtimes` flag. For example, the
+command
+
+```bash
+trivy image --runtimes podman,containerd alpine:3.7.3
+```
+
+Will first search in Podman. If the image is found there, it will be scanned
+and the results returned. If the image is not found in Podman, then Trivy will
+search in Containerd. If the image is not found there either, the scan will
+fail and no more runtimes will be searched.
+
 ### Docker Engine
 Trivy tries to looks for the specified image in your local Docker Engine.
 It will be skipped if Docker Engine is not running locally.
```"
1517235884,4047,DmitriyLewen,2023-04-21T04:18:39Z,Good work! Can you resolve conflicts?
1520228958,4047,pmengelbert,2023-04-24T14:07:22Z,"@DmitriyLewen Merge conflicts have been resolved, thanks!"
1521367615,4047,knqyf263,2023-04-25T08:18:18Z,"```
--runtimes strings Runtime(s) to use, in priority order (docker,containerd,podman,remote) (default [docker,containerd,podman,remote])
```

`remote` runtime sounds like a remote Docker daemon or other daemons. How about `--image-src`, `--image-from`, or something like that? `docker,containerd,podman,registry`."
1521915848,4047,pmengelbert,2023-04-25T14:44:17Z,"> ```
> --runtimes strings Runtime(s) to use, in priority order (docker,containerd,podman,remote) (default [docker,containerd,podman,remote])
> ```
> 
> `remote` runtime sounds like a remote Docker daemon or other daemons. How about `--image-src`, `--image-from`, or something like that? `docker,containerd,podman,registry`.

Renamed to `image-src`, and in the code things like `Runtime` have been renamed to `ImageSource`"
1529713945,4047,pmengelbert,2023-05-01T13:31:17Z,@knqyf263 Is there anything else that this PR needs to be accepted?
1534540234,4047,knqyf263,2023-05-04T10:49:16Z,@pmengelbert I'm back from vacation. We plan to take another look at this PR next week. Thanks for your patience.
2291113610,7340,CLAassistant,2024-08-15T11:34:18Z,[![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=7340) <br/>All committers have signed the CLA.
2291113614,7340,CLAassistant,2024-08-15T11:34:19Z,"[![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=7340) <br/>Thank you for your submission! We really appreciate it. Like many open source projects, we ask that you all sign our [Contributor License Agreement](https://cla-assistant.io/aquasecurity/trivy?pullRequest=7340) before we can accept your contribution.<br/>**1** out of **2** committers have signed the CLA.<br/><br/>:white_check_mark: afdesk<br/>:x: amf<br/><hr/>**amf** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account, please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/aquasecurity/trivy?pullRequest=7340) it.</sub>"
2292812826,7340,knqyf263,2024-08-16T05:03:12Z,"We should add a new test to ensure original BOM-Refs are kept as-is. In the existing test, the input is SBOM, but the output is Trivy JSON.
https://github.com/aquasecurity/trivy/blob/6a72dd47ae40c52bb27fc20c7f97e3c3c5168437/integration/sbom_test.go#L51-L59"
2295103497,7340,afdesk,2024-08-18T04:12:20Z,"> We should add a new test to ensure original BOM-Refs are kept as-is.

The testcase is added now. "
2316736497,7340,afdesk,2024-08-29T05:19:54Z,"Now Trivy builds new SBOM components from the result:

https://github.com/aquasecurity/trivy/blob/98e136eb7baa2b66f4233d96875c1490144e1594/pkg/sbom/io/encode.go#L260

to keep existing BOM-refs we should look for this one (if report.BOM != nil) by name and save it.
it matters for non-root and non-child components.

if we don't want to use this logic I can see 2 options:

1. we don't keep intermediate BOM-refs. because these ones are generated UUIDs.
Trivy still updates them for empty BOM-refs.

2. we don't encode a result into a new BOM report, and keep existing BOM.
just will add vuln fieldsL:
SBOM -> Trivy -> the same SBOM+ vulnerability list.

@knqyf263 @DmitriyLewen wdyt? thanks"
2316844229,7340,DmitriyLewen,2024-08-29T06:53:06Z,"> to keep existing BOM-refs we should look for this one (if report.BOM != nil) by name and save it.
it matters for non-root and non-child components.

I think we can try to use this way.
But we need to save `operating-system` here:
https://github.com/aquasecurity/trivy/blob/98e136eb7baa2b66f4233d96875c1490144e1594/pkg/sbom/io/decode.go#L120-L136

> we don't keep intermediate BOM-refs.

Do you mean BOMrefs for #2?
https://github.com/aquasecurity/trivy/blob/98e136eb7baa2b66f4233d96875c1490144e1594/pkg/sbom/io/encode.go#L160-L173

> we don't encode a result into a new BOM report, and keep existing BOM.
just will add vuln fieldsL:
SBOM -> Trivy -> the same SBOM+ vulnerability list.

I am not sure about this.
This will be work with Trivy reports, but we may see problem with SBOM files from other sources.


"
2316851799,7340,afdesk,2024-08-29T06:58:20Z,"> Do you mean BOMrefs for #2?

yes, for `Application component (/app/package-lock.json)`"
2320510005,7340,afdesk,2024-08-30T08:41:20Z,@DmitriyLewen could you take a look? thanks
2348511017,7340,knqyf263,2024-09-13T09:43:02Z,I have refactored. @DmitriyLewen @afdesk Can you please take a look?
2358136440,7340,knqyf263,2024-09-18T10:46:23Z,I reverted my changes. I'll open another PR.
1930005048,6072,CLAassistant,2024-02-06T15:12:06Z,[![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=6072) <br/>All committers have signed the CLA.
1930005055,6072,CLAassistant,2024-02-06T15:12:07Z,"[![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=6072) <br/>Thank you for your submission! We really appreciate it. Like many open source projects, we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/aquasecurity/trivy?pullRequest=6072) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/aquasecurity/trivy?pullRequest=6072) it.</sub>"
1931293973,6072,knqyf263,2024-02-07T05:08:04Z,Looks good. Can you please test it @DmitriyLewen?
1931441567,6072,bedla,2024-02-07T07:32:15Z,"Sure, I will take a look and make changes."
1954949997,6072,bedla,2024-02-20T19:52:10Z,"On my Maven test project I have generated `integration/testdata/fixtures/sbom/license-cyclonedx.json` file with command `trivy fs --format cyclonedx --output result.json C:\Users\bedla.czech\IdeaProjects\sbom-demo`.

Mind that golden file `integration/testdata/license-cyclonedx.json.golden` has all Licenses marked as `UNKNOWN`.
With deeper investigation I found out that it is because my Maven test project dependencies does not identify licenses using SPDX License ID.

I did more deeper investigation because Cyclone DX Maven plugin is identifying License ID at most cases correctly. What I found is that they use mapping file https://github.com/CycloneDX/cyclonedx-core-java/blob/master/src/main/resources/license-mapping.json to find those License IDs.

I think that new PR should be created to implement similar concept like they do. What do you think? "
1955804849,6072,DmitriyLewen,2024-02-21T03:20:01Z,"We already have mapping - https://github.com/aquasecurity/trivy/blob/82214736a943f61c173902808f2887a660543fe2/pkg/licensing/normalize.go#L8-L14.
But it looks like we need to supplement our map with pairs from `cycledx-core-java`."
1973558566,6072,christiankofler,2024-03-01T17:05:39Z,"This is really a great improvement! Just to be sure: will license scanning on SBOM also work for SPDX json with this PR? If not, this would be another great improvement for trivy."
1975754982,6072,DmitriyLewen,2024-03-04T05:23:19Z,@christiankofler It should work for [all supported SBOM formats](https://aquasecurity.github.io/trivy/v0.49/docs/target/sbom/)
1976141328,6072,knqyf263,2024-03-04T09:42:31Z,"@bedla Do you have time to wrap it up? If not, we can take care of this PR."
1976292973,6072,bedla,2024-03-04T10:46:16Z,"sorry, I was on vacations last week. I will finish it this week."
1987266027,6072,bedla,2024-03-10T15:17:08Z,"Hi, I have force pushed new changes to my branch (sorry for delay).
No thing to note is that it seems to https://github.com/CycloneDX/cyclonedx-core-java/blob/master/src/main/resources/license-mapping.json has more heuristic capabilities then Trivy has. So, I copied definition that I was sure that we can map to Trivy definition - other I left intact."
1988002554,6072,bedla,2024-03-11T09:47:21Z,"ahh, sorry ... will fix it asap. 
(note: it is hard to work with `mage` on windows, and also for some reason first compilation after some time is super-super slow => from time to time I am trying to find root causes on my local machine)"
1996596776,6072,bedla,2024-03-14T06:11:01Z,all the stuff should be fixed
1997219273,6072,bedla,2024-03-14T11:20:02Z,"hmm, interesting that test is not failing on my local machine ... will check it."
2001981323,6072,bedla,2024-03-16T13:03:56Z,"I have force pushed fixes, now it should be ok."
2003395851,6072,bedla,2024-03-18T09:56:46Z,"@DmitriyLewen you are welcome, I am happy to help :)"
2106650988,6674,knqyf263,2024-05-13T04:51:14Z,"@DmitriyLewen I'm still writing a developer guide, but the implementation has been completed. I would appreciate your quick feedback."
2106796937,6674,DmitriyLewen,2024-05-13T06:59:48Z,"1 more thought:
perhaps we want to add information that the plugin was installed successfully?

Currently:
```
➜  trivy git:(feat/plugin_index) ✗ ./trivy plugin install kubectl
2024/05/13 12:57:56 INFO Installing the plugin... prefix=""[plugin] "" src=github.com/aquasecurity/trivy-plugin-kubectl

```"
2107159167,6674,knqyf263,2024-05-13T10:03:26Z,">Also prefix log is broken:

Thanks. It worked at the beginning, and got broken after refactoring. Fixed in https://github.com/aquasecurity/trivy/pull/6674/commits/9dbecdfa41ecfc5868860d291c38664158cc80ba"
2107258687,6674,knqyf263,2024-05-13T10:52:24Z,">perhaps we want to add information that the plugin was installed successfully?

Done
https://github.com/aquasecurity/trivy/pull/6674/commits/466b9f5ea59b8fdeffe4ab2c2cabb0f4f22aaf79"
2107259833,6674,knqyf263,2024-05-13T10:52:58Z,@DmitriyLewen I've addressed your comments and completed the developer guide. This PR is now ready for review.
2562434305,8178,nikpivkin,2024-12-26T10:51:57Z,@knqyf263 I was thinking that we could download the compressed layer and then decompress it ourselves. I saw that [downloader.Download](https://github.com/aquasecurity/trivy/blob/main/pkg/downloader/download.go#L56) is used for decompression. Does it support all the compression types that `go-containerregistry` does?
2562506777,8178,knqyf263,2024-12-26T11:28:38Z,"This is what was in my mind.

```
	layer, err := a.image.LayerByDiffID(h)
	if err != nil {...}

	rc, err := layer.Uncompressed()
	if err != nil {...}

	f, err := os.Open(diffID + "".tar"")
	if err != nil{...}

	io.Copy(f, rc)
```"
2562510998,8178,nikpivkin,2024-12-26T11:30:36Z,"@knqyf263 Then we can't display the progress bar correctly, because we don't know the size of the uncompressed layer."
2562521036,8178,knqyf263,2024-12-26T11:35:19Z,"Can't we use the progress in ggcr?
https://github.com/google/go-containerregistry/blob/6bce25ecf0297c1aa9072bc665b5cf58d53e1c54/pkg/v1/remote/progress.go#L25"
2562525487,8178,knqyf263,2024-12-26T11:37:43Z,"If it doesn't work, we can use `layer.Compressed`, inject the progress bar and re-implement uncompressed logic.
https://github.com/google/go-containerregistry/blob/6bce25ecf0297c1aa9072bc665b5cf58d53e1c54/pkg/v1/partial/compressed.go#L50-L78"
2562983178,8178,nikpivkin,2024-12-26T17:45:05Z,"@knqyf263 I kept the old behavior, if no flag is passed, to avoid unnecessary disk operations. But then the progress bar will be displayed only when the flag is passed. What do you think?"
2563379865,8178,knqyf263,2024-12-27T06:43:08Z,"@nikpivkin I got an idea.
https://go.dev/play/p/fY8jM99don_r"
2563381726,8178,knqyf263,2024-12-27T06:45:45Z,"This might be better.

```
// ProgressLayer wraps a v1.Layer to add progress bar functionality
type ProgressLayer struct {
	v1.Layer
}

func NewProgressLayer(layer v1.Layer) *ProgressLayer {
	return &ProgressLayer{ Layer: layer, }
}

func (l *ProgressLayer) Compressed() (io.ReadCloser, error) {
	size, err := l.Layer.Size()
	if err != nil {
		return nil, err
	}

	rc, err := l.Layer.Compressed()
	if err != nil {
		return nil, err
	}

	bar := pb.Full.Start64(size)
	bar.Set(pb.Bytes, true)

	return bar.NewProxyReader(rc), nil
}
```"
2563382997,8178,knqyf263,2024-12-27T06:47:39Z,"Even better

```
// progressLayer wraps a v1.Layer to add progress bar functionality
type progressLayer struct {
	v1.Layer
}

func (l *progressLayer) Compressed() (io.ReadCloser, error) {
	rc, err := l.Layer.Compressed()
	if err != nil {
		return nil, err
	}

	size, err := l.Layer.Size()
	if err != nil {
		return nil, err
	}

	bar := pb.Full.Start64(size)
	bar.Set(pb.Bytes, true)

	return bar.NewProxyReader(rc), nil
}

func NewProgressLayer(layer v1.Layer) (v1.Layer, error) {
	return partial.CompressedToLayer(&progressLayer{ Layer: layer})
}
```"
2563383820,8178,nikpivkin,2024-12-27T06:49:01Z,"@knqyf263 Ok, I'll think about how to use this with the progress bar pool otherwise there is flickering in the terminal when loading in parallel"
2563386680,8178,knqyf263,2024-12-27T06:52:55Z,"@nikpivkin Actually, the progress bar should be discussed in https://github.com/aquasecurity/trivy/pull/8186. I'll re-post it there."
2572831472,8178,knqyf263,2025-01-06T10:36:12Z,"BTW, Trivy also supports VM images. I'm unsure, but users may want to introduce the same functionality in the future. Do you think we want to rename `--max-image-size` to `--max-target-size` or something like that? Our VM scanning also targets VM ""images"". `--max-image-size` may be fine."
2579276767,8178,DmitriyLewen,2025-01-09T06:34:53Z,"I think that `--max-target-size` will confuse users, because they will try to use this flag in `fs` mode.

I think `--max-image-size` is good name.

Also i suggest to add this flag for VM scan in another PR."
2597585419,8178,knqyf263,2025-01-17T07:16:54Z,"I performed a quick test on Azure, which has a stable network. The current approach (without `--max-image-size`) seems faster. I'm sure we'll get different results depending on the environment, though.
https://gist.github.com/knqyf263/e0e4fa5bd1359fd9e68408f3c5244f1a?permalink_comment_id=5393170#gistcomment-5393170"
2606363007,8178,knqyf263,2025-01-22T05:57:59Z,"Once we update the document, we will merge this PR as it's experimental. We can change the behavior later."
1217982909,2589,knqyf263,2022-08-17T13:03:42Z,@chen-keinan Can you please review it?
1218031520,2589,josedonizetti,2022-08-17T13:45:18Z,"@knqyf263 @chen-keinan I'm changing it currently, will be ready for review soon. "
1231234307,2589,CLAassistant,2022-08-30T07:02:28Z,[![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=2589) <br/>All committers have signed the CLA.
1231234321,2589,CLAassistant,2022-08-30T07:02:30Z,"[![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=2589) <br/>Thank you for your submission! We really appreciate it. Like many open source projects, we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/aquasecurity/trivy?pullRequest=2589) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/aquasecurity/trivy?pullRequest=2589) it.</sub>"
1231275326,2589,josedonizetti,2022-08-30T07:44:16Z,@chen-keinan can you review it? pls
1232629012,2589,chen-keinan,2022-08-31T08:28:34Z,@josedonizetti Look Good! added few comments
1234454108,2589,chen-keinan,2022-09-01T15:38:14Z,"@josedonizetti could you please relate issue to it.

- when running this (scan cluster for vuln only) command `trivy k8s --security-checks vuln --report summary cluster` 
I get no result.
```164 / 164 [----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------] 100.00% 781 p/s```
however when running the full cluster command I get complete result : ` k8s  --report summary cluster`
```
Summary Report for rancher-desktop
┌──────────────┬───────────────────────────────────┬──────────────────────────────┬────────────────────┬───────────────────┐
│  Namespace   │             Resource              │       Vulnerabilities        │ Misconfigurations  │      Secrets      │
│              │                                   ├─────┬──────┬──────┬─────┬────┼───┬───┬───┬────┬───┼───┬───┬───┬───┬───┤
│              │                                   │  C  │  H   │  M   │  L  │ U  │ C │ H │ M │ L  │ U │ C │ H │ M │ L │ U │
├──────────────┼───────────────────────────────────┼─────┼──────┼──────┼─────┼────┼───┼───┼───┼────┼───┼───┼───┼───┼───┼───┤
│ trivy-system │ Job/scan-vulnerabilityreport      │     │      │  1   │ 1   │ 2  │   │   │ 3 │ 4  │   │   │   │   │   │   │
│ profefe      │ Deployment/profefe                │  4  │  29  │  10  │ 2   │    │   │   │ 2 │ 10 │   │   │   │   │   │   │
│ kube-system  │ Deployment/metrics-server         │     │      │      │     │ 6  │   │   │ 3 │ 10 │   │   │   │   │   │   │
│ kube-system  │ Service/metrics-server            │     │      │      │     │    │   │   │ 1 │    │   │   │   │   │   │   │
│ kube-system  │ Deployment/coredns                │     │  7   │  6   │ 1   │ 5  │   │   │ 3 │ 5  │   │   │   │   │   │   │
│ kube-system  │ Deployment/local-path-provisioner │  4  │  32  │  10  │ 2   │    │   │   │ 3 │ 10 │   │   │   │   │   │   │
│ kube-system  │ Service/kube-dns                  │     │      │      │     │    │   │   │ 1 │    │   │   │   │   │   │   │
│ default      │ ReplicaSet/frontend               │ 565 │ 1372 │ 1157 │ 894 │ 64 │   │   │ 2 │ 10 │   │   │   │   │   │   │
│ default      │ Job/pi                            │ 61  │ 434  │ 368  │ 566 │ 4  │   │   │ 2 │ 10 │   │   │   │   │   │   │
└──────────────┴───────────────────────────────────┴─────┴──────┴──────┴─────┴────┴───┴───┴───┴────┴───┴───┴───┴───┴───┴───┘
```"
1236020234,2589,josedonizetti,2022-09-03T01:31:13Z,"@chen-keinan Can you give it another try? I increased the report test coverage from 33% to 79%, which caught a few bugs including the one you mentioned above. "
1236278704,2589,chen-keinan,2022-09-04T07:30:00Z,"LGTM 🚀 I would check if needed to update some documentation , [example](https://aquasecurity.github.io/trivy/v0.31.3/docs/misconfiguration/policy/builtin/) 
"
1250178008,2589,josedonizetti,2022-09-18T02:33:28Z,"@chen-keinan @knqyf263 can you review? Did the change to support `--components`. If you agree with the design/code I'll add documentation next (maybe in a follow up PR), just to be sure this is what we want before going deeper."
1270480735,2589,josedonizetti,2022-10-06T18:02:46Z,@chen-keinan @knqyf263 I really would like this to land on the next release. Let me know if anything is missing for the review.
1274248694,2589,chen-keinan,2022-10-11T07:54:00Z,"@josedonizetti looks good 🚀  , there is something strange experience wise when we run filter by workload we still get rbac results :
```
trivy k8s all --namespace=kube-system  --report=summary --components=workload
34 / 34 [--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------] 100.00% 2 p/s

Summary Report for minikube
┌─────────────┬──────────────────────────────────────┬─────────────────────┬────────────────────┬───────────────────┐
│  Namespace  │               Resource               │   Vulnerabilities   │ Misconfigurations  │      Secrets      │
│             │                                      ├───┬────┬───┬────┬───┼───┬───┬───┬────┬───┼───┬───┬───┬───┬───┤
│             │                                      │ C │ H  │ M │ L  │ U │ C │ H │ M │ L  │ U │ C │ H │ M │ L │ U │
├─────────────┼──────────────────────────────────────┼───┼────┼───┼────┼───┼───┼───┼───┼────┼───┼───┼───┼───┼───┼───┤
│ kube-system │ Pod/etcd-minikube                    │   │ 16 │ 4 │    │ 4 │   │ 1 │ 3 │ 7  │   │   │   │   │   │   │
│ kube-system │ Pod/kube-apiserver-minikube          │   │    │   │    │   │   │ 1 │ 3 │ 9  │   │   │   │   │   │   │
│ kube-system │ Pod/kube-scheduler-minikube          │   │    │   │    │   │   │ 1 │ 3 │ 8  │   │   │   │   │   │   │
│ kube-system │ Deployment/coredns                   │   │ 6  │ 2 │ 1  │ 5 │   │   │ 3 │ 5  │   │   │   │   │   │   │
│ kube-system │ DaemonSet/kube-proxy                 │ 7 │ 11 │ 3 │ 56 │   │   │ 2 │ 4 │ 10 │   │   │   │   │   │   │
│ kube-system │ Service/kube-dns                     │   │    │   │    │   │   │   │ 1 │    │   │   │   │   │   │   │
│ kube-system │ Pod/kube-controller-manager-minikube │   │    │   │    │   │   │ 1 │ 3 │ 8  │   │   │   │   │   │   │
│ kube-system │ Pod/storage-provisioner              │   │ 8  │ 2 │    │ 3 │   │ 1 │ 5 │ 10 │   │   │   │   │   │   │
└─────────────┴──────────────────────────────────────┴───┴────┴───┴────┴───┴───┴───┴───┴────┴───┴───┴───┴───┴───┴───┘
Severities: C=CRITICAL H=HIGH M=MEDIUM L=LOW U=UNKNOWN


Summary Report for minikube
┌─────────────┬─────────────────────────────────────────────────────┬───────────────────┐
│  Namespace  │                      Resource                       │  RBAC Assessment  │
│             │                                                     ├───┬───┬───┬───┬───┤
│             │                                                     │ C │ H │ M │ L │ U │
├─────────────┼─────────────────────────────────────────────────────┼───┼───┼───┼───┼───┤
│ kube-system │ Role/system::leader-locking-kube-scheduler          │   │   │ 1 │   │   │
│ kube-system │ Role/system:controller:cloud-provider               │   │   │ 1 │   │   │
│ kube-system │ Role/system:controller:bootstrap-signer             │ 1 │   │   │   │   │
│ kube-system │ Role/system:persistent-volume-provisioner           │   │ 2 │   │   │   │
│ kube-system │ Role/system::leader-locking-kube-controller-manager │   │   │ 1 │   │   │
│ kube-system │ Role/system:controller:token-cleaner                │ 1 │   │   │   │   │
└─────────────┴─────────────────────────────────────────────────────┴───┴───┴───┴───┴───┘
Severities: C=CRITICAL H=HIGH M=MEDIUM L=LOW U=UNKNOWN
```"
1274250989,2589,chen-keinan,2022-10-11T07:55:44Z,"is the `--components=infra / --components=workload` is not supported on specific resource scan ? 
 ```trivy k8s Pod/kube-apiserver-minikube  --namespace=kube-system   --components=infra```

result : 

` ... 	FATAL	unknown flag: --components`
 "
1285903341,2589,josedonizetti,2022-10-20T17:24:18Z,"> is the `--components=infra / --components=workload` is not supported on specific resource scan ? `trivy k8s Pod/kube-apiserver-minikube --namespace=kube-system --components=infra`
> 
> result :
> 
> ` ... FATAL unknown flag: --components`

@chen-keinan are you sure you had this branch compiled when you executed this command? Because it is saying the flag doesn't exist, but the flag is global for `trivy k8s`. Testing locally now, I see:

```
./trivy k8s -n kube-system --components=workload pod/kube-apiserver-minikube | grep See
1 / 1 [------------------------------------------------------------------------------------------------------------------------------------------------] 100.00% 0 p/s
See https://avd.aquasec.com/misconfig/ksv0012
See https://avd.aquasec.com/misconfig/ksv001
See https://avd.aquasec.com/misconfig/ksv003
See https://avd.aquasec.com/misconfig/ksv009
See https://avd.aquasec.com/misconfig/ksv011
See https://avd.aquasec.com/misconfig/ksv012
See https://avd.aquasec.com/misconfig/ksv014
See https://avd.aquasec.com/misconfig/ksv016
See https://avd.aquasec.com/misconfig/ksv018
See https://avd.aquasec.com/misconfig/ksv020
See https://avd.aquasec.com/misconfig/ksv021
See https://avd.aquasec.com/misconfig/ksv023
See https://avd.aquasec.com/misconfig/ksv106
```

```
trivy k8s -n kube-system --components=infra pod/kube-apiserver-minikube | grep See
1 / 1 [------------------------------------------------------------------------------------------------------------------------------------------------] 100.00% 0 p/s
See https://avd.aquasec.com/misconfig/kcv0001
See https://avd.aquasec.com/misconfig/kcv0006
See https://avd.aquasec.com/misconfig/kcv0010
See https://avd.aquasec.com/misconfig/kcv0013
See https://avd.aquasec.com/misconfig/kcv0018
See https://avd.aquasec.com/misconfig/kcv0019
See https://avd.aquasec.com/misconfig/kcv0020
See https://avd.aquasec.com/misconfig/kcv0021
See https://avd.aquasec.com/misconfig/kcv0022
See https://avd.aquasec.com/misconfig/kcv0028
See https://avd.aquasec.com/misconfig/kcv0029
```"
1285905286,2589,chen-keinan,2022-10-20T17:26:11Z,"Yes , I did run all tests on your branch , but I can check again"
1285906824,2589,josedonizetti,2022-10-20T17:27:42Z,"> @josedonizetti looks good rocket , there is something strange experience wise when we run filter by workload we still get rbac results :

I thought this was the idea. I'm treating `workload` as everything that is not `infra`, as `rbac` isn't infra, it returns on the scanning. Should it be different? "
1285934737,2589,chen-keinan,2022-10-20T17:54:13Z,"> > @josedonizetti looks good rocket , there is something strange experience wise when we run filter by workload we still get rbac results :
> 
> I thought this was the idea. I'm treating `workload` as everything that is not `infra`, as `rbac` isn't infra, it returns on the scanning. Should it be different? 

Yes ,in a way , but it could be confusing.
Anyway it should not hold the pr , we can discuss it later"
1285938928,2589,chen-keinan,2022-10-20T17:58:11Z,LGTM 🚀  well done !!
1285944328,2589,josedonizetti,2022-10-20T18:03:32Z,"Follow up issues:

- https://github.com/aquasecurity/trivy/issues/3056"
1288133046,2589,josedonizetti,2022-10-23T15:03:37Z,"> Just to clarify my understanding, it filters out the misconfiguration results by AVD-ID when the resource is `Pod` under `kube-system` so it can know infra components, right?

Exactly!"
1288133934,2589,knqyf263,2022-10-23T15:07:35Z,"I feel like we may want to show what results each table is displaying. It currently says `Summary Report for minikube` for all the tables, and I didn't understand how those tables are different at first.

For example,

```
Summary Report for minikube
===========================

Workload Assessment
[table]

RBAC Assessment
[table]

Infra Assessment
[table]
```"
1288139918,2589,josedonizetti,2022-10-23T15:39:02Z,"```
Summary Report for minikube

Workload Assessment
┌─────────────┬──────────────────────────────────────┬─────────────────────┬────────────────────┬───────────────────┐
│  Namespace  │               Resource               │   Vulnerabilities   │ Misconfigurations  │      Secrets      │
│             │                                      ├───┬────┬───┬────┬───┼───┬───┬───┬────┬───┼───┬───┬───┬───┬───┤
│             │                                      │ C │ H  │ M │ L  │ U │ C │ H │ M │ L  │ U │ C │ H │ M │ L │ U │
├─────────────┼──────────────────────────────────────┼───┼────┼───┼────┼───┼───┼───┼───┼────┼───┼───┼───┼───┼───┼───┤
│ kube-system │ Service/kube-dns                     │   │    │   │    │   │   │   │ 1 │    │   │   │   │   │   │   │
│ kube-system │ Pod/etcd-minikube                    │   │ 20 │ 4 │    │ 4 │   │ 1 │ 3 │ 7  │   │   │   │   │   │   │
│ kube-system │ Pod/kube-apiserver-minikube          │   │ 2  │ 1 │ 1  │ 2 │   │ 1 │ 3 │ 9  │   │   │   │   │   │   │
│ kube-system │ Pod/kube-scheduler-minikube          │   │ 2  │   │    │   │   │ 1 │ 3 │ 8  │   │   │   │   │   │   │
│ kube-system │ Pod/storage-provisioner              │   │ 9  │ 2 │    │ 3 │   │ 1 │ 5 │ 10 │   │   │   │   │   │   │
│ kube-system │ DaemonSet/kube-proxy                 │   │ 3  │ 2 │ 22 │   │   │ 2 │ 4 │ 10 │   │   │   │   │   │   │
│ kube-system │ Deployment/coredns                   │ 1 │ 3  │ 1 │ 1  │ 4 │   │   │ 3 │ 5  │   │   │   │   │   │   │
│ kube-system │ Pod/kube-controller-manager-minikube │   │ 2  │ 1 │ 1  │ 2 │   │ 1 │ 3 │ 8  │   │   │   │   │   │   │
└─────────────┴──────────────────────────────────────┴───┴────┴───┴────┴───┴───┴───┴───┴────┴───┴───┴───┴───┴───┴───┘
Severities: C=CRITICAL H=HIGH M=MEDIUM L=LOW U=UNKNOWN


RBAC Assessment
┌─────────────┬─────────────────────────────────────────────────────┬───────────────────┐
│  Namespace  │                      Resource                       │  RBAC Assessment  │
│             │                                                     ├───┬───┬───┬───┬───┤
│             │                                                     │ C │ H │ M │ L │ U │
├─────────────┼─────────────────────────────────────────────────────┼───┼───┼───┼───┼───┤
│ kube-system │ Role/system:controller:bootstrap-signer             │ 1 │   │   │   │   │
│ kube-system │ Role/system:controller:cloud-provider               │   │   │ 1 │   │   │
│ kube-system │ Role/system:controller:token-cleaner                │ 1 │   │   │   │   │
│ kube-system │ Role/system::leader-locking-kube-scheduler          │   │   │ 1 │   │   │
│ kube-system │ Role/system::leader-locking-kube-controller-manager │   │   │ 1 │   │   │
│ kube-system │ Role/system:persistent-volume-provisioner           │   │ 2 │   │   │   │
└─────────────┴─────────────────────────────────────────────────────┴───┴───┴───┴───┴───┘
Severities: C=CRITICAL H=HIGH M=MEDIUM L=LOW U=UNKNOWN


Infra Assessment
┌─────────────┬──────────────────────────────────────┬─────────────────────────────┐
│  Namespace  │               Resource               │ Kubernetes Infra Assessment │
│             │                                      ├────┬────┬────┬─────┬────────┤
│             │                                      │ C  │ H  │ M  │ L   │   U    │
├─────────────┼──────────────────────────────────────┼────┼────┼────┼─────┼────────┤
│ kube-system │ Pod/kube-controller-manager-minikube │    │    │    │ 3   │        │
│ kube-system │ Pod/kube-scheduler-minikube          │    │    │    │ 1   │        │
│ kube-system │ Pod/kube-apiserver-minikube          │    │    │ 1  │ 10  │        │
└─────────────┴──────────────────────────────────────┴────┴────┴────┴─────┴────────┘
Severities: C=CRITICAL H=HIGH M=MEDIUM L=LOW U=UNKNOWN

```"
1288158871,2589,knqyf263,2022-10-23T17:22:55Z,@josedonizetti The test is failing now.
1196775423,2607,CLAassistant,2022-07-27T13:38:20Z,[![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=2607) <br/>All committers have signed the CLA.
1196775449,2607,CLAassistant,2022-07-27T13:38:21Z,"[![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=2607) <br/>Thank you for your submission! We really appreciate it. Like many open source projects, we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/aquasecurity/trivy?pullRequest=2607) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/aquasecurity/trivy?pullRequest=2607) it.</sub>"
1196802332,2607,knqyf263,2022-07-27T14:01:24Z,"Hmm. We fixed it before.
https://github.com/aquasecurity/trivy/pull/2422

@DmitriyLewen Could you look into what causes?"
1196820711,2607,Moulick,2022-07-27T14:16:38Z,"My first thought was to add an if-else like 
```go 
ver := fmt.Sprintf(""v%s"", opt.AppVersion)
if opt.AppVersion == ""dev"" {
  ver = opt.AppVersion
  }
```
 which is like essentially reverting https://github.com/aquasecurity/trivy/pull/2422

There are three sources of the version I see
1. If you simply do `go build ./cmd/trivy`, It defaults to dev. This produces a correct URL for dev.
2. If you do `make build`, make take the version from `VERSION := $(shell git describe --tags --always)`, but this also creates an incorrect URL as this returns eg `v0.30.4-3-g4be15455`
3. If the build is produced by goreleaser, it strips the `v` and hence URL is broken

Currently, I have fixed it for goreleaser, I can also fix it for makefile "
1197657013,2607,DmitriyLewen,2022-07-28T04:48:22Z,"Hello @knqyf263 
we have 2 cases:
1) binaries built with `goreleaser` don't have `v` prefix:
```
➜  29.1 ./trivy -v
Version: 0.29.1
```
2) binaries built with `make build` have `v` prefix(looks like in [#2422](https://github.com/aquasecurity/trivy/pull/2422) used this case):
```
➜  git checkout v0.29.1
Note: switching to 'v0.29.1'.
...
➜  make build
go build -ldflags ""-s -w -X=main.version=v0.29.1"" ./cmd/trivy
➜  ./trivy -v
Version: v0.29.1
```

I think we need to create same logic for both cases:
add `v` prefix to `goreleaser` (as @Moulick did) or remove `v` prefix from Makefile and return this logic:
```
ver := fmt.Sprintf(""v%s"", opt.AppVersion)
if opt.AppVersion == ""dev"" {
  ver = opt.AppVersion
  }
```

I think logic of this PR better.

UPD.
I built image with goreleaser. Version number has `v` prefix.
```
➜  ./trivy -v
Version: v0.30.4-SNAPSHOT-4be15455
```"
1197765010,2607,knqyf263,2022-07-28T07:23:10Z,"> Version: v0.29.1

It's no big deal, but it looks weird to me. `v` means `version`,so it is like `Version: version 0.29.1`.

What if we remove `v` here?
https://github.com/aquasecurity/trivy/blob/c2a7ad5c014e3e1861b8bf79b6ef321573cb8983/Makefile#L1"
1197776244,2607,knqyf263,2022-07-28T07:35:21Z,"And add `v` of course.

>add v prefix to goreleaser (as @Moulick did) or remove v prefix from Makefile and return this logic:

"
1199002286,2607,Moulick,2022-07-29T08:12:54Z,"> > Version: v0.29.1
> 
> It's no big deal, but it looks weird to me. `v` means `version`,so it is like `Version: version 0.29.1`.
> 
> What if we remove `v` here?
> 
> https://github.com/aquasecurity/trivy/blob/c2a7ad5c014e3e1861b8bf79b6ef321573cb8983/Makefile#L1

Yes, doable. The documentation links will need to be updated to remove the `v` as well. "
1200361599,2607,knqyf263,2022-07-31T06:49:37Z,"@Moulick Could you fix it as below?

1. Remove `v` here.
https://github.com/aquasecurity/trivy/blob/c2a7ad5c014e3e1861b8bf79b6ef321573cb8983/Makefile#L1

2. Add `v` here as Dmitriy suggested, considering `dev`.
https://github.com/aquasecurity/trivy/blob/e393ce1477901ea566b43ccd2d29a239c1a4c7e8/pkg/commands/artifact/run.go#L471"
1200487620,2607,Moulick,2022-07-31T19:45:24Z,Should work as expected now.
1215001307,2607,knqyf263,2022-08-15T13:16:20Z,@Moulick Thanks for your great contribution and patience!
1215011636,2607,Moulick,2022-08-15T13:24:37Z,@knqyf263 I'd be curious about the comment I added above 🤔.
1215033846,2607,knqyf263,2022-08-15T13:47:35Z,Which comment?
1215039526,2607,Moulick,2022-08-15T13:52:59Z,"I had added a review comment, I suppose GitHub did not send a notification. Attached a screenshot in case it's not visible for some reason 😅
<img width=""1157"" alt=""image"" src=""https://user-images.githubusercontent.com/15780903/184648164-e8bddc0b-bfe6-4c71-aba6-7b76706bf053.png"">
"
1215052778,2607,knqyf263,2022-08-15T14:05:38Z,"`aquasecurity/go-version` is already used directly, while hashicorp/go-version is an indirect dependency. Also, we can easily modify that library as it is maintained by us."
1586308104,4557,chen-keinan,2023-06-11T19:27:48Z,"@itaysk review the `core component` properties, the above example is updated following to code changes"
1592445939,4557,chen-keinan,2023-06-15T06:32:22Z,@knqyf263 comments has been addressed
1596723833,4557,knqyf263,2023-06-19T08:15:24Z,"The database is downloaded with KBOM. Is it intended?

```
$ trivy k8s cluster --format cyclonedx
2023-06-19T11:14:06.338+0300    INFO    Loaded trivy.yaml
2023-06-19T11:14:06.460+0300    INFO    Need to update DB
2023-06-19T11:14:06.460+0300    INFO    DB Repository: ghcr.io/aquasecurity/trivy-db
2023-06-19T11:14:06.460+0300    INFO    Downloading DB...
13.66 MiB / 37.76 MiB [----------------------------->____________________________________________________] 36.16% 552.13 KiB p/s ETA 44s
```"
1596728763,4557,knqyf263,2023-06-19T08:18:49Z,">""name"": ""aquasecurity:trivy:control_plane_components"",

Can we use the upper camel case (a.k.a pascal case) to get aligned with other properties?

>""name"": ""aquasecurity:trivy:PkgID"","
2260587409,7261,afdesk,2024-07-31T13:55:21Z,"@DmitriyLewen I think it's finally ready for review. Could you take a look when you have free time? thanks
"
2261893173,7261,afdesk,2024-08-01T03:31:02Z,there is an idea. I'll refactor it 
2262277508,7261,afdesk,2024-08-01T07:47:06Z,"@DmitriyLewen 
my idea was wrong, so I've done some refactor and it's ready for review."
2262974626,7261,afdesk,2024-08-01T12:57:13Z,@DmitriyLewen your solution is moved here. PTAL )
2401192962,7679,knqyf263,2024-10-09T03:24:24Z,"We should document how to authenticate with ECR. Otherwise, ECR Public has only 500 GB free tier for anonymous users. Also, it's calculated by IP address. I suppose we'll run out of the free tier on CI service as it shares IP addresses."
2401212854,7679,DmitriyLewen,2024-10-09T03:49:24Z,"I'm worried about adding `ecr` as the default registry.
I think most users will ignore the authentication recommendation, and some users just don't read the docs.

Instead of adding `ecr` - I suggest adding warning if downloading db from `ghcr` returns error.
We will show information about using `ecr` (with authentication information) + link to the docs."
2403464594,7679,nvuillam,2024-10-09T21:31:01Z,We read the docs but... having to authenticate to aws would be a breaking change 🥹
2403961270,7679,DmitriyLewen,2024-10-10T04:30:42Z,"hello @nvuillam 
Authentication is necessary to preserve aws limits for unauthenticated users as much as possible.
But we don't require it. We just ask users to do it if possible - it will help avoid rate limiting errors like ghcr.io."
2404119866,7679,simar7,2024-10-10T06:10:58Z,"> We should document how to authenticate with ECR. Otherwise, ECR Public has only 500 GB free tier for anonymous users. Also, it's calculated by IP address. I suppose we'll run out of the free tier on CI service as it shares IP addresses.

Yes - I wanted to add more info on this topic. Added https://github.com/aquasecurity/trivy/pull/7679/commits/fa031898ebd2d39009e6bace47b288595793a6d7"
2404376752,7679,knqyf263,2024-10-10T08:06:07Z,">We will show information about using ecr (with authentication information) + link to the docs.

I'm also leaning toward this approach. I'm afraid that users downloading container images from ECR Public (e.g., Kubernetes cluster) may suddenly reach rate limits due to Trivy DB and be unable to deploy, etc.

Of course, it is best if users can continue to use DBs as before without being aware of it, but the implicit use of ECR Public may have other negative effects. We should be careful about the use of ECR Public. If users explicitly set this up, they will understand these trade-offs."
2418497252,7679,simar7,2024-10-17T04:55:24Z,"> > We will show information about using ecr (with authentication information) + link to the docs.
> 
> I'm also leaning toward this approach. I'm afraid that users downloading container images from ECR Public (e.g., Kubernetes cluster) may suddenly reach rate limits due to Trivy DB and be unable to deploy, etc.
> 

Yes but the same can be said for GHCR today. 

> Of course, it is best if users can continue to use DBs as before without being aware of it, but the implicit use of ECR Public may have other negative effects. We should be careful about the use of ECR Public. If users explicitly set this up, they will understand these trade-offs.

I added some docs [here](https://github.com/aquasecurity/trivy/blob/fa031898ebd2d39009e6bace47b288595793a6d7/docs/docs/configuration/db.md#rate-limits).

Ultimately we can reach rate limits even with authenticated use of container registries. The fallback to using a secondary registry only mitigates the risk up to an extent. "
2418554434,7679,knqyf263,2024-10-17T05:46:42Z,">Yes but the same can be said for GHCR today.

The rate limits in GHCR are on the organization, not the user, unlike ECR Public. In other words, heavy use of GHCR may make aquasecurity images unavailable, but not other images. Users may not be able to use Trivy, but they will be able to pull any other images except aquasecurity."
2428439172,7679,goatwu1993,2024-10-22T07:12:56Z,"checks bundle also needs ecr. 

```yaml
        env:
          TRIVY_DB_REPOSITORY: public.ecr.aws/aquasecurity/trivy-db
          TRIVY_JAVA_DB_REPOSITORY: public.ecr.aws/aquasecurity/trivy-java-db
          TRIVY_CHECKS_BUNDLE_REPOSITORY: public.ecr.aws/aquasecurity/trivy-checks
```"
2434783596,7679,bgoareguer,2024-10-24T09:37:11Z,The `trivy.dbRepository` parameter in the `helm/trivy/values.yaml` file also needs to be updated.
2440651780,7679,afdesk,2024-10-28T06:21:26Z,"> The `trivy.dbRepository` parameter in the `helm/trivy/values.yaml` file also needs to be updated.

thanks for the good idea.
it should be add after the PR is merged and released."
2440660860,7679,afdesk,2024-10-28T06:27:07Z,"@simar7 
Now trivy-db pushes the database to Docker Hub: https://github.com/aquasecurity/trivy-db/pull/448
maybe it makes sense to add Docker Hub as a default repository too?
just idea. thanks!"
2472681302,7679,jeanmarcmoeckel,2024-11-13T07:24:41Z,Any updates here? 
2477256831,7679,knqyf263,2024-11-14T19:36:04Z,"`mirror.gcr.io` seems the best for our use case. Please let us know if anyone knows about rate limits on that.
https://github.com/aquasecurity/trivy/discussions/7538#discussioncomment-11258881"
2478294047,7679,benji78,2024-11-15T09:08:08Z,I see 8 incorrect mentions of `public.ecr.aws/aquasecurity/trivy-db:1` which should be `trivy-java-db` !
2482468366,7679,DmitriyLewen,2024-11-18T09:54:59Z,@aqua-bot backport release/v0.57
2482470900,7679,aqua-bot,2024-11-18T09:55:45Z,Backport PR created: https://github.com/aquasecurity/trivy/pull/7944
1717004235,5154,nikpivkin,2023-09-13T06:10:15Z,@j1nka I left a couple of small comments.
1717136912,5154,knqyf263,2023-09-13T08:00:41Z,"I don't remember, but there might be a reason why we use groups. I'd defer to @DmitriyLewen. He will be back next week."
1722863727,5154,j1nka,2023-09-18T07:13:48Z,"> Hello @j1nka Thanks for your work!
> 
> Some languages have nuances with lowercase in purl (e.g. `Go`, `npm`). To avoid problem with that - we use original names ([#4306 (comment)](https://github.com/aquasecurity/trivy/pull/4306#discussion_r1200428174)).
> 
> Maven plugin uses `Name` and `Group` field. We try to adhere to the language format.
> 
> But i understand your point. I left a comment. Take a look, please.
> 
> Regards, Dmitriy

@DmitriyLewen thanks for the clarification! But i'm talking only about Java projects and nothing else. It may happen that we don't get vulnerability data from SBOM because sometimes we don't have ""Group"""
1722880001,5154,DmitriyLewen,2023-09-18T07:28:01Z,"> It may happen that we don't get vulnerability data from SBOM because sometimes we don't have ""Group""

Can you share some example for this case? 
I am wondering where these apps store `GroupID`.

e.g. before #4674 we save `ArtifactID` + `GroupID` in `name` field."
1722893191,5154,j1nka,2023-09-18T07:38:42Z,"> > It may happen that we don't get vulnerability data from SBOM because sometimes we don't have ""Group""
> 
> Can you share some example for this case? I am wondering where these apps store `GroupID`.
> 
> e.g. before #4674 we save `ArtifactID` + `GroupID` in `name` field.

Sure! Two examples above are the real SBOMs generated by different tools (not Trivy)"
1727277777,5154,j1nka,2023-09-20T08:57:09Z,"> Looks good now. @j1nka Thanks for your work!
> 
> Can you update title of this PR? (we don't use `purl` instead of `name` and `group` name => we use one of these fields.

Hi! Sure. Smth like that? Thanks for your help and patience, Dmitriy!"
1740452787,5154,j1nka,2023-09-29T07:41:42Z,"> Great! Thanks!
> 
> @knqyf263 i approved this PR.

@knqyf263 @DmitriyLewen Hi! Is there anything else I should to to merge this PR? Thanks!"
1744553354,5154,knqyf263,2023-10-03T09:10:16Z,@nikpivkin requested changes. We cannot merge the PR until @nikpivkin approves it.
1385026451,3391,itaysk,2023-01-17T08:38:07Z,@knqyf263 you're required as code owner
1385028649,3391,knqyf263,2023-01-17T08:40:15Z,"Did we test this template?

@AnaisUrlichs PR title must follow this convention.
https://aquasecurity.github.io/trivy/v0.36/community/contribute/pr/#title"
1385062456,3391,AnaisUrlichs,2023-01-17T09:09:38Z,"@knqyf263 it does not really fall under this any of those types tho :D will call it ""docs"""
1385358459,3391,knqyf263,2023-01-17T12:34:02Z,@itaysk @AnaisUrlichs Did either of you two confirm the template actually works in fork or another repository?
1386916820,3391,AnaisUrlichs,2023-01-18T11:39:59Z,@knqyf263 will do
1386968850,3391,itaysk,2023-01-18T12:22:50Z,@AnaisUrlichs can you also please also add an optional field to provide a link to logo? maybe in the future we can create a page like this in the Trivy website: https://fluxcd.io/adopters/ 
1399506645,3391,AnaisUrlichs,2023-01-22T14:38:13Z,"@knqyf263 @itaysk I made some changes and checked that the template works on my branch -- please let me know if you would like anything else to be changed
<img width=""610"" alt=""Screenshot 2023-01-22 at 14 34 39"" src=""https://user-images.githubusercontent.com/33576047/213921523-8d1095cf-df51-4c17-842f-aa1779c6e812.png"">
"
2403943437,7690,afdesk,2024-10-10T04:25:59Z,"@itaysk @knqyf263 Could you take a look at this PR when you have time?

I'm unsure about logs. maybe it's a bit confusing for people.

also I can't reproduce #7684 with this update.

wdyt?

thanks a lot for your time."
2404698272,7690,itaysk,2024-10-10T10:23:09Z,"> I'm unsure about logs. maybe it's a bit confusing for people.

cluster scanning can have many resources, and logging each individual resource scan is too much IMO. we can make it a debug level log.

> also I can't reproduce https://github.com/aquasecurity/trivy/issues/7684 with this update.

Good, that means you think it solved #7684 too?
"
2404774511,7690,afdesk,2024-10-10T10:58:13Z,"> > I'm unsure about logs. maybe it's a bit confusing for people.
> cluster scanning can have many resources, and logging each individual resource scan is too much IMO. we can make it a debug level log.

Thanks!
I understood your point and agree with them. 
so I remove the log update from this PR, and will create a new one for logs only.
 
> > also I can't reproduce #7684 with this update.
> Good, that means you think it solved #7684 too?

I'm unsure, because I don't understand a reason of #7684.
I'm investigating it now"
2415899532,7690,afdesk,2024-10-16T07:00:30Z,@itaysk @knqyf263 could you take a look at this PR again? thanks!
2418545967,7690,afdesk,2024-10-17T05:39:50Z,"@itaysk I finally clarify the reason of #7684 - the race condition appears between a few misconfig scanners, so this PR should resolve it too."
2419017341,7690,nikpivkin,2024-10-17T09:23:45Z,@afdesk Left a couple small comments
2423560304,7690,afdesk,2024-10-19T04:20:03Z,"> lgtm, but I'll wait for @knqyf263 to take a look as well.

@simar7 thanks for your review!! "
2426194261,7690,afdesk,2024-10-21T09:55:49Z,"> LGTM

@knqyf263 thanks for your review.

when tests are completed, I'll add this PR to merge queue, ok?"
2426231251,7690,knqyf263,2024-10-21T10:10:52Z,">when tests are completed, I'll add this PR to merge queue, ok?

Sure. Just FYI: There are many places where it still says ""folder"".
https://github.com/aquasecurity/trivy/pull/7690/commits/84cacc5dc531c09ccce443271b6f0f37bcf05b58"
917042715,1230,CLAassistant,2021-09-10T16:34:22Z,[![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=1230) <br/>All committers have signed the CLA.
919982682,1230,afdesk,2021-09-15T12:40:14Z,"Hi @simon-engledew!
thanks for your feedback! 

I'm studying this issue right now. 
the first moment: this PR changes only the driver's rule ids, and doesn't affect on results's `ruleId`."
920281904,1230,simon-engledew,2021-09-15T18:39:25Z,"Hi @afdesk ! 👋 

> this PR changes only the driver's rule ids, and doesn't affect on results's ruleId.

Yes, quite right! Sorry, I meant this as an illustration of how the issue could be resolved - not a complete solution. 🙇

If you are happy with this direction I can spend some more time trying to get the PR into a mergable state?"
921745728,1230,afdesk,2021-09-17T12:07:53Z,"@simon-engledew thanks a lot for your effort!
it looks good and I don't see problems with these changes."
921759262,1230,afdesk,2021-09-17T12:30:01Z,I'd add more information about scan into `shortDescription`.
921762867,1230,afdesk,2021-09-17T12:36:11Z,"@simon-engledew I found a problem. 
simple `VulnerabilityID` may not be unique for scan."
921768513,1230,afdesk,2021-09-17T12:45:37Z,"I've created next folder `j`:
```
./j
├── commons-io-1.4.jar
└── t
    └── commons-io-1.4.jar
```
and `trivy` creates the report with not unique ids."
921876675,1230,simon-engledew,2021-09-17T15:13:32Z,"You'll need a rule for each type of vulnerability you are scanning for - each rule should have a unique identifier that is stable between scans.

Many results can share the same rule. Results will create alerts that are associated with locations in files. In your example:

```
./j
├── commons-io-1.4.jar
└── t
    └── commons-io-1.4.jar
```

There would be two results, both with the same rule. The first result would have a location of j/commons-io-1.4.jar and the second result would have a location of j/t/commons-io-1.4.jar.

The vulnerability ID being the same for different results allows grouping the results together based on vulnerability and allows the results of two scans to be compared."
949898754,1230,krol3,2021-10-22T19:13:55Z,@afdesk This issue is affecting the results that trivy-gh-action is showing. Doesn't it? 
965487953,1230,simon-engledew,2021-11-10T16:07:37Z,"@afdesk @krol3

Hi folks :wave: Any progress? Trivy is starting to impact our service and we will have to start rejecting its submissions if this issue is not resolved. :disappointed:"
965607927,1230,simar7,2021-11-10T18:10:29Z,"Hi @simon-engledew, I was just added to this thread to assist. We'll take a look at it and follow up. 

cc @rahul2393 "
965878413,1230,simar7,2021-11-11T00:15:53Z,"hi again @simon-engledew, this looks good to me. Just one thing, if you could update the tests to reflect this behaviour then we should be able to merge it in. 

I tried to push to you branch but it seems I don't have access. But here's the diff:

```diff
commit 1bb2951145d9630d5069d929a9797e6183b58705
Author: Simon Engledew <simon-engledew@github.com>
Date:   Fri Sep 10 17:16:52 2021 +0100

    Use a stable SARIF identifier
    
    Co-authored-by: Simar <simar@linux.com>
    Signed-off-by: Simar <simar@linux.com>

diff --git a/contrib/sarif.tpl b/contrib/sarif.tpl
index 1f7bc27..5ecb09e 100644
--- a/contrib/sarif.tpl
+++ b/contrib/sarif.tpl
@@ -20,7 +20,7 @@
                 ,
               {{- end }}
             {
-              ""id"": {{ printf ""%s: %s-%s %s"" $result.Target .PkgName .InstalledVersion .VulnerabilityID | toJson }},
+              ""id"": {{ .VulnerabilityID | toJson }},
               ""name"": ""{{ toSarifRuleName $vulnerabilityType }}"",
               ""shortDescription"": {
                 ""text"": {{ printf ""%v Package: %v"" .VulnerabilityID .PkgName | printf ""%q"" }}
@@ -92,4 +92,4 @@
       }
     }
   ]
-}
\ No newline at end of file
+}
diff --git a/integration/testdata/alpine-310.sarif.golden b/integration/testdata/alpine-310.sarif.golden
index 5698b0f..aa54385 100644
--- a/integration/testdata/alpine-310.sarif.golden
+++ b/integration/testdata/alpine-310.sarif.golden
@@ -11,7 +11,7 @@
           ""version"": ""0.15.0"",
           ""rules"": [
             {
-              ""id"": ""testdata/fixtures/images/alpine-310.tar.gz (alpine 3.10.2): libcrypto1.1-1.1.1c-r0 CVE-2019-1549"",
+              ""id"": ""CVE-2019-1549"",
               ""name"": ""OS Package Vulnerability (Alpine)"",
               ""shortDescription"": {
                 ""text"": ""CVE-2019-1549 Package: libcrypto1.1""
@@ -37,7 +37,7 @@
               }
             },
             {
-              ""id"": ""testdata/fixtures/images/alpine-310.tar.gz (alpine 3.10.2): libcrypto1.1-1.1.1c-r0 CVE-2019-1551"",
+              ""id"": ""CVE-2019-1551"",
               ""name"": ""OS Package Vulnerability (Alpine)"",
               ""shortDescription"": {
                 ""text"": ""CVE-2019-1551 Package: libcrypto1.1""
@@ -63,7 +63,7 @@
               }
             },
             {
-              ""id"": ""testdata/fixtures/images/alpine-310.tar.gz (alpine 3.10.2): libcrypto1.1-1.1.1c-r0 CVE-2019-1563"",
+              ""id"": ""CVE-2019-1563"",
               ""name"": ""OS Package Vulnerability (Alpine)"",
               ""shortDescription"": {
                 ""text"": ""CVE-2019-1563 Package: libcrypto1.1""
@@ -89,7 +89,7 @@
               }
             },
             {
-              ""id"": ""testdata/fixtures/images/alpine-310.tar.gz (alpine 3.10.2): libcrypto1.1-1.1.1c-r0 CVE-2019-1547"",
+              ""id"": ""CVE-2019-1547"",
               ""name"": ""OS Package Vulnerability (Alpine)"",
               ""shortDescription"": {
                 ""text"": ""CVE-2019-1547 Package: libcrypto1.1""
@@ -115,7 +115,7 @@
               }
             },
             {
-              ""id"": ""testdata/fixtures/images/alpine-310.tar.gz (alpine 3.10.2): libssl1.1-1.1.1c-r0 CVE-2019-1549"",
+              ""id"": ""CVE-2019-1549"",
               ""name"": ""OS Package Vulnerability (Alpine)"",
               ""shortDescription"": {
                 ""text"": ""CVE-2019-1549 Package: libssl1.1""
@@ -141,7 +141,7 @@
               }
             },
             {
-              ""id"": ""testdata/fixtures/images/alpine-310.tar.gz (alpine 3.10.2): libssl1.1-1.1.1c-r0 CVE-2019-1551"",
+              ""id"": ""CVE-2019-1551"",
               ""name"": ""OS Package Vulnerability (Alpine)"",
               ""shortDescription"": {
                 ""text"": ""CVE-2019-1551 Package: libssl1.1""
@@ -167,7 +167,7 @@
               }
             },
             {
-              ""id"": ""testdata/fixtures/images/alpine-310.tar.gz (alpine 3.10.2): libssl1.1-1.1.1c-r0 CVE-2019-1563"",
+              ""id"": ""CVE-2019-1563"",
               ""name"": ""OS Package Vulnerability (Alpine)"",
               ""shortDescription"": {
                 ""text"": ""CVE-2019-1563 Package: libssl1.1""
@@ -193,7 +193,7 @@
               }
             },
             {
-              ""id"": ""testdata/fixtures/images/alpine-310.tar.gz (alpine 3.10.2): libssl1.1-1.1.1c-r0 CVE-2019-1547"",
+              ""id"": ""CVE-2019-1547"",
               ""name"": ""OS Package Vulnerability (Alpine)"",
               ""shortDescription"": {
                 ""text"": ""CVE-2019-1547 Package: libssl1.1""
```"
965879034,1230,simar7,2021-11-11T00:17:02Z,And also if you could sign the CLA that would be very appreciated. 
966114184,1230,simon-engledew,2021-11-11T09:08:31Z,"@simar7

It wasn't quite there. AS @afdesk pointed out, the results needed updating.

I've done that, then the next problem is that the rules need to be made unique by `VulnerabilityID` and the `ruleIndex` needs to also reflect that.

I've had a go at that too. :+1:"
966114565,1230,simon-engledew,2021-11-11T09:09:02Z,"> And also if you could sign the CLA that would be very appreciated.

I did. 😞 I'll try again.

Ok, that seemed to do it this time. 😌 "
966228672,1230,afdesk,2021-11-11T11:31:52Z,"Hi @simon-engledew!
thanks for your contribution! 
it looks really great.
I'm testing it now"
966345738,1230,simon-engledew,2021-11-11T14:27:06Z,"Does what I have done make sense for Trivy?

I guess my main concern with this approach is that the rules would have result-specific information in them because of the way Trivy has a 1-1 mapping between results and rules at the moment."
966363669,1230,simon-engledew,2021-11-11T14:50:08Z,"Hmm 🤔 Looking at the sample data more carefully, I think this is going to require a bit more work to resolve.

I've altered the rule metadata so that it is also stable and applicable to all results. I've had to remove the help entirely as it contained information specific to a single result.

If you want to reinstate this information it should really live inside results, e.g: the message field."
966408052,1230,knqyf263,2021-11-11T15:45:06Z,"Hi @simon-engledew, I'm so sorry to be late. We're now putting the highest priority on it. Could you fix the test?"
966419069,1230,simon-engledew,2021-11-11T15:59:08Z,Would it make sense to create a new PR based on this one? I feel like I am making decisions that would be better made by someone with more context about how Trivy works. 🙇 
966494306,1230,simon-engledew,2021-11-11T17:41:24Z,"Ok `go test -v -tags=integration -run TestClientServerWithTemplate ./integration/...` now passes. 🙇  Sorry, I've been busy with other stuff all day and this is the first time I've been able to sit down and try and get the integration tests passing. 😞 

It's the end of the day for me now so if this doesn't do it I am more than happy if you want to cherry pick my commits, make a PR that is not based on my fork and run with it without me."
966496498,1230,afdesk,2021-11-11T17:44:45Z,"@simon-engledew thanks for your time and effort! 
"
966538470,1230,simon-engledew,2021-11-11T18:43:12Z,Thanks for bearing with me as I repeatedly tried and failed to fix the tests @afdesk 😅❤️🙏
966828982,1230,afdesk,2021-11-12T05:20:42Z,@simon-engledew You spent a lot of time. thanks again
982332091,1230,afdesk,2021-11-30T06:40:05Z,"Hi @simon-engledew!
could you help us again?
several parts have been removed from the sarif template: `help` block and `PkgName`.

It seems that was a mistake, right?
thanks!

https://github.com/aquasecurity/trivy/blob/eaf2da20a690874570509e9924e2d5f1680c813d/contrib/sarif.tpl#L40-L49"
982412417,1230,simon-engledew,2021-11-30T08:48:10Z,"Ah, that's what I was refering to in this comment: https://github.com/aquasecurity/trivy/pull/1230#issuecomment-966363669

The rule help has to be applicable to every rule with the same sarif identifier. It should contain some general text talking about the vulnerability and then result specific details should be included in the result object."
982600195,1230,afdesk,2021-11-30T12:41:57Z,"> Ah, that's what I was refering to in this comment: [#1230 (comment)](https://github.com/aquasecurity/trivy/pull/1230#issuecomment-966363669)
> 
> The rule help has to be applicable to every rule with the same sarif identifier. It should contain some general text talking about the vulnerability and then result specific details should be included in the result object.

@simon-engledew thanks a lot. I missed this comment :("
1282185084,2951,chen-keinan,2022-10-18T10:41:05Z,"I have embedded `NsaSpec.yaml` spec in code , its just for demo to be removed before merge"
1287870392,2951,itaysk,2022-10-22T17:59:40Z,@chen-keinan can you please add something to the documentation?
1287894445,2951,chen-keinan,2022-10-22T19:40:48Z,"> @chen-keinan can you please add something to the documentation?

@itaysk @AnaisUrlichs , I have added doc for `compliance/nsa` please review and feedback"
1288029466,2951,itaysk,2022-10-23T06:56:50Z,LGTM
1288030153,2951,itaysk,2022-10-23T06:59:15Z,"This PR probably doesn't fully close issue #2919 thought, since it only adds NSA report as a single hardcoded report, it doesn't yet open up for *custom* reports as the original issue suggests."
1288030585,2951,itaysk,2022-10-23T07:01:36Z,"If you agree I suggest you change the ""close"" directive to ""related"" or something like this. 
if you want to close an issue with this PR you can create another one just for NSA"
1288168292,2951,chen-keinan,2022-10-23T18:14:13Z,"> This PR probably doesn't fully close issue #2919 thought, since it only adds NSA report as a single hardcoded report, it doesn't yet open up for _custom_ reports as the original issue suggests.

OK , change it to `related` instead of `close`
btw: the `nsa` is not hardcoded in `trivy` its coming part of spec API in defsec"
1552786170,4210,agomezmoron,2023-05-18T09:27:43Z,"Hi @knqyf263 ,

We fixed that in our pipelines internally and now the latest `bitnami/elasticsearch` container has the proper files in the `/opt/bitnami/elasticsearch/.sped-elasticsearch.spdx`. 

```
$ docker run --rm -it -u root --entrypoint=/bin/bash bitnami/elasticsearch:8.7.1-debian-11-r7
root@af2e2aef648e:/opt/bitnami/elasticsearch# cat .spdx-elasticsearch.spdx | grep -i guava-2
                    ""fileName"": ""modules/x-pack-security/guava-28.2-jre.jar"",
                    ""fileName"": ""modules/x-pack-watcher/guava-27.1-jre.jar"",
root@af2e2aef648e:/opt/bitnami/elasticsearch# cat .spdx-elasticsearch.spdx | grep -i commons.io
            ""name"": ""commons-io:commons-io"",
                    ""referenceLocator"": ""pkg:maven/commons-io/commons-io@2.11.0""
                    ""fileName"": ""modules/ingest-attachment/commons-io-2.11.0.jar"",
            ""name"": ""commons-io:commons-io"",
                    ""referenceLocator"": ""pkg:maven/commons-io/commons-io@2.5""
                    ""fileName"": ""lib/tools/security-cli/commons-io-2.5.jar"",
```

Thanks!
"
1552896348,4210,knqyf263,2023-05-18T11:06:24Z,@agomezmoron Great! Thanks for updating! I'll be back to this PR next week and wrap it up.
1570636782,4210,carrodher,2023-05-31T17:35:06Z,"Hi, JFYI, the [bitnami/vulndb](https://github.com/bitnami/vulndb) repo was made public"
2244382694,7206,knqyf263,2024-07-23T06:49:00Z,"@DmitriyLewen `ubuntu-latest-m` is still down. I switched it to `ubuntu-latest` so I can confirm this PR passes all tests. It's all green now, and I marked this PR ready for review. I'll change it back to `ubuntu-latest-m` after GitHub gets fixed."
2227736606,7163,knqyf263,2024-07-15T05:43:35Z,"There is one discussion. Technically, `toolchain` is not always used for compilation. If the local Go version is newer than the toolchain version, Go uses the local version.

```
$ go mod init example.com/test
$ go get go@go1.22.0
$ go get toolchain@1.22.2
$ cat go.mod
module example.com/test

go 1.22.0

toolchain go1.22.2
```

```
$ cat main.go
package main

import ""fmt""

func main(){
        fmt.Println(""hello world"")
}
$ go version
go version go1.22.3 darwin/arm64
$ go build ./main.go
$ go version -m ./main | head -n 1
./main: go1.22.3 // <= toolchain go1.22.2 is not used
```

However, if the local version is older, the toolchain version is used for forward compatibility.

```
$ go get toolchain@go1.22.4
go: upgraded toolchain go1.22.2 => go1.22.4
$ cat go.mod
module example.com/test

go 1.22.0

toolchain go1.22.4

$ go build ./main.go
go version -m ./main | head -n 1
./main: go1.22.4
```

They [can be configured](https://go.dev/doc/toolchain) through `GOTOOLCHAIN`, but I think it's too much. We can focus on the default behavior.

><name>, <name>+auto, or <name>+path. GOTOOLCHAIN=auto is shorthand for=local+auto

@DmitriyLewen Do you think we should work in the same way?"
2227752888,7163,DmitriyLewen,2024-07-15T06:01:49Z,"> There is one discussion. Technically, toolchain is not always used for compilation. If the local Go version is newer than the toolchain version, Go uses the local version.

Hmm... I didn't look at that.
In this case, I don't know how we can correctly determine `stdlib` version. We need to define the local version of `Go`, but `GOROOT` is not a required env.

This seems to be the same case as for the SDK in `Dark`.
We can only show a minimal version.

> Do you think we should work in the same way?

Let's start from default logic.
We will handle GOTOOLCHAIN ​​later if users need it."
2227774190,7163,knqyf263,2024-07-15T06:22:18Z,"This is how govulncheck works.
https://github.com/golang/vuln/blob/d9ad5223849a23e412d4a6ac1f61ecfc94cab0d8/internal/scan/run.go#L89-L93

`go version` actually respects go.mod.

```
$ go get toolchain@go1.22.3
go go: downgraded toolchain go1.22.4 => go1.22.3
$ cat go.mod
module example.com/test

go 1.22.0

toolchain go1.22.3

$ go version
go version go1.22.3 darwin/arm64
```

```
$ go get toolchain@go1.22.4
go: upgraded toolchain go1.22.3 => go1.22.4
$ cat go.mod
module example.com/test

go 1.22.0

toolchain go1.22.4
$ go version
go version go1.22.4 darwin/arm64
```

But I'm still not sure this is a good approach. If the environment in which Trivy is run is different from the environment in which the project is built, the vulnerability may be overlooked. Also, people can be confused as a vulnerability may be detected or not detected even though they scan the same project."
2227782940,7163,DmitriyLewen,2024-07-15T06:30:33Z,"> https://github.com/golang/vuln/blob/d9ad5223849a23e412d4a6ac1f61ecfc94cab0d8/internal/scan/run.go#L89-L93

I thought that we don't want to run other apps in Trivy, even if it's `go`.


> But I'm still not sure this is a good approach. If the environment in which Trivy is run is different from the environment in which the project is built, the vulnerability may be overlooked. Also, people can be confused as a vulnerability may be detected or not detected even though they scan the same project.

in this case, users will need to check (or just be mindful) of many things when scanning `go.mod` file.
e.g. version of my local `Go` is not equal to version of `Go` from our CI/CD.
When i will scan `go.mod` => i can get a vulnerable binary (or I will need to scan binary again, but then why would I scan the `go.mod`)"
2227789102,7163,knqyf263,2024-07-15T06:36:12Z,"OK, it is better to use the toolchain version at the moment for reproducibility. Since it's technically different from how the Go version is selected for compiling a binary, we should document it."
2227792173,7163,DmitriyLewen,2024-07-15T06:38:53Z,Yeah. I will update docs.
2227939836,7163,DmitriyLewen,2024-07-15T08:18:47Z,"@knqyf263 i updated docs.
Please take a look.
You might want to add something."
2330510749,7444,CLAassistant,2024-09-05T03:10:35Z,[![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=7444) <br/>All committers have signed the CLA.
2331314871,7444,afdesk,2024-09-05T11:48:16Z,"Hi @smtan-gl  thanks for the contribution! it's really nice and important.

I left some comments about this PR. 

also I took a look at #5889 
it seems we have to add more tests for these cases... "
2333672062,7444,smtan-gl,2024-09-06T09:39:23Z,"> Hi @smtan-gl thanks for the contribution! it's really nice and important.
> 
> I left some comments about this PR.
> 
> also I took a look at #5889 it seems we have to add more tests for these cases...

@afdesk any chance you might have context on this [question](https://github.com/aquasecurity/trivy/issues/5889#issuecomment-2330536466)?"
2339607085,7444,afdesk,2024-09-10T04:52:24Z,"> @afdesk any chance you might have context on this [question](https://github.com/aquasecurity/trivy/issues/5889#issuecomment-2330536466)?

If I understand correctly there is an option to create an image with several tags, so it should be a slice.
https://stackoverflow.com/questions/31963525/is-it-possible-for-image-to-have-multiple-tags"
2345759817,7444,smtan-gl,2024-09-12T09:35:11Z,"@afdesk I've updated the PR, could you have another look please 😄 "
2352032381,7444,afdesk,2024-09-16T05:13:41Z,"> @afdesk I've updated the PR, could you have another look please 😄

sure, thanks! I'll take a look"
2354827508,7444,afdesk,2024-09-17T08:05:34Z,@smtan-gl could you sign CLA for a while? thanks!
2355164429,7444,smtan-gl,2024-09-17T10:07:50Z,"> @smtan-gl could you sign CLA for a while? thanks!

@afdesk, I've just signed it. Thank you."
2358209167,7444,afdesk,2024-09-18T11:25:03Z,"it's a BREAKING change, so we have to create a new discussion about it.
like here: https://github.com/aquasecurity/trivy/discussions/7010
we'll do it after the PR is merged. just to remember about it"
2358244817,7444,afdesk,2024-09-18T11:43:39Z,"@smtan-gl  also, I'm not sure that this PR fixes #5889..."
2358255511,7444,afdesk,2024-09-18T11:49:22Z,"@smtan-gl please, feel free to correct me if I miss something.
I've run an empty minikube. and then I create a pod with 2 images in my test namespace:
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: my-multiimage-pod
spec:
  containers:
  - name: my-image1-nginx
    image: nginx
  - name: my-image2-alpine-sleep
    image: alpine:3.17.1
    command: [ ""/bin/sh"", ""-c"", ""--"" ]
    args: [ ""while true; do sleep 30; done;""]
```
```sh
$ kubectl create namespace k8s-test
$ kubectl create -f multiimagepod.yaml -n k8s
```
and try to scan this cluster with the update:
```sh
$ ./tr k8s --report all -f json -o res2.json --include-namespaces k8s-test --timeout 30m --debug --include-kinds Pod --scanners vuln
```
Metadata still contains only one record:
<img width=""406"" alt=""изображение"" src=""https://github.com/user-attachments/assets/57cb4da2-488c-4d01-aa89-b11dd61d46d8"">
<img width=""542"" alt=""изображение"" src=""https://github.com/user-attachments/assets/5e024791-cfac-4308-b826-f5491249baa5"">

"
2360090116,7444,smtan-gl,2024-09-19T06:22:14Z,"@afdesk, the bug https://github.com/aquasecurity/trivy/issues/5889 occurs only with the `--report summary` configuration. 

In your example, you used `--report all` which [does not consolidate the report](https://github.com/aquasecurity/trivy/blob/35c4262d0b5ac18376a2ca53213b476103b5d51a/pkg/k8s/report/json.go#L23). As such, there are 2 reports in the `Resources` field, 1 for each of the scanned images containing only 1 metadata.

When I run the command using `--report summary`: 
```
$ ./tr k8s --report summary -f json -o res2.json --include-namespaces k8s-test --timeout 30m --debug --include-kinds Pod --scanners vuln
```

It [consolidates the reports](https://github.com/aquasecurity/trivy/blob/35c4262d0b5ac18376a2ca53213b476103b5d51a/pkg/k8s/report/json.go#L28) into 1 consolidated report in the `Findings` field, and you can see that there are 2 metadata for the 2 images.

![Screenshot 2024-09-19 at 2 02 05 PM](https://github.com/user-attachments/assets/5f01facc-6695-4a62-8592-1f645fdd8407)
"
2360260439,7444,afdesk,2024-09-19T07:58:25Z,"> @afdesk, the bug #5889 occurs only with the `--report summary` configuration.

exactly! thanks for clarify!"
2362578138,7444,smtan-gl,2024-09-20T02:22:17Z,Thanks for reviewing the PR @afdesk 😄 May I know what's the next steps needed to have this PR merged?
2362667554,7444,afdesk,2024-09-20T03:03:25Z,"> Thanks for reviewing the PR @afdesk 😄 May I know what's the next steps needed to have this PR merged?

@smtan-gl thanks for your contribution again. 
It's a breaking change so let's wait feedback from another maintainers and community "
2372642748,7444,smtan-gl,2024-09-25T00:48:09Z,"> > Thanks for reviewing the PR @afdesk 😄 May I know what's the next steps needed to have this PR merged?
> 
> @smtan-gl thanks for your contribution again. It's a breaking change so let's wait feedback from another maintainers and community

Hi @afdesk would you have an estimate on how long we need to wait for feedback? "
2373367418,7444,afdesk,2024-09-25T08:08:24Z,"Hi @smtan-gl 

there is a concern about this solution: how people associate the result with the metadata if it's N x N?

wdyt about it? thanks!
"
2373657787,7444,smtan-gl,2024-09-25T10:14:42Z,"> Hi @smtan-gl
> 
> there is a concern about this solution: how people associate the result with the metadata if it's N x N?
> 
> wdyt about it? thanks!

Thanks for the response @afdesk. I thought we could match the vulnerability's `Layer.DiffID` with the metadata `DiffIDs`, but I've realized that the `DiffIDs` across multiple metadata entries might not be unique. Would it make sense to introduce an `ImageID` field to vulnerability?

For your convenience, I've attached below a JSON report from a scan with changes from this MR.

[multi-image-pod.json](https://github.com/user-attachments/files/17129086/multi-image-pod.json)
"
2382162717,7444,afdesk,2024-09-30T05:45:58Z,"@smtan-gl there are a few ideas.

1. @knqyf263 suggests to have Metadata and Results per image. 
<details>
<summary>a sample json for a new field</summary>

```json
  ""Images"": [
    {
      ""Metadata"": {
        ""OS"": {
          ""Family"": ""debian"",
          ""Name"": ""12.6""
        },
        ""RepoTags"": [
          ""image-a:latest""
        ]
      },
      ""Results"": [
        {
          ""Target"": ""image-a:latest(debian 12.6)"",
          ""Class"": ""os-pkgs"",
          ""Type"": ""debian"",
          ""Vulnerabilities"": []
        }
      ]
    },
    {
      ""Metadata"": {
        ""OS"": {
          ""Family"": ""ubuntu"",
          ""Name"": ""22.04""
        },
        ""RepoTags"": [
          ""image-b:latest""
        ]
      },
      ""Results"": [
        {
          ""Target"": ""image-b:latest(ubuntu 22.04)"",
          ""Class"": ""os-pkgs"",
          ""Type"": ""ubuntu"",
          ""Vulnerabilities"": []
        }
      ]
    }
  ]
```
</details>

Next ideas came from the point `summary` report basically is for reference and for table output.

2. disable JSON format for summary reports.
People can summarize results by themselves. and maybe someone will create a plugin for it.

3. Pods are the smallest deployable units of computing that you can create and manage in Kubernetes. so If we say Pod is a single object, and we don't distinguish image. and then the current approach is fine.

Wdyt @smtan-gl ?"
2387536013,7444,smtan-gl,2024-10-02T02:59:03Z,"> Next ideas came from the point summary report basically is for reference and for table output.

Thanks for the response @afdesk. I agree with your points. However, I assume that there are other users who already rely on summary report in JSON format, so disabling it might affect them. For that reason, I support moving forward with approach 3."
2410998564,7444,afdesk,2024-10-14T11:56:06Z,"@smtan-gl just small update that I didn't forget about your job.
I hope we'll resolve it before next release. 
thanks again"
1696938128,5059,CLAassistant,2023-08-29T07:45:17Z,[![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=5059) <br/>All committers have signed the CLA.
1696938153,5059,CLAassistant,2023-08-29T07:45:18Z,"[![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=5059) <br/>Thank you for your submission! We really appreciate it. Like many open source projects, we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/aquasecurity/trivy?pullRequest=5059) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/aquasecurity/trivy?pullRequest=5059) it.</sub>"
1697005137,5059,thapabishwa,2023-08-29T08:33:44Z,"> @thapabishwa thank you for the contribution, maybe its best to add the exclude logic in :` trivy-kubernetes` project [here](https://github.com/aquasecurity/trivy-kubernetes/blob/main/pkg/trivyk8s/trivyk8s.go#L116)

Hi @chen-keinan. Thanks for your swift response. 

I have concerns about adding these changes to the `trivy-kubernetes` repository, as it might introduce complications. The proposed approach seems to involve blocking/filter all objects without granting control to the end user, which I believe is a crucial aspect.

For instance, if these changes are integrated into `trivy-kubernetes`, the output might resemble the following (unless I modify the signature of ListArtifact function):

```
 trivy k8s pods --report=summary --scanners config -A 
Workload Assessment
┌───────────┬────────────┬────────────────────┐
│ Namespace │  Resource  │ Misconfigurations  │
│           │            ├───┬───┬───┬────┬───┤
│           │            │ C │ H │ M │ L  │ U │
├───────────┼────────────┼───┼───┼───┼────┼───┤
│ default   │ Pod/my-pod │   │   │ 4 │ 11 │   │
└───────────┴────────────┴───┴───┴───┴────┴───┘
Severities: C=CRITICAL H=HIGH M=MEDIUM L=LOW U=UNKNOWN

```

However, by choosing to retain the new flag, complete control is handed over to the end user, enabling them to decide what to scan for:

- Without any filtering
```
 trivy k8s pods --report=summary --scanners config -A   
Workload Assessment
┌──────────────┬──────────────────────────────────────────────┬─────────────────────┐
│  Namespace   │                   Resource                   │  Misconfigurations  │
│              │                                              ├───┬───┬────┬────┬───┤
│              │                                              │ C │ H │ M  │ L  │ U │
├──────────────┼──────────────────────────────────────────────┼───┼───┼────┼────┼───┤
│ kube-system  │ Pod/aws-for-fluent-bit-m46xg                 │   │   │ 4  │ 8  │   │
│ kube-system  │ Pod/coredns-655c69d4f4-kmx6c                 │   │   │ 3  │ 5  │   │
│ kube-system  │ Pod/ebs-csi-node-pjml9                       │   │ 1 │ 10 │ 20 │   │
│ kube-system  │ Pod/kube-proxy-mp45r                         │   │ 2 │ 4  │ 10 │   │
│ kube-system  │ Pod/ebs-csi-controller-846b7ddddb-tbl88      │   │   │ 5  │ 31 │   │
│ kube-system  │ Pod/ebs-csi-controller-846b7ddddb-nj6ks      │   │   │ 5  │ 31 │   │
│ kube-system  │ Pod/aws-node-9f6mb                           │   │ 4 │ 8  │ 19 │   │
│ kube-system  │ Pod/coredns-655c69d4f4-fg82d                 │   │   │ 3  │ 5  │   │
│ default      │ Pod/myteam-mytest-cluster5-1                 │   │   │ 3  │ 7  │   │
│ default      │ Pod/frontend-8jw4h                           │   │   │ 3  │ 11 │   │
│ default      │ Pod/frontend-82hnn                           │   │   │ 3  │ 11 │   │
│ default      │ Pod/my-pod                                   │   │   │ 4  │ 11 │   │
│ default      │ Pod/web-1                                    │   │   │ 3  │ 11 │   │
│ default      │ Pod/postgres-operator-ui-7cf5759697-hrlst    │   │   │ 3  │ 7  │   │
│ default      │ Pod/postgres-operator-5c884976b6-bbj7m       │   │   │ 1  │ 6  │   │
│ default      │ Pod/frontend-rkwww                           │   │   │ 3  │ 11 │   │
│ default      │ Pod/web-0                                    │   │   │ 3  │ 11 │   │
│ default      │ Pod/nginx-5d56f7cc56-rj5tk                   │   │   │ 3  │ 11 │   │
│ default      │ Pod/myteam-mytest-cluster5-0                 │   │   │ 3  │ 7  │   │
│ cert-manager │ Pod/cert-manager-webhook-759d6dcbf7-6f4tc    │   │   │ 1  │ 8  │   │
│ cert-manager │ Pod/cert-manager-cainjector-744bb89575-wrvs9 │   │   │ 1  │ 8  │   │
│ cert-manager │ Pod/cert-manager-69cdc85fc8-lmx5s            │   │   │ 1  │ 8  │   │
└──────────────┴──────────────────────────────────────────────┴───┴───┴────┴────┴───┘
Severities: C=CRITICAL H=HIGH M=MEDIUM L=LOW U=UNKNOWN
```
- or, with the filter 
```
 trivy k8s pods --report=summary --scanners config -A  -E
Workload Assessment
┌──────────────┬──────────────────────────────────────────────┬─────────────────────┐
│  Namespace   │                   Resource                   │  Misconfigurations  │
│              │                                              ├───┬───┬────┬────┬───┤
│              │                                              │ C │ H │ M  │ L  │ U │
├──────────────┼──────────────────────────────────────────────┼───┼───┼────┼────┼───┤
│ default      │ Pod/my-pod                                   │   │   │ 4  │ 11 │   │
└──────────────┴──────────────────────────────────────────────┴───┴───┴────┴────┴───┘
Severities: C=CRITICAL H=HIGH M=MEDIUM L=LOW U=UNKNOWN
```

Please let me know your thoughts on it."
1697036941,5059,chen-keinan,2023-08-29T08:55:51Z,"@thapabishwa the flag remain in trivy cli  however trivy should be aware to k8s internal notions for example : `ownerReferences`

one way to do it is to introduce `options` pattern to client (in trivy-kubernetes project) see below:

```
type client struct {
	cluster       k8s.Cluster
	namespace     string
	resources     []string
	allNamespaces bool
	logger        *zap.SugaredLogger
	excludeOwned  bool
}

type K8sOption func(*client)

func WithExcludeOwned(excludeOwned bool) K8sOption {
	return func(c *client) {
		c.excludeOwned = excludeOwned
	}
}

// New creates a trivyK8S client
func New(cluster k8s.Cluster, logger *zap.SugaredLogger, opts ...K8sOption) TrivyK8S {
	c := &client{cluster: cluster, logger: logger}
	for _, opt := range opts {
		opt(c)
	}
	return c
}
```
once you have the flag in client its easy to include you functionality and also will help us in the future to introduce additional options"
1697102309,5059,thapabishwa,2023-08-29T09:38:55Z,"> @thapabishwa the flag remain in trivy cli however trivy should be aware to k8s internal notions for example : `ownerReferences`
> 
> one way to do it is to introduce `options` pattern to client (in trivy-kubernetes project) see below:
> 
> ```
> type client struct {
> 	cluster       k8s.Cluster
> 	namespace     string
> 	resources     []string
> 	allNamespaces bool
> 	logger        *zap.SugaredLogger
> 	excludeOwned  bool
> }
> 
> type K8sOption func(*client)
> 
> func WithExcludeOwned(excludeOwned bool) K8sOption {
> 	return func(c *client) {
> 		c.excludeOwned = excludeOwned
> 	}
> }
> 
> // New creates a trivyK8S client
> func New(cluster k8s.Cluster, logger *zap.SugaredLogger, opts ...K8sOption) TrivyK8S {
> 	c := &client{cluster: cluster, logger: logger}
> 	for _, opt := range opts {
> 		opt(c)
> 	}
> 	return c
> }
> ```
> 
> once you have the flag in client its easy to include you functionality and also will help us in the future to introduce additional options


Thank you, @chen-keinan. 

I've understood the advantages of adding this changes into the `trivy-kubernetes` repository instead. I will send a PR to that repository and once it's approved and merged I will then proceed to update this code once my work there is finished.

Thank you for your prompt reply."
1697123228,5059,thapabishwa,2023-08-29T09:52:55Z,"@chen-keinan 

PR on `trivy-kubernetes` repo
https://github.com/aquasecurity/trivy-kubernetes/pull/214

Pulling it here as I cannot add reviewers on that PR."
1697237193,5059,chen-keinan,2023-08-29T11:10:19Z,"> @chen-keinan
> 
> PR on `trivy-kubernetes` repo [aquasecurity/trivy-kubernetes#214](https://github.com/aquasecurity/trivy-kubernetes/pull/214)
> 
> Pulling it here as I cannot add reviewers on that PR.

@thapabishwa PR has been approved and merged.
you can use this tag `v0.5.7-0.20230829110855-969eb077ad1c` to replace `trivy-kubernetes` in `go.mod` file.

***Note:*** you'll need to update cli docs after adding new flag :: use this command : `mage docs:generate`"
1697446266,5059,thapabishwa-plerionaut,2023-08-29T13:27:19Z,"> > @chen-keinan
> > PR on `trivy-kubernetes` repo [aquasecurity/trivy-kubernetes#214](https://github.com/aquasecurity/trivy-kubernetes/pull/214)
> > Pulling it here as I cannot add reviewers on that PR.
> 
> @thapabishwa PR has been approved and merged. you can use this tag `v0.5.7-0.20230829110855-969eb077ad1c` to replace `trivy-kubernetes` in `go.mod` file.
> 
> _**Note:**_ you'll need to update cli docs after adding new flag :: use this command : `mage docs:generate`

Thanks @chen-keinan.

Upgraded  `trivy-kubernetes` to `v0.5.7-0.20230829110855-969eb077ad1c` and refactored existing code accordingly. 

Please let me know what you think about it."
1697583428,5059,chen-keinan,2023-08-29T14:42:11Z,"@thapabishwa FYI your PR is depend on #5058 as `trivy-kubernetes` dependency you used also picked up changes for #5050 pr , this the reason k8s integration test failing"
1697671172,5059,thapabishwa,2023-08-29T15:28:35Z,"> @thapabishwa FYI your PR is depend on #5058 as `trivy-kubernetes` dependency you used also picked up changes for #5050 pr , this the reason k8s integration test failing

Thanks @chen-keinan . Appreciate your feedback. I've addressed to the comments you've made.
Any suggestions to get the k8s integrations fixed so that this PR can be merged without depending on #5058 ."
1697703245,5059,chen-keinan,2023-08-29T15:42:46Z,"> > @thapabishwa FYI your PR is depend on #5058 as `trivy-kubernetes` dependency you used also picked up changes for #5050 pr , this the reason k8s integration test failing
> 
> Thanks @chen-keinan . Appreciate your feedback. I've addressed to the comments you've made. Any suggestions to get the k8s integrations fixed so that this PR can be merged without depending on #5058 .

I'm do not think it can be merged before #5058  as changes to trivy-kubernets lib will impact trivy k8s functionality , fixing the integration test will still keep trivy broken.
no worries merge will happen soon :)"
1697885462,5059,thapabishwa,2023-08-29T17:48:48Z,"> > > @thapabishwa FYI your PR is depend on #5058 as `trivy-kubernetes` dependency you used also picked up changes for #5050 pr , this the reason k8s integration test failing
> > 
> > 
> > Thanks @chen-keinan . Appreciate your feedback. I've addressed to the comments you've made. Any suggestions to get the k8s integrations fixed so that this PR can be merged without depending on #5058 .
> 
> I'm do not think it can be merged before #5058 as changes to trivy-kubernets lib will impact trivy k8s functionality , fixing the integration test will still keep trivy broken. no worries merge will happen soon :)


@chen-keinan I took some time to rethink the changes made to the `trivy-kubernetes` repository in https://github.com/aquasecurity/trivy-kubernetes/pull/214. 

In the current implementation, resources are skipped just if they have ownerRef. I think, this exclusion criteria might not be optimal as resources can be owned by custom resources(like CRDs).

As a consequence, I think it is more sensible to exclude only the resources that are owned by built-in workloads. I've created another PR in `trivy-kubernetes` to address the short comings https://github.com/aquasecurity/trivy-kubernetes/pull/215.

Please let me know what you think about it."
1698512643,5059,thapabishwa,2023-08-30T05:24:14Z,"> @thapabishwa thank you for the contribution lgtm 🚀 .
> 
> lets wait for #5019 to get approved and merged (will also solve the integration test issue)

Thanks @chen-keinan. Could you also take a look at https://github.com/aquasecurity/trivy-kubernetes/pull/215? I think it might be beneficial for us to consider https://github.com/aquasecurity/trivy-kubernetes/pull/215 PR before merging the current one."
1698519101,5059,chen-keinan,2023-08-30T05:32:03Z,"> > @thapabishwa thank you for the contribution lgtm 🚀 .
> > lets wait for #5019 to get approved and merged (will also solve the integration test issue)
> 
> Thanks @chen-keinan. Could you also take a look at [aquasecurity/trivy-kubernetes#215](https://github.com/aquasecurity/trivy-kubernetes/pull/215)? I think it might be beneficial for us to consider [aquasecurity/trivy-kubernetes#215](https://github.com/aquasecurity/trivy-kubernetes/pull/215) PR before merging the current one.

@thapabishwa  approved and merged , please update trivy-kubernetes version to `v0.5.7-0.20230830053006-95e88d51f82b` on go.mod file"
1698557368,5059,thapabishwa,2023-08-30T06:18:33Z,"> > > @thapabishwa thank you for the contribution lgtm 🚀 .
> > > lets wait for #5019 to get approved and merged (will also solve the integration test issue)
> > 
> > 
> > Thanks @chen-keinan. Could you also take a look at [aquasecurity/trivy-kubernetes#215](https://github.com/aquasecurity/trivy-kubernetes/pull/215)? I think it might be beneficial for us to consider [aquasecurity/trivy-kubernetes#215](https://github.com/aquasecurity/trivy-kubernetes/pull/215) PR before merging the current one.
> 
> @thapabishwa approved and merged , please update trivy-kubernetes version to `v0.5.7-0.20230830053006-95e88d51f82b` on go.mod file

Hey @chen-keinan. Sorry, I made some mistake on last PR to`trivy-kubernetes` library. 

Please take a look at this PR and let me know what you think about it. https://github.com/aquasecurity/trivy-kubernetes/pull/216"
1698576908,5059,chen-keinan,2023-08-30T06:33:10Z,"> > > > @thapabishwa thank you for the contribution lgtm 🚀 .
> > > > lets wait for #5019 to get approved and merged (will also solve the integration test issue)
> > > 
> > > 
> > > Thanks @chen-keinan. Could you also take a look at [aquasecurity/trivy-kubernetes#215](https://github.com/aquasecurity/trivy-kubernetes/pull/215)? I think it might be beneficial for us to consider [aquasecurity/trivy-kubernetes#215](https://github.com/aquasecurity/trivy-kubernetes/pull/215) PR before merging the current one.
> > 
> > 
> > @thapabishwa approved and merged , please update trivy-kubernetes version to `v0.5.7-0.20230830053006-95e88d51f82b` on go.mod file
> 
> Hey @chen-keinan. Sorry, I made some mistake on last PR to`trivy-kubernetes` library.
> 
> Please take a look at this PR and let me know what you think about it. [aquasecurity/trivy-kubernetes#216](https://github.com/aquasecurity/trivy-kubernetes/pull/216)

new tag for trivy-kubernetes: `v0.5.7-0.20230830063136-fe986af3f10f`"
1698582804,5059,thapabishwa,2023-08-30T06:39:03Z,"> v0.5.7-0.20230830063136-fe986af3f10f

@chen-keinan Thanks a lot. Appreciate your support and patience while I addressed the mistakes I made. It means a lot. Updated `go.mod` to new tag.

"
1700356616,5059,thapabishwa,2023-08-31T04:40:34Z,Rebased onto main to resolve `go.mod` and `go.sum` conflicts.
1700599417,5059,chen-keinan,2023-08-31T08:33:18Z,@thapabishwa Please rebase your branch with upstream and k8s integration test issue will be fixed
1700627629,5059,thapabishwa,2023-08-31T08:50:50Z,"> @thapabishwa Please rebase your branch with upstream and k8s integration test issue will be fixed

Thanks @chen-keinan . I've rebased the branch onto latest main. "
1700746261,5059,thapabishwa,2023-08-31T10:06:00Z,@chen-keinan @knqyf263 . I've addressed to all the comments. Please let me know once this is merged.
1700765063,5059,knqyf263,2023-08-31T10:17:58Z,Thanks
2044387371,6357,dus7eh,2024-04-09T08:03:31Z,"> Hello @dus7eh Thanks for your work!
> 
> Left comments. Take a look, please.
> 
> Also you need to update [docs](https://github.com/aquasecurity/trivy/blob/main/docs/docs/coverage/language/c.md) (use `mage docs:generate` command to see changes in browser) - V2 doesn't support dependency tree.
> 
> Regards, Dmitriy

Updated all mentioned issues"
2071482521,6357,knqyf263,2024-04-23T06:11:17Z,">Note 1: newer conan.lock contains fewer information in respect to its predecessor.
>This is described in https://github.com/conan-io/tribe/blob/main/design/034-new_lockfiles.md.
>Thus indirect dependencies are not flagged. Only requirements node is parsed.

It sounds like we need to parse `conanfile.txt` to identify direct dependencies. Please correct me if I'm wrong."
2071614090,6357,DmitriyLewen,2024-04-23T07:27:33Z,"lockfiles v2 doesn't contain info about child dependencies:
e.g. for [pulseaudio](https://conan.io/center/recipes/pulseaudio?version=17.0):
```
root@5acf6dd571c3:/app# cat conan.lock 
{
    ""version"": ""0.5"",
    ""requires"": [
        ""zlib/1.3.1#f52e03ae3d251dec704634230cd806a2%1708593606.497"",
        ""xorg/system#f626cbdd0ba57d9c53bce2d8b9362fad%1709213216.576"",
        ""vorbis/1.3.7#37e58f52e59a6232199b34ef402714a6%1699046045.52"",
        ""pulseaudio/17.0#8d7ad74a97a376caca6ef0a032d25ad3%1710538592.785"",
        ""opus/1.4#54631f551fc450783fb2df8cd63f80a2%1692264047.36"",
        ""openssl/3.2.1#c7b554068caae5eda12b735ea6f23d70%1712227628.919"",
        ""ogg/1.3.5#062626875f5c8c59f069f76f148098ef%1676030023.878"",
        ""mpg123/1.31.2#ce831c936b2284e2066ab3dc58a2628e%1697088458.795"",
        ""libsndfile/1.2.2#b3662f832e29507e8d9840a43737cc14%1701864257.026"",
        ""libmp3lame/3.100#44b12d19316eb2b223d98d3e75dae438%1674992501.853"",
        ""libiconv/1.17#73fefc1b696e069df90fd1d18aa63edd%1707122814.387"",
        ""libgettext/0.22#2c87563d7a69544dd9379f038aca3b0b%1692434363.136"",
        ""flac/1.4.2#6a17595ab773d2de32e18b5d3b24afff%1703803162.098""
    ],
    ""build_requires"": [
        ""pkgconf/2.1.0#27f44583701117b571307cf5b5fe5605%1701537936.436"",
        ""pkgconf/2.0.3#f996677e96e61e6552d85e83756c328b%1696606182.229"",
        ""ninja/1.11.1#77587f8c8318662ac8e5a7867eb4be21%1684431244.21"",
        ""meson/1.3.2#d1125ba555ec1a94f165a3412fdf7f88%1708699393.753"",
        ""meson/1.2.2#04bdfb85d665c82b08a3510aee3ffd19%1702568761.764"",
        ""m4/1.4.19#b38ced39a01e31fef5435bc634461fd2%1700758725.451"",
        ""gnu-config/cci.20210814#dc430d754f465e8c74463019672fb97b%1701248168.479""
    ],
    ""python_requires"": [],
    ""config_requires"": []
}
```

so it won't help users much. 
But `conan` supports `graph` - https://docs.conan.io/2/reference/commands/graph.html
<details> <summary> example </summary>

```json
{
    ""graph"": {
        ""nodes"": {
            ""0"": {
                ""ref"": ""conanfile"",
                ""id"": ""0"",
                ""recipe"": ""Consumer"",
                ""package_id"": null,
                ""prev"": null,
                ""rrev"": null,
                ""rrev_timestamp"": null,
                ""prev_timestamp"": null,
                ""remote"": null,
                ""binary_remote"": null,
                ""build_id"": null,
                ""binary"": null,
                ""invalid_build"": false,
                ""info_invalid"": null,
                ""name"": null,
                ""user"": null,
                ""channel"": null,
                ""url"": null,
                ""license"": null,
                ""author"": null,
                ""description"": null,
                ""homepage"": null,
                ""build_policy"": null,
                ""upload_policy"": null,
                ""revision_mode"": ""hash"",
                ""provides"": null,
                ""deprecated"": null,
                ""win_bash"": null,
                ""win_bash_run"": null,
                ""default_options"": null,
                ""options_description"": null,
                ""version"": null,
                ""topics"": null,
                ""package_type"": ""unknown"",
                ""settings"": {
                    ""os"": ""Linux"",
                    ""arch"": ""armv8"",
                    ""compiler"": ""gcc"",
                    ""compiler.cppstd"": ""gnu17"",
                    ""compiler.libcxx"": ""libstdc++11"",
                    ""compiler.version"": ""12"",
                    ""build_type"": ""Release""
                },
                ""options"": {},
                ""options_definitions"": {},
                ""generators"": [
                    ""CMakeDeps"",
                    ""CMakeToolchain""
                ],
                ""python_requires"": null,
                ""system_requires"": {},
                ""recipe_folder"": null,
                ""source_folder"": null,
                ""build_folder"": null,
                ""generators_folder"": null,
                ""package_folder"": null,
                ""cpp_info"": {
                    ""root"": {
                        ""includedirs"": [
                            ""include""
                        ],
                        ""srcdirs"": null,
                        ""libdirs"": [
                            ""lib""
                        ],
                        ""resdirs"": null,
                        ""bindirs"": [
                            ""bin""
                        ],
                        ""builddirs"": null,
                        ""frameworkdirs"": null,
                        ""system_libs"": null,
                        ""frameworks"": null,
                        ""libs"": null,
                        ""defines"": null,
                        ""cflags"": null,
                        ""cxxflags"": null,
                        ""sharedlinkflags"": null,
                        ""exelinkflags"": null,
                        ""objects"": null,
                        ""sysroot"": null,
                        ""requires"": null,
                        ""properties"": null
                    }
                },
                ""conf_info"": {},
                ""label"": ""conanfile.txt"",
                ""dependencies"": {
                    ""1"": {
                        ""ref"": ""pulseaudio/17.0"",
                        ""run"": true,
                        ""libs"": true,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": true,
                        ""package_id_mode"": null,
                        ""visible"": true
                    },
                    ""2"": {
                        ""ref"": ""libgettext/0.22"",
                        ""run"": false,
                        ""libs"": false,
                        ""skip"": true,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": false,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": null,
                        ""visible"": true
                    },
                    ""3"": {
                        ""ref"": ""libiconv/1.17"",
                        ""run"": false,
                        ""libs"": false,
                        ""skip"": true,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": false,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": null,
                        ""visible"": true
                    },
                    ""4"": {
                        ""ref"": ""libsndfile/1.2.2"",
                        ""run"": false,
                        ""libs"": false,
                        ""skip"": true,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": false,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": null,
                        ""visible"": true
                    },
                    ""6"": {
                        ""ref"": ""vorbis/1.3.7"",
                        ""run"": false,
                        ""libs"": false,
                        ""skip"": true,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": false,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": null,
                        ""visible"": true
                    },
                    ""7"": {
                        ""ref"": ""flac/1.4.2"",
                        ""run"": false,
                        ""libs"": false,
                        ""skip"": true,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": false,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": null,
                        ""visible"": true
                    },
                    ""5"": {
                        ""ref"": ""ogg/1.3.5"",
                        ""run"": false,
                        ""libs"": false,
                        ""skip"": true,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": false,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": null,
                        ""visible"": true
                    },
                    ""8"": {
                        ""ref"": ""opus/1.4"",
                        ""run"": false,
                        ""libs"": false,
                        ""skip"": true,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": false,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": null,
                        ""visible"": true
                    },
                    ""9"": {
                        ""ref"": ""mpg123/1.31.2"",
                        ""run"": false,
                        ""libs"": false,
                        ""skip"": true,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": false,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": null,
                        ""visible"": true
                    },
                    ""13"": {
                        ""ref"": ""libmp3lame/3.100"",
                        ""run"": false,
                        ""libs"": false,
                        ""skip"": true,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": false,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": null,
                        ""visible"": true
                    },
                    ""15"": {
                        ""ref"": ""xorg/system"",
                        ""run"": true,
                        ""libs"": false,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": false,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": null,
                        ""visible"": true
                    },
                    ""16"": {
                        ""ref"": ""openssl/3.2.1"",
                        ""run"": false,
                        ""libs"": false,
                        ""skip"": true,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": false,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": null,
                        ""visible"": true
                    },
                    ""17"": {
                        ""ref"": ""zlib/1.3.1"",
                        ""run"": false,
                        ""libs"": false,
                        ""skip"": true,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": false,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": null,
                        ""visible"": true
                    }
                },
                ""context"": ""host"",
                ""test"": false
            },
            ""1"": {
                ""ref"": ""pulseaudio/17.0#8d7ad74a97a376caca6ef0a032d25ad3"",
                ""id"": ""1"",
                ""recipe"": ""Cache"",
                ""package_id"": ""f6c7066ca0f97b28acb83b1cc0f18092072d6578"",
                ""prev"": null,
                ""rrev"": ""8d7ad74a97a376caca6ef0a032d25ad3"",
                ""rrev_timestamp"": 1710538592.785,
                ""prev_timestamp"": null,
                ""remote"": null,
                ""binary_remote"": null,
                ""build_id"": null,
                ""binary"": ""Missing"",
                ""invalid_build"": false,
                ""info_invalid"": null,
                ""name"": ""pulseaudio"",
                ""user"": null,
                ""channel"": null,
                ""url"": ""https://github.com/conan-io/conan-center-index"",
                ""license"": ""LGPL-2.1"",
                ""author"": null,
                ""description"": ""PulseAudio is a sound system for POSIX OSes, meaning that it is a proxy for sound applications."",
                ""homepage"": ""http://pulseaudio.org/"",
                ""build_policy"": null,
                ""upload_policy"": null,
                ""revision_mode"": ""hash"",
                ""provides"": null,
                ""deprecated"": null,
                ""win_bash"": null,
                ""win_bash_run"": null,
                ""default_options"": {
                    ""with_glib"": false,
                    ""with_fftw"": false,
                    ""with_x11"": true,
                    ""with_openssl"": true,
                    ""with_dbus"": false
                },
                ""options_description"": null,
                ""version"": ""17.0"",
                ""topics"": [
                    ""sound"",
                    ""audio"",
                    ""sound-server""
                ],
                ""package_type"": ""shared-library"",
                ""settings"": {
                    ""os"": ""Linux"",
                    ""arch"": ""armv8"",
                    ""compiler"": ""gcc"",
                    ""compiler.version"": ""12"",
                    ""build_type"": ""Release""
                },
                ""options"": {
                    ""with_dbus"": ""False"",
                    ""with_glib"": ""False"",
                    ""with_openssl"": ""True"",
                    ""with_x11"": ""True""
                },
                ""options_definitions"": {
                    ""with_glib"": [
                        ""True"",
                        ""False""
                    ],
                    ""with_x11"": [
                        ""True"",
                        ""False""
                    ],
                    ""with_openssl"": [
                        ""True"",
                        ""False""
                    ],
                    ""with_dbus"": [
                        ""True"",
                        ""False""
                    ]
                },
                ""generators"": [],
                ""python_requires"": null,
                ""system_requires"": {},
                ""recipe_folder"": ""/root/.conan2/p/pulsee2b7eff0be0d2/e"",
                ""source_folder"": null,
                ""build_folder"": null,
                ""generators_folder"": null,
                ""package_folder"": null,
                ""cpp_info"": {
                    ""root"": {
                        ""includedirs"": [
                            ""include""
                        ],
                        ""srcdirs"": null,
                        ""libdirs"": [
                            ""lib""
                        ],
                        ""resdirs"": null,
                        ""bindirs"": [
                            ""bin""
                        ],
                        ""builddirs"": null,
                        ""frameworkdirs"": null,
                        ""system_libs"": null,
                        ""frameworks"": null,
                        ""libs"": null,
                        ""defines"": null,
                        ""cflags"": null,
                        ""cxxflags"": null,
                        ""sharedlinkflags"": null,
                        ""exelinkflags"": null,
                        ""objects"": null,
                        ""sysroot"": null,
                        ""requires"": null,
                        ""properties"": null
                    }
                },
                ""conf_info"": {},
                ""label"": ""pulseaudio/17.0"",
                ""info"": {
                    ""settings"": {
                        ""os"": ""Linux"",
                        ""arch"": ""armv8"",
                        ""compiler"": ""gcc"",
                        ""compiler.version"": ""12"",
                        ""build_type"": ""Release""
                    },
                    ""options"": {
                        ""with_dbus"": ""False"",
                        ""with_glib"": ""False"",
                        ""with_openssl"": ""True"",
                        ""with_x11"": ""True""
                    },
                    ""requires"": [
                        ""libgettext/0.22#2c87563d7a69544dd9379f038aca3b0b:41e721d904c9ddcfa663c4fb15ecba9da7057704"",
                        ""libiconv/1.17#73fefc1b696e069df90fd1d18aa63edd:7e0918accf1698c5e54c34e18764ad9156b62d25"",
                        ""libsndfile/1.2.2#b3662f832e29507e8d9840a43737cc14:bd5b48e622e983e94e2cf5da5618d44bf5983f49"",
                        ""vorbis/1.3.7#37e58f52e59a6232199b34ef402714a6:b30f0b06917112843bb7972037aa6e8ca1463ef3"",
                        ""flac/1.4.2#6a17595ab773d2de32e18b5d3b24afff:06cc7ca96b14b2063dfeeeb23a530cca2e65b644"",
                        ""ogg/1.3.5#062626875f5c8c59f069f76f148098ef:7e0918accf1698c5e54c34e18764ad9156b62d25"",
                        ""opus/1.4#54631f551fc450783fb2df8cd63f80a2:5b7cfe3a19ddb78609cc708138bb9ebd4d24c1a7"",
                        ""mpg123/1.31.2#ce831c936b2284e2066ab3dc58a2628e:0bc5cf269869489db05381698a16d7fd566053c1"",
                        ""libmp3lame/3.100#44b12d19316eb2b223d98d3e75dae438:7e0918accf1698c5e54c34e18764ad9156b62d25"",
                        ""xorg/system"",
                        ""openssl/3.2.1#c7b554068caae5eda12b735ea6f23d70:469765602cb39c441c3f8afb43977bb72b8b9a93"",
                        ""zlib/1.3.1#f52e03ae3d251dec704634230cd806a2:7e0918accf1698c5e54c34e18764ad9156b62d25""
                    ]
                },
                ""dependencies"": {
                    ""2"": {
                        ""ref"": ""libgettext/0.22"",
                        ""run"": false,
                        ""libs"": true,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": true,
                        ""package_id_mode"": ""full_mode"",
                        ""visible"": true
                    },
                    ""3"": {
                        ""ref"": ""libiconv/1.17"",
                        ""run"": false,
                        ""libs"": true,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": true,
                        ""package_id_mode"": ""full_mode"",
                        ""visible"": true
                    },
                    ""4"": {
                        ""ref"": ""libsndfile/1.2.2"",
                        ""run"": false,
                        ""libs"": true,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": true,
                        ""package_id_mode"": ""full_mode"",
                        ""visible"": true
                    },
                    ""6"": {
                        ""ref"": ""vorbis/1.3.7"",
                        ""run"": false,
                        ""libs"": true,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": false,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": ""full_mode"",
                        ""visible"": true
                    },
                    ""7"": {
                        ""ref"": ""flac/1.4.2"",
                        ""run"": false,
                        ""libs"": true,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": false,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": ""full_mode"",
                        ""visible"": true
                    },
                    ""5"": {
                        ""ref"": ""ogg/1.3.5"",
                        ""run"": false,
                        ""libs"": true,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": false,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": ""full_mode"",
                        ""visible"": true
                    },
                    ""8"": {
                        ""ref"": ""opus/1.4"",
                        ""run"": false,
                        ""libs"": true,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": false,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": ""full_mode"",
                        ""visible"": true
                    },
                    ""9"": {
                        ""ref"": ""mpg123/1.31.2"",
                        ""run"": false,
                        ""libs"": true,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": false,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": ""full_mode"",
                        ""visible"": true
                    },
                    ""13"": {
                        ""ref"": ""libmp3lame/3.100"",
                        ""run"": false,
                        ""libs"": true,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": false,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": ""full_mode"",
                        ""visible"": true
                    },
                    ""15"": {
                        ""ref"": ""xorg/system"",
                        ""run"": true,
                        ""libs"": true,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": true,
                        ""package_id_mode"": ""minor_mode"",
                        ""visible"": true
                    },
                    ""16"": {
                        ""ref"": ""openssl/3.2.1"",
                        ""run"": false,
                        ""libs"": true,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": true,
                        ""package_id_mode"": ""full_mode"",
                        ""visible"": true
                    },
                    ""17"": {
                        ""ref"": ""zlib/1.3.1"",
                        ""run"": false,
                        ""libs"": true,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": false,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": ""full_mode"",
                        ""visible"": true
                    },
                    ""18"": {
                        ""ref"": ""m4/1.4.19"",
                        ""run"": true,
                        ""libs"": false,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": true,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": null,
                        ""visible"": false
                    },
                    ""19"": {
                        ""ref"": ""meson/1.3.2"",
                        ""run"": true,
                        ""libs"": false,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": true,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": null,
                        ""visible"": false
                    },
                    ""20"": {
                        ""ref"": ""ninja/1.11.1"",
                        ""run"": true,
                        ""libs"": false,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": false,
                        ""build"": true,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": null,
                        ""visible"": false
                    },
                    ""21"": {
                        ""ref"": ""pkgconf/2.1.0"",
                        ""run"": true,
                        ""libs"": false,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": true,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": null,
                        ""visible"": false
                    }
                },
                ""context"": ""host"",
                ""test"": false
            },
            ""2"": {
                ""ref"": ""libgettext/0.22#2c87563d7a69544dd9379f038aca3b0b"",
                ""id"": ""2"",
                ""recipe"": ""Cache"",
                ""package_id"": ""41e721d904c9ddcfa663c4fb15ecba9da7057704"",
                ""prev"": null,
                ""rrev"": ""2c87563d7a69544dd9379f038aca3b0b"",
                ""rrev_timestamp"": 1692434363.136,
                ""prev_timestamp"": null,
                ""remote"": null,
                ""binary_remote"": null,
                ""build_id"": null,
                ""binary"": ""Skip"",
                ""invalid_build"": false,
                ""info_invalid"": null,
                ""name"": ""libgettext"",
                ""user"": null,
                ""channel"": null,
                ""url"": ""https://github.com/conan-io/conan-center-index"",
                ""license"": ""LGPL-2.1-or-later"",
                ""author"": null,
                ""description"": ""An internationalization and localization system for multilingual programs"",
                ""homepage"": ""https://www.gnu.org/software/gettext"",
                ""build_policy"": null,
                ""upload_policy"": null,
                ""revision_mode"": ""hash"",
                ""provides"": null,
                ""deprecated"": null,
                ""win_bash"": null,
                ""win_bash_run"": null,
                ""default_options"": {
                    ""shared"": false,
                    ""fPIC"": true
                },
                ""options_description"": null,
                ""version"": ""0.22"",
                ""topics"": [
                    ""gettext"",
                    ""intl"",
                    ""libintl"",
                    ""i18n""
                ],
                ""package_type"": ""static-library"",
                ""settings"": {
                    ""os"": ""Linux"",
                    ""arch"": ""armv8"",
                    ""compiler"": ""gcc"",
                    ""compiler.version"": ""12"",
                    ""build_type"": ""Release""
                },
                ""options"": {
                    ""fPIC"": ""True"",
                    ""shared"": ""False"",
                    ""threads"": ""posix""
                },
                ""options_definitions"": {
                    ""shared"": [
                        ""True"",
                        ""False""
                    ],
                    ""fPIC"": [
                        ""True"",
                        ""False""
                    ],
                    ""threads"": [
                        ""posix"",
                        ""solaris"",
                        ""pth"",
                        ""windows"",
                        ""disabled""
                    ]
                },
                ""generators"": [],
                ""python_requires"": null,
                ""system_requires"": {},
                ""recipe_folder"": ""/root/.conan2/p/libge7dd78f22d4081/e"",
                ""source_folder"": null,
                ""build_folder"": null,
                ""generators_folder"": null,
                ""package_folder"": null,
                ""cpp_info"": {
                    ""root"": {
                        ""includedirs"": [
                            ""include""
                        ],
                        ""srcdirs"": null,
                        ""libdirs"": [
                            ""lib""
                        ],
                        ""resdirs"": null,
                        ""bindirs"": [
                            ""bin""
                        ],
                        ""builddirs"": null,
                        ""frameworkdirs"": null,
                        ""system_libs"": null,
                        ""frameworks"": null,
                        ""libs"": null,
                        ""defines"": null,
                        ""cflags"": null,
                        ""cxxflags"": null,
                        ""sharedlinkflags"": null,
                        ""exelinkflags"": null,
                        ""objects"": null,
                        ""sysroot"": null,
                        ""requires"": null,
                        ""properties"": null
                    }
                },
                ""conf_info"": {},
                ""label"": ""libgettext/0.22"",
                ""info"": {
                    ""settings"": {
                        ""os"": ""Linux"",
                        ""arch"": ""armv8"",
                        ""compiler"": ""gcc"",
                        ""compiler.version"": ""12"",
                        ""build_type"": ""Release""
                    },
                    ""options"": {
                        ""fPIC"": ""True"",
                        ""shared"": ""False"",
                        ""threads"": ""posix""
                    },
                    ""requires"": [
                        ""libiconv/1.17.Z""
                    ]
                },
                ""dependencies"": {
                    ""3"": {
                        ""ref"": ""libiconv/1.17"",
                        ""run"": false,
                        ""libs"": true,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": true,
                        ""package_id_mode"": ""minor_mode"",
                        ""visible"": true
                    }
                },
                ""context"": ""host"",
                ""test"": false
            },
            ""3"": {
                ""ref"": ""libiconv/1.17#73fefc1b696e069df90fd1d18aa63edd"",
                ""id"": ""3"",
                ""recipe"": ""Cache"",
                ""package_id"": ""7e0918accf1698c5e54c34e18764ad9156b62d25"",
                ""prev"": null,
                ""rrev"": ""73fefc1b696e069df90fd1d18aa63edd"",
                ""rrev_timestamp"": 1707122814.387,
                ""prev_timestamp"": null,
                ""remote"": null,
                ""binary_remote"": null,
                ""build_id"": null,
                ""binary"": ""Skip"",
                ""invalid_build"": false,
                ""info_invalid"": null,
                ""name"": ""libiconv"",
                ""user"": null,
                ""channel"": null,
                ""url"": ""https://github.com/conan-io/conan-center-index"",
                ""license"": ""LGPL-2.1-or-later"",
                ""author"": null,
                ""description"": ""Convert text to and from Unicode"",
                ""homepage"": ""https://www.gnu.org/software/libiconv/"",
                ""build_policy"": null,
                ""upload_policy"": null,
                ""revision_mode"": ""hash"",
                ""provides"": null,
                ""deprecated"": null,
                ""win_bash"": null,
                ""win_bash_run"": null,
                ""default_options"": {
                    ""shared"": false,
                    ""fPIC"": true
                },
                ""options_description"": null,
                ""version"": ""1.17"",
                ""topics"": [
                    ""iconv"",
                    ""text"",
                    ""encoding"",
                    ""locale"",
                    ""unicode"",
                    ""conversion""
                ],
                ""package_type"": ""static-library"",
                ""settings"": {
                    ""os"": ""Linux"",
                    ""arch"": ""armv8"",
                    ""compiler"": ""gcc"",
                    ""compiler.version"": ""12"",
                    ""build_type"": ""Release""
                },
                ""options"": {
                    ""fPIC"": ""True"",
                    ""shared"": ""False""
                },
                ""options_definitions"": {
                    ""shared"": [
                        ""True"",
                        ""False""
                    ],
                    ""fPIC"": [
                        ""True"",
                        ""False""
                    ]
                },
                ""generators"": [],
                ""python_requires"": null,
                ""system_requires"": {},
                ""recipe_folder"": ""/root/.conan2/p/libic9912aaea08621/e"",
                ""source_folder"": null,
                ""build_folder"": null,
                ""generators_folder"": null,
                ""package_folder"": null,
                ""cpp_info"": {
                    ""root"": {
                        ""includedirs"": [
                            ""include""
                        ],
                        ""srcdirs"": null,
                        ""libdirs"": [
                            ""lib""
                        ],
                        ""resdirs"": null,
                        ""bindirs"": [
                            ""bin""
                        ],
                        ""builddirs"": null,
                        ""frameworkdirs"": null,
                        ""system_libs"": null,
                        ""frameworks"": null,
                        ""libs"": null,
                        ""defines"": null,
                        ""cflags"": null,
                        ""cxxflags"": null,
                        ""sharedlinkflags"": null,
                        ""exelinkflags"": null,
                        ""objects"": null,
                        ""sysroot"": null,
                        ""requires"": null,
                        ""properties"": null
                    }
                },
                ""conf_info"": {},
                ""label"": ""libiconv/1.17"",
                ""info"": {
                    ""settings"": {
                        ""os"": ""Linux"",
                        ""arch"": ""armv8"",
                        ""compiler"": ""gcc"",
                        ""compiler.version"": ""12"",
                        ""build_type"": ""Release""
                    },
                    ""options"": {
                        ""fPIC"": ""True"",
                        ""shared"": ""False""
                    }
                },
                ""dependencies"": {},
                ""context"": ""host"",
                ""test"": false
            },
            ""4"": {
                ""ref"": ""libsndfile/1.2.2#b3662f832e29507e8d9840a43737cc14"",
                ""id"": ""4"",
                ""recipe"": ""Cache"",
                ""package_id"": ""bd5b48e622e983e94e2cf5da5618d44bf5983f49"",
                ""prev"": null,
                ""rrev"": ""b3662f832e29507e8d9840a43737cc14"",
                ""rrev_timestamp"": 1701864257.026,
                ""prev_timestamp"": null,
                ""remote"": null,
                ""binary_remote"": null,
                ""build_id"": null,
                ""binary"": ""Skip"",
                ""invalid_build"": false,
                ""info_invalid"": null,
                ""name"": ""libsndfile"",
                ""user"": null,
                ""channel"": null,
                ""url"": ""https://github.com/conan-io/conan-center-index"",
                ""license"": ""LGPL-2.1"",
                ""author"": null,
                ""description"": ""Libsndfile is a library of C routines for reading and writing files containing sampled audio data."",
                ""homepage"": ""http://www.mega-nerd.com/libsndfile"",
                ""build_policy"": null,
                ""upload_policy"": null,
                ""revision_mode"": ""hash"",
                ""provides"": null,
                ""deprecated"": null,
                ""win_bash"": null,
                ""win_bash_run"": null,
                ""default_options"": {
                    ""shared"": false,
                    ""fPIC"": true,
                    ""programs"": true,
                    ""experimental"": false,
                    ""with_alsa"": false,
                    ""with_external_libs"": true,
                    ""with_mpeg"": true
                },
                ""options_description"": null,
                ""version"": ""1.2.2"",
                ""topics"": [
                    ""audio""
                ],
                ""package_type"": ""static-library"",
                ""settings"": {
                    ""os"": ""Linux"",
                    ""arch"": ""armv8"",
                    ""compiler"": ""gcc"",
                    ""compiler.cppstd"": ""gnu17"",
                    ""compiler.libcxx"": ""libstdc++11"",
                    ""compiler.version"": ""12"",
                    ""build_type"": ""Release""
                },
                ""options"": {
                    ""experimental"": ""False"",
                    ""fPIC"": ""True"",
                    ""programs"": ""True"",
                    ""shared"": ""False"",
                    ""with_alsa"": ""False"",
                    ""with_external_libs"": ""True"",
                    ""with_mpeg"": ""True""
                },
                ""options_definitions"": {
                    ""shared"": [
                        ""True"",
                        ""False""
                    ],
                    ""fPIC"": [
                        ""True"",
                        ""False""
                    ],
                    ""programs"": [
                        ""True"",
                        ""False""
                    ],
                    ""experimental"": [
                        ""True"",
                        ""False""
                    ],
                    ""with_alsa"": [
                        ""True"",
                        ""False""
                    ],
                    ""with_external_libs"": [
                        ""True"",
                        ""False""
                    ],
                    ""with_mpeg"": [
                        ""True"",
                        ""False""
                    ]
                },
                ""generators"": [],
                ""python_requires"": null,
                ""system_requires"": {},
                ""recipe_folder"": ""/root/.conan2/p/libsn6145c76fe38ac/e"",
                ""source_folder"": null,
                ""build_folder"": null,
                ""generators_folder"": null,
                ""package_folder"": null,
                ""cpp_info"": {
                    ""root"": {
                        ""includedirs"": [
                            ""include""
                        ],
                        ""srcdirs"": null,
                        ""libdirs"": [
                            ""lib""
                        ],
                        ""resdirs"": null,
                        ""bindirs"": [
                            ""bin""
                        ],
                        ""builddirs"": null,
                        ""frameworkdirs"": null,
                        ""system_libs"": null,
                        ""frameworks"": null,
                        ""libs"": null,
                        ""defines"": null,
                        ""cflags"": null,
                        ""cxxflags"": null,
                        ""sharedlinkflags"": null,
                        ""exelinkflags"": null,
                        ""objects"": null,
                        ""sysroot"": null,
                        ""requires"": null,
                        ""properties"": null
                    }
                },
                ""conf_info"": {},
                ""label"": ""libsndfile/1.2.2"",
                ""info"": {
                    ""settings"": {
                        ""os"": ""Linux"",
                        ""arch"": ""armv8"",
                        ""compiler"": ""gcc"",
                        ""compiler.cppstd"": ""gnu17"",
                        ""compiler.libcxx"": ""libstdc++11"",
                        ""compiler.version"": ""12"",
                        ""build_type"": ""Release""
                    },
                    ""options"": {
                        ""experimental"": ""False"",
                        ""fPIC"": ""True"",
                        ""programs"": ""True"",
                        ""shared"": ""False"",
                        ""with_alsa"": ""False"",
                        ""with_external_libs"": ""True"",
                        ""with_mpeg"": ""True""
                    },
                    ""requires"": [
                        ""vorbis/1.3.Z"",
                        ""flac/1.4.Z"",
                        ""ogg/1.3.Z"",
                        ""opus/1.4.Z"",
                        ""mpg123/1.31.Z"",
                        ""libmp3lame/3.100.Z""
                    ]
                },
                ""dependencies"": {
                    ""6"": {
                        ""ref"": ""vorbis/1.3.7"",
                        ""run"": false,
                        ""libs"": true,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": true,
                        ""package_id_mode"": ""minor_mode"",
                        ""visible"": true
                    },
                    ""7"": {
                        ""ref"": ""flac/1.4.2"",
                        ""run"": false,
                        ""libs"": true,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": true,
                        ""package_id_mode"": ""minor_mode"",
                        ""visible"": true
                    },
                    ""5"": {
                        ""ref"": ""ogg/1.3.5"",
                        ""run"": false,
                        ""libs"": true,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": true,
                        ""package_id_mode"": ""minor_mode"",
                        ""visible"": true
                    },
                    ""8"": {
                        ""ref"": ""opus/1.4"",
                        ""run"": false,
                        ""libs"": true,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": true,
                        ""package_id_mode"": ""minor_mode"",
                        ""visible"": true
                    },
                    ""9"": {
                        ""ref"": ""mpg123/1.31.2"",
                        ""run"": false,
                        ""libs"": true,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": true,
                        ""package_id_mode"": ""minor_mode"",
                        ""visible"": true
                    },
                    ""13"": {
                        ""ref"": ""libmp3lame/3.100"",
                        ""run"": false,
                        ""libs"": true,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": true,
                        ""package_id_mode"": ""minor_mode"",
                        ""visible"": true
                    }
                },
                ""context"": ""host"",
                ""test"": false
            },
            ""5"": {
                ""ref"": ""ogg/1.3.5#062626875f5c8c59f069f76f148098ef"",
                ""id"": ""5"",
                ""recipe"": ""Cache"",
                ""package_id"": ""7e0918accf1698c5e54c34e18764ad9156b62d25"",
                ""prev"": null,
                ""rrev"": ""062626875f5c8c59f069f76f148098ef"",
                ""rrev_timestamp"": 1676030023.878,
                ""prev_timestamp"": null,
                ""remote"": null,
                ""binary_remote"": null,
                ""build_id"": null,
                ""binary"": ""Skip"",
                ""invalid_build"": false,
                ""info_invalid"": null,
                ""name"": ""ogg"",
                ""user"": null,
                ""channel"": null,
                ""url"": ""https://github.com/conan-io/conan-center-index"",
                ""license"": ""BSD-2-Clause"",
                ""author"": null,
                ""description"": ""The OGG library"",
                ""homepage"": ""https://github.com/xiph/ogg"",
                ""build_policy"": null,
                ""upload_policy"": null,
                ""revision_mode"": ""hash"",
                ""provides"": null,
                ""deprecated"": null,
                ""win_bash"": null,
                ""win_bash_run"": null,
                ""default_options"": {
                    ""shared"": false,
                    ""fPIC"": true
                },
                ""options_description"": null,
                ""version"": ""1.3.5"",
                ""topics"": [
                    ""codec"",
                    ""audio"",
                    ""lossless""
                ],
                ""package_type"": ""static-library"",
                ""settings"": {
                    ""os"": ""Linux"",
                    ""arch"": ""armv8"",
                    ""compiler"": ""gcc"",
                    ""compiler.version"": ""12"",
                    ""build_type"": ""Release""
                },
                ""options"": {
                    ""fPIC"": ""True"",
                    ""shared"": ""False""
                },
                ""options_definitions"": {
                    ""shared"": [
                        ""True"",
                        ""False""
                    ],
                    ""fPIC"": [
                        ""True"",
                        ""False""
                    ]
                },
                ""generators"": [],
                ""python_requires"": null,
                ""system_requires"": {},
                ""recipe_folder"": ""/root/.conan2/p/ogg09f0a2947bfb4/e"",
                ""source_folder"": null,
                ""build_folder"": null,
                ""generators_folder"": null,
                ""package_folder"": null,
                ""cpp_info"": {
                    ""root"": {
                        ""includedirs"": [
                            ""include""
                        ],
                        ""srcdirs"": null,
                        ""libdirs"": [
                            ""lib""
                        ],
                        ""resdirs"": null,
                        ""bindirs"": [
                            ""bin""
                        ],
                        ""builddirs"": null,
                        ""frameworkdirs"": null,
                        ""system_libs"": null,
                        ""frameworks"": null,
                        ""libs"": null,
                        ""defines"": null,
                        ""cflags"": null,
                        ""cxxflags"": null,
                        ""sharedlinkflags"": null,
                        ""exelinkflags"": null,
                        ""objects"": null,
                        ""sysroot"": null,
                        ""requires"": null,
                        ""properties"": null
                    }
                },
                ""conf_info"": {},
                ""label"": ""ogg/1.3.5"",
                ""info"": {
                    ""settings"": {
                        ""os"": ""Linux"",
                        ""arch"": ""armv8"",
                        ""compiler"": ""gcc"",
                        ""compiler.version"": ""12"",
                        ""build_type"": ""Release""
                    },
                    ""options"": {
                        ""fPIC"": ""True"",
                        ""shared"": ""False""
                    }
                },
                ""dependencies"": {},
                ""context"": ""host"",
                ""test"": false
            },
            ""6"": {
                ""ref"": ""vorbis/1.3.7#37e58f52e59a6232199b34ef402714a6"",
                ""id"": ""6"",
                ""recipe"": ""Cache"",
                ""package_id"": ""b30f0b06917112843bb7972037aa6e8ca1463ef3"",
                ""prev"": null,
                ""rrev"": ""37e58f52e59a6232199b34ef402714a6"",
                ""rrev_timestamp"": 1699046045.52,
                ""prev_timestamp"": null,
                ""remote"": null,
                ""binary_remote"": null,
                ""build_id"": null,
                ""binary"": ""Skip"",
                ""invalid_build"": false,
                ""info_invalid"": null,
                ""name"": ""vorbis"",
                ""user"": null,
                ""channel"": null,
                ""url"": ""https://github.com/conan-io/conan-center-index"",
                ""license"": ""BSD-3-Clause"",
                ""author"": null,
                ""description"": ""The VORBIS audio codec library"",
                ""homepage"": ""https://xiph.org/vorbis/"",
                ""build_policy"": null,
                ""upload_policy"": null,
                ""revision_mode"": ""hash"",
                ""provides"": null,
                ""deprecated"": null,
                ""win_bash"": null,
                ""win_bash_run"": null,
                ""default_options"": {
                    ""shared"": false,
                    ""fPIC"": true
                },
                ""options_description"": null,
                ""version"": ""1.3.7"",
                ""topics"": [
                    ""audio"",
                    ""codec""
                ],
                ""package_type"": ""static-library"",
                ""settings"": {
                    ""os"": ""Linux"",
                    ""arch"": ""armv8"",
                    ""compiler"": ""gcc"",
                    ""compiler.version"": ""12"",
                    ""build_type"": ""Release""
                },
                ""options"": {
                    ""fPIC"": ""True"",
                    ""shared"": ""False""
                },
                ""options_definitions"": {
                    ""shared"": [
                        ""True"",
                        ""False""
                    ],
                    ""fPIC"": [
                        ""True"",
                        ""False""
                    ]
                },
                ""generators"": [],
                ""python_requires"": null,
                ""system_requires"": {},
                ""recipe_folder"": ""/root/.conan2/p/vorbi17ae576c72ece/e"",
                ""source_folder"": null,
                ""build_folder"": null,
                ""generators_folder"": null,
                ""package_folder"": null,
                ""cpp_info"": {
                    ""root"": {
                        ""includedirs"": [
                            ""include""
                        ],
                        ""srcdirs"": null,
                        ""libdirs"": [
                            ""lib""
                        ],
                        ""resdirs"": null,
                        ""bindirs"": [
                            ""bin""
                        ],
                        ""builddirs"": null,
                        ""frameworkdirs"": null,
                        ""system_libs"": null,
                        ""frameworks"": null,
                        ""libs"": null,
                        ""defines"": null,
                        ""cflags"": null,
                        ""cxxflags"": null,
                        ""sharedlinkflags"": null,
                        ""exelinkflags"": null,
                        ""objects"": null,
                        ""sysroot"": null,
                        ""requires"": null,
                        ""properties"": null
                    }
                },
                ""conf_info"": {},
                ""label"": ""vorbis/1.3.7"",
                ""info"": {
                    ""settings"": {
                        ""os"": ""Linux"",
                        ""arch"": ""armv8"",
                        ""compiler"": ""gcc"",
                        ""compiler.version"": ""12"",
                        ""build_type"": ""Release""
                    },
                    ""options"": {
                        ""fPIC"": ""True"",
                        ""shared"": ""False""
                    },
                    ""requires"": [
                        ""ogg/1.3.Z""
                    ]
                },
                ""dependencies"": {
                    ""5"": {
                        ""ref"": ""ogg/1.3.5"",
                        ""run"": false,
                        ""libs"": true,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": false,
                        ""transitive_headers"": true,
                        ""transitive_libs"": true,
                        ""headers"": true,
                        ""package_id_mode"": ""minor_mode"",
                        ""visible"": true
                    }
                },
                ""context"": ""host"",
                ""test"": false
            },
            ""7"": {
                ""ref"": ""flac/1.4.2#6a17595ab773d2de32e18b5d3b24afff"",
                ""id"": ""7"",
                ""recipe"": ""Cache"",
                ""package_id"": ""06cc7ca96b14b2063dfeeeb23a530cca2e65b644"",
                ""prev"": null,
                ""rrev"": ""6a17595ab773d2de32e18b5d3b24afff"",
                ""rrev_timestamp"": 1703803162.098,
                ""prev_timestamp"": null,
                ""remote"": null,
                ""binary_remote"": null,
                ""build_id"": null,
                ""binary"": ""Skip"",
                ""invalid_build"": false,
                ""info_invalid"": null,
                ""name"": ""flac"",
                ""user"": null,
                ""channel"": null,
                ""url"": ""https://github.com/conan-io/conan-center-index"",
                ""license"": [
                    ""BSD-3-Clause"",
                    ""GPL-2.0-or-later"",
                    ""LPGL-2.1-or-later"",
                    ""GFDL-1.2""
                ],
                ""author"": null,
                ""description"": ""Free Lossless Audio Codec"",
                ""homepage"": ""https://github.com/xiph/flac"",
                ""build_policy"": null,
                ""upload_policy"": null,
                ""revision_mode"": ""hash"",
                ""provides"": null,
                ""deprecated"": null,
                ""win_bash"": null,
                ""win_bash_run"": null,
                ""default_options"": {
                    ""shared"": false,
                    ""fPIC"": true
                },
                ""options_description"": null,
                ""version"": ""1.4.2"",
                ""topics"": [
                    ""flac"",
                    ""codec"",
                    ""audio""
                ],
                ""package_type"": ""static-library"",
                ""settings"": {
                    ""os"": ""Linux"",
                    ""arch"": ""armv8"",
                    ""compiler"": ""gcc"",
                    ""compiler.cppstd"": ""gnu17"",
                    ""compiler.libcxx"": ""libstdc++11"",
                    ""compiler.version"": ""12"",
                    ""build_type"": ""Release""
                },
                ""options"": {
                    ""fPIC"": ""True"",
                    ""shared"": ""False""
                },
                ""options_definitions"": {
                    ""shared"": [
                        ""True"",
                        ""False""
                    ],
                    ""fPIC"": [
                        ""True"",
                        ""False""
                    ]
                },
                ""generators"": [],
                ""python_requires"": null,
                ""system_requires"": {},
                ""recipe_folder"": ""/root/.conan2/p/flacb637da3308530/e"",
                ""source_folder"": null,
                ""build_folder"": null,
                ""generators_folder"": null,
                ""package_folder"": null,
                ""cpp_info"": {
                    ""root"": {
                        ""includedirs"": [
                            ""include""
                        ],
                        ""srcdirs"": null,
                        ""libdirs"": [
                            ""lib""
                        ],
                        ""resdirs"": null,
                        ""bindirs"": [
                            ""bin""
                        ],
                        ""builddirs"": null,
                        ""frameworkdirs"": null,
                        ""system_libs"": null,
                        ""frameworks"": null,
                        ""libs"": null,
                        ""defines"": null,
                        ""cflags"": null,
                        ""cxxflags"": null,
                        ""sharedlinkflags"": null,
                        ""exelinkflags"": null,
                        ""objects"": null,
                        ""sysroot"": null,
                        ""requires"": null,
                        ""properties"": null
                    }
                },
                ""conf_info"": {},
                ""label"": ""flac/1.4.2"",
                ""info"": {
                    ""settings"": {
                        ""os"": ""Linux"",
                        ""arch"": ""armv8"",
                        ""compiler"": ""gcc"",
                        ""compiler.cppstd"": ""gnu17"",
                        ""compiler.libcxx"": ""libstdc++11"",
                        ""compiler.version"": ""12"",
                        ""build_type"": ""Release""
                    },
                    ""options"": {
                        ""fPIC"": ""True"",
                        ""shared"": ""False""
                    },
                    ""requires"": [
                        ""ogg/1.3.Z""
                    ]
                },
                ""dependencies"": {
                    ""5"": {
                        ""ref"": ""ogg/1.3.5"",
                        ""run"": false,
                        ""libs"": true,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": true,
                        ""package_id_mode"": ""minor_mode"",
                        ""visible"": true
                    }
                },
                ""context"": ""host"",
                ""test"": false
            },
            ""8"": {
                ""ref"": ""opus/1.4#54631f551fc450783fb2df8cd63f80a2"",
                ""id"": ""8"",
                ""recipe"": ""Cache"",
                ""package_id"": ""5b7cfe3a19ddb78609cc708138bb9ebd4d24c1a7"",
                ""prev"": null,
                ""rrev"": ""54631f551fc450783fb2df8cd63f80a2"",
                ""rrev_timestamp"": 1692264047.36,
                ""prev_timestamp"": null,
                ""remote"": null,
                ""binary_remote"": null,
                ""build_id"": null,
                ""binary"": ""Skip"",
                ""invalid_build"": false,
                ""info_invalid"": null,
                ""name"": ""opus"",
                ""user"": null,
                ""channel"": null,
                ""url"": ""https://github.com/conan-io/conan-center-index"",
                ""license"": ""BSD-3-Clause"",
                ""author"": null,
                ""description"": ""Opus is a totally open, royalty-free, highly versatile audio codec."",
                ""homepage"": ""https://opus-codec.org"",
                ""build_policy"": null,
                ""upload_policy"": null,
                ""revision_mode"": ""hash"",
                ""provides"": null,
                ""deprecated"": null,
                ""win_bash"": null,
                ""win_bash_run"": null,
                ""default_options"": {
                    ""shared"": false,
                    ""fPIC"": true,
                    ""fixed_point"": false,
                    ""stack_protector"": true
                },
                ""options_description"": null,
                ""version"": ""1.4"",
                ""topics"": [
                    ""opus"",
                    ""audio"",
                    ""decoder"",
                    ""decoding"",
                    ""multimedia"",
                    ""sound""
                ],
                ""package_type"": ""static-library"",
                ""settings"": {
                    ""os"": ""Linux"",
                    ""arch"": ""armv8"",
                    ""compiler"": ""gcc"",
                    ""compiler.version"": ""12"",
                    ""build_type"": ""Release""
                },
                ""options"": {
                    ""fPIC"": ""True"",
                    ""fixed_point"": ""False"",
                    ""shared"": ""False"",
                    ""stack_protector"": ""True""
                },
                ""options_definitions"": {
                    ""shared"": [
                        ""True"",
                        ""False""
                    ],
                    ""fPIC"": [
                        ""True"",
                        ""False""
                    ],
                    ""fixed_point"": [
                        ""True"",
                        ""False""
                    ],
                    ""stack_protector"": [
                        ""True"",
                        ""False""
                    ]
                },
                ""generators"": [],
                ""python_requires"": null,
                ""system_requires"": {},
                ""recipe_folder"": ""/root/.conan2/p/opus3cb7732193f63/e"",
                ""source_folder"": null,
                ""build_folder"": null,
                ""generators_folder"": null,
                ""package_folder"": null,
                ""cpp_info"": {
                    ""root"": {
                        ""includedirs"": [
                            ""include""
                        ],
                        ""srcdirs"": null,
                        ""libdirs"": [
                            ""lib""
                        ],
                        ""resdirs"": null,
                        ""bindirs"": [
                            ""bin""
                        ],
                        ""builddirs"": null,
                        ""frameworkdirs"": null,
                        ""system_libs"": null,
                        ""frameworks"": null,
                        ""libs"": null,
                        ""defines"": null,
                        ""cflags"": null,
                        ""cxxflags"": null,
                        ""sharedlinkflags"": null,
                        ""exelinkflags"": null,
                        ""objects"": null,
                        ""sysroot"": null,
                        ""requires"": null,
                        ""properties"": null
                    }
                },
                ""conf_info"": {},
                ""label"": ""opus/1.4"",
                ""info"": {
                    ""settings"": {
                        ""os"": ""Linux"",
                        ""arch"": ""armv8"",
                        ""compiler"": ""gcc"",
                        ""compiler.version"": ""12"",
                        ""build_type"": ""Release""
                    },
                    ""options"": {
                        ""fPIC"": ""True"",
                        ""fixed_point"": ""False"",
                        ""shared"": ""False"",
                        ""stack_protector"": ""True""
                    }
                },
                ""dependencies"": {},
                ""context"": ""host"",
                ""test"": false
            },
            ""9"": {
                ""ref"": ""mpg123/1.31.2#ce831c936b2284e2066ab3dc58a2628e"",
                ""id"": ""9"",
                ""recipe"": ""Cache"",
                ""package_id"": ""0bc5cf269869489db05381698a16d7fd566053c1"",
                ""prev"": null,
                ""rrev"": ""ce831c936b2284e2066ab3dc58a2628e"",
                ""rrev_timestamp"": 1697088458.795,
                ""prev_timestamp"": null,
                ""remote"": null,
                ""binary_remote"": null,
                ""build_id"": null,
                ""binary"": ""Skip"",
                ""invalid_build"": false,
                ""info_invalid"": null,
                ""name"": ""mpg123"",
                ""user"": null,
                ""channel"": null,
                ""url"": ""https://github.com/conan-io/conan-center-index"",
                ""license"": [
                    ""LGPL-2.1-or-later"",
                    ""GPL-2.0-or-later""
                ],
                ""author"": null,
                ""description"": ""Fast console MPEG Audio Player and decoder library"",
                ""homepage"": ""http://mpg123.org/"",
                ""build_policy"": null,
                ""upload_policy"": null,
                ""revision_mode"": ""hash"",
                ""provides"": null,
                ""deprecated"": null,
                ""win_bash"": null,
                ""win_bash_run"": null,
                ""default_options"": {
                    ""shared"": false,
                    ""fPIC"": true,
                    ""flexible_resampling"": true,
                    ""network"": true,
                    ""icy"": true,
                    ""id3v2"": true,
                    ""ieeefloat"": true,
                    ""layer1"": true,
                    ""layer2"": true,
                    ""layer3"": true,
                    ""moreinfo"": true,
                    ""seektable"": ""1000"",
                    ""module"": ""dummy""
                },
                ""options_description"": null,
                ""version"": ""1.31.2"",
                ""topics"": [
                    ""mpeg"",
                    ""audio"",
                    ""player"",
                    ""decoder""
                ],
                ""package_type"": ""static-library"",
                ""settings"": {
                    ""os"": ""Linux"",
                    ""arch"": ""armv8"",
                    ""compiler"": ""gcc"",
                    ""compiler.version"": ""12"",
                    ""build_type"": ""Release""
                },
                ""options"": {
                    ""fPIC"": ""True"",
                    ""flexible_resampling"": ""True"",
                    ""icy"": ""True"",
                    ""id3v2"": ""True"",
                    ""ieeefloat"": ""True"",
                    ""layer1"": ""True"",
                    ""layer2"": ""True"",
                    ""layer3"": ""True"",
                    ""module"": ""dummy"",
                    ""moreinfo"": ""True"",
                    ""network"": ""True"",
                    ""seektable"": ""1000"",
                    ""shared"": ""False""
                },
                ""options_definitions"": {
                    ""shared"": [
                        ""True"",
                        ""False""
                    ],
                    ""fPIC"": [
                        ""True"",
                        ""False""
                    ],
                    ""flexible_resampling"": [
                        ""True"",
                        ""False""
                    ],
                    ""network"": [
                        ""True"",
                        ""False""
                    ],
                    ""icy"": [
                        ""True"",
                        ""False""
                    ],
                    ""id3v2"": [
                        ""True"",
                        ""False""
                    ],
                    ""ieeefloat"": [
                        ""True"",
                        ""False""
                    ],
                    ""layer1"": [
                        ""True"",
                        ""False""
                    ],
                    ""layer2"": [
                        ""True"",
                        ""False""
                    ],
                    ""layer3"": [
                        ""True"",
                        ""False""
                    ],
                    ""moreinfo"": [
                        ""True"",
                        ""False""
                    ],
                    ""seektable"": [
                        null,
                        ""ANY""
                    ],
                    ""module"": [
                        ""dummy"",
                        ""libalsa"",
                        ""tinyalsa"",
                        ""win32""
                    ]
                },
                ""generators"": [],
                ""python_requires"": null,
                ""system_requires"": {},
                ""recipe_folder"": ""/root/.conan2/p/mpg125f57569993ec7/e"",
                ""source_folder"": null,
                ""build_folder"": null,
                ""generators_folder"": null,
                ""package_folder"": null,
                ""cpp_info"": {
                    ""root"": {
                        ""includedirs"": [
                            ""include""
                        ],
                        ""srcdirs"": null,
                        ""libdirs"": [
                            ""lib""
                        ],
                        ""resdirs"": null,
                        ""bindirs"": [
                            ""bin""
                        ],
                        ""builddirs"": null,
                        ""frameworkdirs"": null,
                        ""system_libs"": null,
                        ""frameworks"": null,
                        ""libs"": null,
                        ""defines"": null,
                        ""cflags"": null,
                        ""cxxflags"": null,
                        ""sharedlinkflags"": null,
                        ""exelinkflags"": null,
                        ""objects"": null,
                        ""sysroot"": null,
                        ""requires"": null,
                        ""properties"": null
                    }
                },
                ""conf_info"": {},
                ""label"": ""mpg123/1.31.2"",
                ""info"": {
                    ""settings"": {
                        ""os"": ""Linux"",
                        ""arch"": ""armv8"",
                        ""compiler"": ""gcc"",
                        ""compiler.version"": ""12"",
                        ""build_type"": ""Release""
                    },
                    ""options"": {
                        ""fPIC"": ""True"",
                        ""flexible_resampling"": ""True"",
                        ""icy"": ""True"",
                        ""id3v2"": ""True"",
                        ""ieeefloat"": ""True"",
                        ""layer1"": ""True"",
                        ""layer2"": ""True"",
                        ""layer3"": ""True"",
                        ""module"": ""dummy"",
                        ""moreinfo"": ""True"",
                        ""network"": ""True"",
                        ""seektable"": ""1000"",
                        ""shared"": ""False""
                    }
                },
                ""dependencies"": {
                    ""10"": {
                        ""ref"": ""pkgconf/2.0.3"",
                        ""run"": true,
                        ""libs"": false,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": true,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": null,
                        ""visible"": false
                    }
                },
                ""context"": ""host"",
                ""test"": false
            },
            ""10"": {
                ""ref"": ""pkgconf/2.0.3#f996677e96e61e6552d85e83756c328b"",
                ""id"": ""10"",
                ""recipe"": ""Cache"",
                ""package_id"": ""a93744abf7ebe27c68ffd5c57b1f7f21ff754b90"",
                ""prev"": null,
                ""rrev"": ""f996677e96e61e6552d85e83756c328b"",
                ""rrev_timestamp"": 1696606182.229,
                ""prev_timestamp"": null,
                ""remote"": null,
                ""binary_remote"": null,
                ""build_id"": null,
                ""binary"": ""Skip"",
                ""invalid_build"": false,
                ""info_invalid"": null,
                ""name"": ""pkgconf"",
                ""user"": null,
                ""channel"": null,
                ""url"": ""https://github.com/conan-io/conan-center-index"",
                ""license"": ""ISC"",
                ""author"": null,
                ""description"": ""package compiler and linker metadata toolkit"",
                ""homepage"": ""https://git.sr.ht/~kaniini/pkgconf"",
                ""build_policy"": null,
                ""upload_policy"": null,
                ""revision_mode"": ""hash"",
                ""provides"": null,
                ""deprecated"": null,
                ""win_bash"": null,
                ""win_bash_run"": null,
                ""default_options"": {
                    ""shared"": false,
                    ""fPIC"": true,
                    ""enable_lib"": false
                },
                ""options_description"": null,
                ""version"": ""2.0.3"",
                ""topics"": [
                    ""build"",
                    ""configuration""
                ],
                ""package_type"": ""unknown"",
                ""settings"": {
                    ""os"": ""Linux"",
                    ""arch"": ""armv8"",
                    ""compiler"": ""gcc"",
                    ""compiler.version"": ""12"",
                    ""build_type"": ""Release""
                },
                ""options"": {
                    ""enable_lib"": ""False""
                },
                ""options_definitions"": {
                    ""enable_lib"": [
                        ""True"",
                        ""False""
                    ]
                },
                ""generators"": [],
                ""python_requires"": null,
                ""system_requires"": {},
                ""recipe_folder"": ""/root/.conan2/p/pkgco5ad2671634075/e"",
                ""source_folder"": null,
                ""build_folder"": null,
                ""generators_folder"": null,
                ""package_folder"": null,
                ""cpp_info"": {
                    ""root"": {
                        ""includedirs"": [
                            ""include""
                        ],
                        ""srcdirs"": null,
                        ""libdirs"": [
                            ""lib""
                        ],
                        ""resdirs"": null,
                        ""bindirs"": [
                            ""bin""
                        ],
                        ""builddirs"": null,
                        ""frameworkdirs"": null,
                        ""system_libs"": null,
                        ""frameworks"": null,
                        ""libs"": null,
                        ""defines"": null,
                        ""cflags"": null,
                        ""cxxflags"": null,
                        ""sharedlinkflags"": null,
                        ""exelinkflags"": null,
                        ""objects"": null,
                        ""sysroot"": null,
                        ""requires"": null,
                        ""properties"": null
                    }
                },
                ""conf_info"": {},
                ""label"": ""pkgconf/2.0.3"",
                ""info"": {
                    ""settings"": {
                        ""os"": ""Linux"",
                        ""arch"": ""armv8"",
                        ""build_type"": ""Release""
                    },
                    ""options"": {
                        ""enable_lib"": ""False""
                    }
                },
                ""dependencies"": {
                    ""11"": {
                        ""ref"": ""meson/1.2.2"",
                        ""run"": true,
                        ""libs"": false,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": true,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": null,
                        ""visible"": false
                    },
                    ""12"": {
                        ""ref"": ""ninja/1.11.1"",
                        ""run"": true,
                        ""libs"": false,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": false,
                        ""build"": true,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": null,
                        ""visible"": false
                    }
                },
                ""context"": ""build"",
                ""test"": false
            },
            ""11"": {
                ""ref"": ""meson/1.2.2#04bdfb85d665c82b08a3510aee3ffd19"",
                ""id"": ""11"",
                ""recipe"": ""Cache"",
                ""package_id"": ""da39a3ee5e6b4b0d3255bfef95601890afd80709"",
                ""prev"": ""97f4a23dd2d942f83e5344b1ca496ce7"",
                ""rrev"": ""04bdfb85d665c82b08a3510aee3ffd19"",
                ""rrev_timestamp"": 1702568761.764,
                ""prev_timestamp"": 1702572748.354,
                ""remote"": null,
                ""binary_remote"": ""conancenter"",
                ""build_id"": null,
                ""binary"": ""Skip"",
                ""invalid_build"": false,
                ""info_invalid"": null,
                ""name"": ""meson"",
                ""user"": null,
                ""channel"": null,
                ""url"": ""https://github.com/conan-io/conan-center-index"",
                ""license"": ""Apache-2.0"",
                ""author"": null,
                ""description"": ""Meson is a project to create the best possible next-generation build system"",
                ""homepage"": ""https://github.com/mesonbuild/meson"",
                ""build_policy"": null,
                ""upload_policy"": null,
                ""revision_mode"": ""hash"",
                ""provides"": null,
                ""deprecated"": null,
                ""win_bash"": null,
                ""win_bash_run"": null,
                ""default_options"": null,
                ""options_description"": null,
                ""version"": ""1.2.2"",
                ""topics"": [
                    ""meson"",
                    ""mesonbuild"",
                    ""build-system""
                ],
                ""package_type"": ""application"",
                ""settings"": {},
                ""options"": {},
                ""options_definitions"": {},
                ""generators"": [],
                ""python_requires"": null,
                ""system_requires"": {},
                ""recipe_folder"": ""/root/.conan2/p/meson9aba974547f5b/e"",
                ""source_folder"": null,
                ""build_folder"": null,
                ""generators_folder"": null,
                ""package_folder"": null,
                ""cpp_info"": {
                    ""root"": {
                        ""includedirs"": [
                            ""include""
                        ],
                        ""srcdirs"": null,
                        ""libdirs"": [
                            ""lib""
                        ],
                        ""resdirs"": null,
                        ""bindirs"": [
                            ""bin""
                        ],
                        ""builddirs"": null,
                        ""frameworkdirs"": null,
                        ""system_libs"": null,
                        ""frameworks"": null,
                        ""libs"": null,
                        ""defines"": null,
                        ""cflags"": null,
                        ""cxxflags"": null,
                        ""sharedlinkflags"": null,
                        ""exelinkflags"": null,
                        ""objects"": null,
                        ""sysroot"": null,
                        ""requires"": null,
                        ""properties"": null
                    }
                },
                ""conf_info"": {},
                ""label"": ""meson/1.2.2"",
                ""info"": {},
                ""dependencies"": {
                    ""12"": {
                        ""ref"": ""ninja/1.11.1"",
                        ""run"": true,
                        ""libs"": false,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": null,
                        ""visible"": true
                    }
                },
                ""context"": ""build"",
                ""test"": false
            },
            ""12"": {
                ""ref"": ""ninja/1.11.1#77587f8c8318662ac8e5a7867eb4be21"",
                ""id"": ""12"",
                ""recipe"": ""Cache"",
                ""package_id"": ""85c999356992c5713d308db1a4d7bab6bf572f27"",
                ""prev"": null,
                ""rrev"": ""77587f8c8318662ac8e5a7867eb4be21"",
                ""rrev_timestamp"": 1684431244.21,
                ""prev_timestamp"": null,
                ""remote"": null,
                ""binary_remote"": null,
                ""build_id"": null,
                ""binary"": ""Skip"",
                ""invalid_build"": false,
                ""info_invalid"": null,
                ""name"": ""ninja"",
                ""user"": null,
                ""channel"": null,
                ""url"": ""https://github.com/conan-io/conan-center-index"",
                ""license"": ""Apache-2.0"",
                ""author"": null,
                ""description"": ""Ninja is a small build system with a focus on speed"",
                ""homepage"": ""https://github.com/ninja-build/ninja"",
                ""build_policy"": null,
                ""upload_policy"": null,
                ""revision_mode"": ""hash"",
                ""provides"": null,
                ""deprecated"": null,
                ""win_bash"": null,
                ""win_bash_run"": null,
                ""default_options"": null,
                ""options_description"": null,
                ""version"": ""1.11.1"",
                ""topics"": [
                    ""ninja"",
                    ""build""
                ],
                ""package_type"": ""application"",
                ""settings"": {
                    ""os"": ""Linux"",
                    ""arch"": ""armv8"",
                    ""compiler"": ""gcc"",
                    ""compiler.cppstd"": ""gnu17"",
                    ""compiler.libcxx"": ""libstdc++11"",
                    ""compiler.version"": ""12"",
                    ""build_type"": ""Release""
                },
                ""options"": {},
                ""options_definitions"": {},
                ""generators"": [],
                ""python_requires"": null,
                ""system_requires"": {},
                ""recipe_folder"": ""/root/.conan2/p/ninja19c9f8e277acc/e"",
                ""source_folder"": null,
                ""build_folder"": null,
                ""generators_folder"": null,
                ""package_folder"": null,
                ""cpp_info"": {
                    ""root"": {
                        ""includedirs"": [
                            ""include""
                        ],
                        ""srcdirs"": null,
                        ""libdirs"": [
                            ""lib""
                        ],
                        ""resdirs"": null,
                        ""bindirs"": [
                            ""bin""
                        ],
                        ""builddirs"": null,
                        ""frameworkdirs"": null,
                        ""system_libs"": null,
                        ""frameworks"": null,
                        ""libs"": null,
                        ""defines"": null,
                        ""cflags"": null,
                        ""cxxflags"": null,
                        ""sharedlinkflags"": null,
                        ""exelinkflags"": null,
                        ""objects"": null,
                        ""sysroot"": null,
                        ""requires"": null,
                        ""properties"": null
                    }
                },
                ""conf_info"": {},
                ""label"": ""ninja/1.11.1"",
                ""info"": {
                    ""settings"": {
                        ""os"": ""Linux"",
                        ""arch"": ""armv8"",
                        ""build_type"": ""Release""
                    }
                },
                ""dependencies"": {},
                ""context"": ""build"",
                ""test"": false
            },
            ""13"": {
                ""ref"": ""libmp3lame/3.100#44b12d19316eb2b223d98d3e75dae438"",
                ""id"": ""13"",
                ""recipe"": ""Cache"",
                ""package_id"": ""7e0918accf1698c5e54c34e18764ad9156b62d25"",
                ""prev"": null,
                ""rrev"": ""44b12d19316eb2b223d98d3e75dae438"",
                ""rrev_timestamp"": 1674992501.853,
                ""prev_timestamp"": null,
                ""remote"": null,
                ""binary_remote"": null,
                ""build_id"": null,
                ""binary"": ""Skip"",
                ""invalid_build"": false,
                ""info_invalid"": null,
                ""name"": ""libmp3lame"",
                ""user"": null,
                ""channel"": null,
                ""url"": ""https://github.com/conan-io/conan-center-index"",
                ""license"": ""LGPL-2.0"",
                ""author"": null,
                ""description"": ""LAME is a high quality MPEG Audio Layer III (MP3) encoder licensed under the LGPL."",
                ""homepage"": ""http://lame.sourceforge.net"",
                ""build_policy"": null,
                ""upload_policy"": null,
                ""revision_mode"": ""hash"",
                ""provides"": null,
                ""deprecated"": null,
                ""win_bash"": null,
                ""win_bash_run"": null,
                ""default_options"": {
                    ""shared"": false,
                    ""fPIC"": true
                },
                ""options_description"": null,
                ""version"": ""3.100"",
                ""topics"": [
                    ""multimedia"",
                    ""audio"",
                    ""mp3"",
                    ""decoder"",
                    ""encoding"",
                    ""decoding""
                ],
                ""package_type"": ""static-library"",
                ""settings"": {
                    ""os"": ""Linux"",
                    ""arch"": ""armv8"",
                    ""compiler"": ""gcc"",
                    ""compiler.version"": ""12"",
                    ""build_type"": ""Release""
                },
                ""options"": {
                    ""fPIC"": ""True"",
                    ""shared"": ""False""
                },
                ""options_definitions"": {
                    ""shared"": [
                        ""True"",
                        ""False""
                    ],
                    ""fPIC"": [
                        ""True"",
                        ""False""
                    ]
                },
                ""generators"": [],
                ""python_requires"": null,
                ""system_requires"": {},
                ""recipe_folder"": ""/root/.conan2/p/libmpebf686a19587c/e"",
                ""source_folder"": null,
                ""build_folder"": null,
                ""generators_folder"": null,
                ""package_folder"": null,
                ""cpp_info"": {
                    ""root"": {
                        ""includedirs"": [
                            ""include""
                        ],
                        ""srcdirs"": null,
                        ""libdirs"": [
                            ""lib""
                        ],
                        ""resdirs"": null,
                        ""bindirs"": [
                            ""bin""
                        ],
                        ""builddirs"": null,
                        ""frameworkdirs"": null,
                        ""system_libs"": null,
                        ""frameworks"": null,
                        ""libs"": null,
                        ""defines"": null,
                        ""cflags"": null,
                        ""cxxflags"": null,
                        ""sharedlinkflags"": null,
                        ""exelinkflags"": null,
                        ""objects"": null,
                        ""sysroot"": null,
                        ""requires"": null,
                        ""properties"": null
                    }
                },
                ""conf_info"": {},
                ""label"": ""libmp3lame/3.100"",
                ""info"": {
                    ""settings"": {
                        ""os"": ""Linux"",
                        ""arch"": ""armv8"",
                        ""compiler"": ""gcc"",
                        ""compiler.version"": ""12"",
                        ""build_type"": ""Release""
                    },
                    ""options"": {
                        ""fPIC"": ""True"",
                        ""shared"": ""False""
                    }
                },
                ""dependencies"": {
                    ""14"": {
                        ""ref"": ""gnu-config/cci.20210814"",
                        ""run"": true,
                        ""libs"": false,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": true,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": null,
                        ""visible"": false
                    }
                },
                ""context"": ""host"",
                ""test"": false
            },
            ""14"": {
                ""ref"": ""gnu-config/cci.20210814#dc430d754f465e8c74463019672fb97b"",
                ""id"": ""14"",
                ""recipe"": ""Cache"",
                ""package_id"": ""da39a3ee5e6b4b0d3255bfef95601890afd80709"",
                ""prev"": ""22618e30bd9e326eb95e824dc90cc860"",
                ""rrev"": ""dc430d754f465e8c74463019672fb97b"",
                ""rrev_timestamp"": 1701248168.479,
                ""prev_timestamp"": 1701248306.606,
                ""remote"": null,
                ""binary_remote"": ""conancenter"",
                ""build_id"": null,
                ""binary"": ""Skip"",
                ""invalid_build"": false,
                ""info_invalid"": null,
                ""name"": ""gnu-config"",
                ""user"": null,
                ""channel"": null,
                ""url"": ""https://github.com/conan-io/conan-center-index"",
                ""license"": [
                    ""GPL-3.0-or-later"",
                    ""autoconf-special-exception""
                ],
                ""author"": null,
                ""description"": ""The GNU config.guess and config.sub scripts"",
                ""homepage"": ""https://savannah.gnu.org/projects/config/"",
                ""build_policy"": null,
                ""upload_policy"": null,
                ""revision_mode"": ""hash"",
                ""provides"": null,
                ""deprecated"": null,
                ""win_bash"": null,
                ""win_bash_run"": null,
                ""default_options"": null,
                ""options_description"": null,
                ""version"": ""cci.20210814"",
                ""topics"": [
                    ""gnu"",
                    ""config"",
                    ""autotools"",
                    ""canonical"",
                    ""host"",
                    ""build"",
                    ""target"",
                    ""triplet""
                ],
                ""package_type"": ""build-scripts"",
                ""settings"": {},
                ""options"": {},
                ""options_definitions"": {},
                ""generators"": [],
                ""python_requires"": null,
                ""system_requires"": {},
                ""recipe_folder"": ""/root/.conan2/p/gnu-cbb47279af5340/e"",
                ""source_folder"": null,
                ""build_folder"": null,
                ""generators_folder"": null,
                ""package_folder"": null,
                ""cpp_info"": {
                    ""root"": {
                        ""includedirs"": [
                            ""include""
                        ],
                        ""srcdirs"": null,
                        ""libdirs"": [
                            ""lib""
                        ],
                        ""resdirs"": null,
                        ""bindirs"": [
                            ""bin""
                        ],
                        ""builddirs"": null,
                        ""frameworkdirs"": null,
                        ""system_libs"": null,
                        ""frameworks"": null,
                        ""libs"": null,
                        ""defines"": null,
                        ""cflags"": null,
                        ""cxxflags"": null,
                        ""sharedlinkflags"": null,
                        ""exelinkflags"": null,
                        ""objects"": null,
                        ""sysroot"": null,
                        ""requires"": null,
                        ""properties"": null
                    }
                },
                ""conf_info"": {},
                ""label"": ""gnu-config/cci.20210814"",
                ""info"": {},
                ""dependencies"": {},
                ""context"": ""build"",
                ""test"": false
            },
            ""15"": {
                ""ref"": ""xorg/system#f626cbdd0ba57d9c53bce2d8b9362fad"",
                ""id"": ""15"",
                ""recipe"": ""Cache"",
                ""package_id"": ""da39a3ee5e6b4b0d3255bfef95601890afd80709"",
                ""prev"": ""0ba8627bd47edc3a501e8f0eb9a79e5e"",
                ""rrev"": ""f626cbdd0ba57d9c53bce2d8b9362fad"",
                ""rrev_timestamp"": 1709213216.576,
                ""prev_timestamp"": 1709213382.658,
                ""remote"": null,
                ""binary_remote"": ""conancenter"",
                ""build_id"": null,
                ""binary"": ""Download"",
                ""invalid_build"": false,
                ""info_invalid"": null,
                ""name"": ""xorg"",
                ""user"": null,
                ""channel"": null,
                ""url"": ""https://github.com/conan-io/conan-center-index"",
                ""license"": ""MIT"",
                ""author"": null,
                ""description"": ""The X.Org project provides an open source implementation of the X Window System."",
                ""homepage"": ""https://www.x.org/wiki/"",
                ""build_policy"": null,
                ""upload_policy"": null,
                ""revision_mode"": ""hash"",
                ""provides"": null,
                ""deprecated"": null,
                ""win_bash"": null,
                ""win_bash_run"": null,
                ""default_options"": null,
                ""options_description"": null,
                ""version"": ""system"",
                ""topics"": [
                    ""x11"",
                    ""xorg""
                ],
                ""package_type"": ""shared-library"",
                ""settings"": {
                    ""os"": ""Linux"",
                    ""arch"": ""armv8"",
                    ""compiler"": ""gcc"",
                    ""compiler.cppstd"": ""gnu17"",
                    ""compiler.libcxx"": ""libstdc++11"",
                    ""compiler.version"": ""12"",
                    ""build_type"": ""Release""
                },
                ""options"": {},
                ""options_definitions"": {},
                ""generators"": [],
                ""python_requires"": null,
                ""system_requires"": {},
                ""recipe_folder"": ""/root/.conan2/p/xorge7b7c067f4d9e/e"",
                ""source_folder"": null,
                ""build_folder"": null,
                ""generators_folder"": null,
                ""package_folder"": null,
                ""cpp_info"": {
                    ""root"": {
                        ""includedirs"": [
                            ""include""
                        ],
                        ""srcdirs"": null,
                        ""libdirs"": [
                            ""lib""
                        ],
                        ""resdirs"": null,
                        ""bindirs"": [
                            ""bin""
                        ],
                        ""builddirs"": null,
                        ""frameworkdirs"": null,
                        ""system_libs"": null,
                        ""frameworks"": null,
                        ""libs"": null,
                        ""defines"": null,
                        ""cflags"": null,
                        ""cxxflags"": null,
                        ""sharedlinkflags"": null,
                        ""exelinkflags"": null,
                        ""objects"": null,
                        ""sysroot"": null,
                        ""requires"": null,
                        ""properties"": null
                    }
                },
                ""conf_info"": {},
                ""label"": ""xorg/system"",
                ""info"": {},
                ""dependencies"": {},
                ""context"": ""host"",
                ""test"": false
            },
            ""16"": {
                ""ref"": ""openssl/3.2.1#c7b554068caae5eda12b735ea6f23d70"",
                ""id"": ""16"",
                ""recipe"": ""Cache"",
                ""package_id"": ""469765602cb39c441c3f8afb43977bb72b8b9a93"",
                ""prev"": null,
                ""rrev"": ""c7b554068caae5eda12b735ea6f23d70"",
                ""rrev_timestamp"": 1712227628.919,
                ""prev_timestamp"": null,
                ""remote"": null,
                ""binary_remote"": null,
                ""build_id"": null,
                ""binary"": ""Skip"",
                ""invalid_build"": false,
                ""info_invalid"": null,
                ""name"": ""openssl"",
                ""user"": null,
                ""channel"": null,
                ""url"": ""https://github.com/conan-io/conan-center-index"",
                ""license"": ""Apache-2.0"",
                ""author"": null,
                ""description"": ""A toolkit for the Transport Layer Security (TLS) and Secure Sockets Layer (SSL) protocols"",
                ""homepage"": ""https://github.com/openssl/openssl"",
                ""build_policy"": null,
                ""upload_policy"": null,
                ""revision_mode"": ""hash"",
                ""provides"": null,
                ""deprecated"": null,
                ""win_bash"": null,
                ""win_bash_run"": null,
                ""default_options"": {
                    ""shared"": false,
                    ""fPIC"": true,
                    ""enable_weak_ssl_ciphers"": false,
                    ""386"": false,
                    ""capieng_dialog"": false,
                    ""enable_capieng"": false,
                    ""enable_trace"": false,
                    ""no_aria"": false,
                    ""no_apps"": false,
                    ""no_autoload_config"": false,
                    ""no_asm"": false,
                    ""no_async"": false,
                    ""no_blake2"": false,
                    ""no_bf"": false,
                    ""no_camellia"": false,
                    ""no_chacha"": false,
                    ""no_cms"": false,
                    ""no_comp"": false,
                    ""no_ct"": false,
                    ""no_cast"": false,
                    ""no_deprecated"": false,
                    ""no_des"": false,
                    ""no_dgram"": false,
                    ""no_dh"": false,
                    ""no_dsa"": false,
                    ""no_dso"": false,
                    ""no_ec"": false,
                    ""no_ecdh"": false,
                    ""no_ecdsa"": false,
                    ""no_engine"": false,
                    ""no_filenames"": false,
                    ""no_fips"": false,
                    ""no_gost"": false,
                    ""no_idea"": false,
                    ""no_legacy"": false,
                    ""no_md2"": true,
                    ""no_md4"": false,
                    ""no_mdc2"": false,
                    ""no_module"": false,
                    ""no_ocsp"": false,
                    ""no_pinshared"": false,
                    ""no_rc2"": false,
                    ""no_rc4"": false,
                    ""no_rc5"": false,
                    ""no_rfc3779"": false,
                    ""no_rmd160"": false,
                    ""no_sm2"": false,
                    ""no_sm3"": false,
                    ""no_sm4"": false,
                    ""no_srp"": false,
                    ""no_srtp"": false,
                    ""no_sse2"": false,
                    ""no_ssl"": false,
                    ""no_stdio"": false,
                    ""no_seed"": false,
                    ""no_sock"": false,
                    ""no_ssl3"": false,
                    ""no_threads"": false,
                    ""no_tls1"": false,
                    ""no_ts"": false,
                    ""no_whirlpool"": false,
                    ""no_zlib"": false,
                    ""openssldir"": null,
                    ""tls_security_level"": null
                },
                ""options_description"": null,
                ""version"": ""3.2.1"",
                ""topics"": [
                    ""ssl"",
                    ""tls"",
                    ""encryption"",
                    ""security""
                ],
                ""package_type"": ""static-library"",
                ""settings"": {
                    ""os"": ""Linux"",
                    ""arch"": ""armv8"",
                    ""compiler"": ""gcc"",
                    ""compiler.version"": ""12"",
                    ""build_type"": ""Release""
                },
                ""options"": {
                    ""386"": ""False"",
                    ""enable_trace"": ""False"",
                    ""enable_weak_ssl_ciphers"": ""False"",
                    ""fPIC"": ""True"",
                    ""no_apps"": ""False"",
                    ""no_aria"": ""False"",
                    ""no_asm"": ""False"",
                    ""no_async"": ""False"",
                    ""no_autoload_config"": ""False"",
                    ""no_bf"": ""False"",
                    ""no_blake2"": ""False"",
                    ""no_camellia"": ""False"",
                    ""no_cast"": ""False"",
                    ""no_chacha"": ""False"",
                    ""no_cms"": ""False"",
                    ""no_comp"": ""False"",
                    ""no_ct"": ""False"",
                    ""no_deprecated"": ""False"",
                    ""no_des"": ""False"",
                    ""no_dgram"": ""False"",
                    ""no_dh"": ""False"",
                    ""no_dsa"": ""False"",
                    ""no_dso"": ""False"",
                    ""no_ec"": ""False"",
                    ""no_ecdh"": ""False"",
                    ""no_ecdsa"": ""False"",
                    ""no_engine"": ""False"",
                    ""no_filenames"": ""False"",
                    ""no_fips"": ""False"",
                    ""no_gost"": ""False"",
                    ""no_idea"": ""False"",
                    ""no_legacy"": ""False"",
                    ""no_md2"": ""True"",
                    ""no_md4"": ""False"",
                    ""no_mdc2"": ""False"",
                    ""no_module"": ""False"",
                    ""no_ocsp"": ""False"",
                    ""no_pinshared"": ""False"",
                    ""no_rc2"": ""False"",
                    ""no_rc4"": ""False"",
                    ""no_rc5"": ""False"",
                    ""no_rfc3779"": ""False"",
                    ""no_rmd160"": ""False"",
                    ""no_seed"": ""False"",
                    ""no_sm2"": ""False"",
                    ""no_sm3"": ""False"",
                    ""no_sm4"": ""False"",
                    ""no_sock"": ""False"",
                    ""no_srp"": ""False"",
                    ""no_srtp"": ""False"",
                    ""no_sse2"": ""False"",
                    ""no_ssl"": ""False"",
                    ""no_ssl3"": ""False"",
                    ""no_stdio"": ""False"",
                    ""no_threads"": ""False"",
                    ""no_tls1"": ""False"",
                    ""no_ts"": ""False"",
                    ""no_whirlpool"": ""False"",
                    ""no_zlib"": ""False"",
                    ""openssldir"": null,
                    ""shared"": ""False"",
                    ""tls_security_level"": null
                },
                ""options_definitions"": {
                    ""shared"": [
                        ""True"",
                        ""False""
                    ],
                    ""fPIC"": [
                        ""True"",
                        ""False""
                    ],
                    ""enable_weak_ssl_ciphers"": [
                        ""True"",
                        ""False""
                    ],
                    ""386"": [
                        ""True"",
                        ""False""
                    ],
                    ""enable_trace"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_aria"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_apps"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_autoload_config"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_asm"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_async"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_blake2"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_bf"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_camellia"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_chacha"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_cms"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_comp"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_ct"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_cast"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_deprecated"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_des"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_dgram"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_dh"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_dsa"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_dso"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_ec"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_ecdh"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_ecdsa"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_engine"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_filenames"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_fips"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_gost"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_idea"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_legacy"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_md2"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_md4"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_mdc2"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_module"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_ocsp"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_pinshared"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_rc2"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_rc4"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_rc5"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_rfc3779"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_rmd160"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_sm2"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_sm3"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_sm4"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_srp"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_srtp"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_sse2"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_ssl"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_stdio"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_seed"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_sock"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_ssl3"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_threads"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_tls1"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_ts"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_whirlpool"": [
                        ""True"",
                        ""False""
                    ],
                    ""no_zlib"": [
                        ""True"",
                        ""False""
                    ],
                    ""openssldir"": [
                        null,
                        ""ANY""
                    ],
                    ""tls_security_level"": [
                        null,
                        ""0"",
                        ""1"",
                        ""2"",
                        ""3"",
                        ""4"",
                        ""5""
                    ]
                },
                ""generators"": [],
                ""python_requires"": null,
                ""system_requires"": {},
                ""recipe_folder"": ""/root/.conan2/p/opens838c21f04ce59/e"",
                ""source_folder"": null,
                ""build_folder"": null,
                ""generators_folder"": null,
                ""package_folder"": null,
                ""cpp_info"": {
                    ""root"": {
                        ""includedirs"": [
                            ""include""
                        ],
                        ""srcdirs"": null,
                        ""libdirs"": [
                            ""lib""
                        ],
                        ""resdirs"": null,
                        ""bindirs"": [
                            ""bin""
                        ],
                        ""builddirs"": null,
                        ""frameworkdirs"": null,
                        ""system_libs"": null,
                        ""frameworks"": null,
                        ""libs"": null,
                        ""defines"": null,
                        ""cflags"": null,
                        ""cxxflags"": null,
                        ""sharedlinkflags"": null,
                        ""exelinkflags"": null,
                        ""objects"": null,
                        ""sysroot"": null,
                        ""requires"": null,
                        ""properties"": null
                    }
                },
                ""conf_info"": {},
                ""label"": ""openssl/3.2.1"",
                ""info"": {
                    ""settings"": {
                        ""os"": ""Linux"",
                        ""arch"": ""armv8"",
                        ""compiler"": ""gcc"",
                        ""compiler.version"": ""12"",
                        ""build_type"": ""Release""
                    },
                    ""options"": {
                        ""386"": ""False"",
                        ""enable_trace"": ""False"",
                        ""enable_weak_ssl_ciphers"": ""False"",
                        ""fPIC"": ""True"",
                        ""no_apps"": ""False"",
                        ""no_aria"": ""False"",
                        ""no_asm"": ""False"",
                        ""no_async"": ""False"",
                        ""no_autoload_config"": ""False"",
                        ""no_bf"": ""False"",
                        ""no_blake2"": ""False"",
                        ""no_camellia"": ""False"",
                        ""no_cast"": ""False"",
                        ""no_chacha"": ""False"",
                        ""no_cms"": ""False"",
                        ""no_comp"": ""False"",
                        ""no_ct"": ""False"",
                        ""no_deprecated"": ""False"",
                        ""no_des"": ""False"",
                        ""no_dgram"": ""False"",
                        ""no_dh"": ""False"",
                        ""no_dsa"": ""False"",
                        ""no_dso"": ""False"",
                        ""no_ec"": ""False"",
                        ""no_ecdh"": ""False"",
                        ""no_ecdsa"": ""False"",
                        ""no_engine"": ""False"",
                        ""no_filenames"": ""False"",
                        ""no_fips"": ""False"",
                        ""no_gost"": ""False"",
                        ""no_idea"": ""False"",
                        ""no_legacy"": ""False"",
                        ""no_md2"": ""True"",
                        ""no_md4"": ""False"",
                        ""no_mdc2"": ""False"",
                        ""no_module"": ""False"",
                        ""no_ocsp"": ""False"",
                        ""no_pinshared"": ""False"",
                        ""no_rc2"": ""False"",
                        ""no_rc4"": ""False"",
                        ""no_rc5"": ""False"",
                        ""no_rfc3779"": ""False"",
                        ""no_rmd160"": ""False"",
                        ""no_seed"": ""False"",
                        ""no_sm2"": ""False"",
                        ""no_sm3"": ""False"",
                        ""no_sm4"": ""False"",
                        ""no_sock"": ""False"",
                        ""no_srp"": ""False"",
                        ""no_srtp"": ""False"",
                        ""no_sse2"": ""False"",
                        ""no_ssl"": ""False"",
                        ""no_ssl3"": ""False"",
                        ""no_stdio"": ""False"",
                        ""no_threads"": ""False"",
                        ""no_tls1"": ""False"",
                        ""no_ts"": ""False"",
                        ""no_whirlpool"": ""False"",
                        ""no_zlib"": ""False"",
                        ""openssldir"": null,
                        ""shared"": ""False"",
                        ""tls_security_level"": null
                    },
                    ""requires"": [
                        ""zlib/1.3.Z""
                    ]
                },
                ""dependencies"": {
                    ""17"": {
                        ""ref"": ""zlib/1.3.1"",
                        ""run"": false,
                        ""libs"": true,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": true,
                        ""package_id_mode"": ""minor_mode"",
                        ""visible"": true
                    }
                },
                ""context"": ""host"",
                ""test"": false
            },
            ""17"": {
                ""ref"": ""zlib/1.3.1#f52e03ae3d251dec704634230cd806a2"",
                ""id"": ""17"",
                ""recipe"": ""Cache"",
                ""package_id"": ""7e0918accf1698c5e54c34e18764ad9156b62d25"",
                ""prev"": null,
                ""rrev"": ""f52e03ae3d251dec704634230cd806a2"",
                ""rrev_timestamp"": 1708593606.497,
                ""prev_timestamp"": null,
                ""remote"": null,
                ""binary_remote"": null,
                ""build_id"": null,
                ""binary"": ""Skip"",
                ""invalid_build"": false,
                ""info_invalid"": null,
                ""name"": ""zlib"",
                ""user"": null,
                ""channel"": null,
                ""url"": ""https://github.com/conan-io/conan-center-index"",
                ""license"": ""Zlib"",
                ""author"": null,
                ""description"": ""A Massively Spiffy Yet Delicately Unobtrusive Compression Library (Also Free, Not to Mention Unencumbered by Patents)"",
                ""homepage"": ""https://zlib.net"",
                ""build_policy"": null,
                ""upload_policy"": null,
                ""revision_mode"": ""hash"",
                ""provides"": null,
                ""deprecated"": null,
                ""win_bash"": null,
                ""win_bash_run"": null,
                ""default_options"": {
                    ""shared"": false,
                    ""fPIC"": true
                },
                ""options_description"": null,
                ""version"": ""1.3.1"",
                ""topics"": [
                    ""zlib"",
                    ""compression""
                ],
                ""package_type"": ""static-library"",
                ""settings"": {
                    ""os"": ""Linux"",
                    ""arch"": ""armv8"",
                    ""compiler"": ""gcc"",
                    ""compiler.version"": ""12"",
                    ""build_type"": ""Release""
                },
                ""options"": {
                    ""fPIC"": ""True"",
                    ""shared"": ""False""
                },
                ""options_definitions"": {
                    ""shared"": [
                        ""True"",
                        ""False""
                    ],
                    ""fPIC"": [
                        ""True"",
                        ""False""
                    ]
                },
                ""generators"": [],
                ""python_requires"": null,
                ""system_requires"": {},
                ""recipe_folder"": ""/root/.conan2/p/zlib41bd3946e7341/e"",
                ""source_folder"": null,
                ""build_folder"": null,
                ""generators_folder"": null,
                ""package_folder"": null,
                ""cpp_info"": {
                    ""root"": {
                        ""includedirs"": [
                            ""include""
                        ],
                        ""srcdirs"": null,
                        ""libdirs"": [
                            ""lib""
                        ],
                        ""resdirs"": null,
                        ""bindirs"": [
                            ""bin""
                        ],
                        ""builddirs"": null,
                        ""frameworkdirs"": null,
                        ""system_libs"": null,
                        ""frameworks"": null,
                        ""libs"": null,
                        ""defines"": null,
                        ""cflags"": null,
                        ""cxxflags"": null,
                        ""sharedlinkflags"": null,
                        ""exelinkflags"": null,
                        ""objects"": null,
                        ""sysroot"": null,
                        ""requires"": null,
                        ""properties"": null
                    }
                },
                ""conf_info"": {},
                ""label"": ""zlib/1.3.1"",
                ""info"": {
                    ""settings"": {
                        ""os"": ""Linux"",
                        ""arch"": ""armv8"",
                        ""compiler"": ""gcc"",
                        ""compiler.version"": ""12"",
                        ""build_type"": ""Release""
                    },
                    ""options"": {
                        ""fPIC"": ""True"",
                        ""shared"": ""False""
                    }
                },
                ""dependencies"": {},
                ""context"": ""host"",
                ""test"": false
            },
            ""18"": {
                ""ref"": ""m4/1.4.19#b38ced39a01e31fef5435bc634461fd2"",
                ""id"": ""18"",
                ""recipe"": ""Cache"",
                ""package_id"": ""85c999356992c5713d308db1a4d7bab6bf572f27"",
                ""prev"": null,
                ""rrev"": ""b38ced39a01e31fef5435bc634461fd2"",
                ""rrev_timestamp"": 1700758725.451,
                ""prev_timestamp"": null,
                ""remote"": null,
                ""binary_remote"": null,
                ""build_id"": null,
                ""binary"": ""Skip"",
                ""invalid_build"": false,
                ""info_invalid"": null,
                ""name"": ""m4"",
                ""user"": null,
                ""channel"": null,
                ""url"": ""https://github.com/conan-io/conan-center-index"",
                ""license"": ""GPL-3.0-only"",
                ""author"": null,
                ""description"": ""GNU M4 is an implementation of the traditional Unix macro processor"",
                ""homepage"": ""https://www.gnu.org/software/m4/"",
                ""build_policy"": null,
                ""upload_policy"": null,
                ""revision_mode"": ""hash"",
                ""provides"": null,
                ""deprecated"": null,
                ""win_bash"": null,
                ""win_bash_run"": null,
                ""default_options"": null,
                ""options_description"": null,
                ""version"": ""1.4.19"",
                ""topics"": [
                    ""macro"",
                    ""preprocessor""
                ],
                ""package_type"": ""application"",
                ""settings"": {
                    ""os"": ""Linux"",
                    ""arch"": ""armv8"",
                    ""compiler"": ""gcc"",
                    ""compiler.cppstd"": ""gnu17"",
                    ""compiler.libcxx"": ""libstdc++11"",
                    ""compiler.version"": ""12"",
                    ""build_type"": ""Release""
                },
                ""options"": {},
                ""options_definitions"": {},
                ""generators"": [],
                ""python_requires"": null,
                ""system_requires"": {},
                ""recipe_folder"": ""/root/.conan2/p/m4512cc8aabbc4c/e"",
                ""source_folder"": null,
                ""build_folder"": null,
                ""generators_folder"": null,
                ""package_folder"": null,
                ""cpp_info"": {
                    ""root"": {
                        ""includedirs"": [
                            ""include""
                        ],
                        ""srcdirs"": null,
                        ""libdirs"": [
                            ""lib""
                        ],
                        ""resdirs"": null,
                        ""bindirs"": [
                            ""bin""
                        ],
                        ""builddirs"": null,
                        ""frameworkdirs"": null,
                        ""system_libs"": null,
                        ""frameworks"": null,
                        ""libs"": null,
                        ""defines"": null,
                        ""cflags"": null,
                        ""cxxflags"": null,
                        ""sharedlinkflags"": null,
                        ""exelinkflags"": null,
                        ""objects"": null,
                        ""sysroot"": null,
                        ""requires"": null,
                        ""properties"": null
                    }
                },
                ""conf_info"": {},
                ""label"": ""m4/1.4.19"",
                ""info"": {
                    ""settings"": {
                        ""os"": ""Linux"",
                        ""arch"": ""armv8"",
                        ""build_type"": ""Release""
                    }
                },
                ""dependencies"": {},
                ""context"": ""build"",
                ""test"": false
            },
            ""19"": {
                ""ref"": ""meson/1.3.2#d1125ba555ec1a94f165a3412fdf7f88"",
                ""id"": ""19"",
                ""recipe"": ""Cache"",
                ""package_id"": ""da39a3ee5e6b4b0d3255bfef95601890afd80709"",
                ""prev"": ""3ba677cf44c95996f4f326c668f92f00"",
                ""rrev"": ""d1125ba555ec1a94f165a3412fdf7f88"",
                ""rrev_timestamp"": 1708699393.753,
                ""prev_timestamp"": 1708699927.309,
                ""remote"": null,
                ""binary_remote"": ""conancenter"",
                ""build_id"": null,
                ""binary"": ""Skip"",
                ""invalid_build"": false,
                ""info_invalid"": null,
                ""name"": ""meson"",
                ""user"": null,
                ""channel"": null,
                ""url"": ""https://github.com/conan-io/conan-center-index"",
                ""license"": ""Apache-2.0"",
                ""author"": null,
                ""description"": ""Meson is a project to create the best possible next-generation build system"",
                ""homepage"": ""https://github.com/mesonbuild/meson"",
                ""build_policy"": null,
                ""upload_policy"": null,
                ""revision_mode"": ""hash"",
                ""provides"": null,
                ""deprecated"": null,
                ""win_bash"": null,
                ""win_bash_run"": null,
                ""default_options"": null,
                ""options_description"": null,
                ""version"": ""1.3.2"",
                ""topics"": [
                    ""meson"",
                    ""mesonbuild"",
                    ""build-system""
                ],
                ""package_type"": ""application"",
                ""settings"": {},
                ""options"": {},
                ""options_definitions"": {},
                ""generators"": [],
                ""python_requires"": null,
                ""system_requires"": {},
                ""recipe_folder"": ""/root/.conan2/p/meson664925a500958/e"",
                ""source_folder"": null,
                ""build_folder"": null,
                ""generators_folder"": null,
                ""package_folder"": null,
                ""cpp_info"": {
                    ""root"": {
                        ""includedirs"": [
                            ""include""
                        ],
                        ""srcdirs"": null,
                        ""libdirs"": [
                            ""lib""
                        ],
                        ""resdirs"": null,
                        ""bindirs"": [
                            ""bin""
                        ],
                        ""builddirs"": null,
                        ""frameworkdirs"": null,
                        ""system_libs"": null,
                        ""frameworks"": null,
                        ""libs"": null,
                        ""defines"": null,
                        ""cflags"": null,
                        ""cxxflags"": null,
                        ""sharedlinkflags"": null,
                        ""exelinkflags"": null,
                        ""objects"": null,
                        ""sysroot"": null,
                        ""requires"": null,
                        ""properties"": null
                    }
                },
                ""conf_info"": {},
                ""label"": ""meson/1.3.2"",
                ""info"": {},
                ""dependencies"": {
                    ""20"": {
                        ""ref"": ""ninja/1.11.1"",
                        ""run"": true,
                        ""libs"": false,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": null,
                        ""visible"": true
                    }
                },
                ""context"": ""build"",
                ""test"": false
            },
            ""20"": {
                ""ref"": ""ninja/1.11.1#77587f8c8318662ac8e5a7867eb4be21"",
                ""id"": ""20"",
                ""recipe"": ""Cache"",
                ""package_id"": ""85c999356992c5713d308db1a4d7bab6bf572f27"",
                ""prev"": null,
                ""rrev"": ""77587f8c8318662ac8e5a7867eb4be21"",
                ""rrev_timestamp"": 1684431244.21,
                ""prev_timestamp"": null,
                ""remote"": null,
                ""binary_remote"": null,
                ""build_id"": null,
                ""binary"": ""Skip"",
                ""invalid_build"": false,
                ""info_invalid"": null,
                ""name"": ""ninja"",
                ""user"": null,
                ""channel"": null,
                ""url"": ""https://github.com/conan-io/conan-center-index"",
                ""license"": ""Apache-2.0"",
                ""author"": null,
                ""description"": ""Ninja is a small build system with a focus on speed"",
                ""homepage"": ""https://github.com/ninja-build/ninja"",
                ""build_policy"": null,
                ""upload_policy"": null,
                ""revision_mode"": ""hash"",
                ""provides"": null,
                ""deprecated"": null,
                ""win_bash"": null,
                ""win_bash_run"": null,
                ""default_options"": null,
                ""options_description"": null,
                ""version"": ""1.11.1"",
                ""topics"": [
                    ""ninja"",
                    ""build""
                ],
                ""package_type"": ""application"",
                ""settings"": {
                    ""os"": ""Linux"",
                    ""arch"": ""armv8"",
                    ""compiler"": ""gcc"",
                    ""compiler.cppstd"": ""gnu17"",
                    ""compiler.libcxx"": ""libstdc++11"",
                    ""compiler.version"": ""12"",
                    ""build_type"": ""Release""
                },
                ""options"": {},
                ""options_definitions"": {},
                ""generators"": [],
                ""python_requires"": null,
                ""system_requires"": {},
                ""recipe_folder"": ""/root/.conan2/p/ninja19c9f8e277acc/e"",
                ""source_folder"": null,
                ""build_folder"": null,
                ""generators_folder"": null,
                ""package_folder"": null,
                ""cpp_info"": {
                    ""root"": {
                        ""includedirs"": [
                            ""include""
                        ],
                        ""srcdirs"": null,
                        ""libdirs"": [
                            ""lib""
                        ],
                        ""resdirs"": null,
                        ""bindirs"": [
                            ""bin""
                        ],
                        ""builddirs"": null,
                        ""frameworkdirs"": null,
                        ""system_libs"": null,
                        ""frameworks"": null,
                        ""libs"": null,
                        ""defines"": null,
                        ""cflags"": null,
                        ""cxxflags"": null,
                        ""sharedlinkflags"": null,
                        ""exelinkflags"": null,
                        ""objects"": null,
                        ""sysroot"": null,
                        ""requires"": null,
                        ""properties"": null
                    }
                },
                ""conf_info"": {},
                ""label"": ""ninja/1.11.1"",
                ""info"": {
                    ""settings"": {
                        ""os"": ""Linux"",
                        ""arch"": ""armv8"",
                        ""build_type"": ""Release""
                    }
                },
                ""dependencies"": {},
                ""context"": ""build"",
                ""test"": false
            },
            ""21"": {
                ""ref"": ""pkgconf/2.1.0#27f44583701117b571307cf5b5fe5605"",
                ""id"": ""21"",
                ""recipe"": ""Cache"",
                ""package_id"": ""a93744abf7ebe27c68ffd5c57b1f7f21ff754b90"",
                ""prev"": null,
                ""rrev"": ""27f44583701117b571307cf5b5fe5605"",
                ""rrev_timestamp"": 1701537936.436,
                ""prev_timestamp"": null,
                ""remote"": null,
                ""binary_remote"": null,
                ""build_id"": null,
                ""binary"": ""Skip"",
                ""invalid_build"": false,
                ""info_invalid"": null,
                ""name"": ""pkgconf"",
                ""user"": null,
                ""channel"": null,
                ""url"": ""https://github.com/conan-io/conan-center-index"",
                ""license"": ""ISC"",
                ""author"": null,
                ""description"": ""package compiler and linker metadata toolkit"",
                ""homepage"": ""https://git.sr.ht/~kaniini/pkgconf"",
                ""build_policy"": null,
                ""upload_policy"": null,
                ""revision_mode"": ""hash"",
                ""provides"": null,
                ""deprecated"": null,
                ""win_bash"": null,
                ""win_bash_run"": null,
                ""default_options"": {
                    ""shared"": false,
                    ""fPIC"": true,
                    ""enable_lib"": false
                },
                ""options_description"": null,
                ""version"": ""2.1.0"",
                ""topics"": [
                    ""build"",
                    ""configuration""
                ],
                ""package_type"": ""unknown"",
                ""settings"": {
                    ""os"": ""Linux"",
                    ""arch"": ""armv8"",
                    ""compiler"": ""gcc"",
                    ""compiler.version"": ""12"",
                    ""build_type"": ""Release""
                },
                ""options"": {
                    ""enable_lib"": ""False""
                },
                ""options_definitions"": {
                    ""enable_lib"": [
                        ""True"",
                        ""False""
                    ]
                },
                ""generators"": [],
                ""python_requires"": null,
                ""system_requires"": {},
                ""recipe_folder"": ""/root/.conan2/p/pkgco39164e4b4e12d/e"",
                ""source_folder"": null,
                ""build_folder"": null,
                ""generators_folder"": null,
                ""package_folder"": null,
                ""cpp_info"": {
                    ""root"": {
                        ""includedirs"": [
                            ""include""
                        ],
                        ""srcdirs"": null,
                        ""libdirs"": [
                            ""lib""
                        ],
                        ""resdirs"": null,
                        ""bindirs"": [
                            ""bin""
                        ],
                        ""builddirs"": null,
                        ""frameworkdirs"": null,
                        ""system_libs"": null,
                        ""frameworks"": null,
                        ""libs"": null,
                        ""defines"": null,
                        ""cflags"": null,
                        ""cxxflags"": null,
                        ""sharedlinkflags"": null,
                        ""exelinkflags"": null,
                        ""objects"": null,
                        ""sysroot"": null,
                        ""requires"": null,
                        ""properties"": null
                    }
                },
                ""conf_info"": {},
                ""label"": ""pkgconf/2.1.0"",
                ""info"": {
                    ""settings"": {
                        ""os"": ""Linux"",
                        ""arch"": ""armv8"",
                        ""build_type"": ""Release""
                    },
                    ""options"": {
                        ""enable_lib"": ""False""
                    }
                },
                ""dependencies"": {
                    ""22"": {
                        ""ref"": ""meson/1.2.2"",
                        ""run"": true,
                        ""libs"": false,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": true,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": null,
                        ""visible"": false
                    },
                    ""23"": {
                        ""ref"": ""ninja/1.11.1"",
                        ""run"": true,
                        ""libs"": false,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": false,
                        ""build"": true,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": null,
                        ""visible"": false
                    }
                },
                ""context"": ""build"",
                ""test"": false
            },
            ""22"": {
                ""ref"": ""meson/1.2.2#04bdfb85d665c82b08a3510aee3ffd19"",
                ""id"": ""22"",
                ""recipe"": ""Cache"",
                ""package_id"": ""da39a3ee5e6b4b0d3255bfef95601890afd80709"",
                ""prev"": ""97f4a23dd2d942f83e5344b1ca496ce7"",
                ""rrev"": ""04bdfb85d665c82b08a3510aee3ffd19"",
                ""rrev_timestamp"": 1702568761.764,
                ""prev_timestamp"": 1702572748.354,
                ""remote"": null,
                ""binary_remote"": ""conancenter"",
                ""build_id"": null,
                ""binary"": ""Skip"",
                ""invalid_build"": false,
                ""info_invalid"": null,
                ""name"": ""meson"",
                ""user"": null,
                ""channel"": null,
                ""url"": ""https://github.com/conan-io/conan-center-index"",
                ""license"": ""Apache-2.0"",
                ""author"": null,
                ""description"": ""Meson is a project to create the best possible next-generation build system"",
                ""homepage"": ""https://github.com/mesonbuild/meson"",
                ""build_policy"": null,
                ""upload_policy"": null,
                ""revision_mode"": ""hash"",
                ""provides"": null,
                ""deprecated"": null,
                ""win_bash"": null,
                ""win_bash_run"": null,
                ""default_options"": null,
                ""options_description"": null,
                ""version"": ""1.2.2"",
                ""topics"": [
                    ""meson"",
                    ""mesonbuild"",
                    ""build-system""
                ],
                ""package_type"": ""application"",
                ""settings"": {},
                ""options"": {},
                ""options_definitions"": {},
                ""generators"": [],
                ""python_requires"": null,
                ""system_requires"": {},
                ""recipe_folder"": ""/root/.conan2/p/meson9aba974547f5b/e"",
                ""source_folder"": null,
                ""build_folder"": null,
                ""generators_folder"": null,
                ""package_folder"": null,
                ""cpp_info"": {
                    ""root"": {
                        ""includedirs"": [
                            ""include""
                        ],
                        ""srcdirs"": null,
                        ""libdirs"": [
                            ""lib""
                        ],
                        ""resdirs"": null,
                        ""bindirs"": [
                            ""bin""
                        ],
                        ""builddirs"": null,
                        ""frameworkdirs"": null,
                        ""system_libs"": null,
                        ""frameworks"": null,
                        ""libs"": null,
                        ""defines"": null,
                        ""cflags"": null,
                        ""cxxflags"": null,
                        ""sharedlinkflags"": null,
                        ""exelinkflags"": null,
                        ""objects"": null,
                        ""sysroot"": null,
                        ""requires"": null,
                        ""properties"": null
                    }
                },
                ""conf_info"": {},
                ""label"": ""meson/1.2.2"",
                ""info"": {},
                ""dependencies"": {
                    ""23"": {
                        ""ref"": ""ninja/1.11.1"",
                        ""run"": true,
                        ""libs"": false,
                        ""skip"": false,
                        ""test"": false,
                        ""force"": false,
                        ""direct"": true,
                        ""build"": false,
                        ""transitive_headers"": null,
                        ""transitive_libs"": null,
                        ""headers"": false,
                        ""package_id_mode"": null,
                        ""visible"": true
                    }
                },
                ""context"": ""build"",
                ""test"": false
            },
            ""23"": {
                ""ref"": ""ninja/1.11.1#77587f8c8318662ac8e5a7867eb4be21"",
                ""id"": ""23"",
                ""recipe"": ""Cache"",
                ""package_id"": ""85c999356992c5713d308db1a4d7bab6bf572f27"",
                ""prev"": null,
                ""rrev"": ""77587f8c8318662ac8e5a7867eb4be21"",
                ""rrev_timestamp"": 1684431244.21,
                ""prev_timestamp"": null,
                ""remote"": null,
                ""binary_remote"": null,
                ""build_id"": null,
                ""binary"": ""Skip"",
                ""invalid_build"": false,
                ""info_invalid"": null,
                ""name"": ""ninja"",
                ""user"": null,
                ""channel"": null,
                ""url"": ""https://github.com/conan-io/conan-center-index"",
                ""license"": ""Apache-2.0"",
                ""author"": null,
                ""description"": ""Ninja is a small build system with a focus on speed"",
                ""homepage"": ""https://github.com/ninja-build/ninja"",
                ""build_policy"": null,
                ""upload_policy"": null,
                ""revision_mode"": ""hash"",
                ""provides"": null,
                ""deprecated"": null,
                ""win_bash"": null,
                ""win_bash_run"": null,
                ""default_options"": null,
                ""options_description"": null,
                ""version"": ""1.11.1"",
                ""topics"": [
                    ""ninja"",
                    ""build""
                ],
                ""package_type"": ""application"",
                ""settings"": {
                    ""os"": ""Linux"",
                    ""arch"": ""armv8"",
                    ""compiler"": ""gcc"",
                    ""compiler.cppstd"": ""gnu17"",
                    ""compiler.libcxx"": ""libstdc++11"",
                    ""compiler.version"": ""12"",
                    ""build_type"": ""Release""
                },
                ""options"": {},
                ""options_definitions"": {},
                ""generators"": [],
                ""python_requires"": null,
                ""system_requires"": {},
                ""recipe_folder"": ""/root/.conan2/p/ninja19c9f8e277acc/e"",
                ""source_folder"": null,
                ""build_folder"": null,
                ""generators_folder"": null,
                ""package_folder"": null,
                ""cpp_info"": {
                    ""root"": {
                        ""includedirs"": [
                            ""include""
                        ],
                        ""srcdirs"": null,
                        ""libdirs"": [
                            ""lib""
                        ],
                        ""resdirs"": null,
                        ""bindirs"": [
                            ""bin""
                        ],
                        ""builddirs"": null,
                        ""frameworkdirs"": null,
                        ""system_libs"": null,
                        ""frameworks"": null,
                        ""libs"": null,
                        ""defines"": null,
                        ""cflags"": null,
                        ""cxxflags"": null,
                        ""sharedlinkflags"": null,
                        ""exelinkflags"": null,
                        ""objects"": null,
                        ""sysroot"": null,
                        ""requires"": null,
                        ""properties"": null
                    }
                },
                ""conf_info"": {},
                ""label"": ""ninja/1.11.1"",
                ""info"": {
                    ""settings"": {
                        ""os"": ""Linux"",
                        ""arch"": ""armv8"",
                        ""build_type"": ""Release""
                    }
                },
                ""dependencies"": {},
                ""context"": ""build"",
                ""test"": false
            }
        },
        ""root"": {
            ""0"": ""None""
        },
        ""overrides"": {},
        ""resolved_ranges"": {},
        ""replaced_requires"": {},
        ""error"": null
    }
}

```

</details>

Looks like we can parse cache dir - i do this for licenses in #6329.
We will then need to parse `conanfile.txt` to detect direct dirs.

But User can use `conanfile.py` instead of `conanfile.txt` (https://docs.conan.io/2/reference/conanfile_txt.html).
But if i understand correctly - `conanfile.txt` is toml file. So parse will not be a problem and we can add parse of it.
@dus7eh Can you share your experience - how often do users use `conanfile.txt`?
"
2071742197,6357,dus7eh,2024-04-23T08:39:34Z,"It's hard for me to tell which is the preferred way of working with conan. This depends a lot on a specific usecase. For simple library consumers `conanfile.txt` would be the way to go. However, if you're trying to perform some builds to diferent targets, apply configuration validation logic, or create a package yourself then you should be picking `conanfile.py`.
Here's a sample [article](https://docs.conan.io/2/tutorial/consuming_packages/the_flexibility_of_conanfile_py.html) about the flexability that the py script brings.

Best would be probably to leave handling of the dependency graph to conan itself (via `conan graph info -f json .` command) not to rewrite the same logic in trivy ([graph info](https://github.com/conan-io/conan/blob/develop2/conan/cli/commands/graph.py#L167)). Although, this would put a necessity of having `conan` as a dependency or put a requirement for the user to have it preinstalled in the env where trivy is used."
2071852886,6357,knqyf263,2024-04-23T09:34:47Z,">Best would be probably to leave handling of the dependency graph to conan itself (via conan graph info -f json . command) not to rewrite the same logic in trivy ([graph info](https://github.com/conan-io/conan/blob/develop2/conan/cli/commands/graph.py#L167)). Although, this would put a necessity of having conan as a dependency or put a requirement for the user to have it preinstalled in the env where trivy is used.

We wouldn't go down this way.
https://aquasecurity.github.io/trivy/v0.50/community/principles/#external-dependency-free-single-binary
"
2073979288,6357,DmitriyLewen,2024-04-24T03:59:51Z,"@knqyf263 @dus7eh  I did some research, and found some difficulties with parsing cache directory to detect child deps:
It looks like only `conanfile.py` fileы contain info about child deps:
```bash
root@3472c8d16413:/app# grep -r ""libiconv"" /root/.conan2/p/pulsee2b7eff0be0d2
/root/.conan2/p/pulsee2b7eff0be0d2/e/conanfile.py:        self.requires(""libiconv/1.17"")
/root/.conan2/p/pulsee2b7eff0be0d2/e/conanfile.py:        self.cpp_info.components[""pulse""].requires = [""libiconv::libiconv"", ""libsndfile::libsndfile"", ""libgettext::libgettext""]
```

`conanfile.py` contains child deps in [requires](https://docs.conan.io/2/reference/conanfile/attributes.html#requires) field.
But `conanfile.py` is Python file. So we can see:
- functions - https://github.com/conan-io/conan-center-index/blob/7c859f90ce3997e3501bbd27b8522c496d26c1f5/recipes/pulseaudio/all/conanfile.py#L59
- conditionals - https://github.com/conan-io/conan-center-index/blob/7c859f90ce3997e3501bbd27b8522c496d26c1f5/recipes/pulseaudio/all/conanfile.py#L64-L65
- requires for other components - https://github.com/conan-io/conan-center-index/blob/7c859f90ce3997e3501bbd27b8522c496d26c1f5/recipes/pulseaudio/all/conanfile.py#L143"
2074199284,6357,knqyf263,2024-04-24T06:50:05Z,"@DmitriyLewen So, do you think it's hard to support the dependency graph for Conan v2 lock files? If so, we can merge this PR and work on the dependency graph later."
2074210426,6357,DmitriyLewen,2024-04-24T06:57:22Z,"> If so, we can merge this PR and work on the dependency graph later.

let's do this because it looks like it can't be done using Go 😞"
2082092221,6357,dus7eh,2024-04-29T07:54:33Z,"> @DmitriyLewen So, do you think it's hard to support the dependency graph for Conan v2 lock files? If so, we can merge this PR and work on the dependency graph later.

I'm all for that if I have anything to say :) Graph can be dealt with independently giving some basic support to conan v2 sooner than later."
2082390205,6357,knqyf263,2024-04-29T10:37:29Z,Thank you guys!
2286991462,7339,CLAassistant,2024-08-13T19:36:39Z,[![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=7339) <br/>All committers have signed the CLA.
2286991465,7339,CLAassistant,2024-08-13T19:36:39Z,"[![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=7339) <br/>Thank you for your submission! We really appreciate it. Like many open source projects, we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/aquasecurity/trivy?pullRequest=7339) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/aquasecurity/trivy?pullRequest=7339) it.</sub>"
2310526173,7339,michael-a-shelton,2024-08-26T15:48:48Z,I left a comment on the discussion but will leave it here in hopes to get some feedback. Can we use a CCLA instead of ICLA? This contribution is on behalf of JPMorgan
2316155292,7339,brooklynrob,2024-08-28T20:04:55Z,"> [![CLA assistant check](https://camo.githubusercontent.com/bb14f9741a98be03eb447ca21a4a5e96201df401e5be70f9ef52130f4e1ff903/68747470733a2f2f636c612d617373697374616e742e696f2f70756c6c2f62616467652f6e6f745f7369676e6564)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=7339) Thank you for your submission! We really appreciate it. Like many open source projects, we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/aquasecurity/trivy?pullRequest=7339) before we can accept your contribution.You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/aquasecurity/trivy?pullRequest=7339) it.

I am the CLA at approver JPMC and @michael-a-shelton is approved to contribute on our behalf. It appears you have an ICLA that you use as a form of CCLA? Is that correct?"
2316392266,7339,simar7,2024-08-28T23:13:42Z,"> > [![CLA assistant check](https://camo.githubusercontent.com/bb14f9741a98be03eb447ca21a4a5e96201df401e5be70f9ef52130f4e1ff903/68747470733a2f2f636c612d617373697374616e742e696f2f70756c6c2f62616467652f6e6f745f7369676e6564)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=7339) Thank you for your submission! We really appreciate it. Like many open source projects, we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/aquasecurity/trivy?pullRequest=7339) before we can accept your contribution.You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/aquasecurity/trivy?pullRequest=7339) it.
> 
> I am the CLA at approver JPMC and @michael-a-shelton is approved to contribute on our behalf. It appears you have an ICLA that you use as a form of CCLA? Is that correct?

cc @itaysk "
2334256944,7339,itaysk,2024-09-06T15:02:59Z,@brooklynrob if you want to do CCLA please send an email to oss@aquasec.com
2342043296,7339,michael-a-shelton,2024-09-10T21:29:34Z,"@knqyf263 Any chance for a review for approval on this? Would like to either close/merge this, or adjust any final feedback you may have."
2342638092,7339,knqyf263,2024-09-11T05:11:49Z,"Sorry, I thought it was about misconfigurations, so I left the review to @simar7 and @nikpivkin and didn't look at it.

IMHO, it should be done [by Rego](https://aquasecurity.github.io/trivy/v0.55/docs/configuration/filtering/#by-rego). There is [some discussion](https://github.com/aquasecurity/trivy/pull/7339/files#r1718022223) about whether it should be an exact match or a range, for example, but this depends on the user. Also, other users may want to filter by other fields in the CauseMetadata. I think that it is not practical to cover all of those use cases in the ignorefile."
2343777574,7339,michael-a-shelton,2024-09-11T14:06:22Z,"Rego is a syntax that a lot of engineers are not familiar with. We are intending to drop this into dozens and dozens of repositories and asking 50-75 engineers to use it. Adding lines to a config file is a far smaller learning curve than adding in/maintaining rego, project to project, engineer to engineer. 

By not having line configurations in an ignore file, you're actually producing false findings by ignoring entire rulesets for an entire scan, when it should be more explicit (or at least allow that level of granularity). Specifically, for helm template configuration checks example; it could have two deployment manifests, one that has privileged containers and one that does not. Not having a line enforcement on the ignore file would ignore that rule across both entirely when it should not, and allow privileged containers where it was not intended on a configuration check."
2344122185,7339,knqyf263,2024-09-11T16:25:47Z,">Rego is a syntax that a lot of engineers are not familiar with. We are intending to drop this into dozens and dozens of repositories and asking 50-75 engineers to use it.

Once someone writes a simple example, others in your organization can copy and tweak it. Actually, the line-based filtering can be written within 10 lines.

```
package trivy

default ignore = false

# Ignore AVD-AWS-0086 in line 3-5
ignore {
    input.ID == ""AVD-AWS-0086""
    input.CauseMetadata.StartLine == 3
    input.CauseMetadata.EndLine == 5
}
```

You can even write the line range as below.

```
ignore {
    input.ID == ""AVD-AWS-0086""
    input.CauseMetadata.StartLine > 2
    input.CauseMetadata.EndLine < 6
}
```

As described above, line-based filtering is not expensive to learn and ultimately gives you more flexibility. For example, engineers in other teams may want to filter by the service name.

```
ignore {
    input.ID == ""AVD-AWS-0086""
    input.CauseMetadata.Service == ""s3""
}
```

While I agree that the learning cost of Rego is high (in fact, I'm always struggling with Rego), I believe it is low for this case as it simply accesses each field of the JSON, like `jq`. Adding richer examples [here](https://github.com/aquasecurity/trivy/tree/8876e7065554648a6a85def697559933d9a55706/contrib/example_policy) may help.

@simar7 @nikpivkin, what do you think? The above Rego is simple enough for me, but if you both consider adding this support to `.trivyignore` makes sense, I'm open to it. I just left my thoughts.

>By not having line configurations in an ignore file, you're actually producing false findings by ignoring entire rulesets for an entire scan, when it should be more explicit (or at least allow that level of granularity). Specifically, for helm template configuration checks example; it could have two deployment manifests, one that has privileged containers and one that does not. Not having a line enforcement on the ignore file would ignore that rule across both entirely when it should not, and allow privileged containers where it was not intended on a configuration check.

Yes, I understand the use case, but many demands exist, and it is difficult to address them all in the ignore file. `.trivyignore` is assumed to be used for simple filtering only."
2344687664,7339,simar7,2024-09-11T20:57:06Z,"@knqyf263 your examples have made me rethink this. To be honest @michael-a-shelton if you still think we should add your changes for any reasons not addressed above, please do let us know. I do think to @knqyf263's point that in this particular case Rego is in fact not that hard to write plus is more flexible. At the same time, I don't want to be a gatekeeper for a change if it has a valid reason to exist.

Also to @knqyf263 's point about adding examples such as this is a great idea. This isn't the first time we've received a request to have more granular control over ignores and I feel with Rego's flexibility, we could add more insight into how to tackle such cases. As an example, we've re-written our own checks in Rego so there's a lot more examples to learn from. See [here](https://github.com/aquasecurity/trivy-checks/tree/main/checks).

@nikpivkin is on leave at the moment but once he's back, I'd like to hear from him as well on what he has to say."
2344885970,7339,michael-a-shelton,2024-09-11T23:10:49Z,"I do not think rego solves my issue. Rego is inherently hard to get engineers to learn, especially those who do not work with it regularly. It would be difficult to scale to some of our needs. For example, one chart has 200 ignore rules in the ignore file that we run, when using the granular control. This is a CNCF OSS chart and not our own. Doing that in rego would be unwieldly and unfriendly to those not familiar with rego itself.  That is one chart out of the 40-50 we're pushing. 

The config file approach is in line with other linters (Which is essentially what the misconf is for us, here, for helm templating). It is important to us to try to avoid additional cognitive load on engineers, and staying to the same pattern of maintaining config that is the standard across most tools in the space is ideal. Already managing linters for go, python, terraform, markdown, etc, it is a pattern that has no learning curve. 

I also think the ignorefile concept for misconf is inherently broken without the use of explicit lines. So, it is not so much a feature as it is a potential bugfix.

For example; running the misconf scan against a template that has clusterroles. ksv048 flags over privileged cluster roles, however there is a need for the CRUD verbs on one of the admin roles. By simply adding ksv048 to the ignore file, it is now essentially disabling that rule for the admin role and other possibly read-only roles in the same file. This is a security risk. By stating we only want to ignore ksv048 for lines 9-14, it will still be enforced on the read-only clusterrole. 

We could split this into separate files for this scenario, however we have seen this same pattern a lot in upstream OSS components and we try to avoid manipulating those and deviating from upstream. 

I realize the yaml ignorefile is experimental, but it is something we would like to use. The other alternative would be creating a rego wrapper and loading the yaml config ourselves and parsing it in rego, which I would like to avoid doing."
2345310346,7339,knqyf263,2024-09-12T05:33:38Z,">This isn't the first time we've received a request to have more granular control over ignores and I feel with Rego's flexibility, we could add more insight into how to tackle such cases

Exactly. Ignoring by line number exact matching is necessary in this case, but other users have other needs.

>@nikpivkin is on leave at the moment but once he's back, I'd like to hear from him as well on what he has to say.

Ah, I forgot about it. I'd like to hear his thoughts as well.

>Rego is inherently hard to get engineers to learn, especially those who do not work with it regularly. It would be difficult to scale to some of our needs.

If you are limiting yourself to a specific application (e.g., line-based filtering), there is no need to learn Rego syntax. Simply modify the line numbers in the sample I wrote.

These two files are almost the same.

```
  - id: AVD-AWS-0086
    start_line: 3
    end_line: 5
```

```
ignore {
    input.ID == ""AVD-AWS-0086""
    input.CauseMetadata.StartLine == 3
    input.CauseMetadata.EndLine == 5
}
```

What is the difference for you? Debugging Rego can be difficult if it does not work as expected, but so is YAML. Without reading the source code, it is impossible to understand how `.trivyignore.yaml` is processed.
Like @simar7 said, I am not opposed to adding the feature if there is a good reason. I'm just trying to understand what is preventing you from using Rego."
2346103531,7339,michael-a-shelton,2024-09-12T12:04:29Z,"It is managing code versus managing config. Code has significantly more overhead with it in regards to TLM. It is also quite a bit more verbose and more prone to error. For a one off scenario, I agree the rego approach is fine. At scale and longevity is where issues may start popping up.

OPA v1 changes are an example here; this does not fit that syntax and would break when required/moved to it. Also, if CauseMetadata or any part of that struct changes, all of  the rego now becomes invalidated. 

One chart out of the many we work with has over 200 entries for an ignore file. ID, start_line, end_line, statement. That is 800 lines, which is a lot in it's own right.

However, moving that to rego now becomes 1200 lines (adding the lines for the ignore block and the spaces before/after). Sure, we could write more advanced rego to eliminate duplication of ignore blocks per ID and handle the sets of lines, but that gets back into managing and requiring engineers now to understand sets/comprehension etc in rego. Let's now take that number and multiple it times the amount of charts we're managing of 40-50, and you see how quickly that becomes unmanageable. Now, not every repo  has 200 entries, but lets use that number and extrapolate... thats 48k lines of rego that now have to be managed.

Should a change to CauseMetadata struct happen, or the flip to OPAv1 syntax, a config file is abstracted away from those changes and would not require any uplift. The rego approach would require alterations to 48k lines of uplift. "
2346282122,7339,knqyf263,2024-09-12T13:26:30Z,">At scale and longevity is where issues may start popping up.

This sounds like the opposite argument to me. As the operation scales, YAML becomes inadequate, and more flexible filtering is needed. This is actually what we have seen over the years.

>However, moving that to rego now becomes 1200 lines (adding the lines for the ignore block and the spaces before/after).

A comparison with regard to the line number would help the transition to Rego more, although I don't think it is meaningful. As you also mentioned, rules can be written in short as follows.

```
package trivy

default ignore = false

ignore {
    rule = [
        {""id"": ""AVD-AWS-0086"", ""start"": 1, ""end"": 3},
        {""id"": ""AVD-AWS-0087"", ""start"": 1, ""end"": 6},
        {""id"": ""AVD-AWS-0088"", ""start"": 10, ""end"": 20}
        {""id"": ""AVD-AWS-0089"", ""start"": 20, ""end"": 30}
    ][_]
    input.ID == rule.id
    input.CauseMetadata.StartLine == rule.start
    input.CauseMetadata.EndLine == rule.end
}
```

If there are 200 rules, YAML will result in 800 lines, whereas Rego will only require 210 lines. If there are 50 repositories, with YAML it is 40k lines, but with Rego it is about 10k lines. However, again, a comparison of line numbers doesn't make sense to me.

OPA v1 changes make sense, but it can also happen in Trivy's ignorefile. As you probably know, Trivy used to have `.trivyignore`, but needed to introduce `.trivyignore.yaml` for more flexibility. Furthermore, `.trivyignore.yaml` is still an experimental feature that is subject to breaking changes. We try to minimize such change, but sometimes it is unavoidable. It may not be correct to assume that a change in `.trivyignore.yaml` is less disruptive than one in Rego.

I assume that OPA is not yet stable as it is below v1, which is why breaking changes will be made at the time of becoming v1, but it is expected to be stable after reaching v1. Also, for migration to the new syntax, [migration methods are supported](https://www.openpolicyagent.org/docs/latest/opa-1/#making-new-and-existing-policies-compatible-with-opa-v10-3
) at language level, such as `opa fmt --refactor-local-variables`. If changes are made to `.trivyignore.yaml`, it is difficult to provide such functionality.

In conclusion, our policy is to recommend Rego for more advanced filtering and implement it in `.trivyignore.yaml` for the basic filtering that most people need. Otherwise, we end up implementing very complex logic in `.trivyignore.yaml`. @simar7 should know more about how much need there is, so I'd defer to him."
2604270703,8244,knqyf263,2025-01-21T10:14:17Z,"@DmitriyLewen I tried to reduce duplicates in https://github.com/aquasecurity/trivy/pull/8244/commits/2981a6f5cfb37d152e1e10949b2c42085de8a5df, but please correct me if I'm missing something."
2606463790,8244,DmitriyLewen,2025-01-22T07:15:33Z,"I always forget that i can use generics :(
great implementation 👍 
LGTM"
2606509406,8244,knqyf263,2025-01-22T07:45:38Z,">I always forget that i can use generics :(

I'm not a big fan of generics as it complicates things, but we can use it in simple cases."
938505508,1287,czunker,2021-10-08T09:48:42Z,"I also tried to create a httpClient with the new transport config, but that didn't work out:
```
httpClient := &http.Client{
	Transport: httpTransport,
}
return rpc.NewScannerProtobufClient(string(remoteURL), httpClient), nil

```

Only the change to the DefaultTransport fixed the TLS verification failure.

In case you have an idea or a pointer, I'd be glad to give it a try."
988538676,1287,knqyf263,2021-12-08T06:32:21Z,">I also tried to create a httpClient with the new transport config, but that didn't work out:

Hmm. It should work. Could you describe how it didn't work?"
988687232,1287,czunker,2021-12-08T10:27:59Z,"When I remember correctly, I still got verification errors.

But, I can try to reproduce it in the coming days."
990681069,1287,czunker,2021-12-10T07:26:52Z,"It turned out
```
httpClient := &http.Client{
	Transport: httpTransport,
}
return rpc.NewScannerProtobufClient(string(remoteURL), httpClient), nil
```
actually worked.

Changing the `DefaultTransport` made it work accidentally. The x509 error, I experienced, wasn't thrown by the rpc client, but by the remote cache client.

Adding the `TRIVY_INSECURE` also to the cache remote client resolved the problem. So, no need to change the `DefaultTransport`.

The new commit changes this and also adds tests for both clients."
1009632540,1287,czunker,2022-01-11T06:17:30Z,Just rebased the branch. @knqyf263 Could you please have a look again?
1028770998,1287,knqyf263,2022-02-03T09:18:49Z,I'm sorry for the late reply. I was busy on [v0.23.0](https://github.com/aquasecurity/trivy/discussions/1652). I have some time for a while and want to wrap up this PR. Could you please resolve conflicts first?
1029641911,1287,czunker,2022-02-04T05:18:28Z,Rebased and resolved conflicts.
1037962766,1287,knqyf263,2022-02-13T09:34:42Z,Thanks a lot!
1048040955,1756,CLAassistant,2022-02-22T17:31:41Z,[![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=1756) <br/>All committers have signed the CLA.
1048198199,1756,krol3,2022-02-22T20:47:52Z,"@natefear thanks for your contribution, do you think that you could update the documentation about how to use it, some screenshots about the report will be nice to have in the documentation too. 

https://aquasecurity.github.io/trivy/v0.23.0/advanced/integrations/gitlab-ci/"
1048699368,1756,natefive,2022-02-23T11:46:01Z,"Hi @krol3 I'll add some screen shots in a bit I just would like to discuss the template further first :)

At present the gitlab-codequality.tpl template will set the  package name and version as the path for vulnerabilities (cve's)        https://github.com/aquasecurity/trivy/blob/378b115deceba50b18c9120b1d90e776b50d88da/contrib/gitlab-codequality.tpl#L31 whilst this is more useful when doing an image scan because the target https://github.com/aquasecurity/trivy/blob/378b115deceba50b18c9120b1d90e776b50d88da/contrib/gitlab-codequality.tpl#L5 is just the  image name e.g. `aquasec/trivy (alpine 3.15.0)` when scanning trivy, this is however not as useful as it could be when doing filesystem scan as in this scenario the `.Target` key is able to point to the exact file the vulnerability (cve) originates from e.g. a pip file and you can then click on it in the Gitlab UI to take you to the file.

To try to get the best of both, should I:

1. Always set path to $target for vulnerabilities (cve's) but include the package name and version in the description
2. Try to get the `ArtifactType` field exposed to the report templating logic then use this to create conditions - at present the untemplated json report includes an `ArtifactType` field (see code block below) which lets you know if the report is from an image or file system scan however the templating fuction only knows about the contents of the results array. See error: ""output template"" at <.ArtifactType>: can't evaluate field ArtifactType in type report.Results""
3. Create a separate template for filesystem scans

```
  ""SchemaVersion"": 2,
  ""ArtifactName"": ""."",
  ""ArtifactType"": ""filesystem"",
  ""Metadata"": {
    ""ImageConfig"": {
      ""architecture"": """",
      ""created"": ""0001-01-01T00:00:00Z"",
      ""os"": """",
      ""rootfs"": {
        ""type"": """",
        ""diff_ids"": null
      },
      ""config"": {}
    }
  },
  ""Results"": [
```

"
1055485400,1756,natefive,2022-03-01T14:10:34Z,@knqyf263 would I be able to get your thoughts on the above ^? :)
1056855705,1756,knqyf263,2022-03-02T12:06:46Z,"To be honest, I've never used GitLab Code Quality, but it seems to be associated with the project's files. I feel like we should use `path` for file paths. #1 looks good from that perspective.
"
1056981848,1756,natefive,2022-03-02T14:20:03Z,"@knqyf263 I've added screen shots to make it clearer :)

At present (master) we get the severity, CVE ID and title in the description and package name and version in the path for CVE's when doing an image scan using the gitlab code quality template:
![Screenshot from 2022-03-02 13-42-13](https://user-images.githubusercontent.com/11523803/156375577-2b50d126-0033-43d3-a4e6-b0ccdd547650.png)

and the same again for CVE's when doing an filesystem scan using the gitlab code quality template:
![Screenshot from 2022-03-02 13-43-16](https://user-images.githubusercontent.com/11523803/156376239-c092f3ca-188f-4e1b-97e2-c39c42f5e0d1.png)

After implementing option 1: Always setting path to $target for vulnerabilities (CVE's) but include the package name and version in the description

The package name and version would be moved the the description (taking suggestions on what separators to use) and the path would output the docker image path (making it abit easier to manually find the source of the CVE)
![Screenshot from 2022-03-02 13-51-47](https://user-images.githubusercontent.com/11523803/156377899-24d0ffb6-4946-42ae-879d-8c730c11a8e4.png)
N.B redacted part of the image path hence the blank bits

however this would greatly improve the output of CVE's picked up by filesystem scans as the report can then link you to the file where the CVE originates
![Screenshot from 2022-03-02 13-50-03](https://user-images.githubusercontent.com/11523803/156375505-ee80f1c9-0bd5-4c43-8988-ad64f60cb7e5.png)
N.B redacted part of the file path hence the blank bits"
1057993674,1756,knqyf263,2022-03-03T12:28:09Z,@natefear Thanks for the detailed explanation. It looks good.
1058130488,1756,natefive,2022-03-03T15:02:08Z,"@krol3 @knqyf263 Added a screen shot of the expected output when using the template to the docs, let me know if you want me to crop the screen shot further :) thanks"
1058163186,1756,knqyf263,2022-03-03T15:34:24Z,"Thanks, but the link seems to be broken.

<img width=""710"" alt=""image"" src=""https://user-images.githubusercontent.com/2253692/156595498-e0c2f431-0494-45df-bb03-d5be4f05df56.png"">

You can see the doc by running `make mkdocs-serve` and visiting http://localhost:8000. Also, you can refer to other places.
https://github.com/aquasecurity/trivy/blob/9e08bd44fb3c50360d4b992a4d843824c8272c95/docs/advanced/modes/standalone.md?plain=1#L7"
1058251927,1756,natefive,2022-03-03T16:48:30Z,"@knqyf263 It works [here](https://github.com/aquasecurity/trivy/blob/8cab693fbad4755f14346f4fcc78613514d20bf6/docs/advanced/integrations/gitlab-ci.md) and locally via mkdocs, I think it's broken when viewing in rich diff mode in the files changes UI because it's trying to look in the main branch -> https://github.com/aquasecurity/trivy/blob/main/docs/imgs/gitlab-codequality.png which is 404"
1059102676,1756,natefive,2022-03-04T12:02:30Z,fixed failing integration tests - https://github.com/aquasecurity/trivy/runs/5410960038?check_suite_focus=true#step:4:352 by updating the expected output https://github.com/aquasecurity/trivy/pull/1756/files#diff-987afca26799d63f38791b6b5f7f8e7dce0b1d123ea64db563f7e59ba92cae2fR6
1059913358,1756,knqyf263,2022-03-06T07:49:51Z,">@knqyf263 It works [here](https://github.com/aquasecurity/trivy/blob/8cab693fbad4755f14346f4fcc78613514d20bf6/docs/advanced/integrations/gitlab-ci.md) and locally via mkdocs, I think it's broken when viewing in rich diff mode in the files changes UI because it's trying to look in the main branch -> https://github.com/aquasecurity/trivy/blob/main/docs/imgs/gitlab-codequality.png which is 404

We use MkDocs and it must work here after building the doc. You don't need to care about how it looks like on GitHub.
https://aquasecurity.github.io/trivy/v0.24.2/advanced/integrations/gitlab-ci/"
1059914818,1756,knqyf263,2022-03-06T08:01:39Z,"Oh, I missed you said it worked locally via mkdocs. Let me check it again."
1059915551,1756,knqyf263,2022-03-06T08:06:24Z,"Again, it doesn't work. The path seems to be wrong.
<img width=""596"" alt=""image"" src=""https://user-images.githubusercontent.com/2253692/156914717-ce5534e3-eca8-48e8-a7a4-40ab72a5e502.png"">
"
1060605591,1756,natefive,2022-03-07T11:51:10Z,@knqyf263 ahh you're right apologies I'd not pushed the extra `../` - I've pushed it now
1063133139,1756,natefive,2022-03-09T16:49:09Z,"@knqyf263 @krol3 can someone kick the tests off, approve and merge this if you think it's ready :) thanks

the tests had already run successfully once, but I've had to rebase because the main branch has been updated "
1069119234,1756,natefive,2022-03-16T13:18:16Z,@knqyf263 @krol3 -  by the time someone responds to run the tests or approves the PR my branch becomes out of sync with main :( try again please?
1069137937,1756,natefive,2022-03-16T13:35:58Z,"@knqyf263 @krol3 not sure if one of you triggered the tests, but they're done and ready for approval :) thanks"
1069427336,1756,natefive,2022-03-16T18:29:24Z,@krol3 Seems odd that you want me to include the proposed changes from someone else's PR in this one? shouldn't you be letting me merge and then asking other PR author to rebase so they can add it where relevant
1069793268,1756,krol3,2022-03-17T00:58:13Z,"@natefear, I was trying to tell you, is that you'll probably need to do a remerge. I will focus on reviewing your PR"
1070839584,1756,natefive,2022-03-17T12:01:21Z,@krol3 ahh okay sorry didn't see there MR had already been approved :) I guess I'll wait for them to merge
1071111689,1756,knqyf263,2022-03-17T17:16:42Z,Merged #1801 
1073801872,1756,natefive,2022-03-21T11:51:49Z,@krol3 @knqyf263 rebased to include the CI env var changes 
1080684385,1756,natefive,2022-03-28T13:55:21Z,@krol3 @knqyf263 rebased again :(
1081921918,1756,natefive,2022-03-29T14:10:56Z,@krol3 @knqyf263 are either of you authorised to merge :) ty
1083243791,1756,knqyf263,2022-03-30T14:55:18Z,Thanks!
2202259951,7039,knqyf263,2024-07-02T08:08:30Z,@DmitriyLewen Can you create an issue so we can add it to the [v0.54.0 milestone](https://github.com/aquasecurity/trivy/milestone/36)?
2202380618,7039,DmitriyLewen,2024-07-02T08:58:42Z,@knqyf263 Created #7079
2238236655,7039,DmitriyLewen,2024-07-19T05:36:51Z,"I updated PR according to notes
@knqyf263 @ericstj if you don't have any suggestions - i think we can merge this PR."
2313044372,7039,ericstj,2024-08-27T16:39:27Z,"@DmitriyLewen  It looks like this might not be working correctly.  We're still seeing reports of this when using the latest trivvy 0.54.1.  Is there a way to get some diagnostic information out of trivvy to see why it's still flagging vulnerabilities here?

"
2313927168,7039,DmitriyLewen,2024-08-28T01:47:31Z,"Hello @ericstj 
Trivy has `debug` flag, but I'm not sure if it will help you.
It seems like one way is to use the IDE debugger to step through it.
Or you can send me a test file and I'll check it."
2316007329,7039,ericstj,2024-08-28T18:30:56Z,"@DmitriyLewen 
The command I was trying was this: 
`docker run -it aquasec/trivy:0.54.1 image mcr.microsoft.com/dotnet/sdk:8.0 --scanners vuln --vuln-type library --debug`

It reports a vulnerability in System.Formats.Asn1, however all files present are updated.

I believe it's still seeing mention to the older package versions in deps files, however I believe all those deps files should have empty targets sections.  If I search the container for any other copies of this file, I do see one in powershell, but that's also of sufficient version to not trigger.
"
2316807411,7039,DmitriyLewen,2024-08-29T06:25:55Z,"Hello @ericstj 
I found file with `System.Formats.Asn1`dependency
Trivy found this file from spdx file:
```bash
➜  7039 docker run -it --rm mcr.microsoft.com/dotnet/sdk:8.0 cat /usr/share/powershell/.store/powershell.linux.arm64/7.4.4/powershell.linux.arm64/7.4.4/tools/net8.0/any/Modules/PSReadLine/_manifest/spdx_2.2/manifest.spdx.json | grep '""name"": ""System.Formats.Asn1""' -A 16
      ""name"": ""System.Formats.Asn1"",
      ""SPDXID"": ""SPDXRef-Package-D60BE9A079A339572CC368D77C4FE3CD4860E5B2846B9831B99485A3ABD77F4B"",
      ""downloadLocation"": ""NOASSERTION"",
      ""filesAnalyzed"": false,
      ""licenseConcluded"": ""NOASSERTION"",
      ""licenseDeclared"": ""NOASSERTION"",
      ""copyrightText"": ""NOASSERTION"",
      ""versionInfo"": ""6.0.0"",
      ""externalRefs"": [
        {
          ""referenceCategory"": ""PACKAGE-MANAGER"",
          ""referenceType"": ""purl"",
          ""referenceLocator"": ""pkg:nuget/System.Formats.Asn1@6.0.0""
        }
      ],
      ""supplier"": ""NOASSERTION""
    },
```"
2318087748,7039,ericstj,2024-08-29T15:20:38Z,"Oh, that's interesting.  It's an SBOM from powershell.  It's another false positive since they aren't actually shipping that binary.  I'll follow up with them to see if it's a problem they can fix.

Thank you for your help.  Is there any trick to getting the map of components out of the scanner or more logging out of the scanner?"
2319990924,7039,DmitriyLewen,2024-08-30T04:17:50Z,">  Is there any trick to getting the map of components out of the scanner

`json` format + `'--list-all-pkgs` flag shows all detected packages."
2322162800,7039,ericstj,2024-08-30T18:58:32Z,"Perfect, thank you!"
1059992030,1799,CLAassistant,2022-03-06T16:18:34Z,[![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=1799) <br/>All committers have signed the CLA.
1076848589,1799,knqyf263,2022-03-23T21:42:26Z,Thanks
1077277897,1799,hazcod,2022-03-24T06:21:39Z,Thank you @tamirkiviti13 !
1426865838,3599,CLAassistant,2023-02-11T20:03:05Z,[![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=3599) <br/>All committers have signed the CLA.
1428509101,3599,aswath-s-tw,2023-02-13T19:12:28Z,"Hey @AndreyLevchenko , Thank you so much for suggesting changes. Have tried my bit in improving the code as per the mentioned suggestions. Please take a look at it and let me know ! Thanks again."
1429499239,3599,aswath-s-tw,2023-02-14T10:35:15Z,Not sure why the windows section in pipeline failed. Any ideas on this ?
1429579110,3599,aswath-s-tw,2023-02-14T11:28:04Z,"I think i got it, for windows, the domain socket url starts with `npipe` instead of `unix`. not sure how we handle this though ! Any suggestions @AndreyLevchenko "
1429622384,3599,AndreyLevchenko,2023-02-14T11:56:30Z,"> I think i got it, for windows, the domain socket url starts with `npipe` instead of `unix`. not sure how we handle this though ! Any suggestions @AndreyLevchenko

There is lot of examples in trivy code. For instance https://github.com/aquasecurity/trivy/blob/main/pkg/misconf/scanner_test.go#L128"
1429652487,3599,aswath-s-tw,2023-02-14T12:14:39Z,"@AndreyLevchenko, can you trigger the pipeline to see if the current change works ?"
1430004789,3599,pmengelbert,2023-02-14T16:13:50Z,"There is already a way to set the socket address for [containerd](https://github.com/aquasecurity/trivy/blob/aa8e185e030af1193cbdd5a0cbb50d424d025a1e/pkg/fanal/image/daemon/containerd.go#L74), and it's done by environment variable. 

This PR splits the configuration of the socket: docker uses a cli arg and containerd uses an env var.  What's more, the socket for the [podman daemon](https://github.com/aquasecurity/trivy/blob/1d4327487ce5a418258ebcd2a78d602baca6830e/pkg/fanal/image/daemon/podman.go#L30) can only be set indirectly by the `XDG_RUNTIME_DIR` env var.

It's a little awkward to have three different ways to configure the socket address for the three different supported runtimes. Would it be possible to expand the scope of this PR to include support for the other runtimes as well? You would probably also want to rename the flag from `--docker-host` to something like `--runtime-host`, since it would apply across runtime implementations."
1430055925,3599,aswath-s-tw,2023-02-14T16:45:38Z,"sure @pmengelbert , that makes total sense. I can maybe get into implementing your suggestion right after we figure out how to resolve the test for windows environment.
"
1430956282,3599,knqyf263,2023-02-15T08:49:08Z,"I feel like `--runtime-host` could be confusing. I think we want to configure the specific runtime explicitly. I prefer `--docker-host` for the reason. Or, we may need something like `--runtime-host docker:/path/to/socket`."
1433309827,3599,aswath-s-tw,2023-02-16T15:54:02Z,"@knqyf263 @pmengelbert I think we can limit the scope of this issue / PR to support `--docker-host` and discuss more about `--runtime-host` in a different issue ? Let me know your thoughts. 

@AndreyLevchenko Also the pipeline is green RN. Please review and accept the PR or suggest changes if any.

Thanks !"
1433344603,3599,pmengelbert,2023-02-16T16:16:42Z,"> I feel like `--runtime-host` could be confusing. I think we want to configure the specific runtime explicitly. I prefer `--docker-host` for the reason. Or, we may need something like `--runtime-host docker:/path/to/socket`.

@knqyf263 Since the code looks for the image by first attempting the docker socket, then the containerd socket, then podman, then remote registry, I think you are right that there should be either a) separate flags or, b) `--runtime-host` can be supplied multiple times with the runtime as the scheme of the url. Separate flags is probably easier. Thoughts?

The other issue is, what happens if users supply both the flag and the env var? I assume the CLI arg takes precedence.

> @knqyf263 @pmengelbert I think we can limit the scope of this issue / PR to support `--docker-host` and discuss more about `--runtime-host` in a different issue ? Let me know your thoughts.

I'll defer to @knqyf263 but IMO this PR should at least allow setting the socket address by environment variable, since users can do so already with containerd and podman. Thoughts?"
1433398166,3599,aswath-s-tw,2023-02-16T16:53:34Z,I guess all 3 container runtimes can be configured by ENV vars already. The scope of this issue was to add a flag to control the host for local docker engine scan.  
1438915284,3599,knqyf263,2023-02-21T18:21:23Z,">Separate flags is probably easier. Thoughts?

`trivy image --docker-host /path/to/docker.sock --containerd-host /path/to/containerd.sock`

or

`trivy image --runtime-hosts docker:/path/to/docker.sock --runtime-hosts containerd:/path/to/containerd.sock`

The first one may be more intuitive.

>The other issue is, what happens if users supply both the flag and the env var? I assume the CLI arg takes precedence.

Yes, CLI flags should take precedence. I believe `WithHost` takes care of that.
https://github.com/aquasecurity/trivy/blob/c447d1c471eeb477c00fcf3c4ebde66fb609f62c/pkg/fanal/image/daemon/docker.go#L20

>I guess all 3 container runtimes can be configured by ENV vars already. The scope of this issue was to add a flag to control the host for local docker engine scan.

Right.

"
1444880265,3599,aswath-s-tw,2023-02-25T01:34:42Z,"So shall I start working on these changes ? I have one doubt though. Let's assume this scenario. If the user provides `--containerd-host` as an arg, should we limit the scan to just `containerd` and ignore the other 3 scanners ? Same question applies for other host options as well !"
1458421326,3599,pmengelbert,2023-03-07T16:01:57Z,Related https://github.com/aquasecurity/trivy/issues/3049 
1489057954,3599,aswath-s-tw,2023-03-29T17:59:06Z,"https://github.com/aquasecurity/trivy/pull/3599#issuecomment-1444880265

Any updates on this comment ? I can work accordingly if we can make a decision !"
1516227896,3599,knqyf263,2023-04-20T12:17:10Z,"We recently refactored options, and it causes conflicts. It is just bothering you, so I've resolved them.

>should we limit the scan to just containerd and ignore the other 3 scanners ?

No, I don't think so. `--docker-host` just configures the socket path."
1516817960,3599,knqyf263,2023-04-20T19:11:07Z,Thanks for your patience!
2401677838,7664,knqyf263,2024-10-09T08:28:09Z,"@itaysk I'll merge this PR, but we can fix the command name anytime you find a better one."
2401854178,7664,itaysk,2024-10-09T09:48:18Z,"feel free to merge, but I do think we'll need to change it. 
I'll continue the discussion here (even if the PR is merged) since there's no issue/discussion."
2401910473,7664,knqyf263,2024-10-09T10:15:15Z,"@itaysk You can open a discussion if you want. Since I didn't think we needed a discussion on this topic, and it was easy to implement, I didn't create an issue, but I'm open to discussion."
2402071835,7664,itaysk,2024-10-09T11:35:28Z,"I'll try to summarize my feedback into 3 points:

## 1 - main login command should be reserved for main api login

when we say `trivy auth login` it's not very clear what the purpose of this login is for. `docker login`, `gh auth login`, `snyk auth`, `aws sso login` and every other CLI tool with a login command will sign me into the main service that the CLI is representing, and allow me to interact with the service via the CLI. So as a normal user might expect that `trivy auth login` will allow me to sign into the trivy service - maybe this is trivy server mode, maybe this is aqua, maybe this is the future version of trivy server/aqua, but either way, I'm not sure it's expected that the main login command will authenticate me to an arbitrary container registry.

## 2 - registry login is not the only kind of auth we support

Flows based on container registry:
1. pulling image to scan
1. pulling a trivy asset from registry (except vex-db): trivy-db/trivy-java-db/trivy-checks
1. installing wasm modules from registry

Flows not based on container registry:
1. scanning other targets:  all are authenticated ourside of trivy
    1. private repos - GitHub/GitLab token in env vars
    2. k8s clusters - kubeconfig
    3. AMI - AWS SDK env vars
    4. TF modules - TF SDK env vars
1. vex repository: HTTP auth, or implementation specific auth
1. trivy client/server mode: dedicated `--token` flag

## 3 - several registry authentication options

If I understand correctly, this command (or docker login) will cover all of the registry based flows listed abobe.
It appears that if the artifact is hosted in AWS/Azure/GCP registry, docker login (or this command) will not suffice, and cloud-specific authentication will be required (please correct me if wrong). Also, we currently aupport dedicated `--username`/`--password` flags for basic authentication registries. "
2402093444,7664,knqyf263,2024-10-09T11:44:46Z,">docker login (or this command) will not suffice, and cloud-specific authentication will be required (please correct me if wrong)

It is required to obtain a password for `docker login` or `trivy auth login`, like `aws ecr get-login-password | docker login --username AWS --password-stdin xxxxxxxxxxx.dkr.ecr.us-east-1.amazonaws.com`.

`trivy auth registry login` appears to help some of your feedback. What do you think?"
2403390060,7664,simar7,2024-10-09T20:40:47Z,"> my reservation was that when we say trivy auth login it's not very clear what the purpose of this login is for.

@itaysk that's an interesting point and to be honest I do agree, it sounds like trivy requires a login to use it's functionality. 


> trivy auth registry login appears to help some of your feedback. What do you think?

If we're not planning to support any other credentials in the future, `trivy registry login` might be shorter. But on the other hand, if we do want to support future creds (maybe telemetry?), then I agree keeping `trivy auth <subcommand> <action>` is probably better."
2404772416,7664,itaysk,2024-10-10T10:57:16Z,"> `trivy auth registry login` appears to help some of your feedback. What do you think?

yes it does

excuse me for thinking out loud for a bit:
we have a number of other similar commands for managing connection to external registries: ` trivy module`, `trivy plugin` and `trivy vex`. Today these commands don't mange authentication to the respective registries (maybe in the future they will?) but I suspect that if they did, it would be under that subcommand and not under the `auth` subcommand. These commands are grouped as ""Management commands"". Based on this UX that we've evolved into, managing registry connections would have to be under: `trivy registry` subcommand (which is also under Management commands), i.e `trivy registry login` or `trivy registry add`).

The problem with this approach is that it might be confusing with registry scanning (which we don't support today).
Perhaps a better solution in hindsight would have been to move all those administrative commands under a subcommand `trivy admin` (not unlike the proposed `trivy auth`) including `clean`, `module`, `plugin`, `vex`, etc. that would remove any ambiguity and allow us to grow admin commands freely.

But coming back to reality, I guess `trivy auth registry login` is fine, and `trivy registry login` as well. I'd vote for the latter I think."
2404773828,7664,itaysk,2024-10-10T10:57:57Z,I worte this before reading @simar7 's response :)
2404879868,7664,knqyf263,2024-10-10T11:50:19Z,"I don't mind `trivy auth registry login` or `trivy registry login`. I don't think it's a good idea to nest too many commands, so `trivy registry login` looks slightly better.

@DmitriyLewen @nikpivkin Any thoughts? If not, I'd go for `trivy registry login`."
2407137645,7664,DmitriyLewen,2024-10-11T10:41:48Z,`trivy registry login` looks good to me.
913241806,1202,macedogm,2021-09-05T23:00:14Z,@knqyf263 I added the test case. Can you please have another look in this PR?
913497904,1202,knqyf263,2021-09-06T09:30:18Z,@afdesk Could you review this PR?
913876891,1202,macedogm,2021-09-06T22:45:30Z,"After some tests that I did, I realised that I was not properly double-quoting strings according to [RFC4180](https://www.rfc-editor.org/rfc/rfc4180.html).
The template is more robust now, but it might also be a bit too complex. I appreciate any feedback about its usefulness and complexity."
919699349,1202,CLAassistant,2021-09-15T04:57:32Z,"[![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=1202) <br/>Thank you for your submission! We really appreciate it. Like many open source projects, we ask that you all sign our [Contributor License Agreement](https://cla-assistant.io/aquasecurity/trivy?pullRequest=1202) before we can accept your contribution.<br/>**1** out of **2** committers have signed the CLA.<br/><br/>:white_check_mark: macedogm<br/>:x: Guilherme Macedo<br/><hr/>**Guilherme Macedo** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account, please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/aquasecurity/trivy?pullRequest=1202) it.</sub>"
921812359,1202,afdesk,2021-09-17T13:49:38Z,"@macedogm thanks for your work and your time!
I've tested this PR, and it looks good!

I did next steps:
1. build `trivy` for this PR and run: 
```
./trivy i --format template --template ""@contrib/csv.tpl"" -o r.csv nginx:latest
```
2. check the csv result file (`r.csv`) on two validators: [csvlint.io](https://csvlint.io) and [www.toolkitbay.com](https://www.toolkitbay.com/tkb/tool/csv-validator): the both checks told that the result is valid.
[validation results on csvlint](https://csvlint.io/validation/61449a5862393a0004000032)

**upd**:  also i did this test for `image` and `fs` commands. the csv results are valid."
932804295,1202,macedogm,2021-10-02T18:59:53Z,"Hi @afdesk 👋🏻 
Is there anything else that I need to do in this PR or does it looks good?"
977642135,1202,afdesk,2021-11-24T08:26:02Z,"@macedogm I'm so sorry for waiting.
I retested this PR, and it looks good.

@knqyf263 what do you think?"
977646060,1202,afdesk,2021-11-24T08:31:06Z,"there is one my personal moment. 
if I want to open `.csv` file in Microsoft Excel 2010, the separator should be a semicolon.
but I'm not sure that it matters in this case
"
977647896,1202,afdesk,2021-11-24T08:33:45Z,@macedogm could you pull the `main` branch here?
977819104,1202,macedogm,2021-11-24T12:12:08Z,"@afdesk thanks for you reply. Sure, I'll rebase and switch the separator from comma to semicolon. Semicolon is a valid separator and should work with all editors/parsers. 👍🏻

As a side note, I also opened this PR https://github.com/aquasecurity/fanal/pull/253 quite some time ago. Not sure if you can also review it or not. I believe that it's an interesting feature to add."
977833253,1202,afdesk,2021-11-24T12:29:07Z,@macedogm I'm not sure that we need to change the separator from comma to semicolon.
977836447,1202,macedogm,2021-11-24T12:33:41Z,"@afdesk okay, then in this case I believe that we are good to go (I just pulled the `main`)."
1005564730,1202,macedogm,2022-01-05T10:30:43Z,@knqyf263 Can you please have a look in this PR and let me know your thoughts?
1010913225,1202,sc-sd,2022-01-12T10:54:03Z,"Looks like CLA bot has errored. Seems to think ""Macedogm"" & ""Guilherme Macedo"" are two different contributors when in fact they are the same user."
1144631306,1202,redcatsec,2022-06-02T09:09:31Z,Anything new on this Branch ? 
1144633701,1202,macedogm,2022-06-02T09:12:05Z,"If there is still interest in adding this PR with CSV template support, then I can update it."
1144648894,1202,knqyf263,2022-06-02T09:29:01Z,We're sorry to be late. Looks like it is hard for us to maintain the template. Can we rewrite it in Go?
1144793755,1202,macedogm,2022-06-02T12:14:47Z,"@knqyf263 

> We're sorry to be late.

No worries.

> Looks like it is hard for us to maintain the template. Can we rewrite it in Go?

Yes. Is there any guidance that you would like to provide in advance, please?
Otherwise, I'll update the PR when I'm done."
1147041120,1202,knqyf263,2022-06-06T04:49:06Z,"I just want you to use `encoding/csv`.
https://pkg.go.dev/encoding/csv

You can just add a new writer in `pkg/report` like sarif.
https://github.com/aquasecurity/trivy/blob/main/pkg/report/sarif.go"
1180557508,1202,redcatsec,2022-07-11T15:31:16Z,anything new hier ?
1240468202,1202,xikunyu,2022-09-08T09:32:57Z,"@macedogm Thank you first, I need csv template very much. But which version of trivy is working well with this template? I use trivy 0.25.0 as well as 0.31.3 with docker to use this template, but I got error that function ""escapeCsv"" not defined.

`docker run --rm -v ~/Code/Caches:/root/.cache/ -v ~/Code/csv.tpl:/tmp/csv.tpl aquasec/trivy:0.31.3 i --format template --template ""@/tmp/csv.tpl"" nginx:latest`

```
2022-09-08T09:22:28.163Z        INFO    Need to update DB
2022-09-08T09:22:28.163Z        INFO    DB Repository: ghcr.io/aquasecurity/trivy-db
2022-09-08T09:22:28.163Z        INFO    Downloading DB...
400.00 KiB / 33.81 MiB [>____________________________________________________________] 1.16% ? p/s ?3.92 MiB / 33.81 MiB [------->______________________________________________________] 11.60% ? p/s ?8.03 MiB / 33.81 MiB [-------------->_______________________________________________] 23.75% ? p/s ?9.17 MiB / 33.81 MiB [------------->___________________________________] 27.12% 14.64 MiB p/s ETA 1s10.48 MiB / 33.81 MiB [-------------->_________________________________] 31.01% 14.64 MiB p/s ETA 1s13.95 MiB / 33.81 MiB [------------------->____________________________] 41.26% 14.64 MiB p/s ETA 1s18.05 MiB / 33.81 MiB [------------------------->______________________] 53.37% 14.65 MiB p/s ETA 1s20.55 MiB / 33.81 MiB [----------------------------->__________________] 60.77% 14.65 MiB p/s ETA 0s23.62 MiB / 33.81 MiB [--------------------------------->______________] 69.87% 14.65 MiB p/s ETA 0s27.83 MiB / 33.81 MiB [--------------------------------------->________] 82.30% 14.75 MiB p/s ETA 0s29.03 MiB / 33.81 MiB [----------------------------------------->______] 85.86% 14.75 MiB p/s ETA 0s30.97 MiB / 33.81 MiB [------------------------------------------->____] 91.59% 14.75 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [---------------------------------------------->] 100.00% 14.45 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [---------------------------------------------->] 100.00% 14.45 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [---------------------------------------------->] 100.00% 14.45 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [---------------------------------------------->] 100.00% 13.51 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [---------------------------------------------->] 100.00% 13.51 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [---------------------------------------------->] 100.00% 13.51 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [---------------------------------------------->] 100.00% 12.64 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [---------------------------------------------->] 100.00% 12.64 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [---------------------------------------------->] 100.00% 12.64 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [---------------------------------------------->] 100.00% 11.83 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [---------------------------------------------->] 100.00% 11.83 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [---------------------------------------------->] 100.00% 11.83 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [---------------------------------------------->] 100.00% 11.06 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [---------------------------------------------->] 100.00% 11.06 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [---------------------------------------------->] 100.00% 11.06 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [---------------------------------------------->] 100.00% 10.35 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [---------------------------------------------->] 100.00% 10.35 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [---------------------------------------------->] 100.00% 10.35 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 9.68 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 9.68 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 9.68 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 9.06 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 9.06 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 9.06 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 8.47 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 8.47 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 8.47 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 7.93 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 7.93 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 7.93 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 7.41 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 7.41 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 7.41 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 6.94 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 6.94 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 6.94 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 6.49 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 6.49 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 6.49 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 6.07 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 6.07 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 6.07 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 5.68 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 5.68 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 5.68 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 5.31 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 5.31 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 5.31 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 4.97 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 4.97 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 4.97 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 4.65 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 4.65 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 4.65 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 4.35 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 4.35 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 4.35 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 4.07 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 4.07 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 4.07 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 3.81 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 3.81 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 3.81 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 3.56 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 3.56 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 3.56 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 3.33 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 3.33 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 3.33 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 3.12 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 3.12 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 3.12 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 2.91 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 2.91 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 2.91 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 2.73 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 2.73 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 2.73 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 2.55 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 2.55 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 2.55 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 2.39 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 2.39 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 2.39 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 2.23 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 2.23 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [----------------------------------------------->] 100.00% 2.23 MiB p/s ETA 0s33.81 MiB / 33.81 MiB [---------------------------------------------------] 100.00% 1.71 MiB p/s 20s2022-09-08T09:22:50.754Z      INFO    Vulnerability scanning is enabled
2022-09-08T09:22:50.754Z        INFO    Secret scanning is enabled
2022-09-08T09:22:50.754Z        INFO    If your scanning is slow, please try '--security-checks vuln' to disable secret scanning
2022-09-08T09:22:50.754Z        INFO    Please see also https://aquasecurity.github.io/trivy/v0.31.3/docs/secret/scanning/#recommendation for faster secret detection
2022-09-08T09:23:11.599Z        INFO    Detected OS: debian
2022-09-08T09:23:11.599Z        INFO    Detecting Debian vulnerabilities...
2022-09-08T09:23:11.634Z        INFO    Number of language-specific files: 0
2022-09-08T09:23:11.660Z        FATAL   report error: unable to write results: failed to initialize template writer: error parsing template: template: output template:7: function ""escapeCsv"" not defined
```

Please help me. Thank you again."
1241261986,1202,macedogm,2022-09-08T21:40:25Z,@xikunyu and @aasyria let me work on this during the weekend and submit a new PR.
1241604019,1202,xikunyu,2022-09-09T07:25:23Z,@macedogm Thank you for your reply. I'm very looking forward to it.
1250596079,1202,xikunyu,2022-09-19T05:50:43Z,"@macedogm Hi, are there any updates?"
1494436852,1202,rams3sh,2023-04-03T14:30:52Z,"While the format gets merged in the upstream.  I made a tsv template that works. 

I prefer tsv since handling quotes and `,` is a headache in csv. This however can be opened by any of the spreadsheet software and has same view as csv. Template is below :- 

```
""Image"" ""Title"" ""Description""   ""Severity""  ""Vulnerability ID""  ""Vendor ID"" ""Package Class"" ""Package Type""  ""Package Name""  ""Installed Version"" ""Fixed Version"" ""Severity Source""   ""Primary Url""   ""Reference""
{{- range $ri, $r := . }}
{{- $imageName := $r.Target }}
{{- $pkgClass := $r.Class }}
{{- $pkgType := $r.Type }}
{{- range $vi, $v := .Vulnerabilities }}
{{$imageName}}  {{ $v.Title }}  {{ $v.Description }}    {{$v.Severity}} {{ $v.VulnerabilityID }}    {{$v.VendorIDs | join "", ""}}    {{ $pkgClass }} {{$pkgType}}    {{ $v.PkgName }}    {{$v.InstalledVersion }}    {{ $v.FixedVersion }}   {{$v.SeveritySource}}   {{$v.PrimaryURL}}   ""{{$v.References | join ""\r""}}""
{{- end}}
{{- end }}
```
Sixth line in the above code block is `tab` separated. In case , while copying, formatting gets lost, re-edit the template and manually put the `tab` between each of the fields. 

Save the above template as say `tsv.tpl`. 

Use trivy cli as below :- 

```
trivy image --format template --template '@tsv.tpl'  centos > output.tsv
```


The template and the provided cli works well with the following trivy version :- 
```
Version: 0.36.1
Vulnerability DB:
  Version: 2
  UpdatedAt: 2023-04-03 12:08:20.93338503 +0000 UTC
  NextUpdate: 2023-04-03 18:08:20.933384329 +0000 UTC
  DownloadedAt: 2023-04-03 13:28:04.607696009 +0000 UTC

```

Thought of putting this up here in case any one finds it helpful until the feature is part of the upstream."
1313632699,3037,prabhu,2022-11-14T12:43:08Z,"@owenrumney Like many, I can't wait to have this support. In the interim, is it possible to release a small PR that only does `replace hard coded file paths to use filepath.Join()`?"
1325151583,3215,luhring,2022-11-23T14:25:24Z,(Compilation will fail until https://github.com/aquasecurity/trivy-db/pull/266 is merged and we update this branch of `trivy` to use the new version of `trivy-db`.)
1336435668,3215,afdesk,2022-12-04T15:09:18Z,"@luhring thanks for your efforts. 
could you say why we need a custom analyzer? https://github.com/luhring/trivy/tree/wolfi-support/pkg/fanal/analyzer/os/wolfi

You already handle family ID: https://github.com/luhring/trivy/blob/b7c961a65c08aa289a32659a412b550535688dd9/pkg/fanal/analyzer/os/release/release.go#L62-L63"
1336464154,3215,luhring,2022-12-04T16:44:13Z,"> @luhring thanks for your efforts. could you say why we need a custom analyzer? https://github.com/luhring/trivy/tree/wolfi-support/pkg/fanal/analyzer/os/wolfi
> 
> You already handle family ID: https://github.com/luhring/trivy/blob/b7c961a65c08aa289a32659a412b550535688dd9/pkg/fanal/analyzer/os/release/release.go#L62-L63

We might not need it, actually! 😃  I'm still learning Trivy's architecture, but that's what I was hoping to learn here https://github.com/aquasecurity/trivy/issues/3205#issuecomment-1325133291:

>I'm wondering if I can even delete what I added at `pkg/fanal/analyzer/os/wolfi/...`, relying instead on `pkg/fanal/analyzer/os/release/release.go` to detect the Wolfi OS. What do you think?"
1336469021,3215,afdesk,2022-12-04T17:07:25Z,"@luhring sorry, missed your thought. 
yes, you can remove `wolfi` analyzer and rely on `release` package. "
1336472831,3215,luhring,2022-12-04T17:26:29Z,"> sorry, missed your thought.
> yes, you can remove wolfi analyzer and rely on release package.

No worries! Removed in b0df2e5b"
1342624891,3215,luhring,2022-12-08T12:03:30Z,"Now that https://github.com/aquasecurity/trivy-db/pull/266 is merged, I've updated this branch to use the latest version of `trivy-db`.

@knqyf263 and @afdesk could you please take a look? I'm happy to make any other changes you'd like!

Also, in these situations do you typically wait for an updated Trivy DB to be published, in order to test Trivy without using a local cache of the DB?"
1342861050,3215,knqyf263,2022-12-08T14:58:09Z,"The addition of Wolfi is causing the DB to fail to build (it is our fault), so let us fix that first.
https://github.com/aquasecurity/trivy-db/actions/runs/3648065794/jobs/6161044855"
1343309811,3215,luhring,2022-12-08T20:24:16Z,@knqyf263 The DB looks good to me now! Do you think this one is ready to merge?
1346675194,3215,knqyf263,2022-12-12T15:11:30Z,"Hi, it looked good to me, but I found that the installed versions are empty. Do you know the reason? This analyzer should capture versions.
https://github.com/aquasecurity/trivy/blob/b944ac628616b892d2c1cb085c1bae63128de45d/pkg/fanal/analyzer/pkg/apk/apk.go"
1346678264,3215,knqyf263,2022-12-12T15:13:35Z,"Doesn't Wolfi have origin package names/versions? If it is the case, we need to use FormatVersion instead.
https://github.com/aquasecurity/trivy/blob/0dfe8322d503482d23bfeea7973afaef9f4daf55/pkg/detector/ospkg/wolfi/wolfi.go#L66

```
C:Q1LzfStMeff9oZ+09WB5Z5OR73s/Q=
P:binutils-dev
V:2.39-r4
A:x86_64
S:1052112
I:4209277
T:binutils development headers
U:
L:GPL-3.0-or-later
o:binutils
F:usr
F:usr/include
```

In the above example, can we assume `binutils-dev` is installed from `binutils` v2.39-r4? In other words, the origin package version and sub-package version are always the same?"
1346747890,3215,luhring,2022-12-12T15:44:08Z,"> In the above example, can we assume `binutils-dev` is installed from `binutils` v2.39-r4? In other words, the origin package version and sub-package version are always the same?

Yes, that's correct. Good to know about `utils.FormatVersion`, thanks! Updated."
1346753360,3215,luhring,2022-12-12T15:46:15Z,"> Hi, it looked good to me, but I found that the installed versions are empty. Do you know the reason? This analyzer should capture versions.

Just so I understand this comment, where are you looking? I'm seeing installed versions in Trivy's output."
1346756498,3215,knqyf263,2022-12-12T15:47:28Z,"In your PR description, installed versions are empty in the table.
https://github.com/aquasecurity/trivy/pull/3215#issue-1460559772

![image](https://user-images.githubusercontent.com/2253692/207090297-db89e4cc-0594-4830-ab3c-95d4b7096c73.png)
"
1346760102,3215,knqyf263,2022-12-12T15:48:51Z,"It works now, though.

```
cgr.dev/chainguard/wolfi-base:latest-20221001 (wolfi 20220914)
==============================================================
Total: 4 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 2, CRITICAL: 1)

┌─────────┬────────────────┬──────────┬───────────────────┬───────────────┬─────────────────────────────────────────────────────────────┐
│ Library │ Vulnerability  │ Severity │ Installed Version │ Fixed Version │                            Title                            │
├─────────┼────────────────┼──────────┼───────────────────┼───────────────┼─────────────────────────────────────────────────────────────┤
│ busybox │ CVE-2022-28391 │ HIGH     │ 1.35.0-r2         │ 1.35.0-r3     │ busybox: remote attackers may execute arbitrary code if     │
│         │                │          │                   │               │ netstat is used                                             │
│         │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2022-28391                  │
│         ├────────────────┤          │                   │               ├─────────────────────────────────────────────────────────────┤
│         │ CVE-2022-30065 │          │                   │               │ busybox: A use-after-free in Busybox's awk applet leads to  │
│         │                │          │                   │               │ denial of service...                                        │
│         │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2022-30065                  │
├─────────┼────────────────┼──────────┼───────────────────┼───────────────┼─────────────────────────────────────────────────────────────┤
│ glibc   │ CVE-2022-39046 │ MEDIUM   │ 2.36-r0           │ 2.36-r1       │ glibc: a crafted input may allow information disclosure     │
│         │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2022-39046                  │
├─────────┼────────────────┼──────────┼───────────────────┼───────────────┼─────────────────────────────────────────────────────────────┤
│ zlib    │ CVE-2022-37434 │ CRITICAL │ 1.2.12-r2         │ 1.2.12-r3     │ zlib: heap-based buffer over-read and overflow in inflate() │
│         │                │          │                   │               │ in inflate.c via a...                                       │
│         │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2022-37434                  │
└─────────┴────────────────┴──────────┴───────────────────┴───────────────┴─────────────────────────────────────────────────────────────┘
```"
1346761946,3215,luhring,2022-12-12T15:49:34Z,"> In your PR description, installed versions are empty in the table.

Got it! There have been a handful of changes in the past 3 weeks. I'm seeing installed versions locally — let me know if you see something different when you run it."
1347282050,3215,knqyf263,2022-12-12T20:43:17Z,I didn't see installed versions before this commit https://github.com/aquasecurity/trivy/pull/3215/commits/95568b5902c967ae67fa9b9fce0fc0f0d6510030. It looks good now.
1347285796,3215,knqyf263,2022-12-12T20:44:29Z,Thanks for your contribution👍 It will be included in [v0.36.0](https://github.com/aquasecurity/trivy/milestone/12).
1347316665,3215,luhring,2022-12-12T20:57:30Z,Thanks for all your help @knqyf263 and @afdesk! 🙏  This was a great learning experience.
1987008656,6240,codefromthecrypt,2024-03-09T23:26:07Z,@knqyf263 what do you use to draw that diagram? looks neat.
1987636698,6240,knqyf263,2024-03-11T04:59:30Z,@codefromthecrypt This one https://excalidraw.com/
1987771501,6240,knqyf263,2024-03-11T07:22:41Z,@DmitriyLewen @chen-keinan I've resolved all comments. Can you please take another look?
2158125749,6882,stringbean,2024-06-10T11:46:24Z,"> Looks awesome! Thanks for your contribution! I have a question. Is there any way to determine if a dependency is directly used by the project or transitively installed?

Not at the moment. I can look at adding that to the next major version of sbt-dependency-lock."
2008599142,6333,parvez0,2024-03-20T03:11:09Z,"Hey @DmitriyLewen, needed your opinion on this. After integrating the Location Changes, I noticed that `integration_test/client_server.go` started failing for the `busybox_with_cargo.lock` and `scan pox.xml` test cases. The issue from these test cases is expecting `DetectedVulnerability.Location` to be nil. However, the output golden files `busybox-with-lockfile.json.golden` and `pom.json.golden` are also used in other integration tests where non-nil Location data is expected. To address this, I created two duplicate files that includes Location data. Please let me know if you have a better solution for this."
2008640756,6333,DmitriyLewen,2024-03-20T04:22:02Z,"@parvez0 You need to update `rpc` package.
Let me know when you're done making changes (to avoid conflicts) and i will update client/server part."
2011008923,6333,parvez0,2024-03-21T01:13:23Z,"> @parvez0 You need to update `rpc` package. Let me know when you're done making changes (to avoid conflicts) and i will update client/server part.

Hey @DmitriyLewen what do I have to do in `rpc` package I haven't seen any changes that need to be made there, can you please let me know I'll try to do it as soon as possible"
2011690056,6333,DmitriyLewen,2024-03-21T09:06:30Z,"Hm... we don't insert `Locations` in client/server mode...
I created #6366 for this bug.
After merge #6366 you need to merge `main` branch into this PR and follow these steps:
- add locations to [Vulnerabilities](https://github.com/aquasecurity/trivy/blob/8ec3938e01a93855503e3400eae9831abbb5de4a/rpc/common/service.proto#L110-L135) (use 26 number). Use [Location](https://github.com/DmitriyLewen/trivy/blob/84dc645df01ed5a9c7bdc141888a59a9b7f52fd2/rpc/common/service.proto#L64-L67) struct.
- run `mage fmt`.
- run `mage:protoc`.
- add `Locations` to `Vulnerabilties` [as for Packages](https://github.com/DmitriyLewen/trivy/blob/84dc645df01ed5a9c7bdc141888a59a9b7f52fd2/pkg/rpc/convert.go#L68) ( use `ConvertToRPCLocations` and `ConvertFromRPCLocation` functions)
- add Locations in testcase in `convert_test.go`.
- recheck that you don't need new test golden files in integration tests.
"
2069461458,6333,knqyf263,2024-04-22T13:35:46Z,"Originally, our policy was to include only minimal data in reports. It may be better to embed [Package](https://github.com/aquasecurity/trivy/blob/30cc88fa87ba69c64f09885c23f36663fa8aa5d1/pkg/fanal/types/artifact.go#L68-L105) in [DetectedVulnerability](https://github.com/aquasecurity/trivy/blob/30cc88fa87ba69c64f09885c23f36663fa8aa5d1/pkg/types/vulnerability.go#L9-L31) than to gradually add more and more attributes."
2073922701,6333,DmitriyLewen,2024-04-24T03:04:14Z,"sounds logical. 
@parvez0  Do you have the time and opportunity to do this?"
2075015546,6333,parvez0,2024-04-24T13:56:56Z,"Hey @DmitriyLewen, I'll take a look at this and update"
2081955961,6333,knqyf263,2024-04-29T06:12:04Z,We're so sorry. We discussed this offline and found out that embedding packages will get lots of duplicate data if multiple vulnerabilities are found in one package. We need to carefully think about it.
2082876247,6333,parvez0,2024-04-29T14:16:59Z,"Hey @knqyf263, I had the same question and was just about to reach out to you. Please let me know if you've settled on an approach for this and need my assistance to finalize it. In the meantime, I'll start looking into other issues that I can address."
2086270998,6333,knqyf263,2024-04-30T17:54:20Z,@parvez0 Thanks for your understanding. I implemented [my idea](https://github.com/aquasecurity/trivy/pull/6583) and would collect feedback from other maintainers.
2548046559,8106,nikpivkin,2024-12-17T10:14:16Z,"`poetry` does not yet support PEP 735, so for now we can just exclude the dev group without resolving dependencies from other groups:
```bash
[dependency-groups]
test = [""pytest<8"", ""coverage""]
typing = [""mypy==1.7.1"", ""types-requests""]
lint = [""black"", ""flake8""]
dev = [{include-group = ""test""}, {include-group = ""typing""}, {include-group = ""lint""}]
```
https://github.com/python-poetry/poetry/issues/9751
"
2559056962,8106,DmitriyLewen,2024-12-23T07:20:03Z,@aqua-bot backport release/v0.58
2559057843,8106,aqua-bot,2024-12-23T07:20:49Z,Backport PR created: https://github.com/aquasecurity/trivy/pull/8158
576023536,376,knqyf263,2020-01-19T16:49:46Z,@tnir Thank you for the awesome contribution! We'll have a look soon.
577483532,376,tnir,2020-01-23T03:02:04Z,Templating does looks working well: https://gitlab.com/tnir/trivy-ci-test/-/jobs/412246842
578193349,376,tnir,2020-01-24T16:06:57Z,Blocked by PR #387 (issue #386)
578193929,376,tnir,2020-01-24T16:08:26Z,Task list was moved to the description of the PR.
578479243,376,knqyf263,2020-01-26T08:18:28Z,@tnir I've merged #327. I didn't check it carefully😓 I appreciate your contribution.
578505247,376,knqyf263,2020-01-26T14:08:53Z,Thanks! Awesome work!
1614495716,4706,AliDatadog,2023-06-30T11:03:41Z,"Hi @knqyf263 , thank you for the review 🙇  I addressed the comments and applied the changes."
1649637309,4706,AliDatadog,2023-07-25T11:17:03Z,"Hi @knqyf263 , small bump for this PR."
1680886186,4706,AliDatadog,2023-08-16T16:04:29Z,@knqyf263 would you have any update regarding this PR ?
1740811359,4706,AliDatadog,2023-09-29T12:26:41Z,@knqyf263 Any update ? 🙇 
1741996203,4706,knqyf263,2023-10-01T07:58:43Z,"After careful consideration, I thought that `--retain-pkg-installed-files` may not be necessary, as installed files are not output by default without `--list-all-pkgs`. I am sorry that you went to the trouble of implementing this. Other than that, it looks good, and I will merge it right after removing `--retain-pkg-installed-files`."
1742744987,4706,AliDatadog,2023-10-02T10:09:20Z,I changed the git history to add the co-author
1744467600,4706,knqyf263,2023-10-03T08:29:57Z,Tests are failing. Please let us know if you need any help.
1750701213,4706,AliDatadog,2023-10-06T13:40:15Z,"> Tests are failing. Please let us know if you need any help.

It appears that `mage test:updateGolden` is not updating the golden files as expected when I run the command. For info I have a mac m1 and have docker on my machine"
1763743371,4706,knqyf263,2023-10-16T05:20:00Z,">It appears that mage test:updateGolden is not updating the golden files as expected when I run the command.

The build constraint excludes the file for macOS.
https://github.com/aquasecurity/trivy/blob/cbbd1ce1f07ea2a440c08b6902958f0af6977b25/pkg/fanal/test/integration/containerd_test.go#L1"
1140454993,2186,chen-keinan,2022-05-29T13:56:58Z,"@josedonizetti I think it would be better to implement `cluster` and `all` as `trivy k8s` <b>subcommands</b> rather than args, it will make it more modular and better to maintain"
1144249726,2186,josedonizetti,2022-06-01T23:39:00Z,"@chen-keinan @knqyf263 Let me know what you think about the changes. I'd like to know if this look good for you, before adding integration tests, to validate the CLI works.

Things to keep in mind:
- When using Subcommands with `urfave/cli` it won't print the `CustomHelpTemplate`, I looked into fixing it, but there is a PR opened on the repository already, which took over 5 months to get a review. So, to be able to show examples of how to use, I'm using `UsageText`
- I'm mixing a command structure, where the main command handle resources `trivy k8s deployment app` and we have individual subcommands for cluster and namespace `trivy k8s cluster`, `trivy k8s all`. This allows for better maintainability but also looks good, when using subcommands we can do `trivy k8s cluster --report`, without it the flags must come before the action `trivy k8s --report cluster`. And to support the API, I didn't want to have a subcommand `resource`.
- I have extracted a `option.go` for kubernetes commands, because I don't want to add an if for every subcommand we add under `k8s` on https://github.com/aquasecurity/trivy/blob/main/pkg/commands/option/artifact.go#L41 to handle parameters diffrent. 
- The main command acts like other trivy commands `trivy k8s` shows help
- `urfave/cli` subcommands don't inherit flags, so we have to redeclare it per subcomand
"
1144602723,2186,chen-keinan,2022-06-02T08:38:27Z,"> @chen-keinan @knqyf263 Let me know what you think about the changes. I'd like to know if this look good for you, before adding integration tests, to validate the CLI works.
> 
> Things to keep in mind:
> 
> * When using Subcommands with `urfave/cli` it won't print the `CustomHelpTemplate`, I looked into fixing it, but there is a PR opened on the repository already, which took over 5 months to get a review. So, to be able to show examples of how to use, I'm using `UsageText`
> * I'm mixing a command structure, where the main command handle resources `trivy k8s deployment app` and we have individual subcommands for cluster and namespace `trivy k8s cluster`, `trivy k8s all`. This allows for better maintainability but also looks good, when using subcommands we can do `trivy k8s cluster --report`, without it the flags must come before the action `trivy k8s --report cluster`. And to support the API, I didn't want to have a subcommand `resource`.
> * I have extracted a `option.go` for kubernetes commands, because I don't want to add an if for every subcommand we add under `k8s` on https://github.com/aquasecurity/trivy/blob/main/pkg/commands/option/artifact.go#L41 to handle parameters diffrent.
> * The main command acts like other trivy commands `trivy k8s` shows help
> * `urfave/cli` subcommands don't inherit flags, so we have to redeclare it per subcomand

there is an effort to introduce cobra in Trivy @knqyf263 any idea when its planned, if at all? "
1144632881,2186,knqyf263,2022-06-02T09:11:10Z,">I think it would be better to implement cluster and all as trivy k8s subcommands rather than args, it will make it more modular and better to maintain

I'm still not sure if we should have `cluster` and `all` as subcommands. Any big benefit? For now, it makes maintenance hard."
1147776616,2186,josedonizetti,2022-06-06T18:52:06Z,"_there is an effort to introduce cobra in Trivy @knqyf263 any idea when its planned, if at all?_
@chen-keinan I don't think it is planned, I saw a PR for it, but there is no work on it.

_I'm still not sure if we should have cluster and all as subcommands. Any big benefit? For now, it makes maintenance hard._

@knqyf263 do you mean subcommands vs one command parsing argument? or do you mean separating cluster/all in different actions? "
1148377882,2186,knqyf263,2022-06-07T08:44:24Z,">do you mean subcommands vs one command parsing argument?

I mean the first one. Do we want to have `cluster` and `all` as subcommands?"
1150518829,2186,josedonizetti,2022-06-08T23:39:58Z,"@knqyf263 I liked the subcommands better, mostly because of the flags. Without it, users always need to pass the flags before the command, for example `trivy k8s --report summary  all` or  `trivy k8s --format json --security-checks=config cluster`, if we do `trivy k8s all --report summary` it won't work, because `urfave/cli` is based on golang builtin flags, which stop processing whenever an argument without `-` is found. 

But with subcommands this works different, `all` and `cluster` are no longer arguments but the commands themselves. So it works when we pass flags after it, eg: `trivy k8s cluster --format json --security-checks=config`

wdyt?"
1150731526,2186,knqyf263,2022-06-09T06:40:16Z,"But then, `trivy k8s --format json --security-checks=config cluster` no longer works unless we define flags for `k8s` and `cluster` subcommands both, right?
Also, all other commands don't work like `trivy image alpine:3.15 --format json --security-checks=config`. I think `cluster` is a target name like `alpine:3.15`. To keep consistency with other commands, it should be like `trivy k8s --format json --security-checks=config cluster`, no?

I agree flags should work even after the CLI argument. We can do it after we move to cobra, but cannot at the moment."
1152681987,2186,josedonizetti,2022-06-10T19:51:06Z,"@knqyf263 @chen-keinan can you review it please? Tried to address all concerns (new CLI API, improving code maintenance and still keeping the trivy way of working)"
1153186731,2186,chen-keinan,2022-06-12T14:20:39Z,"could add a comment on this as it is an older change:
the error below are ignored
`_, _ = fmt.Fprintln(s.Output)`
`_, _ = fmt.Fprintf(s.Output, ""Summary Report for %s\n"", consolidated.ClusterName)`

"
1156107354,2186,knqyf263,2022-06-15T07:41:06Z,I think it is a breaking change. We should mention it in the release note. @josedonizetti Could you write it? You can refer to the old release notes.
1180717914,2494,CLAassistant,2022-07-11T18:15:14Z,[![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=2494) <br/>All committers have signed the CLA.
1180717915,2494,CLAassistant,2022-07-11T18:15:14Z,"[![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=2494) <br/>Thank you for your submission! We really appreciate it. Like many open source projects, we ask that you sign our [Contributor License Agreement](https://cla-assistant.io/aquasecurity/trivy?pullRequest=2494) before we can accept your contribution.<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/aquasecurity/trivy?pullRequest=2494) it.</sub>"
1183148324,2494,ShubhamPalriwala,2022-07-13T12:16:36Z,"Hey @knqyf263, Thanks for the useful feedback. Have incorporated all the suggested changes and answered the `Depth` option query too under your question.

Pushed the change and the PR is ready for review from my end again!"
1184499346,2494,ShubhamPalriwala,2022-07-14T14:12:46Z,@knqyf263 Can you take a look at the latest commit? It has the required change of migrating the test service to a local git
1323293883,3130,chen-keinan,2022-11-22T08:34:16Z,"@simar7 you are not using the `compliance.BuildComplianceReport(scanResults, complianceSpec)` functionality built for producing compliance reports ? "
1323625691,3130,simar7,2022-11-22T12:46:01Z,"> @simar7 you are not using the `compliance.BuildComplianceReport(scanResults, complianceSpec)` functionality built for producing compliance reports ?

That’s right. As we discussed last time, it uses options.ScannerwithSpec in defsec to load only the checks that need to be loaded for a particular spec. "
1324618281,3130,chen-keinan,2022-11-23T06:44:02Z,"> > @simar7 you are not using the `compliance.BuildComplianceReport(scanResults, complianceSpec)` functionality built for producing compliance reports ?
> 
> That’s right. As we discussed last time, it uses options.ScannerwithSpec in defsec to load only the checks that need to be loaded for a particular spec.

`compliance.BuildComplianceReport` is not just loading/filtering checks, it is also producing a specific compliance report view,  it will be great to have all compliance report view to look a like. 
example:
https://github.com/aquasecurity/trivy/blob/main/docs/docs/kubernetes/cli/compliance.md "
1325780050,3130,simar7,2022-11-23T23:55:25Z,"> > > @simar7 you are not using the `compliance.BuildComplianceReport(scanResults, complianceSpec)` functionality built for producing compliance reports ?
> > 
> > 
> > That’s right. As we discussed last time, it uses options.ScannerwithSpec in defsec to load only the checks that need to be loaded for a particular spec.
> 
> `compliance.BuildComplianceReport` is not just loading/filtering checks, it is also producing a specific compliance report view, it will be great to have all compliance report view to look a like. example: https://github.com/aquasecurity/trivy/blob/main/docs/docs/kubernetes/cli/compliance.md

Good point - I didn't think of that. I added it here https://github.com/aquasecurity/trivy/pull/3130/files#diff-fe969e5428e7e462874a674a3116c74787735b8a6d25f113cd3c06653433eb38 along with some tests. PTAL."
1327053182,3130,chen-keinan,2022-11-25T05:59:54Z,lgtm
1341444101,3130,knqyf263,2022-12-07T19:03:54Z,"I believe you just forgot to remove the png, so I've removed it in https://github.com/aquasecurity/trivy/pull/3130/commits/3c15cd053a4c08371c51945caf02b543f420cc12. Please let me know if I'm missing something."
1126663516,2111,owenrumney,2022-05-14T07:34:39Z,I don't know if Further Reading should be removed as well? It references online resources about Starboard
1126667111,2111,itaysk,2022-05-14T08:03:12Z,"sure, we can remove it.

Also, could you please add some note in the operator index.md about relationship to starboard operator? something like:

> Trivy Operator is based on existing Aqua OSS project - [Starboard](https://github.com/aquasecurity/starboard), and shares much of the design, principles and code with it. Existing content that relates to Starboard Operator might also be relevant for Trivy Operator. To learn more about the transition from Starboard from Trivy, see the [announcement discussion](https://github.com/aquasecurity/starboard/discussions/1173)"
1126669658,2111,owenrumney,2022-05-14T08:19:53Z,"I think at this point where we're editing text someone who has worked on the project does it.
"
1126670667,2111,itaysk,2022-05-14T08:27:29Z,"fair enough, I'll give it another round and this time just commit into your branch"
1126692268,2111,itaysk,2022-05-14T11:05:49Z,"gave it another run, tried to simplify things. I would try to do it again later an probably converge some pages.
also, I think Images dir still has some work to do."
1126867095,2111,chen-keinan,2022-05-15T05:58:06Z,"looks very good, couple of comments: 
 These images can be removed : 
- docs/docs/kubernetes/operator/images/node01-report.png
- docs/docs/kubernetes/operator/images/html-report.png
- docs/docs/kubernetes/operator/images/starboard-cli-with-octant-demo.gif
This report was produced from Starboard CLI which no longer exists

 html/pdf can be removed from this image :
- /docs/kubernetes/operator/images/trivy-operator-overview.png"
1127021815,2111,itaysk,2022-05-15T20:29:04Z,"@chen-keinan
https://github.com/aquasecurity/trivy/pull/2111/commits/92af7a07639a1e80e25a99aa33d8eb6597dcd216 - merge config and settings, I think it wasn't clear why we two very similar pages.
https://github.com/aquasecurity/trivy/pull/2111/commits/3053a5c746e3fd91ef4387fcdfc18bdcbc6d6082 - merge installation options, not sure this one is better than before LMK WDYT, we can also revert this one
"
1127031686,2111,chen-keinan,2022-05-15T21:06:40Z,"> 
@itaysk 
- The setting and config merge looks OK, for now, probably we will have to do an additional review to validate content and order.
- The Install option merge is a little bit confusing, not fully clear when each install ends and if the other part is relevant to me, for example, if I choose helm or else
"
1127431706,2111,itaysk,2022-05-16T09:19:34Z,"ok, reverted it"
1323369941,2910,knqyf263,2022-11-22T09:35:23Z,"I saw several errors

### Vagrant Box: Amazon Linux 2 (bento)

```
$ wget https://app.vagrantup.com/bento/boxes/amazonlinux-2/versions/1.2.1/providers/virtualbox.box
$ tar xvf virtualbox.box
$ trivy vm amazon-2-x86_64-disk001.vmdk
2022-11-22T09:22:56.598Z        INFO    Vulnerability scanning is enabled
2022-11-22T09:22:56.599Z        WARN    Partition error: 1 error occurred:
        * new xfs filesystem error: failed to parse allocation group 1: failed to parse super block: failed to parse superblock magic byte error: 00000000
```

### Vagrant Box: Ubuntu 20.04

```
$ wget https://app.vagrantup.com/ubuntu/boxes/focal64/versions/20221121.0.0/providers/virtualbox.box
$ tar xvf virtualbox.box
box.ovf
Vagrantfile
metadata.json
ubuntu-focal-20.04-cloudimg.mf
ubuntu-focal-20.04-cloudimg.vmdk
ubuntu-focal-20.04-cloudimg-configdrive.vmdk
$ trivy VM ubuntu-focal-20.04-cloudimg-configdrive.vmdk
2022-11-22T09:39:19.778Z        INFO    Vulnerability scanning is enabled
2022-11-22T09:39:19.778Z        FATAL   vm scan error: scan error: scan failed: failed analysis: walk vm error: failed to new disk driver: failed to new MBR: Invalid master boot record signature
```

### Vagrant Box: Ubuntu 14.04
Intentional

```
$ wget https://app.vagrantup.com/ubuntu/boxes/trusty64/versions/20190514.0.0/providers/virtualbox.box
$ tar xvf virtualbox.box
box.ovf
Vagrantfile
box-disk1.vmdk
$ trivy vm box-disk1.vmdk
2022-11-22T09:42:22.073Z        INFO    Vulnerability scanning is enabled
2022-11-22T09:42:22.074Z        WARN    Partition error: unable to detect filesystem
```

### Vagrant Box: Debian 10
Intentional

```
$ wget https://app.vagrantup.com/debian/boxes/buster64/versions/10.20220912.1/providers/virtualbox.box
$ tar xvf virtualbox.box
metadata.json
Vagrantfile
box.vmdk
$ trivy vm box.vmdk
2022-11-22T09:52:07.433Z        INFO    Vulnerability scanning is enabled
2022-11-22T09:52:07.433Z        FATAL   vm scan error: scan error: scan failed: failed analysis: failed to open storage: failed to open /home/teppei/vm_test/debian/box.vmdk error: open virtual machine error: monolithicSparse: type is not supported: unsupported type error
```

### Vagrant Box: Debian 10 (generic)

```
$ wget https://app.vagrantup.com/generic/boxes/debian10/versions/4.2.2/providers/virtualbox.box
$ tar xvf virtualbox.box
Vagrantfile
box.ovf
generic-debian10-virtualbox-disk001.vmdk
info.json
metadata.json
$ trivy vm generic-debian10-virtualbox-disk001.vmdk
2022-11-22T10:47:04.363Z        INFO    Vulnerability scanning is enabled
2022-11-22T10:47:04.364Z        WARN    Partition error: unable to detect filesystem
2022-11-22T10:47:04.373Z        INFO    Number of language-specific files: 0
```

### Ubuntu 18.04

```
$ wget https://cloud-images.ubuntu.com/releases/bionic/release/ubuntu-18.04-server-cloudimg-amd64.vmdk
$ trivy vm ubuntu-18.04-server-cloudimg-amd64.vmdk
2022-11-22T09:54:58.191Z        INFO    Vulnerability scanning is enabled
2022-11-22T09:54:58.192Z        FATAL   vm scan error: scan error: scan failed: failed analysis: walk vm error: failed to new disk driver: failed to new MBR: Invalid master boot record signature
```

### Exported OVA from VirtualBox

```
$ trivy vm --security-checks vuln /tmp/vagrant/virtualbox/Ubuntu2004_default_1654869193307_72344-disk001.vmdk -d
...
2022-11-22T12:18:01.878+0200    INFO    Vulnerability scanning is enabled
2022-11-22T12:18:01.878+0200    DEBUG   Vulnerability type:  [os library]
2022-11-22T12:18:01.879+0200    DEBUG   Found partition: 1
2022-11-22T12:18:01.881+0200    DEBUG   Found partition: 2
2022-11-22T12:18:02.113+0200    DEBUG   OS is not detected.
2022-11-22T12:18:02.113+0200    DEBUG   Detected OS: unknown
2022-11-22T12:18:02.113+0200    INFO    Number of language-specific files: 0
```"
1323493887,2910,knqyf263,2022-11-22T11:02:22Z,"## Status


| Image | Status | Note |
|-------|--------|------|
|  Vagrant Box: Amazon Linux 2 (bento) | ✅ |   https://github.com/aquasecurity/trivy/pull/2910/commits/15d91cd1e8a5a0c27e941b4505c19594a5886b9d  |
| Vagrant Box: Ubuntu 20.04 |  ▲ Skip Boot partition only image|  https://github.com/aquasecurity/trivy/pull/2910/commits/7c8d930d64017df974b1b426023e075ab7d929ce  |
|  Vagrant Box: Ubuntu 14.04 |  ▲ Skip Boot partition only image |   https://github.com/aquasecurity/trivy/pull/2910/commits/7c8d930d64017df974b1b426023e075ab7d929ce  |
|  Vagrant Box: Debian 10 (generic) |  ✅ |   https://github.com/aquasecurity/trivy/pull/2910/commits/15d91cd1e8a5a0c27e941b4505c19594a5886b9d   |
| Cloud Images: Ubuntu 18.04 | ✅ | https://github.com/aquasecurity/trivy/pull/2910/commits/15d91cd1e8a5a0c27e941b4505c19594a5886b9d |
| Exported OVA from VirtualBox | ▲ | https://github.com/aquasecurity/trivy/pull/2910/commits/50378d3e0f793367768ab0a0a606fd9c6c262063 skip LVM |"
1323539867,2910,knqyf263,2022-11-22T11:43:30Z,"## EBS snapshot scanning

| AMI ID | AMI name | Status | Note
|-------|-------|:--------:|---------|
| ami-0c0000ceb18c73b8a |  Red Hat Enterprise Linux 9 | ✅ | |
| ami-06220be3176081cf0 | Red Hat Enterprise Linux (RHEL) 7 (HVM) | ✅ | `not support XFS_DINODE_FMT_EXTENTS` |
| ami-076309742d466ad69 | Amazon Linux 2 AMI (HVM) - Kernel 5.10 | ✅ | `not support XFS_DINODE_FMT_EXTENTS` |
| ami-034a7d2833172671e | Amazon Linux 2 AMI (HVM) - Kernel 4.14 | ✅ | `not support XFS_DINODE_FMT_EXTENTS` |
| ami-0caef02b518350c8b |Ubuntu Server 22.04 LTS | ✅ | | 
| ami-06148e0e81e5187c8 |Ubuntu Server 20.04 LTS | ✅ | |
| ami-0a5b5c0ea66ec560d |Debian 11 | ✅ | | 
| ami-0b4c74d41ee4bed78 | CentOS 7 (x86_64) - with Updates HVM | ❌ | `Partition error: unable to detect filesystem` |
| ami-0003c30c98690e304  | Develatio's Ruby on Rails AMI (Debian 10) | ✅ | |
| ami-0fb02f20850e23fd0 | SUSE Linux Enterprise Server 15 | ✅ | `failed to parse header error magic: 1701012595: unsupported block` |
| ami-06716a923f0430b50 | TensorFlow from NVIDIA AMI with Support by Terracloudx | ❌ | `Partition error: unable to detect filesystem` |
| ami-0b3d1809cc222924a | AlmaLinux OS 8 | ✅ | `not support XFS_DINODE_FMT_EXTENTS` |
| ami-0e2bc7a3ca89f5d06 | Rocky Linux 8 | ❌ | `Partition error: unable to detect filesystem` |

## Script
https://gist.github.com/knqyf263/50a36af26ad9036ed8d798b86c2b8e5c"
1324732222,2910,knqyf263,2022-11-23T09:00:26Z,"## AMI scanning (VMDK)

| AMI ID | AMI name | Status | Note
|-------|-------|:--------:|---------|
| ami-0c0000ceb18c73b8a |  Red Hat Enterprise Linux 9 | ✅ | |
| ami-06220be3176081cf0 | Red Hat Enterprise Linux (RHEL) 7 (HVM) | ✅ |  |
| ami-076309742d466ad69 | Amazon Linux 2 AMI (HVM) - Kernel 5.10 | ✅ |  |
| ami-034a7d2833172671e | Amazon Linux 2 AMI (HVM) - Kernel 4.14 | ✅ |  |
| ami-0caef02b518350c8b |Ubuntu Server 22.04 LTS | ✅ | | 
| ami-06148e0e81e5187c8 |Ubuntu Server 20.04 LTS | ✅ | |
| ami-0a5b5c0ea66ec560d |Debian 11 | ✅ | | 
| ami-0b4c74d41ee4bed78 | CentOS 7 (x86_64) - with Updates HVM | - | The image ID provided (ami-07e1709b931547118) is a marketplace AMI and is not exportable. |
| ami-0fb02f20850e23fd0 | SUSE Linux Enterprise Server 15 | - | The image ID provided (ami-03512b450e089b4f5) is a marketplace AMI and is not exportable. |
| ami-0b3d1809cc222924a | AlmaLinux OS 8 | - | The image ID provided (ami-0081079be037be39e) is a marketplace AMI and is not exportable. |
| ami-0e2bc7a3ca89f5d06 | Rocky Linux 8 | - | The image ID provided (ami-043b19653568f9986) is a marketplace AMI and is not exportable. |

## Script
https://gist.github.com/knqyf263/560020453511fe8107e2e9796fffbbd6#file-ami-sh"
1327778543,2910,knqyf263,2022-11-25T18:38:50Z,"## AMI scanning (EBS snapshot)

| AMI ID | AMI name | Status | Note
|-------|-------|:--------:|---------|
| ami-0c0000ceb18c73b8a |  Red Hat Enterprise Linux 9 | ✅ | |
| ami-06220be3176081cf0 | Red Hat Enterprise Linux (RHEL) 7 (HVM) | ✅ |  |
| ami-076309742d466ad69 | Amazon Linux 2 AMI (HVM) - Kernel 5.10 | ✅ |  |
| ami-034a7d2833172671e | Amazon Linux 2 AMI (HVM) - Kernel 4.14 | ✅ |  |
| ami-0caef02b518350c8b |Ubuntu Server 22.04 LTS | ✅ | | 
| ami-06148e0e81e5187c8 |Ubuntu Server 20.04 LTS | ✅ | |
| ami-0a5b5c0ea66ec560d |Debian 11 | ✅ | | 
| ami-0b4c74d41ee4bed78 | CentOS 7 (x86_64) - with Updates HVM | ❌ | bootable partition |
| ami-0fb02f20850e23fd0 | SUSE Linux Enterprise Server 15 | ✅ | |
| ami-0b3d1809cc222924a | AlmaLinux OS 8 | ✅ | |
| ami-0e2bc7a3ca89f5d06 | Rocky Linux 8 | ❌ | bootable partition |

## Script
https://gist.github.com/knqyf263/560020453511fe8107e2e9796fffbbd6#file-ami-snapshot-sh"
1328106016,2910,knqyf263,2022-11-26T20:05:12Z,"I figured out why it failed on CentOS/Rocky Linux.

The images successfully scanned were GPT-partitioned.

```
[ec2-user@ip-172-31-32-24 ~]$ sudo fdisk -l /dev/xvda
Disk /dev/xvda: 8 GiB, 8589934592 bytes, 16777216 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: gpt
Disk identifier: DA90AB95-8C11-4BAE-9157-C48213FBAD0C

Device       Start      End  Sectors Size Type
/dev/xvda1    4096 16777182 16773087   8G Linux filesystem
/dev/xvda128  2048     4095     2048   1M BIOS boot

Partition table entries are not in disk order.
```

Rocky Linux is MBR-partitioned.

```
[rocky@ip-172-31-46-195 ~]$ sudo fdisk -l
Disk /dev/xvda: 10 GiB, 10737418240 bytes, 20971520 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0xec07056d

Device     Boot Start      End  Sectors Size Id Type
/dev/xvda1 *     2048 20971486 20969439  10G 83 Linux
```

We should not just skip bootable partition. We should skip only MBR and BIOS boot partition, not EFI System Partition (ESP)."
1328110425,2910,knqyf263,2022-11-26T20:38:24Z,Fixed in https://github.com/aquasecurity/trivy/pull/2910/commits/6c7f9705840d209f083aeadf861b3390fa2260a1. I confirmed CentOS and Rocky Linux work now.
1328204005,2910,knqyf263,2022-11-27T09:19:20Z,"## AMI scanning (EBS snapshot) after the fix

| AMI ID | AMI name | Status | Note
|-------|-------|:--------:|---------|
| ami-0c0000ceb18c73b8a |  Red Hat Enterprise Linux 9 | ✅ | |
| ami-06220be3176081cf0 | Red Hat Enterprise Linux (RHEL) 7 (HVM) | ✅ |  |
| ami-076309742d466ad69 | Amazon Linux 2 AMI (HVM) - Kernel 5.10 | ✅ |  |
| ami-034a7d2833172671e | Amazon Linux 2 AMI (HVM) - Kernel 4.14 | ✅ |  |
| ami-0caef02b518350c8b |Ubuntu Server 22.04 LTS | ✅ | | 
| ami-06148e0e81e5187c8 |Ubuntu Server 20.04 LTS | ✅ | |
| ami-0a5b5c0ea66ec560d |Debian 11 | ✅ | | 
| ami-0b4c74d41ee4bed78 | CentOS 7 (x86_64) - with Updates HVM | ✅ | MBR |
| ami-0fb02f20850e23fd0 | SUSE Linux Enterprise Server 15 | ✅ | |
| ami-0b3d1809cc222924a | AlmaLinux OS 8 | ✅ | |
| ami-0e2bc7a3ca89f5d06 | Rocky Linux 8 | ✅ | MBR |

## Script
https://gist.github.com/knqyf263/560020453511fe8107e2e9796fffbbd6#file-ami-snapshot-sh"
1328204071,2910,knqyf263,2022-11-27T09:19:44Z,Now it's all green 🎉🎉 🎉 🎉 🎉 
2156362547,6861,chen-keinan,2024-06-09T07:18:53Z,"@simar7 after bumping trivy-policies to v0.12.0 [integration test. --> repo test](https://github.com/aquasecurity/trivy/actions/runs/9434754821/job/25987269309?pr=6861) are failing.

can you please have a look ? "
2188168569,6861,chen-keinan,2024-06-25T07:21:47Z,@knqyf263 @simar7 @nikpivkin please review the PR and comment
2189834844,6861,simar7,2024-06-25T19:41:14Z,"> @knqyf263 @simar7 @nikpivkin please review the PR and comment

I had created https://github.com/aquasecurity/trivy/pull/7005 already but since you already bumped trivy-checks here, I will close the other one."
2178237614,6965,msmeissn,2024-06-19T09:45:22Z,"I tried to build using ""mage"", but it does not work with mage-v1.11.0~git0.07afc7d-150500.1.1.x86_64 on SLES 15 SP5.

""No .go files marked with the mage build tag in this directory."" (neither in top or in cmd/trivy/) 

go build cmd/trivy/main.go   goes through"
2191763145,6965,msmeissn,2024-06-26T13:51:20Z,"i did some test  but i need to figure out how to run tests first, the mage howto does not seem to work on older mage"
2193881946,6965,DmitriyLewen,2024-06-27T06:13:29Z,"Trivy mage commands - https://aquasecurity.github.io/trivy/v0.52/community/contribute/pr/#development
Also you can always use `go test`"
2206418642,6965,msmeissn,2024-07-03T14:56:25Z,"One thing, scans work (the image currently will always report this one entry, as the version was lowered after the update):

```bash
./trivy image registry.opensuse.org/opensuse/bci/bci-init:latest
2024-07-03T16:48:59+02:00       INFO    Vulnerability scanning is enabled
2024-07-03T16:48:59+02:00       INFO    Secret scanning is enabled
2024-07-03T16:48:59+02:00       INFO    If your scanning is slow, please try '--scanners vuln' to disable secret scanning
2024-07-03T16:48:59+02:00       INFO    Please see also https://aquasecurity.github.io/trivy/dev/docs/scanner/secret#recommendation for faster secret detection
2024-07-03T16:49:01+02:00       INFO    Detected OS     family=""opensuse.tumbleweed"" version=""20240607""
2024-07-03T16:49:01+02:00       INFO    [opensuse.tumbleweed] Detecting vulnerabilities...      os_version=""20240607"" pkg_num=149
2024-07-03T16:49:01+02:00       INFO    Number of language-specific files       num=0

registry.opensuse.org/opensuse/bci/bci-init:latest (opensuse.tumbleweed 20240607)
=================================================================================
Total: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

┌─────────────┬──────────────────────────┬──────────┬────────┬───────────────────┬────────────────────┬────────────────────────────────────────┐
│   Library   │      Vulnerability       │ Severity │ Status │ Installed Version │   Fixed Version    │                 Title                  │
├─────────────┼──────────────────────────┼──────────┼────────┼───────────────────┼────────────────────┼────────────────────────────────────────┤
│ permissions │ openSUSE-SU-2024:11165-1 │ MEDIUM   │ fixed  │ 1699_20240522-1.1 │ 20210901.1550-29.2 │ chkstat-1550_20210901-29.2 on GA media │
└─────────────┴──────────────────────────┴──────────┴────────┴───────────────────┴────────────────────┴────────────────────────────────────────┘
```


I otherwise started on more tests, but the integration tests are a bit large:

- how does the reference image get onto ghcr.io/aquasecurity/trivy-test-images: ? 
- how is golden generated? manually edited?"
2208119378,6965,DmitriyLewen,2024-07-04T04:57:01Z,"> how does the reference image get onto ghcr.io/aquasecurity/trivy-test-images: ?

you need to add your image to this script - https://github.com/aquasecurity/trivy-test-images/blob/master/copy-images.sh

> how is golden generated? manually edited?

Use `mage:updateGolden` command to update integration golden files"
2208512507,6965,msmeissn,2024-07-04T09:22:44Z,https://github.com/aquasecurity/trivy-test-images/pull/32  opened
2210939175,6965,msmeissn,2024-07-05T14:03:28Z,"Update:

I added some integration tests now, and 
    mage test:integration
seems to go through. 
trying to get test:unit to work, but i need to find/build a working tinygo for openSUSE first."
2216485740,6965,knqyf263,2024-07-09T04:25:35Z,@msmeissn Thanks for your great contribution!
2560687053,8134,knqyf263,2024-12-24T05:47:57Z,@nikpivkin Can you rebase the main branch? I think the linter will fail on `map[string]struct{}`.
2560689824,8134,nikpivkin,2024-12-24T05:51:55Z,I'm working on it right now
543362580,201,simar7,2019-10-17T21:08:19Z,Hey @knqyf263 this PR lgtm modulo the comments above!
658565946,552,knqyf263,2020-07-15T06:08:57Z,"It looks like Gem has a version with 3 dot such as `1.6.7.1` and this library can't handle such a version. As you can see, it detects CVE-2015-5312 in nokogiri, but `1.10.9-java` seems newer than `1.6.7.1`.

```
$ ./trivy image --vuln-type library logstash:7.8.0
2020-07-15T09:05:38.332+0300    INFO    Detecting bundler vulnerabilities...
2020-07-15T09:05:38.334+0300    ERROR   NewConstrainterrorimproper constraint: >= 1.6.6.0
2020-07-15T09:05:38.334+0300    ERROR   NewConstrainterrorimproper constraint:  < 1.6.7.1
2020-07-15T09:05:38.334+0300    ERROR   NewConstrainterrorimproper constraint:  < 1.6.7.2
2020-07-15T09:05:38.335+0300    ERROR   NewConstrainterrorimproper constraint: ~> 1.6.6.4
2020-07-15T09:05:38.335+0300    ERROR   NewConstrainterrorimproper constraint: >= 1.6.7.1
2020-07-15T09:05:38.335+0300    ERROR   NewConstrainterrorimproper constraint: >= 1.6.7.2

usr/share/logstash/Gemfile.lock
===============================
Total: 6 (UNKNOWN: 0, LOW: 0, MEDIUM: 4, HIGH: 2, CRITICAL: 0)

+----------+------------------+----------+-------------------+---------------+--------------------------------+
| LIBRARY  | VULNERABILITY ID | SEVERITY | INSTALLED VERSION | FIXED VERSION |             TITLE              |
+----------+------------------+----------+-------------------+---------------+--------------------------------+
| json     | CVE-2020-10663   | MEDIUM   | 1.8.6-java        | >= 2.3.0      | rubygem-json: Unsafe Object    |
|          |                  |          |                   |               | Creation Vulnerability in JSON |
+----------+------------------+----------+-------------------+---------------+--------------------------------+
| nokogiri | CVE-2015-5312    | HIGH     | 1.10.9-java       | >= 1.6.7.1    | libxml2: CPU exhaustion when   |
|          |                  |          |                   |               | processing specially crafted   |
|          |                  |          |                   |               | XML input                      |
+          +------------------+----------+                   +---------------+--------------------------------+
|          | CVE-2015-7499    | MEDIUM   |                   | >= 1.6.7.2    | libxml2: Heap-based buffer     |
|          |                  |          |                   |               | overflow in xmlGROW            |
+----------+------------------+----------+-------------------+---------------+--------------------------------+
| puma     | CVE-2020-11076   | HIGH     | 4.3.3-java        | 4.3.4, 3.12.5 | rubygem-puma: HTTP             |
|          |                  |          |                   |               | Smuggling via an invalid       |
|          |                  |          |                   |               | Transfer-Encoding Header       |
+          +------------------+----------+                   +---------------+--------------------------------+
|          | CVE-2020-11077   | MEDIUM   |                   | 4.3.5, 3.12.6 | rubygem-puma: HTTP Smuggling   |
|          |                  |          |                   |               | through a proxy via            |
|          |                  |          |                   |               | Transfer-Encoding Header       |
+----------+------------------+          +-------------------+---------------+--------------------------------+
| rack     | CVE-2020-8184    |          | 2.2.2             | 2.2.3, 2.1.4  | rubygem-rack: percent-encoded  |
|          |                  |          |                   |               | cookies can be used to         |
|          |                  |          |                   |               | overwrite existing prefixed    |
|          |                  |          |                   |               | cookie names...                |
+----------+------------------+----------+-------------------+---------------+--------------------------------+
```"
658658037,552,rahul2393,2020-07-15T09:29:12Z,"@knqyf263 Added logic to replace all occurrences of dots with ""-"" in patch version since it seems like Ruby having 3 dots is language-specific, all other languages put the dash in patch versioning. After it the code working fine for Ruby gems too, check tests
https://github.com/aquasecurity/trivy/pull/552/files#diff-7dcd81704618427d55b195b1e68cffc1R72-R76
"
658699699,552,rahul2393,2020-07-15T10:54:42Z,"<img width=""1311"" alt=""Screenshot 2020-07-15 at 4 24 18 PM"" src=""https://user-images.githubusercontent.com/18293335/87537059-a81cdc80-c6b7-11ea-881c-d987913d0853.png"">
"
919326301,1081,nscuro,2021-09-14T16:44:11Z,"Hi @masahiro331, I see you're using properties in your implementation. CycloneDX recently introduced the concept of property namespaces: https://github.com/CycloneDX/cyclonedx-property-taxonomy

I think it's a good idea to choose one (or more) namespaces for trivy as well. 
For example, `Type` could become `aquasecurity:trivy:Type` and so on. "
919699578,1081,CLAassistant,2021-09-15T04:58:13Z,[![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=1081) <br/>All committers have signed the CLA.
931987033,1081,masahiro331,2021-10-01T07:41:43Z,"@nscuro 
Thank you for information !!!

I have some question. 

Is this a custom property?
https://cyclonedx.org/use-cases/#properties--name-value-store

Would I write like this if I use namespaces for custom properties?
```
		Properties: &[]cdx.Property{
			{
				Name:  ""aquasecurity:trivy:Type"",
				Value: r.Type,
			},
			{
				Name:  ""aquasecurity:trivy:Class"",
				Value: string(r.Class),
			},
		},
```
"
932049252,1081,nscuro,2021-10-01T08:58:33Z,"@masahiro331 Yes, that's how you'd use namespaces :)

We released cyclonedx-gomod v1.0.0 yesterday which makes use of namespaced properties as well. For example: https://github.com/CycloneDX/cyclonedx-gomod/blob/v1.0.0/examples/app_minikube-v1.23.1.bom.json#L43-L60"
933622072,1081,masahiro331,2021-10-04T15:55:04Z,"@coderpatros 
Thank you for reserve aquasecurity namespace.
"
971479962,1081,savujevi,2021-11-17T11:19:17Z,"Hello,

maybe I have a little improvement for the implementation to generate the purl url. 
I am using dependencytrack which reads the purls of the dependencies and generates a list of vulnerabilities.
 
If I interpret the purl spec correct it would look like this:
`scheme:type/namespace/name@version?qualifiers#subpath`
 
When I look at your implementation you use the result.Type (from the trivy result it is e.g. redhat) for the type. As I interpret it right, it should be “rpm” for the type. It should look something like this: 
`pkg:rpm/bash@4.2.46`
and not
`pkg:redhat/bash@4.2.46`
Also for “jar” type it should be “maven” if I read the purl spec correctly.

Please correct me if I am wrong.
 
I have add following code snippet to your code to test the results with dependencytrack and it generates purls which seems to work.

I have updated the code a little bit (I am not sure if this is the right place and the best implementation).
I hope I am correct with my suggestion (I am no golang specialist).
`func NewPackageURL(t string, pkg types.Package) string {
...
switch t {
                case ""jar"":
                               t = ""maven""
                case ""alpine"":
                               t = ""apk""
                case ""debian"":
                               t = ""deb""
                case ""redhat"":
                               t = ""rpm""
                case ""centos"":
                                t = ""rpm""
                case ""opensuse.leap"":
                               t = ""rpm""
                case ""suse linux enterprise server"":
                               t = ""rpm""
                default:
}
...
}`

Thank you for your attention.

Best regards,
   Sascha Vujevic"
973950293,1081,masahiro331,2021-11-19T10:32:51Z,"I consider it a better implementation than mine.
I will refer to it and fix it.

Thanks for the suggestion."
988203101,1081,stevespringett,2021-12-07T19:22:37Z,"Here's the latest update on CycloneDX v1.4 - which will include representing vulnerabilities as part of the core spec.

A vote will take place on 16 December. Merge date is 17 December. The Core Working Group is anticipating to release v1.4 mid-January.

* [Added vulnerabilities as part of core spec [#91]](https://github.com/CycloneDX/specification/pull/91)
* [All 1.4 milestone tickets](https://github.com/CycloneDX/specification/milestone/5)"
997373410,1081,masahiro331,2021-12-19T11:14:07Z,"@stevespringett 
Thank you information. 
I will support fast!!"
1011592968,1081,stevespringett,2022-01-13T00:45:14Z,"CycloneDX v1.4 was released today. This release includes vulnerability support, and optional exploitability support.

https://cyclonedx.org/capabilities/
https://cyclonedx.org/news/cyclonedx-v1.4-released/"
1027813576,1668,CLAassistant,2022-02-02T10:54:32Z,[![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/aquasecurity/trivy?pullRequest=1668) <br/>All committers have signed the CLA.
1048801247,1668,developer-guy,2022-02-23T13:49:37Z,kindly ping @knqyf263 @naveensrinivasan 🙋🏻‍♂️
1048817428,1668,knqyf263,2022-02-23T14:07:40Z,"I'm sorry, but I've been busy on the CycloneDX release recently. Please let me retake a review shortly.
https://github.com/aquasecurity/trivy/discussions/1760"
1066103883,1668,knqyf263,2022-03-13T13:35:47Z,Thanks
