id,pr_number,user,created_at,body
832098352,835,crsib,2021-05-04T17:03:57Z,"VERSION was renamed to VERSION-* due to issues with the XCode 12.5.

The same reason stands for raising minSDKVersion on macOS to 10.9"
832134353,835,JamesCrook,2021-05-04T18:00:27Z,"New libs need COPYING files (or equivalent) to state their license.
New libs need to be listed with their licenses in the top level README.txt file."
832143383,835,crsib,2021-05-04T18:14:38Z,"> New libs need COPYING files (or equivalent) to state their license.

ThreadPool has COPYING, libcurl is downloaded in a similar way to the wxWidgets.

> New libs need to be listed with their licenses in the top level README.txt file.

Both libraries are now added to REAMDE.txt
"
832164483,835,JamesCrook,2021-05-04T18:48:06Z,"What's the status on lib-string-utils, lib-uuid, lib-timer, lib-telemetry Dmitry?

E.g. if they are entirely ours, are they ""GPL2 or later"" or MIT or something else?  Maybe that just needs a comment in README.txt to say that /libraries is under same license as /src ?

Separately, now assuming these are all ours, the class files will need the /****  and \class \brief style of doxygen comments, so that doxygen https://doxy.audacityteam.org/annotated.html will include these classes.  Probably the doxygen .dox.in file needs to be updated to include /libraries too."
832168950,835,crsib,2021-05-04T18:55:39Z,"> E.g. if they are entirely ours, are they ""GPL2 or later"" or MIT or something else? Maybe that just needs a comment in README.txt to say that /libraries is under same license as /src ?

Will do. The list of internal libraries will be further extended as part of @Paul-Licameli future work.

> Separately, now assuming these are all ours, the class files will need the /**** and \class \brief style of doxygen comments

Sure, no problem.

"
833458749,835,Paul-Licameli,2021-05-06T11:46:06Z,"> New libs need COPYING files (or equivalent) to state their license.
> New libs need to be listed with their licenses in the top level README.txt file.

Is this also pertinent to pull request #836 ? https://github.com/audacity/audacity/pull/836
"
833477828,835,Paul-Licameli,2021-05-06T12:19:51Z,"I'm trying to verify that each commit in the sequence is buildable for me, on my MacBook at least.  I fail at the first one:

echo ""Performing update step for 'curl'""
Performing update step for 'curl'
cd /Users/paullicameli/GitHub/audacity/build/cmake-proxies/libcurl/libcurl/src/curl && /Applications/CMake.app/Contents/bin/cmake -P /Users/paullicameli/GitHub/audacity/build/cmake-proxies/libcurl/libcurl/tmp/curl-gitupdate.cmake
echo ""Performing configure step for 'curl'""
Performing configure step for 'curl'
cd /Users/paullicameli/GitHub/audacity/build/cmake-proxies/libcurl/libcurl/src/curl-build && /Applications/CMake.app/Contents/bin/cmake -DCMAKE_INSTALL_PREFIX=/Users/paullicameli/GitHub/audacity/build/cmake-proxies/libcurl/libcurl -DHTTP_ONLY=On -DBUILD_CURL_EXE=Off -DCMAKE_USE_SECTRANSP=On -GXcode /Users/paullicameli/GitHub/audacity/build/cmake-proxies/libcurl/libcurl/src/curl
-- The C compiler identification is AppleClang 12.0.0.12000032
CMake Error at CMakeLists.txt:48 (project):
  No CMAKE_C_COMPILER could be found.



-- Configuring incomplete, errors occurred!
See also ""/Users/paullicameli/GitHub/audacity/build/cmake-proxies/libcurl/libcurl/src/curl-build/CMakeFiles/CMakeOutput.log"".
make: *** [/Users/paullicameli/GitHub/audacity/build/cmake-proxies/libcurl/libcurl/src/curl-stamp/Debug/curl-configure] Error 1
Command /bin/sh failed with exit code 2
"
833484481,835,Paul-Licameli,2021-05-06T12:30:59Z,"The commit dc7c7368f7bb9e40772cae271648edc8607ec254 ""Fixes XCode 12.5 build"" still doesn't fix my build.  I'm using XCode 12.4 and macOS 10.15.6.  Are you increasing the minimum needed for builds?

If this commit ""Fixes"" the build, that suggests to me that not all of the previous commits were buildable for you even on 12.5.  Can you permute this list of commits so that each step is sure to build and run?
"
833495776,835,crsib,2021-05-06T12:49:45Z,"> If this commit ""Fixes"" the build, that suggests to me that not all of the previous commits were buildable for you even on 12.5. Can you permute this list of commits so that each step is sure to build and run?

Only XCode 12.5 was broken, 12.4 worked fine, as obviously 12.3 does (as build succeeds on CI). 

12.5, however, won't be able to build Audacity master as well.  

I'm not sure if force push will be a great idea now, as Anton has already started working from this branch. However, if you are worried about bisect in the future - we can do a squash merge. This will be less time-consuming and much safer.

Can you please post the full error? From the CMakeOutput.log? I'm not able to reproduce it with the clean build and everything builds fine with GitHub Actions. Usually, `No CMAKE_C_COMPILER could be found` means some environmental problems.

"
833497370,835,Paul-Licameli,2021-05-06T12:52:17Z,"I think some interactive rebasing to simply this commit history would be useful.

As I have said, don't squash everything into a big commit, rather, do leave logical steps of the project in place for easier review and possibly later bisection for debugging.  But don't leave a record of mistakes and corrections made during development.  Squash the small corrections.

What requires the macOS deployment target minimum to increase from 10.7 to 10.9?  If the XCode minimum to build also increases, then what is forcing that?  Explain these things prominently in commit comments.

You introduce the libraries folder, which I also want to do in my misc-modules branch.  Are we agreed that:  each sub-folder of libraries builds one library, which Audacity depends on?  Each of these is (for now) shared?  (Though I might in future want to make certain of them static instead.)  Where should the compiled libraries be copied?  (In my branch they simply go into the folder with the executable file.)

And the code in libraries is always ""ours"", whereas anything in lib-src is only third-party code plus only small patches of ours that we must apply.  Yes?

About white space preferences,  I don't want to expend much time on those, but I do find it a little odd to see a space between a function name and the left parenthesis.  I prefer to leave the space before the parenthesis only for if, for, and while.




"
833517852,835,crsib,2021-05-06T13:21:13Z,"> I think some interactive rebasing to simply this commit history would be useful.
> 

At this point, force-pushing will break the day for another developer. Rebasing into a fully compilable and runnable set of commits will be very time-consuming. So if you are concerned about bisecting the master - we can squash the request or create a merge commit.

> What requires the macOS deployment target minimum to increase from 10.7 to 10.9? If the XCode minimum to build also increases, then what is forcing that? Explain these things prominently in commit comments.

If we want to support developers running newer XCode versions and/or M1 hardware - we need to increase the target, because compiling for 10.7 and 10.8 is no longer supported. It is possible to take the Xcode version and host system into account and configure it on this basis if we think that is critical to stay on 10.7, but I recall you wanted to raise min SDK version as well.
 
> You introduce the libraries folder, which I also want to do in my misc-modules branch. Are we agreed that: each sub-folder of libraries builds one library, which Audacity depends on? 

Yes.

> Each of these is (for now) shared? 

Yes.

> Where should the compiled libraries be copied? (In my branch they simply go into the folder with the executable file.)

This is system-dependent. Currently, on macOS, they will be placed into the Frameworks directory.

> And the code in libraries is always ""ours"", whereas anything in lib-src is only third-party code plus only small patches of ours that we must apply. Yes?

Yes.


**Just to clarify the situation with XCode 12.5:**

It was released last week (Apr 26) and breaks the Audacity build. There are two major issues: 

1. Looks like we cant compile for 10.7 anymore
2. We need to force CMake to use the legacy build system.

"
833527183,835,Paul-Licameli,2021-05-06T13:34:04Z,"> > I think some interactive rebasing to simply this commit history would be useful.
> 
> At this point, force-pushing will break the day for another developer. Rebasing into a fully compilable and runnable set of commits will be very time-consuming. So if you are concerned about bisecting the master - we can squash the request or create a merge commit.

I think what I suggested is a good rule for topic branches that are the work of one person.  I do this sort of interactive rebasing of my own work in progress often, and I don't find it very time consuming.  But collaboration with someone else does make force pushes difficult, that is true.

> 
> > What requires the macOS deployment target minimum to increase from 10.7 to 10.9? If the XCode minimum to build also increases, then what is forcing that? Explain these things prominently in commit comments.
> 
> If we want to support developers running newer XCode versions and/or M1 hardware - we need to increase the target, because compiling for 10.7 and 10.8 is no longer supported. It is possible to take the Xcode version and host system into account and configure it on this basis if we think that is critical to stay on 10.7, but I recall you wanted to raise min SDK version as well.

I'd like to use C++17.  You say developing on M1 also requires it.

The increase of the minimum supported version is not strictly necessary, though, to make telemetry work in the product.  Is that right?

So it's still not strictly needed to abandon 10.7 and 10.8 for that reason.  Still I hope that affects only a small minority of users.

"
833537942,835,crsib,2021-05-06T13:48:36Z,"> and I don't find it very time consuming

Rebasing is quick and fun :-) But in this case, it will be more of `git reset --soft` and then checking every commit against the CI. I hope that in the future we won't have the feature branches of this size. Strictly speaking - this branch should be divided into like 5 different branches merged one by one, each for a library. The problem, however, that `lib-telemetry` is the main consumer of the functionality included in the other libraries now.

> Is that right?

That's right. I can implement a set of checks in the CMake that will set the `CMAKE_OSX_DEPLOYMENT_TARGET` based on the version of XCode and the host hardware.

AFAIK 10.7 and 10.8 stand for less than 0.5% of the macOS install base, that is hard to say how many Audacity users are on this versions.

"
833545347,835,Paul-Licameli,2021-05-06T13:57:58Z,"
> AFAIK 10.7 and 10.8 stand for less than 0.5% of the macOS install base, that is hard to say how many Audacity users are on this versions.

Think of some statistic we might want to know about the users -- and now we might write code to collect just that information!  (If they opt in)

(I'm not suggesting we necessarily build 3.0.3 for 10.7 still, just so collect the hard data on just how few really use it, and only then decide to abandon 10.7.)


"
833562408,835,Paul-Licameli,2021-05-06T14:20:33Z,"> > and I don't find it very time consuming
> 
> Rebasing is quick and fun :-) But in this case, it will be more of `git reset --soft` and then checking every commit against the CI. I hope that in the future we won't have the feature branches of this size. Strictly speaking - this branch should be divided into like 5 different branches merged one by one, each for a library. The problem, however, that `lib-telemetry` is the main consumer of the functionality included in the other libraries now.

Those five little branches would add the lib-* one at a time, bottom up?  That might be less overwhelming to review.

The stuff in lib-* is all your work, not copied from elsewhere?

I can't see yet in his fork how much work Anton has done with dependency on your branch, which is why you don't want to force commit.
"
833622526,835,crsib,2021-05-06T15:37:19Z,"> Those five little branches would add the lib-* one at a time, bottom up? That might be less overwhelming to review.

Yep. But the most of the code is in lib-network-manager still

> The stuff in lib-* is all your work, not copied from elsewhere?

It is mine, no 3d party code there"
833778895,835,spacekookie,2021-05-06T18:53:57Z,"I know me leaving a comment is not going to stop this feature being included in Audacity, but I want to voice my opposition to this change anyway. Feel free to ignore me if my opinion is inconvenient to you.

I've never contributed to Audacity, and haven't really engaged in the development of the project before. I have however used audacity for various audio editing tasks for the better part of a decade. And while I welcome the prospect of new development, and the project getting some of the updates it deserves, I am concerned about the use of analytics, from a principled stand point.

We live our lives in a world where virtually every movement we make online, and many of the movements we make in the real world are subject to surveillance and tracking. It has been normalised to the point where the majority of people just put up with it, or don't question its usage.
Fundamentally tracking and analytics are about a power imbalance between the people doing the tracking and the people being tracked on. Yes, I understand that this is opt-in, but that is how a lot of things started, and how they become normalised to the point where a lot of applications and websites _don't_ ask for permission first. Worse, because a lot of users have been conditioned to think that tracking is normal, many will just press ""ok"" or ""yes"" to make an annoying dialog go away, not fully realising what they are consenting to. Consent based on incomplete data is not truly consent.

As I said, I am very happy to see that Audacity is getting some love and attention from a design perspective. I'm excited to see how the project can be improved. But I am worried about the use of analytics, especially using large data mining companies (Google & Yandex) as a platform to do so. If you want to know what your users think about something, ask us. Ask us directly and out in the open. Don't spy on us.

Thank you for reading."
833778913,835,MrPetovan,2021-05-06T18:53:58Z,Is telemetry opt-in only or do users have to disable it manually once they update to the next release?
833785461,835,Be-ing,2021-05-06T19:03:34Z,"I agree with @spacekookie. I don't think these kinds of data collection are actually very helpful. The Mixxx website had Google Analytics for years and in practice it never changed a decision we made. If you're going ahead with this, I think you owe it to users to explain in specific terms (not some vague ""this will help us improve Audacity"") what you are planning to do with this data and how it is going to help users. You can get the information you need to improve Audacity by listening to what users already say and watching them use the software in usability tests.

As a harm reduction measure, I suggest to use a service that Audacity hosts. Collecting data about Audacity users is one thing and sending that data to Google and Yandex is another. I would feel deceived if I thought I was opting into sending data to the Audacity developers and later found out it was also going to Google and Yandex.

I also suggest to guard this with a CMake option that defaults to `OFF`. I suspect some Linux distributions will want to build without this. Like users, packagers should have to specifically opt into this."
833794008,835,nils-van-zuijlen,2021-05-06T19:16:53Z,"Also, you may want to think about the GDPR, Google isn't known for respecting it... And although it only applies to ""personal information"", the definition of it isn't really precise, and an IP may be considered ""personal info"".

PS: I'm no lawyer, that's why I used conditional... [Other people](https://github.com/audacity/audacity/pull/835#issuecomment-833852063) down below pointed out that IP is in fact a personal information, by law."
833801556,835,axb21,2021-05-06T19:29:04Z,"Google is a monopoly and a bad actor and I do not want their spyware in Audacity. Please do not include it in any form. I've spent more time than I care to account for trying to divest from Google and I don't want to have to worry that Audacity is funneling data about me to them when I listen to or work with music tracks. I will simply stop using it.

Telemetry isn't that useful anyway. It's certainly not useful enough to justify selling out users to a very large surveillance company, in my view. Please remove it completely."
833802256,835,Marie-Joseph,2021-05-06T19:30:14Z,"I'm just some rando, but I've been using Audacity for at least a decade at this point, for everything from school assignments to experimental art. I will find something to replace it if this is merged.

Getting information about users would be more ethically conducted via a survey of some sort, linked to from the startup modal, ideally with a fully-qualified URL and hosted by a site without tracking. At the very least then there would be more transparency for the user about who is collecting one's information, how, and what of that information is received by Audacity developers. This could even be done - albeit with less automation - by linking to a forum thread whose sole purpose is to retrieve user feedback. The first post could explain the thread and provide a template for what information the developers would most like to have."
833808574,835,herzmut,2021-05-06T19:40:17Z,"Telemetry won't tell you if users like the software or wish for a new feature. It only tells them they've been subjected to economic surveillance in an economic manner, and not even a decently useful one. Let's face it: telemetry is useless. By its nature, it can't bear any context information, as the telemetry to read a user's mind is yet to be found. (A quest which hopefully never succeeds.) 

How comes that other successful open source software never had any use for analytics? Blender, Inkscape, GIMP... afaik none of them utilitized Google or Yandex or any other corporate surveillance service and they're doing great without. Some out-of-the-box thinking which innovative companies claim to be good at is probably what's required here."
833821994,835,ghost,2021-05-06T20:01:44Z,"in addition to all the above comments, i'd like to point out that mandating telemetry may hurt people with any issues related to connectivity. i hope you make this opt-in(and not google! google is terrible with privacy. look into ethical alternatives to data analytics!), rather than opt-out. don't spy on your users. let them tell you things."
833822556,835,ArneBab,2021-05-06T20:02:42Z,"Audacity is wonderful software. It is great, because it works well at what it does. Sending surveillance data to third-party companies is not part of that. If you want to collect data, please save it locally, without Google or other intermediaries, and ask when you want to send it, giving me the option to inspect it beforehand.

Even better: Allow me to enable recording my actions in a typical use-case and send you exactly this data as usage scenario. That way you get self-curated data which is much more useful for improving audacity, and you avoid selling our privacy to surveillance companies."
833824787,835,sandycorzeta,2021-05-06T20:06:17Z,"I guess we can learn from the past of where musecore did also having a backlash for implementing telemetry. Since Audacity now is part of mu.se group, its inevitable. (https://musescore.org/en/telemetry)

 But yes... make it opt-in option and if possible, please give an option to disable to this feature in build/make parameter too."
833838117,835,Be-ing,2021-05-06T20:28:37Z,"It is quite concerning that this comes so soon after the announcement regarding Muse Group. I was excited to learn that Audacity was getting attention on its design, but this makes me concerned about what other questionable changes are coming for Audacity in the future."
833840159,835,ivan-avalos,2021-05-06T20:31:42Z,"We need a community fork without telemetry and using a different branding, so, as soon as Muse Group implements more ~~privacy-abusing~~ people-abusing features, or decides to simply make Audacity proprietary, development can continue independently."
833840933,835,yurkobb,2021-05-06T20:32:55Z,"There are two separate issues:
1. Telemetry itself;
2. The sharing of user data with Google Analytics, Yandex or other third-party for-profit ad-oriented companies.

While telemetry itself is sometimes included in libre software (as explicit opt-in), I don't believe piping user behavior data into Google Analytics et al is a widespread practice in well-known free software projects yet. (I _may_ be totally wrong and other projects may already be doing this, but at least the explicit opt-in popups that I have seen as a user didn't mention Google Analytics).

I suspect that GDPR-wise this might be an interesting legal problem not only for Audacity but for Linux distributions as well.

Please manage the telemetry data yourself instead, without using Google Analytics (perhaps by using self-hosted open-source tools).

And make it opt-in, with clear consent (GDPR, again)."
833841340,835,Be-ing,2021-05-06T20:33:33Z,"> or decides to simply make Audacity proprietary

Let's not get hyperbolic here. Audacity is licensed under the GPLv2. Nobody can make it proprietary."
833844145,835,ghost,2021-05-06T20:37:43Z," > Let's not get hyperbolic here. Audacity is licensed under the GPLv2. Nobody can make it proprietary.

if muse group holds the license to all the code, they can simply not release future versions under the GPL. the existing code would exist, but the other code wouldn't be GPL licensed."
833850896,835,Be-ing,2021-05-06T20:43:06Z,"> Universal Google Analytics is used to track the following events:
    Session start and end
    Errors, including errors from the sqlite3 engine, as we need to debug corruption issues reported on the Audacity forum
    Usage of effects, sound generators, analysis tools, so we can prioritize future improvements.
    Usage of file formats for import and export
    OS and Audacity versions

Please make each of these categories of information easy for the user to individually opt into with separate checkboxes. A simple ""send information to Audacity developers"" option is not sufficient for informed consent or giving users meaningful choices to make about their privacy. I personally would be fine telling Audacity developers what effects, OS, and Audacity version I am using, but I am not comfortable telling you when I am using Audacity. That feels invasive and you don't need to know that.

Also, please explain directly in the user interface where these options are toggled how sending each of these pieces of information to the Audacity developers will benefit users sending the information, for example, ""Telling us what operating system you are using helps us prioritize which operating systems to keep Audacity compatible with."""
833852063,835,meduzen,2021-05-06T20:44:35Z,"> Also, you may want to think about the GDPR, Google isn't known for respecting it... And although it only applies to ""personal information"", the definition of it isn't really precise, and an IP may be considered ""personal info"".

IP **is** a personal data [according to the GDPR](https://ec.europa.eu/info/law/law-topic/data-protection/reform/what-personal-data_en):

> Examples of personal data
>
> …
> an Internet Protocol (IP) address;
> …

(See also this [working party document](https://ec.europa.eu/justice/article-29/documentation/opinion-recommendation/files/2007/wp136_en.pdf), page 16.)

When it comes to Google Analytics, it’s a no-brainer: if the user has a Google account and has been connected to the account on the same IP address Audacity is used, there will likely to be a match (depending on the number of users having the same IP, and/or sharing the device).

That said, if Audacity maintainers want to do telemetry:
- you’re by law required to make it opt-in, at least for European users;
- there are open source and/or self-hosted alternatives you should consider:
  - https://matomo.org
  - https://umami.is
  - https://plausible.io
  - https://usefathom.com
  - https://simpleanalytics.com
  - https://ackee.electerious.com
  - https://github.com/milesmcc/shynet
  - https://chiffre.io
- make sure your privacy policy:
  - receives the attention it deserves;
  - is explicit about what you track and what it enables;
  - states that the collected data are publicly accessible, because it’s open software."
833868941,835,alexxroche,2021-05-06T21:10:04Z,"> This request provides the basic telemetry for Audacity.

If you audaciously add this I'm going to have to fork Audacity and remove it again."
833881022,835,Be-ing,2021-05-06T21:30:12Z,"Please post screenshots with your pull requests when you propose to change the GUI to make it easier for users to give feedback on the design, especially considering you require a forked version of wxWidgets which makes it cumbersome to build Audacity locally."
833884135,835,SamantazFox,2021-05-06T21:35:48Z,"As a long time user, I'm really struggling to see why you'd want to add telemetry. First, it's going to Google, which is kinda againsty the FOSS (free and open-source software) philosophy, and second, what is that going to help you with? Audacity managed to be the best FOSS sound editing software you can get, with a lot of features, and without a bit of telemetry.

If your goal is to provide a good piece of software to the FOSS community, then listen to the community instead of selling it to Google, and ""trying to figure out what they want"" based on some numbers in a chart."
833886274,835,Be-ing,2021-05-06T21:39:38Z,Are users able to see the data that is collected or is that only available to a few Audacity developers?
833890995,835,les-citrons,2021-05-06T21:48:03Z,"I am concerned for the direction of the project if the maintainers are considering incorporating telemetry, of all things."
833892740,835,ivan-avalos,2021-05-06T21:50:49Z,"@Be-ing 
> Let's not get hyperbolic here. Audacity is licensed under the GPLv2. Nobody can make it proprietary.

Not necessarily, it depends on whether the copyright of code and contributions is owned entirely by the developers/authors, or not. Contribution agreements play an important role on whether you can take a GPL'd software proprietary or not.

This article explains different cases: https://wpandlegalstuff.com/taking-gpld-code-proprietary/"
833905304,835,Chaz6,2021-05-06T22:11:07Z,One suggestion: make it clear in the permission dialog that telemetry uses Google Analytics rather than a private service you host yourself. This may be particularly of note to users who are covered by GDPR regulations.
833906949,835,ccoenen,2021-05-06T22:14:21Z,"> Is telemetry opt-in only or do users have to disable it manually once they update to the next release?

Including it in the first place (opt-in or opt-out) is the problem. Changing the default down the road is just too tiny a change (and maybe too tempting not to do it).

This should not be included at all.
"
833911364,835,Be-ing,2021-05-06T22:22:27Z,"Some users are going to be upset if you merge any form of telemetry whatsoever. Personally, my respect for Audacity would increase if you really take the feedback here to heart, put in the work to switch to a self-hosted server, and work with us to make the GUI design very specific and clear so users can easily make informed decisions about their privacy. I think you will get more complete and useful data if users feel they can trust you with it.

EDIT: My [opinion has changed](https://github.com/audacity/audacity/pull/835#issuecomment-834969949)."
833914225,835,GiovanH,2021-05-06T22:27:55Z,Is there a specific issue or request that this PR addresses? I'm not seeing any reference here to the usual discussion a major change like this would usually require.
833914295,835,axb21,2021-05-06T22:28:01Z,"The commit stats on this are amazing to me:

> +5,506 −25 
> Commits 29
> Files changed 92
 
5,506 lines of code inserted to implement telemetry that should not be in there. That is a substantial amount of code that certainly contains dozens of bugs and likely several security issues. That is enough code to be a maintenance headache for someone forever. That's also enough code to implement at least one cool new feature that end users actually want to have.

Why telemetry, in an already excellent piece of software? Whyyyyyyyyyyyy?"
833915363,835,Be-ing,2021-05-06T22:29:58Z,"> 5,506 lines of code

Most of that code is from vendored dependencies. The changes to the Audacity code are quite small."
833917324,835,axb21,2021-05-06T22:33:45Z,"> > 5,506 lines of code
> 
> Most of that code is from vendored dependencies. The changes to the Audacity code are quite small.

Good point. So perhaps the ""dang, this could have been an actually useful feature"" part of my mini-rant is not as relevant. The rest is though--that's a lot of code, with potentially a lot of bugs and security holes, and you've already started documenting above! Adding a bunch of new dependencies is worrisome generally speaking, too, let alone for this."
833917348,835,natevw,2021-05-06T22:33:50Z,"Not going to dispute that this is a bad look, or might violate the GDPR, or even that it's a slippery slope and all that.

But as a long time casual Audacity user this is not the end of the world for me either:

* at least it's Google (motto: ""We're Not Evil™""), and not Facebook (motto: ""Hahah, whoops you caught us…"")
* sounds like I will not be required to opt-in (and/or at least can opt-out, …and block any initial attempts via Little Snitch until then ;-)

And one thing that makes a big difference to me:

* the telemetry agent looks to be custom code tracked in the repository itself, instead of dropping in some supply chain attack that an advertising company offers in pre-built form (and which may/may-not actually respect my tracking preferences behind the scenes!)"
833918134,835,SamantazFox,2021-05-06T22:35:18Z,"> Adding a bunch of new dependencies is worrisome generally speaking, too, let alone for this.

Yup. They're adding a whole network and HTTP stack *just* for that."
833919359,835,les-citrons,2021-05-06T22:37:30Z,"> > Adding a bunch of new dependencies is worrisome generally speaking, too, let alone for this.
> 
> Yup. They're adding a whole network and HTTP stack _just_ for that.

it seems like the PR author forgot that this is an audio editing program and not a ""stream mouse clicks to Google"" program."
833920426,835,axb21,2021-05-06T22:39:41Z,"> * at least it's Google (motto: ""We're Not Evil™""), and not Facebook (motto: ""Hahah, whoops you caught us…"")

@natevw I strongly recommend you read up on just how evil Google is. They've had multiple, multi-billion dollar fines for their various misdeeds; they spy relentlessly on anyone who gets near their platform; they are involved in multiple lawsuits in the US for violations of antitrust law; they're a revolving door for US military higher-ups; they take large amounts of money from the US military and there's good reason to believe it's helping to build weapons; etc etc etc etc. Literally Google ""Google actually is evil"" and you'll find lots.

""As least it's Google and not Facebook"" doesn't make sense. That's like saying you're glad you had a major stroke instead of a heart attack.
"
833923797,835,lodenrogue,2021-05-06T22:46:26Z,I'll add my vote against this PR. You shouldn't be sending any data to Google. Looking forward to the fork without the telemetry code.
833925410,835,matu3ba,2021-05-06T22:49:35Z,"Your privacy policy is missing all your information how to handle collected data on your website https://www.audacityteam.org/contact/privacy-policy/. 

Do you even have a privacy policy for your application?

You have a google searchbar, but dont list the conditions of usage (including privacy terms) which is legally worrisome at least.

I want to quote your message on your website https://www.audacityteam.org/contact/advertising-and-monetization-opportunities/
""We are happy with our current advertising partners and are not interested in new offers of advertising or monetization schemes.
We do not, and will not bundle other applications with Audacity.""

Your website and ""The Google logo is a trademark of Google, Inc."" (https://www.audacityteam.org/copyright/) makes me think different."
833931985,835,sirocyl,2021-05-06T23:03:35Z,"Itemize this down into several parts.

Adding libcurl, while increasing the complexity and dependency chain of Audacity, may be useful in the future (e.g., networked live/streaming audio capture, linking audio files in a project from network sources) but not to implement a development nightmare like this.

Don't import the library wholesale, but rather, include its code in a maintainable way that is safe to upgrade by maintainers. Lobbing the whole library into local scope may interfere with the speedy response to security/vulnerability reports, and looks ugly in general to maintainers.

Don't fork wxWidgets for one feature. Try instead, to write the feature in a local scope - a lot of the Wx APIs are declared weak, for a reason.

Don't add telemetry to a third-party provider that isn't owned by a maintainer of Audacity, or a leading member of the Audacity team.

> _I am not an Audacity team member; these are only suggestions, and may not reflect the Team's views or goals._"
833940218,835,Sciss,2021-05-06T23:20:13Z,"> @Be-ing
> 
> > Let's not get hyperbolic here. Audacity is licensed under the GPLv2. Nobody can make it proprietary.
> 
> Not necessarily, it depends on whether the copyright of code and contributions is owned entirely by the developers/authors, or not. Contribution agreements play an important role on whether you can take a GPL'd software proprietary or not.
> 
> This article explains different cases: https://wpandlegalstuff.com/taking-gpld-code-proprietary/

as far as I can see, there isn't and wasn't any sort of CLA in place that specified that anyone submitting patches to the project would agree to future license changes. So if I'm not mistaken, the license of the project cannot be changed from GPL unless the new project managers obtain permission from everyone who contributed in the past and/or remove code contributed from people who refuse to change the license. Therefore, while monetisation can come into the project by building additional paid cloud services or selling the telemetry data, the project cannot become closed source with respect to what is on a user's desktop."
833940717,835,mt6572a,2021-05-06T23:21:28Z,bruh
833941987,835,telugu-boy,2021-05-06T23:24:33Z,"'-'

\""
\-

\""
0
\="
833942631,835,ccoenen,2021-05-06T23:26:03Z,"> Therefore, while monetisation can come into the project by building additional paid cloud services or selling the telemetry data, the project cannot become closed source with respect to what is on a user's desktop.

Half of that sentence is true, it can not become closed source. The other half is not related in any way. Of course one can and may charge for open source software. You can tie pre-built binaries to payment, for example.

"
833946994,835,IGBC,2021-05-06T23:36:26Z,"adding telemetry is a good way to instantly create 20 new forks of this project, all of which remove muse group's control over their investment. Consider yourselves threatened."
833947114,835,AeroNotix,2021-05-06T23:36:43Z,Neat! Another project I can cross off my list.
833948080,835,IGBC,2021-05-06T23:39:14Z,Also what are you doing to keep this GDPR and local Data Protection laws complaint?
833950999,835,joepie91,2021-05-06T23:46:49Z,"Just to reassert this: making it opt-in is a __requirement__ of the GDPR. Without misleading dialogs, and without manipulation like a shiny green 'accept' button vs. a tiny 'reject' button.

And yes, other commenters have been correct in saying that telemetry isn't that useful, and you should just *ask* users what issues they run into with the software. You will learn a lot more actionable information, without being invasive.

Edit: To clarify, ask users what they dislike or what frustrates them, not what they want. Learning what people *don't* want is the most actionable information for improving a piece of software - pie-in-the-sky ideas are much less useful."
833951629,835,IGBC,2021-05-06T23:48:24Z,"This nonsence, but still no bug fixes to Jack support.... Really? I guess the Muse Group money had strings attached."
833953134,835,tilda,2021-05-06T23:52:23Z,"I feel bad for all the people getting emails about this right now...

Personally, I wouldn't mind the change if it didn't add more dependencies (both locally in terms of libraries, and in terms of depending on 2 relatively large tech companies for your data). Maybe if it was a Matomo instance (or similar), it would be more likable."
833955655,835,lodenrogue,2021-05-06T23:59:14Z,"> This nonsence, but still no bug fixes to Jack support.... Really? I guess the Muse Group money had strings attached.

How do we know he's with them? "
833957329,835,IGBC,2021-05-07T00:03:15Z,"@lodenrogue I did some digging, the account is largely inactive until this year. First contribution to Audacity was in 29 March, and was an edit to the Error handling. One other PR merged yesterday was a SQLite version bump, presumably to support this change. Finally the account states his location is St Petersburg, and has a very small set of projects given the account's 9yr old age.

Generally it stinks of corporate interference, but at least they didn't sneak this in as a side entry to some other more important changes. Clearly they're new to this FOSS thing."
833958358,835,GiovanH,2021-05-07T00:05:42Z,"> @lodenrogue I did some digging, the account is largely inactive until this year. First contribution to Audacity was in 29 March, and was an edit to the Error handling. One other PR merged yesterday was a SQLite version bump, presumably to support this change. Finally the account states his location is St Petersburg, and has a very small set of projects given the account's 9yr old age.

The most suspicious thing here is how readily reviewers jumped to inspecting the implementation details of a PR given the complete lack of any discussion of the feature, or even a single relevant ticket. "
833963533,835,tilda,2021-05-07T00:15:16Z,"> Finally the account states his location is St Petersburg

Okay, I can understand why you would be suspicious of the other things but why is being located in Russia a suspicious thing? Does country of origin really matter in this case?

"
833964145,835,mindinsomnia,2021-05-07T00:16:31Z,"Wow so many people in this thread need to chill out.
A) It's opt in
B) It's anonymous
C) It's only collecting basic stats about how users are using the application, ya know, helpful stuff that helps developers make decisions on how to improve the user experience?

Chill out folks."
833964165,835,IGBC,2021-05-07T00:16:35Z," Its where muse group's headquarters are. No malcontent to any Russians intended, I am only pointing out that makes it more likely this where that guy works. "
833969076,835,falkTX,2021-05-07T00:26:34Z,"As someone who has worked and collaborated on many open-source audio applications and plugins myself, **please DO NOT merge** this PR.
I will fork and maintain a custom Audacity build myself if I have to.

We do not want analytics, phone-home or other ""modern"" crap in such tools.
Thank you
"
833969481,835,Be-ing,2021-05-07T00:27:34Z,I don't think we need a fork if this is behind a compile option that defaults to off.
833969780,835,tastytea,2021-05-07T00:27:59Z,"> Wow so many people in this thread need to chill out.
> A) It's opt in

For now.

> B) It's anonymous

It's pseudonymous at best, Google and Yandex can likely de-pseudonymize you.

> C) It's only collecting basic stats about how users are using the application, ya know, helpful stuff that helps developers make decisions on how to improve the user experience?

There's already a tool for that, it's called asking.

> Chill out folks.

[It's very likely that this “feature” is illegal in the EU.](https://noyb.eu/en/101-complaints-eu-us-transfers-filed)"
833969933,835,SamantazFox,2021-05-07T00:28:27Z,"> A) It's opt in

Yup, but it's a slippery slope to see it enabled by default some day...

> B) It's anonymous

Nope, that's GA. They will do whatever they can to add that data to the (already large) user profile they have of everybody.

> C) It's only collecting basic stats about how users are using the application, ya know, helpful stuff that helps developers make decisions on how to improve the user experience?

Tracking users is not the FOSS way of making better software. There are tons of great FOSS software that has decent UX (blender, inkscape, ...) and spoiler, they're not tracking their users."
833970698,835,IGBC,2021-05-07T00:30:32Z,"> I don't think we need a fork if this is behind a compile option that defaults to off.

100% not the point. One of the pillars of FOSS is maintaining decentralized systems. This PR is in direct conflict with those values."
833971160,835,jxu,2021-05-07T00:31:43Z,"Get the GDPR lawsuit threats ready just in case folks

and pitchforks"
833974696,835,nhhollander,2021-05-07T00:40:40Z,"I'm concerned about the use of a persistent identifier and google analytics here. Google does not have much respect for user privacy, and this change provides more than enough information to allow a user to be tracked across networks."
833975002,835,BlueRaccoonTech,2021-05-07T00:41:21Z,"I personally can see some value in having telemetry information, but I would politely, yet firmly, disagree with the notion of adding Google-based tracking to Audacity and, instead, would ask for something that wouldn't deliver information, ""anonymized"" or otherwise, to a company such as Google on a silver platter...

Isn't OpenTelemetry a thing?"
833977715,835,ghost,2021-05-07T00:49:01Z,just do a survey
833981552,835,draeath,2021-05-07T00:59:02Z,Is the author aware of submodules? Why are those dependencies directly included?
833983858,835,TheEvilSkeleton,2021-05-07T01:05:39Z,"> I personally can see some value in having telemetry information, but I would politely, yet firmly, disagree with the notion of adding Google-based tracking to Audacity and, instead, would ask for something that wouldn't deliver information, ""anonymized"" or otherwise, to a company such as Google on a silver platter...

I second this.

> Isn't OpenTelemetry a thing?

It is a thing, but Google is heavily involved with the project, but I am not sure if it's actually a Google project:

> OpenTelemetry is an open source observability framework created when CNCF merged the OpenTracing and OpenCensus projects.[64] OpenTracing offers ""consistent, expressive, vendor-neutral APIs for popular platforms""[65] while the Google-created OpenCensus project acts as a ""collection of language-specific libraries for instrumenting an application, collecting stats (metrics), and exporting data to a supported backend.""[66] Under OpenTelemetry, the projects create a ""complete telemetry system [that is] suitable for monitoring microservices and other types of modern, distributed systems — and [is] compatible with most major OSS and commercial backends.""[67] It is the ""second most active"" CNCF project.[68] In October 2020, AWS announced the public preview of its distro for OpenTelemetry.[69] 

https://en.wikipedia.org/wiki/Cloud_Native_Computing_Foundation#OpenTelemetry

Also: https://opensource.google/projects/opentelemetry"
833983936,835,dromer,2021-05-07T01:05:54Z,"Nice, it's almost a ""real DAW"" now.

Fork name suggestions?"
833984854,835,KatiaCooksCakes,2021-05-07T01:08:26Z,🍞 💨 
833985343,835,Be-ing,2021-05-07T01:09:42Z,Please don't post one word or just an emoji in a comment. It only makes noise with notifications and clutters the discussion. Use GitHub reactions instead.
833987550,835,Pokechu22,2021-05-07T01:15:27Z,"> Is the author aware of submodules? Why are those dependencies directly included?

Audacity already [directly includes other dependencies](https://github.com/audacity/audacity/tree/master/lib-src) instead of using submodules.  I don't know exactly why it's done like that, but one advantage is that downloading the repository as a zip file includes the libraries (which doesn't happen with submodules), and also regular `git clone` works normally instead of requiring `git clone --recurse-submodules`.

IMO it would be wrong to add a new dependency as a submodule without converting the existing ones to submodules, which would also be something that should happen in its own PR (if converting to submodules is actually a good idea)."
833988587,835,eunakria,2021-05-07T01:18:14Z,"As a developer who does a lot of ""proprietary-flavored"" services, stuff that has a very corporate coat of paint over it, I know the value of telemetry information to get a sense of user base topology. Audacity is often prided on its high-quality forum, but it's really hard to get users to actually speak up when they find something wrong with your service. Users don't report crashes or bugs; they just complain. The thing is, I want to make my software better for them!

Telemetry and crash reporting is *super* helpful, because it takes the effort off of the user to get information about crashes. If you have issues with a given feature, it ends up on your radar a lot quicker. As such, I totally support the decision by Audacity to include telemetry in the next release of Audacity.

But...\
Google Analytics?

Guys, I think you need to reconsider. Google Analytics isn't a telemetry or analytics platform; it's the eyes and ears of a cosmic horror of a company. I shouldn't need to go into the details of why Google or GA is so bad. I realize I alone won't have any power to dissuade you guys, but I seriously implore y'all to reconsider. Please, guys, pick another telemetry platform."
833990054,835,IGBC,2021-05-07T01:22:28Z,"I would like to point out there is in the shadow of this PR a draft PR to add breakpad support. Which is a crash and error reporting tool, much more appropriate to the types of information that *should* be collected here.

That said breakpad is also a google technology and I am unaware how tightly it is integrated with google infra, but It stands as a statement that even in google's wheel house analytics is a tool for making money, not actionable insites on software stability."
833991711,835,AndreiSva,2021-05-07T01:27:41Z,"I understand the need for this kind of telemetry. But I think it would be better if instead of the telemetry of being opt out it would be opt in. This way people who value privacy wouldn't feel like they are using creepware and people who are willing to give their information can do so by changing a setting.

Also, using Google Analytics is a very bad move and would discourage a lot of people from keeping the setting enabled. I would be willing to send my information somewhere I trust but Google is definitely not a company that is trustworthy and has a horrible privacy track record."
833994410,835,sirocyl,2021-05-07T01:36:23Z,"I will say that self-hosted telemetry services are a thing. I'm not inherently against the idea of telemetry; but while a high-dollar, professional and closed-source application may handle it with Google and wide-brushed opt-out click-tracking, this particular implementation is extremely sore for a free-software project.

The damage done by even *__suggesting__* this line of action, will completely undo the supposed benefits of direct feedback, knowing which features are used how, in a general user workflow.

I'm aware Audacity is under new management, in general, but that just makes things even more sore for the community of users and contributors on seeing this change come to light. It puts egg on the face of not the project, but its management, leadership and ownership.

I strongly suggest cancelling this change set - as I mentioned before, keep the parts which do have value to the project now or in the future, like library additions and upgrades - the SQLite upgrade merge happened without issue! And this change set is at least in multiple commits, which are easier to break down and work with - those should have been separare PR's, rather than this obstructive patch of regolith with many layers to support one core function.

I'd recommend that you do keep the different parts in separate itemized PRs with a smaller code footprint, and do open a public request for comments on telemetry implementations, best-practices, things like GDPR/California CCPA regulatory and compliance hurdles, and get a general feel for the community that uses the software. Hell, if you have legal counsel on the team, it would be a bright idea to loop them in on the telemetry changes. Audacity is a global project, and legal scope matters just as much as jurisdiction.

All in all, everyone commenting and 👎'ing the PR here, are a very small minority of Audacity users; most (myself included!) won't even see changes like this, until it's brought to their attention by someone, likely a contributor, who _has_ seen this.

If a small cluster of us, including open-source contributors, are strongly against it, it would be remiss of you, and the management of the project here, to push through without soliciting further comment and considering changing course in the ways that matter.

This change set exemplifies ""audacity"" by the word; not as in ""bold courage"", but as in ""brazen impudence""."
833995626,835,ThisIsPaulDaily,2021-05-07T01:40:00Z,"If there was a way to force this branch to always conflict, so that it could never successfully merge, that would be cool. 

Others have pointed to GDPR, Privacy Policies, statements made previously about third parties, and whatnot. I'm here, looking at a merge that passes checks and is two affirmative reviews away from a hard fork away from here. 

If we, as a community, created and got approved merge requests that intentionally conflict with this branch it could slow this down. 

I say this as someone who has yet to contribute to the Audacity project. 

How dare you have the audacity to put analytics into FOSS!?"
833996744,835,GiovanH,2021-05-07T01:43:11Z,"> If there was a way to force this branch to always conflict, so that it could never successfully merge, that would be cool.
> 
> Others have pointed to GDPR, Privacy Policies, statements made previously about third parties, and whatnot. I'm here, looking at a merge that passes checks and is two affirmative reviews away from a hard fork away from here.
> 
> If we, as a community, created and got approved merge requests that intentionally conflict with this branch it could slow this down.
> 
> I say this as someone who has yet to contribute to the Audacity project.
> 
> How dare you have the audacity to put analytics into FOSS!?

This kind of sabotage, and spam, and general anger in this thread isn't the right way to do this and isn't productive. The important thing is that reviewers don't approve it and the maintainers don't merge it until it gets the thorough evaluation and discussion it deserves. Spam does nothing but make the people who object (who are right, of course) look bad.

**Don't** simply merge this PR. That's the obvious takeaway here.

**Do** open a full and thorough issue and discussion about whether to have any sort of analytics. If there's consensus that analytics are beneficial, then have a discussion about what platforms and providers to use, and how to safely protect that information to confirm to the relevant requirements. If there's consensus about that, then we can figure out what the best software stacks are to use. This PR is jumping *far* ahead of a reasonable process."
833996897,835,IGBC,2021-05-07T01:43:39Z,"> If we, as a community, created and got approved merge requests that intentionally conflict with this branch it could slow this down.

Git is not a weapon. Behavior like this would be counter productive and damaging to the software as a whole.


"
833997086,835,Be-ing,2021-05-07T01:44:13Z,"@ThisIsPaulDaily, this pull request is definitely bad, but antagonizing the Audacity developers who have put *years* of hard work into this software is unhelpful and ungrateful."
833997191,835,AndreiSva,2021-05-07T01:44:32Z,@Be-ing agreed
833998003,835,Zellfaze,2021-05-07T01:46:59Z,"> I don't think we need a fork if this is behind a compile option that defaults to off.

I think we do. If this is merged I don't know that I can trust the Audacity team anymore. And I don't think anyone else should either. The privacy of their users and the backlash that this is getting should be strongly considered.

If this is merged I will no longer be using Audacity. I will no longer be installing it on my own machines or the machines of any company whose infra I manage, now and in the future.

We have enough stuff that is watching us and listening to us already. I don't need my audio editor added to the list.

Privacy is a human right. Involving Google or Yandex in the use of a piece of software like this is completely uncalled for.

I was legitimately excited when I heard Muse Group was getting involved in Audacity. I see my excitement was misplaced."
833998386,835,Be-ing,2021-05-07T01:48:00Z,"> This PR is jumping far ahead of a reasonable process.

I strongly recommend all Audacity developers read this [blog post](https://aturon.github.io/tech/2018/05/25/listening-part-1/) about the Rust project's experience with an inside group trying to push through a controversial change, the lessons learned, and the changes in process and culture that resulted from that. The whole 3 part series of blog posts is fantastic. "
833998723,835,AndreiSva,2021-05-07T01:48:58Z,"



> If there was a way to force this branch to always conflict, so that it could never successfully merge, that would be cool.
> 
> Others have pointed to GDPR, Privacy Policies, statements made previously about third parties, and whatnot. I'm here, looking at a merge that passes checks and is two affirmative reviews away from a hard fork away from here.
> 
> If we, as a community, created and got approved merge requests that intentionally conflict with this branch it could slow this down.
> 
> I say this as someone who has yet to contribute to the Audacity project.
> 
> How dare you have the audacity to put analytics into FOSS!?

This is the exact mindset that lead to the actix web incident."
834000581,835,IGBC,2021-05-07T01:54:28Z,"> This is the exact mindset that lead to the actix web incident.

Sounds to me like the outcome of that was the project rid themselves of a Toxic individual.
"
834002259,835,Qix-,2021-05-07T01:59:04Z,"No problem. If this is merged, a fork will emerge that will most likely take over. I certainly won't be using upstream Audacity if it does.

Why on earth anyone thought this was a good idea is astounding. Tantacrul, if you're here, this is highly suspicious. I sincerely hope this has nothing to do with MuseScore.

---

# EDIT: Another PR that is adding Google dependencies, potentially telemetry: #836"
834005951,835,gohanko,2021-05-07T02:09:18Z,"> 
> 
> Is the author aware of submodules? Why are those dependencies directly included?

Noob question, why is directly including the dependencies bad? "
834005956,835,Zuyoutoki,2021-05-07T02:09:19Z,"As stated by many before me, **please** don't add telemetry to Audacity. Doesn't matter if it is opt-in or if it helps to improve user experience. When a user had an issue in the past, they posted to forums and got help that way. That's how it can still continue to work. Analytics are __not__ needed, especially due to the decentralized aspect of free software. Who will collect theses logs? This is absurd. This is an audio software, not a data collection solution.

I think this PR (or any that involves telemetry) should not be merged. I believe this goes against the essence of free software. I will be using a telemetry-free fork and encouraging people to do the same if the project decides to go down that path."
834006290,835,AndreiSva,2021-05-07T02:10:14Z,"> that will most likely take over

@Qix- except it won't. Visual studio code is a great example that bundling telemetry in a FOSS project can be done. Adding telemetry in audacity, even opt out, will inevitably affect the privacy of the majority of people. The ones who won't bother to switch to one of the forks."
834006924,835,nhhollander,2021-05-07T02:11:58Z,"> Noob question, why is directly including the dependencies bad?

A module which is included directly won't get updates or security patches, requiring developers to manually upgrade. This increases the risk that a fix for a security vulnerability or important bugfix doesn't get into the program quickly."
834007724,835,IGBC,2021-05-07T02:14:04Z,"> > Is the author aware of submodules? Why are those dependencies directly included?
> 
> Noob question, why is directly including the dependencies bad?

It puts the responsibility to update and maintain the dependency on the maintainer, it also provides an opportunity for the dependency to diverge from its upstream which has license and maintainability concerns. the UNIX philosophy would be to dynamically link against the library, allowing the OS to manage updates and provide bugfixes when available, but that its its own can of worms. Using a sub module is an in between."
834008784,835,acikek,2021-05-07T02:16:58Z,"Whether this PR is merged or not, it's a good thing that this issue came to the community's attention. I don't really pay much attention to the developer side of most of the products I use, and I doubt vast majority of people on the consumers' end do either. Good on you guys!
"
834010117,835,sirocyl,2021-05-07T02:20:39Z,"> > Is the author aware of submodules? Why are those dependencies directly included?
> 
> Noob question, why is directly including the dependencies bad?

Not a noob question imo, and a very good one, too. <3 People don't ask questions about large codebase management often enough, at all. :)

There's pros and cons to including the dependencies, versus alternatives like, getting tarballs in the buildscripts, or git submodules.

**Include all libraries in-tree, and maintain them ourselves.** (Audacity does this.)
- **Pro:** By homing the dependencies and libraries, you can quickly integrate your own changes to the libraries you need as you need them, without waiting for upstream developers and maintainers to review and merge them.
- **Con:** However, including dependencies can cause bit rot and API erosion, where new versions of the library are introduced that are incompatible with the included version, and contain important or valuable changes (such as security fixes or performance improvements),

**Separately download and patch a specific version of upstream libraries, at build-time, through build automation.**
- **Pro:** Having the build scripts pull in the libraries and patching them locally is a good compromise between self-maintainership, flexibility and autonomy, while better enabling out-of-tree development to continue, and for the upstream changes to be included in the current source as needed, efficiently. Many GNU-type tools do this.
- **Con:** Getting the libraries separately as a tarball can introduce bit rot when remote maintainers (like, say, the GNU project or a sourceforge page) change URL formats, remove old versions, or otherwise go dark.

**Use Git submodules to fragment dependencies out-of-tree, and handle patches through change-request branches.**
- **Pro:** Including the dependencies as submodules works best for a Git-based workflow, and is automatic, Further, this exposes changes that Audacity would seek to include in a future version of a dependency, to maintainers who may wish to import and merge the changes. And, if they choose not to, the branch you made will remain available for your own use, regardless.
- **Con:** Well, this can be quite a headache to maintain, especially to someone not strongly familiar with Git and Github and the like, and this method does not easily carry over into a tarball format (unless the .git tree, or at least the submodules/gitconfigs, are included alongside.)

I view the first issue as the most problematic, far outweighing its pros, and would recommend against including the libraries in-tree for that reason alone.

Personally, I'd do a mix of the above:
- Host our own version of dependencies, libraries and such, under the Audacity github organization or its canon git server.
- Have the build scripts download and patch the library dependencies, using Git as needed, if they're not found (e.g., by way of tarball); 
- Use submodules, pointing to the included versions hosted by Audacity, which are forks of upstream libraries at specific versions;
- and, finally, provide tarballs including a flat (`--depth=1`) git tree, plus making `git bundle` format sourceballs available alongside the tarballs, as Git may compress the code better than a flat code tree in gzip."
834011310,835,Be-ing,2021-05-07T02:23:53Z,"> I view the first issue as the most problematic, and would recommend against including the libraries in-tree for that reason alone.

Audacity's vendoring of PortAudio has already caused hassle for Fedora packaging (#840), which ends up affecting developers of other applications (Mixxx) that use PortAudio because it is up to us to do the work to keep Audacity working with the distribution package and include the updates our applications need (to be fair, the PortAudio maintainers were not very responsive in the past few years which has gotten better in the past few months)."
834012936,835,IGBC,2021-05-07T02:27:48Z,while we're on the topic of problematically bundling dependencies why on earth does Audacity have an SQLite <s>server</s> **Database** in it in the first place?
834013153,835,AndreiSva,2021-05-07T02:28:22Z,"> while we're on the topic of problematically bundling dependencies why on earth does Audacity have an SQLite server in it in the first place?

IIRC SQLite doesn't require a server"
834014031,835,jxu,2021-05-07T02:30:51Z,"> while we're on the topic of problematically bundling dependencies why on earth does Audacity have an SQLite server **Database** in it in the first place?

I don't use databases much but sqlite is useful for small single user databases for standalone applications 

from their own page https://sqlite.org/whentouse.html"
834016199,835,IGBC,2021-05-07T02:36:36Z,"> while we're on the topic of problematically bundling dependencies why on earth does Audacity have an SQLite server **Database** in it in the first place?

I have answered my own question, aup3 files are actually SQLite databases. Seems like a strange design decision but this PR is not the place to argue about such things."
834017256,835,sirocyl,2021-05-07T02:39:39Z,"> I have answered my own question, aup3 files are actually SQLite databases. Seems like a strange design decision but this PR is not the place to argue about such things.

that's interesting, but it makes sense - a lot of embedded, serialized data types use sqlite for such things - like, video game save files, working projects in some video editors, configurations for some IDEs and text editors, and things like Mozilla Firefox for storing a combination of user settings, history, bookmarks and such in a nicely bundled, easily-queried and reproducible tabular form."
834021100,835,1ctinus,2021-05-07T02:50:32Z,"is there an official statement about telemetry and this pull request? Trying to be respectful to all parties, but this does not seem like it is helping the user and/or the maintainers at the moment. Does this coincide with the recent acquisition?  "
834021610,835,johannesrld,2021-05-07T02:52:07Z,"While adding some form of telemetry is useful, I would absolutely recommend against using google analytics, there are plenty of good alternatives that don't require you pinging google every time you use audacity"
834029318,835,rghvdberg,2021-05-07T03:08:35Z,Just no. 
834029854,835,BurnyBoi,2021-05-07T03:10:07Z,No. Remove entirely. Shouldn't even be opt-in. 100% using a fork without this from now on if this malware is merged.
834029931,835,Hielyr,2021-05-07T03:10:24Z,"I'm ok with telemetry. I'm _not_ ok with Google telemetry. I'll immediately stop using Audacity if you put this in and I'll warn all of my colleagues to do the same. 

I understand the need for telemetry and analytics, but I cannot and will not condone Google analytics in any open source software I use. "
834030137,835,Zellfaze,2021-05-07T03:11:00Z,"There is no public statement that I am aware of yet, but I imagine there
will be one tomorrow, or if not, in the next few days. I can't imagine them
not making one with the amount of pushback the PR has received.

On Thu, May 6, 2021, 22:50 Ict ***@***.***> wrote:

> is there an official statement about telemetry and this pull request?
> Trying to be respectful to all parties, but this does not seem like it is
> helping the user and/or the maintainers at the moment. Does this coincide
> with the recent acquisition?
>
> —
> You are receiving this because you commented.
> Reply to this email directly, view it on GitHub
> <https://github.com/audacity/audacity/pull/835#issuecomment-834021100>,
> or unsubscribe
> <https://github.com/notifications/unsubscribe-auth/ATJASMGGMEHKXQE6KUYLEQLTMNIQXANCNFSM44C5SLTA>
> .
>
"
834034363,835,a-wip0,2021-05-07T03:22:39Z,the first red flag has arrived
834035359,835,AndreiSva,2021-05-07T03:25:20Z,@a-wip0 it's only the beginning
834037351,835,SndChaser,2021-05-07T03:31:23Z,"I have been reading through this PR, and all of the comments, and agree that the idea of adding telemetry using the Google API's is extremely problematic.  There really does need to be a lot of conversation around this PR considering all of the issues that have been brought up, including (but not limited to):

- The apparent lack of following the normal process for this PR.
- The apparent lack of consideration of how this change needs to be implemented for different localities, such as the EU's GDPR, California's CCPA regulations, and other regions regulation, etc.
- Questions surrounding Google API's being used for gathering this information.
- Serious issues with privacy questions.
- Questions about the custody of this information: ie, who is going to gather and use this information?  And to what end is this information going to be used?
- Are there other options that can be implemented that will enable the same functionality without impeding on the privacy of users?

The problem with this PR is now that it is out there is a stain of mistrust on the Audacity project... Something that I would never have thought I would be saying about one of the most revered Open Source projects of all time.  (Seriously, I can't think of many projects that have had the enduring admiration of such a large audience.)

IMO - if there is not a public statement about this PR made tomorrow, I would suggest that someone participating in these comments start a **respectful** conversation on the forum, as this PR's proposals need to be discussed with the much larger user base of Audacity."
834038939,835,Be-ing,2021-05-07T03:36:12Z,"I tried to find discussion about this in the forum and could not.

If you want to know more about how to improve Audacity for users, I recommend switching to modern and more usable infrastructure, in particular migrating your old phpBB forum to Discourse. This will make it nicer for users to tell you what they want."
834039616,835,GiovanH,2021-05-07T03:38:20Z,"> I tried to find discussion about this in the forum and could not.
> 
> If you want to know more about how to improve Audacity for users, I recommend switching to modern and more usable infrastructure, in particular migrating your old phpBB forum to Discourse. This will make it nicer for users to tell you what they want.

The forum is an interesting idea, but really any GitHub PR should be strongly linked to one (or more) GitHub issues"
834043338,835,SndChaser,2021-05-07T03:50:29Z,"> I tried to find discussion about this in the forum and could not.

So did I, and for some reason I cannot create a new conversation, which is why I suggested that someone should start one.

 
> If you want to know more about how to improve Audacity for users, I recommend switching to modern and more usable infrastructure, in particular migrating your old phpBB forum to Discourse. This will make it nicer for users to tell you what they want.

Personally, I'm not a fan of Discourse, and a forum with over 150,000 members, and hundreds of users online at a time migrating to a new forum is likely something that would (a) take considerable effort, and (b) be just as divisive as this PR. :)"
834043447,835,KevinVerre,2021-05-07T03:50:52Z,"I strongly recommend never putting any telemetry code into Audacity. Audacity is an open source music app for editing sound and music. You don't need numerical data and metrics and analytics to improve the app. It's not the end of the world if someone encounters an error and the developers aren't aware of it right away. What good could possibly come out of it? None. What bad could come out of it? Lots privacy issues and bugs.

From the PR:

>Session start and end
>Errors, including errors from the sqlite3 engine, as we need to debug corruption issues reported on the Audacity forum
>Usage of effects, sound generators, analysis tools, so we can prioritize future improvements.
>Usage of file formats for import and export
>OS and Audacity versions

You can fix bugs as you encounter them. Or as people report them and you are able to reproduce them. If you want, you can make logs and have people to upload those log files manually. You don't need to know which file formats are popular, you can just ask people to open Issues if they want a file format supported. You don't need to know which effects are popular. Prioritize improvements based on your own experiences with the app and encourage people to give written feedback. Why does it matter which OS version or Audacity version people are using? That information should be private. If for some reason you really care you can create a poll."
834043801,835,yonderbread,2021-05-07T03:52:07Z,"Excuse me, but what the fuck do you think you're doing to our baby?!"
834044525,835,dofrancis,2021-05-07T03:54:30Z,based!
834045016,835,yonderbread,2021-05-07T03:56:05Z,"This is completely unnecessary, nobody except the users who run the program should know anything about the host machine or what the user did with the program. Audacity is one of the last FOSS programs out there without Telemetry in it, there is no reason to add any to it. It's a fucking AUDIO EDITOR for Christs sake!"
834045448,835,jxu,2021-05-07T03:57:33Z,"> If you want to know more about how to improve Audacity for users, I recommend switching to modern and more usable infrastructure, in particular migrating your old phpBB forum to Discourse. This will make it nicer for users to tell you what they want.

What benefit is derived from moving from one forum to another?"
834046893,835,Be-ing,2021-05-07T04:02:24Z,"> What benefit is derived from moving from one forum to another?

Moving to infrastructure that is easier to use makes it easier for users to give feedback, which helps developers know what is important to users, much moreso than questionably useful incomplete statistics."
834047250,835,Zellfaze,2021-05-07T04:03:39Z,"Regarding the software used on the forum. Respectfully, I do not believe
this PR is the right avenue to discuss this. We should keep this discussion
on topic. Post here should be directly related to this PR. We have plenty
enough to discuss in the PR already.

On Thu, May 6, 2021, 23:57 jxu ***@***.***> wrote:

> If you want to know more about how to improve Audacity for users, I
> recommend switching to modern and more usable infrastructure, in particular
> migrating your old phpBB forum to Discourse. This will make it nicer for
> users to tell you what they want.
>
> What benefit is derived from moving from one forum to another?
>
> —
> You are receiving this because you commented.
> Reply to this email directly, view it on GitHub
> <https://github.com/audacity/audacity/pull/835#issuecomment-834045448>,
> or unsubscribe
> <https://github.com/notifications/unsubscribe-auth/ATJASMAIACKKJQBSTD2HCB3TMNQMBANCNFSM44C5SLTA>
> .
>
"
834047308,835,jxu,2021-05-07T04:03:49Z,"> > What benefit is derived from moving from one forum to another?
> 
> Moving to infrastructure that is easier to use makes it easier for users to give feedback.

There is nothing difficult about using a phpbb forum.

(Personally I find Discourse to be horribly ugly and difficult to navigate, compared to traditional forums. You may think the opposite, but the change from a well established forum won't go over easily.)"
834047419,835,SndChaser,2021-05-07T04:04:12Z,"> > What benefit is derived from moving from one forum to another?
> 
> Moving to infrastructure that is easier to use makes it easier for users to give feedback.

Easier to use for who?  Discourse is an annoyance (at best) to me, and I think it would be a pain to many of the 150,000+ users that are used to phpBB already.  IMO."
834047464,835,Be-ing,2021-05-07T04:04:20Z,"Okay, enough about the forum software. Let's not drag this further off topic."
834049281,835,JacobCallahan,2021-05-07T04:09:36Z,NACK
834049591,835,ChaseCares,2021-05-07T04:10:22Z,"I don't want to pile on in regards to analytics or the implementation here, so far as to say that I disagree with it and I largely agree with the community sentiment in the above posts.

I would like to point out that home assistant which is a very large and active community recently implemented some analytics. They had really good discussions and a significant amount of communication with the community about what they were going to collect and how they were going to use it, with specific tangible benefits and examples. I think a lot can be learned about the process that they went through and how they implemented this feature. While their implementation collects different information and is not directly equivalent to what is being implement it here, I think that how they went about implementing it and how they interacted with the community was excellent and is a good case study for how such things could by implemented in the future.

https://www.home-assistant.io/integrations/analytics"
834050507,835,StarWitch,2021-05-07T04:13:12Z,"Emphatic -1. Google is a scourge on the internet. There is absolutely no way this analytics data will not be cross-referenced inside their insidious black box of multi-billion-dollar ad tracking, just another finger prying into people's online lives. I, like many others, will simply use a ""Google-free"" fork of this software and encourage everyone else to do so, even if there are no other changes to Audacity other than a bunch of red minus symbols cutting the entire Google stack out wholesale.

Don't take this as an invitation to more tightly integrate the software with Google, such as requiring their SSO or an email login to get access to ""enhanced features"" or whatever, either."
834050545,835,jxu,2021-05-07T04:13:20Z,Waiting for a statement by Tantacrul who is quite active on social media (does he have a github account?)
834050798,835,micahlt,2021-05-07T04:14:08Z,"### For those that are saying telemetry should not **ever** be implemented: 
Yeah, sorry, but as the new maintainers are trying to improve the UI and UX (which I strongly support and am looking forward to as Audacity is still stuck with a really old-looking GUI and skinning is still horrible), analytics _can_ be helpful.  However, though I myself have no problems with Google Analytics, I have many friends that do.  It's not a matter of whether we can or should implement Google Analytics in Audacity - it's the fact that as one of the oldest/best FOSS projects the brand-new maintainers should not immediately begin making such controversial decisions without approval of the userbase.  

I'd once again draw the maintainer's attention to @meduzen's comment where they provide many decentralized and/or FOSS analytics platforms as alternatives: https://github.com/audacity/audacity/pull/835#issuecomment-833852063  There's little reason to use Google Analytics over these other options for the type of data the Audacity team _should_ be collecting in order to improve this project.  

I'd remind us all to stay positive and remember that as a community we don't get anywhere from division and anger.  The Muse Group has done an excellent job with MuseScore, so let's continue to support their efforts to improve Audacity and simply provide _constructive_ feedback.  Cheers!"
834051729,835,mikae1,2021-05-07T04:17:27Z,"As a mere user, I'd be fine with user tracking _only_ if:
- It was opt-in.
- It did not use Google Analytics, but rather an open-source analytics suite hosted by Audacity developers.
- The developers did not share this data with a third party.

EDIT: I'd even opt-in if it would provides developers with data useful for UX improvements. Considering Google Analytics is controversial in FOSS, I feel this early move by new management is somewhat worrying."
834051878,835,Zellfaze,2021-05-07T04:17:55Z,"@jxu I messaged him on Patreon about this PR. If he isn't aware of it yet,
he likely will be by the morning.

On Fri, May 7, 2021, 00:13 jxu ***@***.***> wrote:

> Waiting for a statement by Tantacrul who is quite active on social media
> (does he have a github account?)
>
> —
> You are receiving this because you commented.
> Reply to this email directly, view it on GitHub
> <https://github.com/audacity/audacity/pull/835#issuecomment-834050545>,
> or unsubscribe
> <https://github.com/notifications/unsubscribe-auth/ATJASMECR72FLVSQQ5A4XXTTMNSHJANCNFSM44C5SLTA>
> .
>
"
834053139,835,jxu,2021-05-07T04:21:48Z,">  messaged him on Patreon about this PR. If he isn't aware of it yet, he likely will be by the morning.

Oh right, he has a Patreon. It is for his videos, but given he made a popular video on being the head of audacity (how I found about him), it's safe to say it's relevant.

"
834053829,835,SndChaser,2021-05-07T04:23:47Z,"> @jxu I messaged him on Patreon about this PR. If he isn't aware of it yet, he likely will be by the morning.

I've found is Github account, but it doesn't look like he doesn't do much work on here, one commit to musescore and one PR review in musescore.

IMO - I'm guessing he isn't aware of this PR as he isn't on the approval chain.  It appears the author of this PR, and the approvers are likely associated with Ultimate Guitar, the company that acquired both MuseScore and Audacity.

This PR is likely not in his area of responsibility.  However, I have the feeling he would likely want to be aware of it since he has made himself and his associations with these projects very publicly visible."
834054832,835,micahlt,2021-05-07T04:26:53Z,"> Ultimate Guitar, the company that acquired both MuseScore and Audacity

@SndChaser Just a quick correction, they're known as the Muse Group ([mu.se](https://mu.se)) 😄"
834056694,835,SndChaser,2021-05-07T04:32:42Z,"> > Ultimate Guitar, the company that acquired both MuseScore and Audacity
> 
> @SndChaser Just a quick correction, they're known as the Muse Group ([mu.se](https://mu.se)) smile

Thanks for the correction...  I picked up the UG name from Reddit, I should have double checked it before repeating it publicly.  (Although, at least UG is one of their applications...)"
834063410,835,yzziizzy,2021-05-07T04:50:48Z,"Absolute insanity. Google spying in an audio editor? Are you out of your mind, or are you just bought and paid for by some three-letter government agency?

You do realize that it will be forked and all the spying removed, right? Even if this is merged, all you will accomplish is taking all your goodwill in the open source community and lighting it on fire."
834065295,835,yonderbread,2021-05-07T04:53:46Z,"> Yeah, sorry, but as the new maintainers are trying to improve the UI and UX (which I strongly support and am looking forward to as Audacity is still stuck with a really old-looking GUI and skinning is still horrible), analytics _can_ be helpful. 

Okay but how do the following things help with UI/UX at all? Shouldn't we be getting feedback directly from the users instead of an automated system?

- Session start and end
- Errors, including errors from the sqlite3 engine, as we need to debug corruption issues reported on the Audacity forum
- Usage of effects, sound generators, analysis tools, so we can prioritize future improvements.
- Usage of file formats for import and export
- OS and Audacity versions

EDIT: Instead of having telemetry, why don't we make it easier for users to find places to submit issues and feedback in the program?
"
834066758,835,jxu,2021-05-07T04:57:32Z,audacity team does not need info on how many fart.wav sound effects I export
834066969,835,yonderbread,2021-05-07T04:58:02Z,"> 
> 
> audacity team does not need info on how many fart.wav sound effects I export

Exactly lmao"
834067353,835,yonderbread,2021-05-07T04:59:11Z,"I've created a fork of audacity that I'll be trying to maintain, if any of you would like to help out in any way, I'll be setting up Github Discussions for it shortly.

https://github.com/yonderbread/foss_audacity"
834067514,835,Aslai,2021-05-07T04:59:39Z,"I will sincerely hope for the failure of the audacity project and cheer for any clean fork if Audacity gains the capability to send any of my data to a third party data aggregator such as Google or Yandex, no matter how ""trivial"" that data is."
834068454,835,jxu,2021-05-07T05:01:24Z,"> I've created a fork of audacity that I'll be trying to maintain, if any of you would like to help out in any way, I'll be setting up Github Discussions for it shortly.
> 
> https://github.com/yonderbread/foss_audacity

I think it's a little premature and why should the community trust you as a maintainer? "
834068753,835,yonderbread,2021-05-07T05:02:07Z,"> 
> 
> I will sincerely hope for the failure of the audacity project and cheer for any clean fork if Audacity gains the capability to send any of my data to a third party data aggregator such as Google or Yandex, no matter how ""trivial"" that data is.

At this point I don't even know if I can trust the Linux kernel."
834068997,835,yzziizzy,2021-05-07T05:02:50Z,"> > I've created a fork of audacity that I'll be trying to maintain, if any of you would like to help out in any way, I'll be setting up Github Discussions for it shortly.
> > https://github.com/yonderbread/foss_audacity
> 
> I think it's a little premature and why should the community trust you as a maintainer?

Simple. Follow upstream exactly except for the telemetry. Should be easy to see in git."
834069296,835,smartroad,2021-05-07T05:03:39Z,"I don't have the knowledge but is there anyone out there who can copy the code base and start a new, really open source, spy and adware free (because you know the next thing will be ads) version of this and then drop this version?"
834069416,835,yonderbread,2021-05-07T05:04:00Z,"> 
> 
> > I've created a fork of audacity that I'll be trying to maintain, if any of you would like to help out in any way, I'll be setting up Github Discussions for it shortly.
> > https://github.com/yonderbread/foss_audacity
> 
> I think it's a little premature and why should the community trust you as a maintainer?

Well they have no reason to trust me as of now, but I'm going to make sure all contributions to my fork are composed of 100% free and open source code. You shouldn't trust anyone, just use good judgement."
834069735,835,AndreiSva,2021-05-07T05:04:54Z,"> At this point I don't even know if I can trust the Linux kernel.

@yonderbread Linux kernel is pretty trustworthy."
834070087,835,yonderbread,2021-05-07T05:05:54Z,"> 
> 
> > At this point I don't even know if I can trust the Linux kernel.
> 
> @yonderbread Linux kernel is pretty trustworthy.

So was audacity."
834070300,835,krisnova,2021-05-07T05:06:29Z,the audacity of this pull request - the 12 year old versions of ourselves would be kicking all of our asses right now if they knew this was going on
834070346,835,jxu,2021-05-07T05:06:37Z,"> > > I've created a fork of audacity that I'll be trying to maintain, if any of you would like to help out in any way, I'll be setting up Github Discussions for it shortly.
> > > https://github.com/yonderbread/foss_audacity
> > 
> > 
> > I think it's a little premature and why should the community trust you as a maintainer?
> 
> Well they have no reason to trust me as of now, but I'm going to make sure all contributions to my fork are composed of 100% free and open source code. You shouldn't trust anyone, just use good judgement.

A maintainer does a lot more than contribute code. He/she has to make tough decisions about what changes are made."
834070446,835,Pokechu22,2021-05-07T05:06:56Z,"IMO it _is_ useful to know how often each function or file format is used, but it's much more sensitive than OS version numbers.  The only way that would be reasonable is if each type of information were individual opt-ins where the user explicitly says that they're OK with sending each kind of data.  And I didn't even know Google Analytics was a thing for non-web apps; I agree with everyone here that involving Google as a third party is a terrible idea.

Feedback from users is helpful, but it doesn't let you know what people _don't_ use, only what they _do_ use and have issues with.

And just to be explicit, **this change has not been merged yet**."
834071300,835,sigseg5,2021-05-07T05:09:13Z,"Anonymous telemetry is really good idea, this may help devs to improve software. Now you want to use surveillance software like Yandex and Google Metrics, that's definitely bad idea due to privacy reasons. I hope that this PR wouldn't be merged at the current state. If Audacity really needs some telemetry we should create _privacy and free_ friendly solution"
834071965,835,yonderbread,2021-05-07T05:11:12Z,"> 
> 
> > > > I've created a fork of audacity that I'll be trying to maintain, if any of you would like to help out in any way, I'll be setting up Github Discussions for it shortly.
> > > > https://github.com/yonderbread/foss_audacity
> > > 
> > > 
> > > I think it's a little premature and why should the community trust you as a maintainer?
> > 
> > 
> > Well they have no reason to trust me as of now, but I'm going to make sure all contributions to my fork are composed of 100% free and open source code. You shouldn't trust anyone, just use good judgement.
> 
> A maintainer does a lot more than contribute code. He/she has to make tough decisions about what changes are made.

I guess I'll have to learn along the way!"
834072533,835,Electro707,2021-05-07T05:12:42Z,"In my opinion something similar to the way KDE does telemetry is a good way of doing it: [https://community.kde.org/Policies/Telemetry_Policy](https://community.kde.org/Policies/Telemetry_Policy)

If something similar gets implemented by Audacity, that will be fine. But Google Analytics, no thank you,"
834072628,835,jxu,2021-05-07T05:12:55Z,"If you must have telemetry, why can't it be a transparent JSON file emailed to the maintainers? Is that ridiculous?"
834073116,835,miou-gh,2021-05-07T05:14:16Z,"The audacity of adding telemetry to Audacity...

If the premise is to 'prioritize future improvements' then by nature of being opt-in, wouldn't there be an extremely small sample size relative to the entire userbase? I especially doubt many people would willingly opt-in knowing that the information is being collected by Google Analytics, let alone Yandex whose headquarters is in Moscow, Russia."
834073691,835,misyltoad,2021-05-07T05:15:54Z,No.
834075332,835,jpike88,2021-05-07T05:20:34Z,"I use audacity a lot and welcome all improvements. Telemetry is an extremely useful tool for helping release the full potential of software... because relying on users to report issues alone is simply not enough. It's clunky, prone to misinformation/misinterpretation, and just not giving the full picture.

I agree with all points regarding using your own FOSS hosted analytics platform, making it opt-in and ensuring privacy policy is succinct, correct and requiring explicit consent, handling GDPR considerations etc. If it's a FOSS project, it should be sensitive towards issues like privacy and the legality of collecting and storing certain data.

What I don't agree with is hyperbole and the freaking out some people are doing because of the mere idea of telemetry. That makes no sense at all."
834077198,835,Be-ing,2021-05-07T05:25:33Z,"> In my opinion something similar to the way KDE does telemetry is a good way of doing it: https://community.kde.org/Policies/Telemetry_Policy

This is great. Kudos to the KDE community for working to put together these sensible guidelines in clear, concise language. That page is licensed under the Creative Commons Attribution-Share Alike License, so I recommend that Audacity start by copying that verbatim and perhaps make some small adjustments for Audacity's use case."
834077665,835,yonderbread,2021-05-07T05:26:47Z,"> > In my opinion something similar to the way KDE does telemetry is a good way of doing it: https://community.kde.org/Policies/Telemetry_Policy
> 
> This is great. Kudos to the KDE community for working to put together these sensible guidelines in clear, concise language. That page is licensed under the Creative Commons Attribution-Share Alike License, so I recommend that Audacity start by copying that verbatim and perhaps make some small adjustments for Audacity's use case.

If you have to change the rules later, you might as well not have rules at all."
834082422,835,Evrey,2021-05-07T05:40:09Z,"Disabled by default, a user must manually and without nagging explicitly opt-in to telemetry themselves. This is what GDPR demands, this is what i expect."
834083594,835,kisaragi-hiu,2021-05-07T05:43:29Z,"Telemetry burns the community as you should be able to see in this PR. User testing is more expensive than telemetry on its own, but contributors *will* leave over this. It isn't worth it. Please stop before you kill the project."
834084755,835,Evrey,2021-05-07T05:46:38Z,"@kisaragi-hiu Realistically speaking, telemetry does not kill a project. Win10 is still the most-installed OS, GitLab still exists, and so will Audacity continue. However, the user base will shrink. Plus there's also the issue of how useful telemetry *really* is, 'cause there's an endless well of biases to consider when trying to use telemetry for anything more than automated sending of crash reports."
834086529,835,Maykeye,2021-05-07T05:51:13Z,"> Universal Google Analytics is used to track the following events:

This list seems somewhat misleading.

Every single [wxDialogWrapper title](https://github.com/audacity/audacity/pull/835/files#diff-4bfd3b3b53026d49a2072771cab4e8afd22b54de76baf68e3cb222adec2e191aR84) is being recorded. It doesn't matter if  there was an error or not. 

Seems it's only a matter of time before filenames(linked with IP) will be leaked through the titles. "
834087149,835,bscout9956,2021-05-07T05:52:51Z,Google Analytics? Seriously? 
834087151,835,yzziizzy,2021-05-07T05:52:51Z,"> @kisaragi-hiu Realistically speaking, telemetry does not kill a project. Win10 is still the most-installed OS, GitLab still exists, and so will Audacity continue. However, the user base will shrink. Plus there's also the issue of how useful telemetry _really_ is, 'cause there's an endless well of biases to consider when trying to use telemetry for anything more than automated sending of crash reports.

Win10 is not FOSS and cannot be forked sans telemetry. Audacity is and can. "
834087518,835,kittenswolf,2021-05-07T05:53:50Z,"Audacity survived without having trackers for more than 20 years.

Why is this needed all of the sudden?"
834087605,835,XakepSDK,2021-05-07T05:54:06Z,"I rarely use Audacity. I think telemetry is a good thing to improve software.
But please, use open source platform to collect telemetry, if you will use proprietary platform, it has high chance to be removed from distros like Debian because of 3rd party non-free dependency.
So my wishes are:
1. Use open source telemetry platform
2. Dynamic linking, so it's easier to package audacity for distro developers
3. Ask on first launch if user wants to share telemetry"
834088486,835,serebit,2021-05-07T05:56:20Z,"Just passing by to say that yes, this is a horrible idea. Don't integrate *Google Analytics*, of all things, into a FOSS desktop audio program. Please. Opt-*in* anonymous well-defined self-hosted analytics? I'm personally okay with that, but it still toes the line for a lot of people. I don't see the value-add here beyond error reporting, but even then, you could just implement a system where if an error happens it can be optionally reported by itself, like what JetBrains does in their IDEs. Just seems silly to me."
834088881,835,csivanich,2021-05-07T05:57:23Z,"> In my opinion something similar to the way KDE does telemetry is a good way of doing it: https://community.kde.org/Policies/Telemetry_Policy
> 
> If something similar gets implemented by Audacity, that will be fine. But Google Analytics, no thank you,

VLC's implementation of first-run opt-in for something as basic as _network access for thumbnail lookup_ is something I think Audacity could model after for anonymous usage/failure data."
834089404,835,Nexuist,2021-05-07T05:58:45Z,I'm so confused. Why use off the shelf analytics software for this? You can run your own endpoint to collect events with like....one PHP file. And that could be open source too so we see exactly how you collect analytics data and decide for ourselves whether we want to opt in or not. Why soil your non-controversial brand with associations to controversial ones? All of this just to avoid setting up a backend service that inserts rows into a table?
834091160,835,sam-ka,2021-05-07T06:01:00Z,Please 1) make telemetry opt-in and 2) provide an easy way for users to see what technical information is collected *directly from within Audacity*.
834091513,835,Be-ing,2021-05-07T06:01:52Z,"> This list seems somewhat misleading.
Every single wxDialogWrapper title is being recorded. It doesn't matter if there was an error or not.
Seems it's only a matter of time before filenames(linked with IP) will be leaked through the titles.

Thank you for this astute code review. @Maykeye I hope you keep an eye on whatever proposed code changes follow this."
834091542,835,yonderbread,2021-05-07T06:01:55Z,"Just the fact that it collects your IP address and assigns a UUID to your machine ALONE is worrying..
(Yes, I'm aware Github probably does the same thing, but at least it isn't something that's directly installed on my PC and I can *easily* do something to anonymize myself from it)"
834091568,835,Evrey,2021-05-07T06:01:59Z,"> Google Analytics? Seriously?

This one *really* concerns me as well, not to say disgusts me. Not only is there an addition of telemetry, of which i do not see potential merits outweighing all concerns to be had, but that data is shoved right through fucking Google. The one entity with enough data to deanonymise anything they want to, given time and will.

I have not ever observed telemetry resulting in an improvement of usability of software. It always ended up just collecting biased data. You can't tell the difference between e.g. a person not being interested in a feature or just not being able to fucking find it or a person not seeing it due to accessibility issues. Yes, all damn software jumps onto that false prophet. And once it does, there's is zero guarantee that said software may not one day add none-of-your-business data to the mix, be it on purpose or by accident. (See the file name concern raised above.)

Looks like i should more seriously start reinstalling all my software except the browser in sandboxed environments without any network connections."
834093680,835,Evrey,2021-05-07T06:05:39Z,@yonderbread Precisely. There is *no such thing* as truly anonymised data. It's only obfuscated at best. Throw enough effort at it and everything's an open book. And all that for little benefit to the end user.
834095687,835,ultrabear,2021-05-07T06:10:16Z,Yikes
834095931,835,rahmanlar,2021-05-07T06:10:50Z,No.
834096200,835,sirocyl,2021-05-07T06:11:29Z,"I feel like all the points have been driven in - for telemetry, against all telemetry, against _these_ telemetry services; jokes about ""the audacity of"" Audacity; how badly it will kill the project/the team/my ego/my ex's pet slime mold; rallying calls to pitch forks and spoons - all that remains now is to wait on a decision to be made, and set down the pitchforks for the time being.

After all, we're just a small sample of the audience. Many people use Audacity and may remain blissfully unaware of an issue like this, until people notice it being a problem. It would be rather difficult to rally the momentum behind millions of Audacity users to a random fork over a single issue like this.

It is best that we address it _in this project_ primarily, and avoid dragging users through miles of heartbreak over ""which audacity"" to use.

Also worth noting: Audacity ®️ is a registered trademark in the US and other jurisdictions. While I'm not a lawyer, and this is not legal advice: forks really must not carry the name ""Audacity"" on them without permission from its rights-owner - and, in my opinion, even for other reasons aside from the legal."
834097973,835,midn1,2021-05-07T06:15:44Z,"A shitty company will make shitty software, that's no surprise."
834099287,835,Zardoz89,2021-05-07T06:18:41Z,"A summary of the general feeling would be : 

1) Basic telemetry isn't a bad idea but...
2) Opt-in and by default disabled. Ask on first run if the user wishes to enable it, and inform about it.
3) DON'T USE GOOGLE ANALYTICS. "
834099844,835,Newbytee,2021-05-07T06:19:55Z,How about we cease the one-word comments and repetition of already-stated arguments and wait for a response from the Audacity team? I think it's pretty clear what the community's stance on this is. Further dilution only hides the actually good arguments.
834100409,835,Evrey,2021-05-07T06:21:18Z,"@Zardoz89 I feel misrepresented by your summary. My standpoint is:

- Telemetry for UX studies is near useless thanks to all the sources of bias in your data.
- Automatic crash reports with user confirmation are super valuable.
- If you absolutely must have telemetry or else someone dies, at least follow the entire GDPR by the letter, take it as dogma, and whatever you do, no Google."
834101248,835,Hoimar,2021-05-07T06:23:13Z,"> Privacy always trumps any need for telemetry data, no matter how legitimate.

\- from the [KDE Telemetry Policy](https://community.kde.org/Policies/Telemetry_Policy).

I wonder how you got to this decision - as a team or as a FOSS contributor to just say ""yeah, it's fine if we can track users using Google Analytics"" (of all things). Don't you know that Google is a data mining company? Users are the _product_, data is their _currency_.

But to keep this constructive, what about another, self-hosted FOSS telemetry library (e.g. https://opentelemetry.io/)? Here's a list of different open source analytics libraries: https://github.com/0xnr/awesome-analytics (seems to be web focused mostly).

Really hope this doesn't get merged and this direction of questionable changes to Audacity under the new leadership will stop!"
834103291,835,AndreiSva,2021-05-07T06:27:59Z,"> Also worth noting: Audacity registered is a registered trademark in the US and other jurisdictions. While I'm not a lawyer, and this is not legal advice: forks really must not carry the name ""Audacity"" on them without permission from its rights-owner - and, in my opinion, even for other reasons aside from the legal.

then we can call the fork ""Audacious"" :+1: "
834105437,835,Evrey,2021-05-07T06:32:45Z,"Ah, we doing joke fork names? Given the »audacity to telemetry«, how about naming the telemetry-free fork »Respect«?"
834105536,835,yzziizzy,2021-05-07T06:32:56Z,"> > Also worth noting: Audacity registered is a registered trademark in the US and other jurisdictions. While I'm not a lawyer, and this is not legal advice: forks really must not carry the name ""Audacity"" on them without permission from its rights-owner - and, in my opinion, even for other reasons aside from the legal.
> 
> then we can call the fork ""Audacious"" +1

Call it ""Humility"" or ""Respect""."
834105674,835,yzziizzy,2021-05-07T06:33:16Z,"> Ah, we doing joke fork names? Given the »audacity to telemetry«, how about naming the telemetry-free fork »Respect«?

Beat me to it."
834105891,835,bbappserver,2021-05-07T06:33:44Z,"I know it's beating a dead horse at this point, but what exactly does adding telemetry accomplish?  Audacity is already the
> Basic audio editing program that runs on damn near anything.

And if there were any scenario in which it were not accomplishing the running on damn near anything which it already does near flawlessly for decades, would not somebody just open a ticket and upload a crashlog?

The benefit of FOSS is you don't need metrics on which platforms to support, because if it's not working on your end, you can just patch it until it does.  You don't need to predict what the market wants, just carry it forward every once and a while and barring a backport make old releases available."
834105911,835,Evrey,2021-05-07T06:33:46Z,@yzziizzy Concurrency hard. :)
834107887,835,Evrey,2021-05-07T06:37:48Z,"@bbappserver Average Joe™ will indeed not open a GitHub issue with a crash report, 'cause Average Joe™ doesn't even know what GitHub is. We are the tech-savvy 1% here. But that's why i said automated crash/error reports with user confirmation are fine. Nobody has to open an issue, Audacity devs get their stack traces in the formats they prefer, everyone's happy."
834110983,835,ghost,2021-05-07T06:44:17Z,"Absolutely no. Remove it already. 
Why do you think people use this tool in the first place? You are taking away something. VERY bad idea.
Resolve this. Make a good decision. Thank you."
834112117,835,yzziizzy,2021-05-07T06:46:46Z,"> @bbappserver Average Joe™ will indeed not open a GitHub issue with a crash report, 'cause Average Joe™ doesn't even know what GitHub is. We are the tech-savvy 1% here. But that's why i said automated crash/error reports with user confirmation are fine. Nobody has to open an issue, Audacity devs get their stack traces in the formats they prefer, everyone's happy.

Serious suggestion here: Put a button in the top right of the menubar that says ""Complain to the Developers"". It pops up a little input box, 128 character max, and sends it directly to a simple webserver along with the build number and OS version, both visible in the box. 100% anonymous. No UUID's, no machine fingerprints, no sneaky anything. Have a 10 minute cooloff or something to prevent spam. Post all the messages publicly on the audacity website. You will collect the real frustrations of your users very quickly. 

The wording of the button is important; do not soften it. You want _complaints_, not _feedback_. You want to know when things aren't working to the degree that people are getting frustrated enough to _complain_, not just that someone had a nifty idea about how the icon should be corn-flower blue."
834113385,835,ghost,2021-05-07T06:49:30Z,"As someone who values privacy more. I aggresively disagree with this. If this gets merged, then I guess I have to look for another Audio Recording software. This is just BS and a violation of our Privacy. "
834113942,835,bbappserver,2021-05-07T06:50:36Z,"> @bbappserver Average Joe™ will indeed not open a GitHub issue with a crash report, 'cause Average Joe™ doesn't even know what GitHub is. We are the tech-savvy 1% here. But that's why i said automated crash/error reports with user confirmation are fine. Nobody has to open an issue, Audacity devs get their stack traces in the formats they prefer, everyone's happy.

Opening a github issue is by no means the only recourse, the first recommended action in a google search is to ak the forum, then the bugzilla, not the github(though this may be historic, everybody likes the Cloud™ these days.

For modernizing bug reports, I would accept being prompted to upload a log as a convenience, but automatically collecting a bunch of log data during normal operation is probably mostly pointless, and having software that doesn't need to constantly call home just always feels nefarious, even if nobody would ever use Audacity to do something nefarious.  Just collect the last hour of logs, and the postmortem if necessary, maybe scrub some paths etc.

I can see a reason for prompting the user to upload a crash log on relaunch after dirty exit.  And I can see a reason to have a wizard under the help menu for opening a ticket with a simple HTTP POST from within the application for behaviours that are not behaving.   These are always nice to haves for non technical end users.  But session and platform tracking, now that's just dumb."
834114374,835,Evrey,2021-05-07T06:51:32Z,"@yzziizzy On that note, i *really* like how MS Teams handles feedback/complaints after video calls. It politely asks for a star rating, you can just click it away. And if you rated, you get the option to specify whether something didn't work. A few checkboxes for expectedly common problems, an input field for custom complaints, done."
834114715,835,psynautic,2021-05-07T06:52:07Z,the level of paranoia on this PR is wildly out of control
834117010,835,Hoimar,2021-05-07T06:56:23Z,"> the level of paranoia on this PR is wildly out of control

Your level of denial to the practices of your run of the mill ""Don't be evil™"", ""Do the good thing™"" megacorporations is wildly out of control."
834117437,835,DC7IA,2021-05-07T06:57:14Z,"> the level of paranoia on this PR is wildly out of control

Funny, I just wanted to say the same about the level of ignorance. :D "
834118155,835,PowerMan2206,2021-05-07T06:58:36Z,Excuse me what the funk
834118225,835,bbappserver,2021-05-07T06:58:45Z,"It's not paranoid to act suspicious of unnecessary features in software that is working fine, particularly if it adds a bunch of otherwise unnecessary dependencies that you now have to manage, and depends on an external commercial interest, especially one that has its entire business model predicated on violating your privacy as much as the law will allow."
834118874,835,yzziizzy,2021-05-07T07:00:01Z,"> the level of paranoia on this PR is wildly out of control

In some countries, privacy is a matter of life and death. It is understandable that some people have strong feelings about it. 

That being said, most of the commenters do not have a problem with responsibly implemented, opt-in, truly and fully anonymous, completely FOSS usage data collection. That's not what this PR is. This PR sends the titles of all your windows to a company known to sell data to all sorts of bad actors."
834119695,835,Zerocchi,2021-05-07T07:01:32Z,"I've been using Audacity since 15 years ago and it's perfectly fine without this unnecessary ""telemetry"" and stuff."
834119981,835,AndreiSva,2021-05-07T07:02:03Z,Also I've heard people defend telemetry because it would help the UI design. Personally I think the UI is fine as it is...
834120906,835,DC7IA,2021-05-07T07:03:54Z,"> > the level of paranoia on this PR is wildly out of control
> 
> In some countries, privacy is a matter of life and death. It is understandable that some people have strong feelings about it.
> 
> That being said, most of the commenters do not have a problem with responsibly implemented, opt-in, truly and fully anonymous, completely FOSS usage data collection. That's not what this PR is. This PR sends the titles of all your windows to a company known to sell data to all sorts of bad actors.

Exactly, I wonder how many people will die because US agencies use that data, collected by Google, for drone strikes."
834121824,835,thomasf,2021-05-07T07:05:47Z,"This mostly echoes what other people have written but this would be my important shortlist before considering something like this.

- Implement your own data collection service, use data sampling to make the data volumes reasonable.
- Anonymize all data before it's being written to any kind of storage, preferably in the client when its possible.
- Be GDPR compliant (and really spend some time on understanding what this means).
- Provide a detailed document to the users that explains all the events that are collected.
- Always ask users for consent initially and for every change in what you collect.
"
834122255,835,yzziizzy,2021-05-07T07:06:37Z,"> Also I've heard people defend telemetry because it would help the UI design. Personally I think the UI is fine as it is...

I second this. I'm sick and tired of having to constantly re-learn the UI of this or that application because it was ""modernized"" or the devs just felt like changing everything for fashion reasons. Very seldom is there a legitimate improvement in redesigns, and very often it's a step backwards. Look at Excel 2003 vs the new ""ribbon"" garbage. gedit is basically unusable now with the new CSD hamburger menus."
834127490,835,PowerMan2206,2021-05-07T07:16:29Z,"So in conclusion, nobody really likes this. Skedaddle."
834127508,835,mcilrain,2021-05-07T07:16:31Z,"I speak for the quantified opinion of the masses when I say this isn't going to happen.

The finer details of how this isn't going to happen are up to you, Dmitry Vedenko."
834127964,835,Evrey,2021-05-07T07:17:22Z,"> - Be GDPR compliant (and really spend some time on understanding what this means).

If not, someone will report failures to be compliant to the corresponding offices, there'd be a tongue-lashing, and if things don't get fixed ASAP then, boy will it be expensive."
834130242,835,bbappserver,2021-05-07T07:21:56Z,"The first post be like
![image](https://user-images.githubusercontent.com/27609692/117412896-2c03b780-aeca-11eb-9d8e-cc1b2f4d0993.png)
"
834131991,835,seemsindie,2021-05-07T07:25:02Z,Make this ONLY opt-in and I don't have an issue with this. We don't want to give Google even more data. I mean if you need analytics setup Matomo Analytics on a DO box and do it like that. I am 100% sure that DO or AWS will provide servers for free for this open-source project but we can also sponsor this.
834134753,835,PowerMan2206,2021-05-07T07:29:57Z,"![funkyoucrsib](https://user-images.githubusercontent.com/61635519/117413852-fe3c6400-af05-11eb-84f7-cf65dc2de989.jpg)
"
834134939,835,Evrey,2021-05-07T07:30:13Z,"I would not sponsor for telemetry infrastructure, btw. I prefer throwing my money into the river instead and watch it float. Much better UX."
834135069,835,yonderbread,2021-05-07T07:30:28Z,"> 
> 
> ![funkyoucrsib](https://user-images.githubusercontent.com/61635519/117413852-fe3c6400-af05-11eb-84f7-cf65dc2de989.jpg)

Respect for making that homemade meme right on the spot."
834135965,835,Dragas,2021-05-07T07:32:03Z,At this point most of this pull request is spam. It's very obvious audacity does not need telemetry. As far as I remember that audacity has plugin support. So why not make this a plugin instead?
834137797,835,PowerMan2206,2021-05-07T07:35:17Z,"> At this point most of this pull request is spam. It's very obvious audacity does not need telemetry. As far as I remember that audacity has plugin support. So why not make this a plugin instead?

A plugin tucked away in a repo deep, deep underground where no sunlight will ever reach it."
834142456,835,gnutechie,2021-05-07T07:43:31Z,"I have a few simple questions.

1) Why on earth would you need Telemetry in an audio editor like Audacity?
2) Telemetry and Crash Reporting are two different things. Why go with Telemetry?
3) Where is telemetry going to help users? Given that users escape Microsoft's Telemetry and come to GNU/Linux distributions for the privacy (as one of the many of the reasons that they use when they decide to switch OSes) why implement a feature that is so hated in a F/LOSS software that is so used?
4) Audacity is a pretty famous F/LOSS piece of software. Noone is denying that and there are plenty of evidence to back that claim up. Why the telemetry?Why now? What makes you guys think that this is ever going to change (apart from merging such a feature into a perfectly fine piece of software)?

Thank you in advance for taking the time to answer my questions."
834146852,835,nonetrix,2021-05-07T07:51:22Z,"Who's idea was this? 

![56ebpd](https://user-images.githubusercontent.com/45698918/117416505-0fbe4580-aedf-11eb-892f-5123c39051ba.jpg)
"
834148153,835,unfa,2021-05-07T07:53:27Z,"I thought this is a joke. It's not funny. I guess all that had to be said about this has already been said.

I trust the new maintainers will listen to the community and realize doing things this way is not actually going to help Audacity and it's community.

I'll happily share some data with the team to help improve Audacity, but **not like this**."
834148572,835,borkform2555,2021-05-07T07:54:10Z,Might as well just use propietary software at this point.
834149347,835,Sciss,2021-05-07T07:55:32Z,"> The damage done by even _**suggesting**_ this line of action

I don't know the communication policy of this project, but any other reasonably large project I know use one of ticket / RFC / forum post / mailing list post to “suggest” something like adding phoning home. A PR is for submitting implementations, as can be directly witnessed here it bifurcates into people discussing the change itself, while others focus on the technicalities of the implementation. So perhaps this is also an opportunity to reset the question how adding things like this are communicated to and discussed with the project first."
834151099,835,hfr4,2021-05-07T07:58:25Z,Nice idea ! You should also add a Bitcoin miner !
834156337,835,dentillozie,2021-05-07T08:06:47Z,"No, just no"
834156790,835,neobenedict,2021-05-07T08:07:33Z,"As with modern OSS development in 2021, it is likely the discussion here will be ignored, this PR and any issues marked as ""locked; too heated"", and merged anyway."
834158289,835,dvzrv,2021-05-07T08:09:53Z,"I would like to raise my concern about this pull request as the maintainer of this software for Arch Linux.
With several hundreds of packages to maintain I can not spend the time to start devendoring more things, that are being vendored into audacity for no good reason.

It is one thing to vendor [your custom version of wxwidgets](https://github.com/audacity/audacity/issues/625) (poorly), and not fix issues with the build system (https://github.com/audacity/audacity/issues/522, https://github.com/audacity/audacity/issues/521, https://github.com/audacity/audacity/issues/519). However, it is something completely different to start vendoring `curl` (poorly) and potentially expose users to its numerous CVEs per year.
To remove all this and protect users from this harmful decision making adds more work for me.

This decision is short sighted and *very* frustrating for users and maintainers alike..."
834159119,835,Duckrinium,2021-05-07T08:11:09Z,"Ah yes, Open Source Google Spyware, how great"
834162338,835,emptytriangle,2021-05-07T08:16:26Z,WTF are you doing? You woke up one morning and decided your time was best spent writing this garbage?
834162619,835,Be-ing,2021-05-07T08:16:51Z,"Regarding the concerns of vendoring dependencies, I recommend considering [vcpkg](https://github.com/microsoft/vcpkg). I recently helped [set up vcpkg for Mixxx's Windows dependencies](https://mixxx.org/news/2021-02-23-build-infrastructure-updates/). Despite being made by Microsoft, it was surprisingly pleasant to work with. It's implemented with CMake scripts and integrates with CMake easily. I suspect Mixxx and Audacity have a lot of dependencies in common so you likely won't need to add many packages to vcpkg yourself. It's quite easy to add new packages to vcpkg and it's easy to vendor the dependencies you need to vendor while keeping the rest up to date. Mixxx uses GitHub Actions to build all Windows dependencies, scp an archive of them to a server, then downloads and caches that archive for the CI jobs on the application code repository. I'd be happy to discuss this further and give you some tips to get started on this if you're interested."
834163955,835,eevvoor,2021-05-07T08:19:06Z,It is an absolute no-go to include a tracker. Please remove Google Analytics. I do not want to send my data to Google. And in particular certainly not via Audacity.
834168078,835,Phundrak,2021-05-07T08:25:44Z,"Well lads, if this gets merged, we might as well create a new fork. I’d absolutely hate it if telemetry were to be in Audacity, even more so if it is Google Analytics."
834169284,835,ftpmorph,2021-05-07T08:27:41Z,"Google Analytics in FOSS... the sheer audacity of it all.

Realtalk: if you do this expect much of the userbase to move over to a fork without this spyware in it."
834170392,835,UX0l0l,2021-05-07T08:29:19Z,why the fuck would you add that
834171177,835,nonetrix,2021-05-07T08:30:28Z,"Don't really think this is a good idea I was hopeful they would just improve the UI and mostly leave it alone but seems I was wrong

I wouldn't mind if this was opt-in or heck opt-out if the user is prompted after install also don't like the idea of this being done with Google or Yandex

Tracking can be very useful sometimes for fixing bugs but shouldn't be too spook this is only going to push people away from Audacity and probably create many forks

Also don't know how true this is since I am probably the worst programmer on earth but many have pointed out that curl is not very secure and have many security bugs"
834174629,835,just1a-person,2021-05-07T08:36:05Z,Telemetry is not bad. Just make sure Google isn't the one collecting data. Also make it opt-in.
834178223,835,ghost,2021-05-07T08:41:47Z,"That's the beginning of the end of Audacity.

That's 5500 lines full of bugs that need to be maintained and will take brain time off the actual program. Such things are actively harmful to projects.

Projects that have become greedy for improvement so badly that they start to harm themselves (and their users) into a vicious cycle.

*Actual* users who liked the program and who have something to say about it will leave. And you'll be left with uninvolved people whose usage doesn't reflect the original usage anymore. And so will Audacity die."
834180924,835,HeyBanditoz,2021-05-07T08:46:11Z,Can I be in the screenshot?
834181098,835,joepie91,2021-05-07T08:46:29Z,"Let's stop collectively posting insults and doomsaying, it's not helpful. The actual points have already been made, and this is just drowning them in the noise."
834182783,835,rail01,2021-05-07T08:49:07Z,I strongly oppose this change
834183003,835,herrschr,2021-05-07T08:49:28Z,if this gets merged I will have to look for an alternative. 
834184146,835,BotchedRPR,2021-05-07T08:51:16Z,"I'll probably too. I try not to use software that ""adds"" my data into Google's magic data collection server lab to do... well nobody knows what they are going to do."
834186011,835,megastallman,2021-05-07T08:54:02Z,"@crsib , why doesn't your management just stay away from Audacity development instead of slowly killing it? Just let this program alone, and the community will make it sustain without any telemetry junk!
Nice improvements from the very first days of acquisition!"
834186867,835,ghost,2021-05-07T08:55:21Z,🍴
834186975,835,Atulin,2021-05-07T08:55:30Z,"![Audacity](https://user-images.githubusercontent.com/11233299/117425064-baa42300-af22-11eb-964a-56c462bd88e7.png)
"
834189232,835,wioxjk,2021-05-07T08:58:46Z,"I am against this PR.
Not because it is telemetry, not because it is helpful for the developers

I am against this because it is not opt-in(It is opt-in, according to @SpyTec), and it is using third-party services suchs as Google Analytics and Yandex. 
Good luck writing the new privacy policy and we users are forced to accept"
834189779,835,AbstractQbit,2021-05-07T08:59:34Z,The fact that project members discuss implementation details of this instead of questioning the whole idea leads me to believe that a major fork is just a matter of time.
834189942,835,Venefilyn,2021-05-07T08:59:48Z,"> I am against this because it is not opt-in

It is opt-in. Looking through the code can verify that"
834193417,835,leap0x7b,2021-05-07T09:04:57Z,How about ***no***
834195205,835,paniash,2021-05-07T09:07:34Z,"Next up, adding telemetry to the linux kernel via Google analytics.

Jokes aside, a big **NO**."
834197663,835,ivanka2012,2021-05-07T09:11:30Z,ITT Twitter and Reddit
834198695,835,JD557,2021-05-07T09:13:11Z,"I guess that this is going to be merged anyway, but have you considered at least using a self-hosted OSS analytics solution like [Plausible](plausible.io) or [Matomo](https://matomo.org/) instead of Google/Yandex?

At least that's a more privacy friendly solution and should get rid of the quota problem."
834199078,835,severak,2021-05-07T09:13:48Z,"Traditional way to get feedback from users (which functions they use and how much) was to send questionnaire. I wonder if this would be better alternative (e.g. optional questionnaire shown after first run of newly installed Audacity)

Also - I think there are many users which use older versions of Audacity and does not need to update it (because older version just works fine without problems). So probably you will not get actual usage stats this way, but version somewhat skewed to new users / users who update regularly.

EDIT: I use Audacity a lot and updated to 2.4.2 only after I needed to use some advanced noise reduction trick which was not possible with older version which otherwise worked just fine for some years."
834199124,835,zdimension,2021-05-07T09:13:53Z,"For all that I dislike the *idea* of having telemetry in FOSS, as a developer I have to admit that it _can be useful_ for cases such as tracking feature usage and bugs. Honestly, what percentage of users **will take the time to write an issue or a forum post** whenever they have a bug? 

That being said, *if* telemetry there is, it should absolutely be opt-in, and **not in the GDPR** ""click OK to accept all or spend fifteen minutes clicking on checkboxes to disable everything"" way.  There are numerous FOSS with telemetry that simply, at the first launch, present the user with a ""Do you agree for XXX to send usage data to the developers?"" dialog box with a simple Yes/No answer. 

That doesn't fix the problem of shipping additional libraries required for telemetry which increases both the time required for OS maintainers to package new releases, and the attack surface. The latter could be solved by providing telemetry-free builds of Audacity for those who want them (remember the ANSI/Unicode Windows builds days?).

No real conclusion in this comment, I simply wrote it to say that the issue isn't as simple as ""Telemetry bad""."
834199991,835,ghost,2021-05-07T09:15:15Z,"It would be especially ironic if after all this true user feedback, Audacity decides to still spy on their users. Clearly it would show that ""user feedback"" is **not** what they really care about, at all."
834201963,835,maiksd,2021-05-07T09:18:19Z,"If this gets merged, the project will be forked and the community split."
834202275,835,ghost,2021-05-07T09:18:46Z,You will own nothing and you will be happy.
834203391,835,lengthwave,2021-05-07T09:20:31Z,"> > Let's not get hyperbolic here. Audacity is licensed under the GPLv2. Nobody can make it proprietary.
> 
> if muse group holds the license to all the code, they can simply not release future versions under the GPL. the existing code would exist, but the other code wouldn't be GPL licensed.

While we may choose to uplicense as necessary (ex: GPLv2 --> GPLv3), Audacity was born GPL and will remain GPL for as long as it will exist.

Uplicensing is also not something to take lightly either, as there are considerable downstream implications. It should only be done when there is a genuine blocker that prevents enhancements that are clear benefits to the user. 

A good example of such a blocker is the VST3 SDK which is GLPv3. If Audacity is not uplicensed to GLPv3, VST3 support is not possible, significantly limiting future capability and user choice.

Every choice we make as a company in contribution to the open source initiatives that we support is in service of improving the experience of the user.

Part of our commitment to open source is a commitment to transparency. Being fully transparent, the CLA of the open source projects we support does grant some form of flexibility in licensing. But what does this mean?

I will use the example of MuseScore. The MuseScore CLA does allow for the possibility to dual license the source code as GPL and proprietary, so long as it remains also available under GPL.

But why would we ever want to do this? How could this possibly be in service of the user and user choice?

To answer this, let's back up to when the Audacity project began. At that time, the most powerful and capable mobile devices on the market had a 2 inch bitmap screen. The most powerful potential of the capabilities of that device was the ability to play Snake.

Fast forward to now, where the new iPad Pro devices are even more powerful and capable than Apple's top Macbook Pro.

User choice also means choice of devices they wish to experience the software on. But there is only one problem. The ability to install software on some devices is limited by the manufacturer who acts as gatekeeper. 

As we have learned from the Apple/VLC issue from a few years back, there is considerable risk with being subject to these sole gatekeepers and their interpretation of GPL. To minimize such risk, it is good to have more flexible options for limited scenarios such as alternative licensing for a specific build for a specific platform to solve a specific issue (ex: excluded from platform due to GLP as in VLC case).

In more simple terms, we view the potential of dual licensing as an insurance policy in order to ensure availability for the user on the platform of their choice.

All of this is simply words. I completely understand this. I can only suggest that you look to our actions, particularly as it is related with MuseScore."
834205099,835,HookedBehemoth,2021-05-07T09:23:08Z,"> 
> 
> > I am against this because it is not opt-in
> 
> It is opt-in. Looking through the code can verify that

It's not opt-in if the default is on.

https://github.com/audacity/audacity/pull/835/files#diff-38452b2ab9b100d5046eb855410add20e6158dbc69533301bfc15f6d0913d3efR93-R94"
834206645,835,Nytelife26,2021-05-07T09:25:18Z,"Things like this are the work of corporate developers, not software engineers and computer scientists. Let it be known that users, especially those in the open source community, will not stand to be spied on.

This is quite possibly one of the largest rebuttals to a pull request I've seen, second only to GitHub's DMCA on youtube-dl (which I have commonly used in conjunction with audacity actually).

Good job people."
834206657,835,Be-ing,2021-05-07T09:25:19Z,"> I can only suggest that you look to our actions

This action looks very bad right now. Your response with an essay on a tangential issue rather than addressing the substance of this pull request only adds fuel to the fire."
834207153,835,phoe,2021-05-07T09:25:58Z,"> I can only suggest that you look to our actions

@workedintheory You seem to be including Google Analytics in Audacity as opt-out. Looking at that action alone shows that you are hostile towards your users: you data-mine them and feed the results into Google, so you can get a little bit of that data for yourself in return."
834207774,835,AngryPhantom,2021-05-07T09:26:53Z,A big **NO**. Waiting for a split/fork and staying with the previous version.
834208378,835,IGBC,2021-05-07T09:27:48Z,"Original Author:
> Universal Google Analytics is used to track the following events:
> 
>     * Session start and end
> 
>     * Errors, including errors from the sqlite3 engine, as we need to debug corruption issues reported on the Audacity forum
> 
>     * Usage of effects, sound generators, analysis tools, so we can prioritize future improvements.
> 
>     * Usage of file formats for import and export
> 
>     * OS and Audacity versions


Me Last Night:
> > while we're on the topic of problematically bundling dependencies why on earth does Audacity have an SQLite server **Database** in it in the first place?
> 
> I have answered my own question, aup3 files are actually SQLite databases. Seems like a strange design decision but this PR is not the place to argue about such things.

I have realized that the phrase ""Errors, including errors from the sqlite3 engine,"" is deliberately misleading. As mentioned in the Quote from an off topic discussion earlier the SQLlite3 engine IS the save file handler in the (new and ill-conceived) Audacity 3.0 save format. So without going through 5000 lines of code to confirm this there is a distinct possibility that 

## __this code is uploading portions of your save files to Google and Yandex__. 

Which is not as harmless as the developers have indicated but is a major invasion of privacy.

I commented last night that this is not the time to argue about save files, but it has come to my attention that even Archlinux (a distribution known for tracking software releases quickly) is refusing to update past Audacity 2.4.1 Which implies there is something fundamentally wrong with the new release. I think that the new save format which is evidently causing many issues on the forum is part of this problem. 

So a message for the devs: If you ditch this ill conceived idea of using web tech to store real time audio data that is fundamentally incompatible with how people want to use the software, maybe to won't need telemetry to track why it's broken. I can tell you why its broken RN, it was a bad idea!

I demand a community petition to roll the entire project back to v2.4, and divorce from MuZegroup
 
"
834208625,835,Nytelife26,2021-05-07T09:28:11Z,"As the founder of Kludge Cyber Systems we are happy to make and adopt a community fork if this is merged. Rest assured, this ship will not sail anywhere other than the seas of freedom."
834211484,835,Be-ing,2021-05-07T09:32:14Z,"@falkTX has already offered to maintain a fork. If that ends up being necessary, it would best be done by someone with a strong reputation and skills in cooperative audio software."
834212390,835,jxu,2021-05-07T09:33:31Z,"> As the founder of Kludge Cyber Systems we are happy to make and adopt a community fork if this is merged. Rest assured, this ship will not sail anywhere other than the seas of freedom.

I thought this was a joke at first. Then I realized you really did found a company called Kludge Cyber Systems. My bad"
834214437,835,Nytelife26,2021-05-07T09:36:42Z,"> I thought this was a joke at first. Then I realized you really did found a company called Kludge Cyber Systems. My bad

No worries. My friends laughed at me for the name when I made it, too. But ultimately I founded it to prove to myself you don't have to swallow your morals to be successful, so that doesn't matter to me

> @falkTX has already offered to maintain a fork. If that ends up being necessary, it would best be done by someone with a strong reputation and skills in cooperative audio software.

I agree. This would be our first undertaking into audio software, but we pick up on things very quickly, and in general have a good reputation with maintaining open source projects of many sizes. For instance, we have inherited 2 year old Python abandonware, I myself know C++, Go, Rust, et cetera, and we are strong advocates of open source software.

Not to toot my own trumpet, though - this decision is best left to the community as a whole."
834214521,835,Roki100,2021-05-07T09:36:49Z,This is a really bad idea
834215152,835,Frenzoid,2021-05-07T09:37:45Z,"> No worries. My friends laughed at me for the name when I made it, too. But ultimately I founded it to prove to myself you don't have to swallow your morals to be successful, so that doesn't matter to me

I like the name :)"
834216423,835,arkadiusz-wieczorek,2021-05-07T09:39:31Z,"_Embrace, Extend, Exterminate_"
834216720,835,Venefilyn,2021-05-07T09:39:57Z,"> 
> 
> > > I am against this because it is not opt-in
> > 
> > 
> > It is opt-in. Looking through the code can verify that
> 
> It's not opt-in if the default is on.
> 
> [#835 (files)](https://github.com/audacity/audacity/pull/835/files#diff-38452b2ab9b100d5046eb855410add20e6158dbc69533301bfc15f6d0913d3efR93-R94)

No, it is opt-in. You're referring to a modal with ""Yes"" already focused so that pressing enter key will enable it. You still have a yes and no button next to each other. Throughout the code telemetry is disabled and will only be enabled if the user clicks yes. Focusing on the confirmation button does not mean it's opt-out"
834218277,835,Nytelife26,2021-05-07T09:42:09Z,"> No, it is opt-in. You're referring to a modal with ""Yes"" already focused so that pressing enter key will enable it.

I do have to ask, though - why is this even necessary? The only thing software like this needs to collect is when errors occur and crash logs happen, at which point a popup should display at the end of the session or on crash letting them see the log that's about to be sent and asking if they want to report it."
834218441,835,TOGLK,2021-05-07T09:42:25Z,"> This request provides the basic telemetry for Audacity.
> 
> To implement the network layer libcurl is used to avoid issues with the built-in networking of the wxWidgets.
> 
> Universal Google Analytics is used to track the following events:
> 
> * Session start and end
> * Errors, including errors from the sqlite3 engine, as we need to debug corruption issues reported on the Audacity forum
> * Usage of effects, sound generators, analysis tools, so we can prioritize future improvements.
> * Usage of file formats for import and export
> * OS and Audacity versions
> 
> To identify sessions we use a UUID, which is generated and stored on the client machine.
> 
> We use Yandex Metrica to be able to correctly estimate the daily active users correctly. We have to use the second service as Google Analytics is known to have some really tight quotas.
> 
> Both services also record the IP the request is coming from.
> 
> Telemetry collection is optional and configurable at any time. In case of data sharing is disabled - all calls to the telemetry Report* functions are no-op.
> 
> Additionally, this pull request comes with a set of libraries to help the future efforts on Audacity.

To whom it may concern,

I speak as only an individual amongst the huge FOSS community, so value the following comments as just a representation of only MY feelings & opinions on this matter.

*But* take note that this is the **FIRST** time that I have ever been so against a decision that I have felt that I needed to voice my opinion on it.


So the first issue I have here is just how **poorly** the *Audacity Development Team* have handled this entire Push Request/Suggested Changes process.
You have failed from the very outset to identify that as a widely used and well loved FOSS, you will be, and must be, at all times subject to public scrutiny of decisions prior to **ANY** kind of code changes being submitted.

Your entire teams complete lack of transparency, and the failure of your team to respond adequately & promptly following such a strong public disagreement shows that the systems you have in place for managing Public Relations are an utter shambles and really need to have attention paid to them so that situations similar to this if they do occur in the future aren't pushed through with such complete disregard for end-users & package maintainers.


Now that I have highlighted the flaws in the poor execution of public relations with the community I shall now move on to addressing the actual Code Commit itself, it's contents, it's intentions, and it's usefulness.

##1.) The addition of Telemetry inside of a FOSS project

Now that I have clearly outlined in the title of this section exactly what I will now cover you should hopefully be prepared to listen to and take note of the issues that I have with this change.

FOSS prides itself on being highly privacy-focused and open, this is something that many people in the FOSS community see as a cornerstone of FOSS development, and it seems that the the Audacity Development Team have failed to realise just how critical privacy is to many people that choose Linux and FOSS as thier chosen methods of software interaction.

Telemetry is not welcome in FOSS software, regardless of the project, and as someone who helps support a FOSS project I can tell you from my own personal experience that Telemetry is essentislly useless to most people looking to find faults with and fix bugs in software, the methods with which the data is gathered, and, the inability for that data to be understood from the users perspective mean that it is impossible to gain any useful context from Telemetry Data.

The Audactiy Development Team should be fully aware that Telemetry is useless for all but some very invasive marketing and analytical subjections.

***WHY*** **did you ever think this was an acceptable change to make?**

**Do you think we are stupid?**

Under no circumstances should Telemetry be included into Audacity.
It doesn't belong in FOSS projects under any circumstances.

And, your attitude towards how you have handled it's suggested integration into Audacity highlights your complete disconnection from the huge community that uses Audacity.


Stop the process here and now.
Go back to the drawing board and re-evaluate the feedback you have recieved from the community on this matter.
You'll learn a lot by listening to the communtiy and taking on-board the feedback that has been provided.

Don't make us fork this project just because you are unable to accept honest criticism from your end-users.
Do the right thing, work with us to improve the project in ways that the community want it to be improved.


The last two points I was going to cover are frankly irrelevant because they don't even need to be considered once you taken on-board my feedback on the first point.
But just in case you think you know better than your own end-users..... 

***NO Google. NO Yandex.***

**NO Opportunity for discussions on the matter either. It's the communities way or the highway for the current Audacity Development Team.**


Take heed, we want our values preserved, please don't fight against us on this matter.



"
834219131,835,Frenzoid,2021-05-07T09:43:23Z,I like the guy above me.
834219161,835,lenincritus,2021-05-07T09:43:25Z,Don't merge this.
834219643,835,tomlister,2021-05-07T09:44:11Z,This is sus as.
834219764,835,CristhianCC,2021-05-07T09:44:19Z,Where am i?
834219957,835,Veritius,2021-05-07T09:44:34Z,"If I had to guess, I don't think the community wants this. Not like there's 19 likes and 1570 dislikes.
In all seriousness, this might contribute to the development of Audacity but this seems unnecessary, especially with the existence of forums. If there's a crash... just post it on the forums. No automation or Google Analytics required, and users can leave their privacy concerns at rest."
834220617,835,lenincritus,2021-05-07T09:45:34Z,"> Where am i?

The place from where it all went down :("
834221539,835,jxu,2021-05-07T09:46:49Z,"This is preaching to the choir and may be melodramatic grandstanding: the spirit of Audacity was a open research project at Carnegie Mellon. I don't speak for my institution, but it seems like many of my peers are all to eager to cash out with a lucrative big tech job violating people's privacies. Somewhere along the way, most of the hacker spirit died and programming just became a way to market and track people more. "
834221854,835,Frenzoid,2021-05-07T09:47:18Z,"> > Where am i?
> 
> The place from where it all went down :(

@CristhianCC and me looking at this PR :D
![image](https://user-images.githubusercontent.com/30338644/117431827-f7274d00-af29-11eb-94ed-1162cd2a4e62.png)
"
834222324,835,petterroea,2021-05-07T09:47:59Z,"Use internal infrastructure instead of relying on a third party for analytics collection, please."
834222459,835,Nytelife26,2021-05-07T09:48:11Z,"> This is preaching to the choir and may be melodramatic grandstanding: the spirit of Audacity was a open research project at Carnegie Mellon. I don't speak for my institution, but it seems like many of my peers are all to eager to cash out with a lucrative big tech job violating people's privacies. Somewhere along the way, most of the hacker spirit died and programming just became a way to market and track people more.

That isn't software engineering. That isn't computer science. It's computer industry. Your peers can enjoy it, but I'd hope you reasonably want no part of it, and certainly nor do the rest of us."
834223088,835,IGBC,2021-05-07T09:49:07Z,"Polite reminder this is GITHUB, not your local discord server. Please keep discussions on topic, and ensure every new post adds to the discussion. As a further reminder every time someone clicks ""Comment"" about 200 people get an email. "
834224445,835,CristhianCC,2021-05-07T09:51:09Z,"> adds

Sorry, i thought Reddit had a new feature to upload code. My bad."
834224591,835,Sciss,2021-05-07T09:51:22Z,"> All of this is simply words. I completely understand this. I can only suggest that you look to our actions, particularly as it is related with MuseScore.

These are all very sweet words. But the TL'DR of your message is that you are somehow implying you will add a CLA to be able dual license Audacity, i.e. add a non-GPL version. Could you please clarify if you obtained that permission from all main constributors of _the existing code base_ (which in my understanding is a precondition to add dual licensing), and what you intend to do with code that has been submitted by people who were not part of that deal?"
834225352,835,jxu,2021-05-07T09:52:35Z,"> and ensure every new post adds to the discussion.

I think that ship sailed 200 comments ago"
834226077,835,IGBC,2021-05-07T09:53:47Z,"> All of this is simply words. I completely understand this. I can only suggest that you look to our actions, particularly as it is related with MuseScore.

Not really a strong leg to stand on MuseScore has been littered with subscription only features and bolted to a closed source server infrastructure. With as far as I can tell little input from the community about if that is what they want. Muse is about monetizing these apps not improving them."
834226461,835,CompSciOrBust,2021-05-07T09:54:19Z,Currently over 99.97% of the reactions to the original commit are negative. Clearly the users are overwhelming opposed to it. If it gets added that will be a massive middle finger to people who have used Audacity all these years and will most likely result in a loss of users.
834228086,835,IGBC,2021-05-07T09:56:38Z,"BTW Ardour is Free Open Source, has no tracking, and still manages to fund its self. BTW its also got 90% of the features of Audacity, and is a viable exit strategy for many.

 * Cough * https://ardour.org/ * cough *"
834228994,835,jxu,2021-05-07T09:57:54Z,"> Currently over 99.97% of the reactions to the original commit are negative. Clearly the users are overwhelming opposed to it. If it gets added that will be a massive middle finger to people who have used Audacity all these years and will most likely result in a loss of users.

Most users who were led here by reddit, HN, etc. It would be more fair to survey ""the typical Audacity users"" (what telemetry does, but voluntarily). I think Audacity users care about open source, but a lot of people couldn't care less and just use it because it's free. Or maybe distro maintainers will decide whether or not to use a fork."
834229696,835,vess-dev,2021-05-07T09:58:58Z,"https://old.reddit.com/r/programming/comments/n6kxm8/psa_audacity_pr_to_add_telemetry_sharing_user/gx91j70/

> We're going to be writing up an announcement about this soon. Apologies for the delay. I just woke up to see this thread.
> 
> To calm those who are concerned, here are the facts about the telemetry PR:
> 
> The purpose is to collect app performance statistics. Most importantly, the crash rate.
> It is anonymous. There is understandable concern that this is intended to collect personal information. It really isn't.
> This has absolutely nothing to do with advertising of any kind
> It is optional. We ask users whether they will allow us to collect these statistics when the app opens. You can say 'no' and we don't ask again. We can not automatically track anything by law and wouldn't try to.
> There is nothing sneaky about our intentions here. We've been getting a few disturbing comments about crashes on large projects and we want to determine how widespread they are. It's a very useful tool to help us keep the app stable.
> 
> This message won't answer every concern raised here. We're getting on that. Just thought I'd at least let you know the basics.
> 
> edit: it is also disabled by default"
834230873,835,Frenzoid,2021-05-07T10:00:46Z,"Getting back on topic.. sorry to say but Google Analitycs and Datadog are ones of the most intrusive methods to datamine the user, the way and the ammount of data that it collects its disgustingly wide.

I honestly wouldn't feel comfortable knowing that Audacity uses it, even if there was a button to disable it."
834230959,835,phoe,2021-05-07T10:00:56Z,"> Most users who were led here by reddit, HN, etc. It would be more fair to survey ""the typical Audacity users"" (what telemetry does, but voluntarily).

Anecdotal data point: I'm a regular Audacity user and I also learned about this issue via Reddit. (I don't know if I would have learned about this in time if it wasn't for Reddit/HN.) I assume that many of the people speaking in this thread actually use the application instead of participating in storms about applications they don't even use or haven't seen them used themselves."
834231964,835,TheEvilSkeleton,2021-05-07T10:02:32Z,"> Telemetry is not welcome in FOSS software, regardless of the project, and as someone who helps support a FOSS project I can tell you from my own personal experience that Telemetry is essentislly useless to most people looking to find faults with and fix bugs in software, the methods with which the data is gathered, and, the inability for that data to be understood from the users perspective mean that it is impossible to gain any useful context from Telemetry Data.

@TOGLK I understand the motive behind it but I disagree with this. While I do admit that telemetry is useless for the end user, it's *theoretically* only directly useless for them. If developers use telemetry properly, this will indirectly be useful for the end user as many more bugs will get squashed which will make it more stable and potentially faster, but that's only if developers use telemetry properly.

I'm all for FOSS telemetry. I don't like opt-in or opt-out telemetry; I prefer a prompt at first launch that asks the user if they want to enable telemetry or not, which can then be enabled or disabled in the settings depending on what you chose initially.

That being said, I'm all for FOSS telemetry. Google Analytics is something I will sincerely disagree with however."
834232432,835,CompSciOrBust,2021-05-07T10:03:16Z,"> > Currently over 99.97% of the reactions to the original commit are negative. Clearly the users are overwhelming opposed to it. If it gets added that will be a massive middle finger to people who have used Audacity all these years and will most likely result in a loss of users.
> 
> Most users who were led here by reddit, HN, etc. It would be more fair to survey ""the typical Audacity users"" (what telemetry does, but voluntarily). I think Audacity users care about open source, but a lot of people couldn't care less and just use it because it's free. Or maybe distro maintainers will decide whether or not to use a fork.

That may be the case but that doesn't mean when the average user hears about this and how it was added to Audacity anyway despite the overwhelming concerns of other developers that there won't be a loss of users, not all users, most likely not a majority of users, but it will still drive people away from the program. Are the benefits of telemetry worth that loss?"
834233129,835,jxu,2021-05-07T10:04:13Z,"

> https://old.reddit.com/r/programming/comments/n6kxm8/psa_audacity_pr_to_add_telemetry_sharing_user/gx91j70/
> 
> > We're going to be writing up an announcement about this soon. Apologies for the delay. I just woke up to see this thread.
> > To calm those who are concerned, here are the facts about the telemetry PR:
> > The purpose is to collect app performance statistics. Most importantly, the crash rate.
> > It is anonymous. There is understandable concern that this is intended to collect personal information. It really isn't.
> > This has absolutely nothing to do with advertising of any kind
> > It is optional. We ask users whether they will allow us to collect these statistics when the app opens. You can say 'no' and we don't ask again. We can not automatically track anything by law and wouldn't try to.
> > There is nothing sneaky about our intentions here. We've been getting a few disturbing comments about crashes on large projects and we want to determine how widespread they are. It's a very useful tool to help us keep the app stable.
> > This message won't answer every concern raised here. We're getting on that. Just thought I'd at least let you know the basics.
> > edit: it is also disabled by default

This response by Tantracrul misses most of the complaints people have. I am not hopeful at this stage for the Audacity team to actually listen to the feedback."
834233782,835,AlexanderBalson,2021-05-07T10:05:13Z,"This is a terrible idea, and is a crime against the values of many of your core users. Absolutely immoral."
834234012,835,IGBC,2021-05-07T10:05:30Z,I have a Distro developer telling me they are preparing a patch to remove this PR from future builds for their OS. So this is already starting to fracture the product.
834234184,835,busybox11,2021-05-07T10:05:46Z,"Why do you want telemetry this much with all these services?
They're never going to make their way into this software, move on and make your own fork of audacity with Google Analytics telemetry if you want, but keep in mind that it isn't Audacity's goal to track (not directly) its users."
834235362,835,ror6ax,2021-05-07T10:07:31Z,"Yandex, seriously? Like a KGB cyber front? Haha, try harder next time..."
834236982,835,marcan,2021-05-07T10:10:03Z,"All I will say is that after [this little gem](https://github.com/Xmader/musescore-downloader/issues/5) where, after the acquisition by Ultimate Guitar (now Muse Group), MuseScore developers threatened a developer with sending the police to their door for *using a public API* to download sheet music... I am not in the least bit surprised that their first move after taking control of Audacity would be something like this.

> Otherwise, I will have to transfer information about you to lawyers who will cooperate with github.com and Chinese government to physically find you and stop the illegal use of licensed content.

Seriously, read the whole thread for more."
834238211,835,fpesari,2021-05-07T10:12:07Z,This IMHO (and the success of programs like Blender) is the proof that FLOSS projects work best as non-profit endeavors (e.g. foundations) backed by donations. We have to change the culture so that all users realize the value of FLOSS programs they use and donate to feed the people who put their work into those programs!
834238221,835,jxu,2021-05-07T10:12:08Z,The success of a fork or a continuing series of patches depends on where the regular contributors contribute to. The same issue arose when youtube-dl got into hot water on github. Have the regular contributors made any statements yet? 
834239917,835,Be-ing,2021-05-07T10:14:55Z,"> This IMHO (and the success of programs like Blender) is the proof that FLOSS projects work best as non-profit endeavors (e.g. foundations) backed by donations. We have to change the culture so that all users realize the value of FLOSS programs they use and donate to feed the people who put their work into those programs!

Yes, take a look at Krita and Ardour for positive examples of how to fund cooperative creative software. @workedintheory I recommend you have some discussions with the developers of those software about how they make it work in practice."
834240262,835,MayorUshanka,2021-05-07T10:15:29Z,"> every time someone clicks ""Comment"" about 200 people get an email.

Good. Telemetry is not wanted.
"
834240416,835,Coding-Boon,2021-05-07T10:15:48Z,pls never merge this.
834241743,835,ghost,2021-05-07T10:17:54Z,"this is a horrible, horrible idea"
834241794,835,lpcvoid,2021-05-07T10:17:58Z,"It really is a bad omen if the first thing that MuseScore does is implement user tracking using Google, of all things."
834242208,835,ivanka2012,2021-05-07T10:18:36Z,"> Polite reminder this is GITHUB, not your local discord server. Please keep discussions on topic, and ensure every new post adds to the discussion. As a further reminder every time someone clicks ""Comment"" about 200 people get an email.

What's the point of being constructive? This is garbage pull request, the points have been made, and now the only thing left is to get those points across."
834242882,835,Gamewizard,2021-05-07T10:19:42Z,"I am as an end user firmly in the camp this pull request should be rejected as one it raises serious privacy concerns and two it will cause a fork. If something like this is allowed in can I trust the Audacity team any more? Because from where I'm standing I can not and this is coming from a long time user that has used Audacity in a professional context and suggested it to other people over the years.  The fact parts of the code are obviously obfuscated to hide what they actually do and where they are sending data is worrying especially with the fact we know there are actors out there trying to initiate supply chain attacks on OSS projects. 

EDIT: One thing I forgot to mention is I have no issue with some telemetry per say it's more the providers being used to process it as I know Google has been caught in the past intentionally trying to link 3rd part apps and services using their analytics to their user tracking database.  I do believe a better solution can be found with a little time with the greater community. "
834243297,835,ghost,2021-05-07T10:20:21Z,yay another fork and revert 
834243310,835,jxu,2021-05-07T10:20:22Z,"> It really is a bad omen if the first thing that MuseScore does is implement user tracking using Google, of all things.

It's true. I haven't seen a single UX improvement yet."
834244565,835,Be-ing,2021-05-07T10:22:25Z,"> The fact parts of the code are obviously obfuscated to hide what they actually do

The Audacity code is not obfuscated. It's right here in this pull request, have a look yourself if you want. Multiple people have already. However, the code running on the servers this data is sent to *is* proprietary."
834244660,835,NayamAmarshe,2021-05-07T10:22:36Z,Please no. Thank you.
834245011,835,Eschryn,2021-05-07T10:23:14Z,The telemetry should be put behind a define so one could compile Audacity without telemetry. Opt In after compiling it and optional in the compilation process.
834250046,835,js-j,2021-05-07T10:31:21Z,"This is an awful idea. At least you could have tried to implement it in some non-google, open-source way. If this gets accepted, you are losing me as a devoted Audacity user. Please do not continue with these efforts."
834253599,835,dgurney,2021-05-07T10:37:19Z,"Umpteenth user chiming in: the issue is not telemetry, it's the provider used. I am happy to provide telemetry data, so long as the telemetry infrastructure is open source and hosted by Audacity. A black box is unacceptable in free and open-source software."
834254283,835,cbun1123,2021-05-07T10:38:23Z,"""Additionally, this pull request comes with a set of libraries to help the future efforts on Audacity.""
Putting sugar on crap doesn't make it not crap."
834254661,835,Eschryn,2021-05-07T10:39:01Z,"> Umpteenth user chiming in: the issue is not telemetry, it's the provider used. I am happy to provide telemetry data, so long as the telemetry infrastructure is open source and hosted by Audacity. A black box is unacceptable in free and open-source software.

Maybe making it viewable for everyone would also help? Because that way everyone knows transparently whats being collected + independend devs can also use that data for improving the software."
834255149,835,nuenuewei,2021-05-07T10:39:47Z,"People really going ""these people came here from reddit, they're not real users"" when the merge request calls the program ""the audacity"" like some geezer calling their grandkids' favorite game ""the pokemon"""
834257435,835,Eschryn,2021-05-07T10:43:32Z,"> People really going ""these people came here from reddit, they're not real users"" when the merge request calls the program ""the audacity"" like some geezer calling their grandkids' favorite game ""the pokemon""

That they had _the audacity_ to do this 🤪 (sorry I couldn't help myself)"
834257470,835,bonecountysheriff,2021-05-07T10:43:36Z,"It will be the ""Vital vs Vitalium"" situation all over again. An audio editing tool is an audio editing tool, not something that connects to your toaster and short-circuits it.

But if you're butt-tight about telemetry, how about using something like [plausible](https://plausible.io/) instead of Google analytics? Plausible is open source and can be self hosted."
834258121,835,Builder999,2021-05-07T10:44:39Z,I wouldn't care a lot about this but it is using Google analytics. No just no. 
834260386,835,fpesari,2021-05-07T10:47:55Z,"> Umpteenth user chiming in: the issue is not telemetry, it's the provider used. I am happy to provide telemetry data, so long as the telemetry infrastructure is open source and hosted by Audacity. A black box is unacceptable in free and open-source software.

Even if the infrastructure is FLOSS, once your data leaves your computer you have no control over it. Audacity's servers could still send it to other servers owned by ad companies. My question is: since Muse Group is a for-profit company and it decided to buy Audacity, which is clearly an offline program, why did they buy it? What is their proposed business model?"
834260813,835,Issung,2021-05-07T10:48:33Z,bruh
834261093,835,PureIncompetence,2021-05-07T10:48:57Z,"And this, dear viewers, is the first step of a formerly very popular foss software into irrelevance.
Fair well, it was a good time before it stopped being Free and Libre Open Source software."
834261239,835,jxu,2021-05-07T10:49:11Z,"> People really going ""these people came here from reddit, they're not real users"" when the merge request calls the program ""the audacity"" like some geezer calling their grandkids' favorite game ""the pokemon""

Muse Group developers appear to be located in Russia. I wouldn't hassle them over English usage"
834262567,835,IGBC,2021-05-07T10:51:01Z,"> Umpteenth user chiming in: the issue is not telemetry, it's the provider used. I am happy to provide telemetry data, so long as the telemetry infrastructure is open source and hosted by Audacity. A black box is unacceptable in free and open-source software.

I would like to point out that I am NOT happy with any telemetry. Telemetry shows a shift from the user base being a community to being a customer base. Instead of cooperating with the community a telemetry system spies on them, and stores its findings in a database that only a handful of developers can access. This is flies in the face of the fundamental goals of free open source software that anyone can contribute and all project materials are freely available."
834263257,835,Frenzoid,2021-05-07T10:52:09Z,"I think its clear that most of us don't like this PR, can we finally agree on that and cancel this PR?

![image](https://user-images.githubusercontent.com/30338644/117439179-d283a300-af32-11eb-84db-f86f2695ac04.png)


Worst case scenario, we can always make a fork if people want to keep using it without the proposed changes."
834263753,835,falkTX,2021-05-07T10:52:57Z,"To all people complaining here, MuseScore already includes google analytics.
https://github.com/musescore/MuseScore/tree/master/thirdparty/qt-google-analytics

So they likely already have a working setup with GA, it makes sense (for them, on their side) to use the same setup once again.

I think complaining here will do nothing. They will merge this and just wait for the storm to die out as usual.
"
834264437,835,Eschryn,2021-05-07T10:54:01Z,"

> To all people complaining here, MuseScore already includes google analytics.
> https://github.com/musescore/MuseScore/tree/master/thirdparty/qt-google-analytics
> 
> So they likely already have a working setup with GA, so make sense (for them, on their side) to use the same setup once again.
> 
> I think complaining here will do nothing. They will merge this and just wait for the storm to die out as usual.

I think it still makes sense to put it behind a define - maybe even making the data public - its open source after all (but especially not using Google or Yandex would help)"
834264968,835,jxu,2021-05-07T10:54:53Z,"> I think its clear that most of us don't like this PR, can we finally agree on that and cancel this PR?

The people who can do that are project maintainers and members i.e. the people who have permissions to for this repo."
834265106,835,wiltaylor,2021-05-07T10:55:04Z,This was a dumb idea. It is just going to mean the project gets forked and the developers move.
834266533,835,IGBC,2021-05-07T10:56:32Z,"> I think its clear that most of us don't like this PR, can we finally agree on that and cancel this PR?
> 
> `<image snipped>`
> 
> Worst case scenario, we can always make a fork if people want to keep using it without the proposed changes.



> bruh


> I don't like you.

Polite reminder this is GITHUB, not your local discord server. Please keep discussions on topic, and ensure every new post adds to the discussion. As a further reminder every time someone clicks ""Comment"" about 200 people get an email.

@Frenzoid  @CristhianCC  Final warning both of you before you get passed up to the GitHub Moderation team


"
834266651,835,bonecountysheriff,2021-05-07T10:56:42Z,"@falkTX, so is distrho ports going to have a new addition?"
834267150,835,DatanoiseTV,2021-05-07T10:57:27Z,"I agree, terrible idea. I will use a fork."
834267598,835,nprintf,2021-05-07T10:58:08Z,Regular users shouldn't have their data unsolicitedly sent to servers.
834268241,835,cloud11665,2021-05-07T10:58:56Z,we engage in subtle ammounts of tomfoolery
834268677,835,falkTX,2021-05-07T10:59:33Z,"> @falkTX, so is distrho ports going to have a new addition?

distrho-ports is for juce plugins, not this.

for open-source and linux distributions in general, the best we can do for audacity is de-vendor the dependencies as much as possible.
the custom modifications to wxwidgets are particularly hard to deal with for packaging #625"
834270606,835,IGBC,2021-05-07T11:02:27Z,"> To all people complaining here, MuseScore already includes google analytics.
> https://github.com/musescore/MuseScore/tree/master/thirdparty/qt-google-analytics
> 
> So they likely already have a working setup with GA, it makes sense (for them, on their side) to use the same setup once again.
> 
> I think complaining here will do nothing. They will merge this and just wait for the storm to die out as usual.

Well if true that's that. Time of death May 2021, age 22 years."
834270741,835,mkg20001,2021-05-07T11:02:40Z,"For error reporting a good alternative could be sentry.io, as it's opensource and has way better tools for catching errors.

For tracking there's always matomo.org, which is also opensource."
834271482,835,Yethiel,2021-05-07T11:03:29Z,"Please do not add telemetry to Audacity. I do not like the idea in general but using Google makes this even worse.
Maybe use polls and surveys to find out how people are using the program. I'm 1000 times more willing to fill out a survey than passively provide use information. I'm sure many other people feel the same, especially since this is open source software that people are inclined to trust more than proprietary software."
834271796,835,CristhianCC,2021-05-07T11:03:58Z,"> 
> 
> > > Where am i?
> > 
> > 
> > The place from where it all went down :(
> > @CristhianCC and me :D
> > ![image](https://user-images.githubusercontent.com/30338644/117431827-f7274d00-af29-11eb-94ed-1162cd2a4e62.png)



> 
> 
> > To all people complaining here, MuseScore already includes google analytics.
> > https://github.com/musescore/MuseScore/tree/master/thirdparty/qt-google-analytics
> > So they likely already have a working setup with GA, it makes sense (for them, on their side) to use the same setup once again.
> > I think complaining here will do nothing. They will merge this and just wait for the storm to die out as usual.
> 
> Well if true that's that. Time of death May 2021, age 22 years.

Polite reminder this is GITHUB, not your local discord server. Please keep discussions on topic, and ensure every new post adds to the discussion. As a further reminder every time someone clicks ""Comment"" about 200 people get an email.

@IGBC Final warning before you get passed up to the GitHub Moderation team"
834274230,835,crsib,2021-05-07T11:07:37Z,"Dear all,

We have updated the PR description to clarify what is going on."
834274809,835,Frenzoid,2021-05-07T11:08:33Z,"I think its quite clear that people dont like this PR, as for this topic, as i said before, its gotten out of hands.

People already said more than 10 times that noone wants these changes, and the fact that it doesnt stop says alot about the progression of this topic.

Its gotten to the point where the conclusion of the topic is more than clear, and theres nothing else to add that could change the mind of the users.

The topic should be closed at this point, you wanted a feedback for this PR, and you got it.



Not meant to be rude with this message, but the topic started deviating from the original subject long ago."
834277206,835,Eschryn,2021-05-07T11:12:24Z,"> Dear all,
> 
> We have updated the PR description to clarify what is going on.

If this is absolutely necessary - what about at least making the data public (anonymized) and using open-source tools?"
834277830,835,kernelzeroday,2021-05-07T11:13:21Z,Please do not add telemetry to this project.
834278044,835,falkTX,2021-05-07T11:13:43Z,"> Dear all,
> 
> We have updated the PR description to clarify what is going on.

The updated description states:

> We will consider replacing Google and Yandex with another service if we find one that fulfills our requirements - thanks for the suggestions and keep them coming.

As-is, going with GA is crossing a line many people here expressed not being okay with.

I am personally not okay with any kind of analytics, but if it really has to happen without question, FFS do not use Google.
The fact that we even need to state this makes me lose hope on the development process of the team behind Audacity.
"
834280099,835,IGBC,2021-05-07T11:16:48Z,">     2\. Telemetry only works in the builds made by GitHub CI from the official repo (the telemetry URLs are only defined there).

This will essentially erase all users of your software not using Windows or MacOS, as most UNIXes rebuild the software on their own servers which will automatically exclude them from your statistics. With an automatic measurement bias such as this how do you expect to extract meaningful information from this move, without punishing users on platforms that are not supporting your telemetry?"
834280769,835,kreha1,2021-05-07T11:17:45Z,"> Regular users shouldn't have their data unsolicitedly sent to servers.

Please fully read the PR comment:
`Telemetry is strictly optional and disabled by default. No data is shared unless you choose to opt-in and enable telemetry. `.

I don't know, do you cry over the fact that when Firefox crashes you can send crash info back to Mozilla?"
834280783,835,Torsteinws,2021-05-07T11:17:47Z,Please don't merge this. I don't want to share my data – especially not with a google service.
834280938,835,Be-ing,2021-05-07T11:18:00Z,"I agree with @falkTX. I would like to see a clear, unambiguous commitment now that you will *not* use Google Analytics *nor* Yandex. To quote [KDE's Telemetry Policy](https://community.kde.org/Policies/Telemetry_Policy):

> Privacy always trumps any need for telemetry data, no matter how legitimate.

I understand it will take some time to evaluate the various alternatives that have been proposed and decide on one. If none fulfill everything you wanted, then continuing with Google Analytics and/or Yandex is still not acceptable."
834282036,835,sandycorzeta,2021-05-07T11:19:51Z,"Even its disabled by default, the fact that it use GA and Yandex as first start is still disappointing. Should have choose the free open source analytics one if still insisting doing telemetry"
834282994,835,iambastian,2021-05-07T11:21:20Z,"> Telemetry is strictly optional and disabled by default.

So on the prompt window the button for sending telemetry is pretty much highlighted. Yet you state, that it is disabled by default. It makes no sense to me. "
834283058,835,IGBC,2021-05-07T11:21:26Z,"> Due to the large amount of worry about this PR

Nah you have mistaken worry for anger"
834283808,835,ftpmorph,2021-05-07T11:22:35Z,"> My question is: since Muse Group is a for-profit company and it decided to buy Audacity, which is clearly an offline program, why did they buy it? What is their proposed business model?

My guess? Make an ad filled mobile app with a paid ""premium version"" to remove the ads and slowly turn Audacity itself into a ""cloud based music creation platform"" with a subscription fee."
834284738,835,exore13,2021-05-07T11:24:00Z,"![imagen](https://user-images.githubusercontent.com/45803478/117442748-78391100-af37-11eb-8d71-7670d053cbf7.png)
"
834285264,835,collinalexbell,2021-05-07T11:24:48Z,Is this a joke?
834285554,835,TheBeardOfTruth,2021-05-07T11:25:16Z,"I'm not a fan of telemetry in general, especially for a fully offline application.

But my biggest concern lies with google and yandex, these are not privacy conscious companies nor do you have any control over how they use the data. (That's, of course, assuming the telemetry remains opt-in by default and that the behavior never changes, this seems unlikely to me seeing how this industry tends to operate so I'm strongly against it in general).

Notably this prompts the question ""how is this going to change over time?""
Is it going to become mandatory in five years? Is it going to then expand in scope? 

I suspect I'm not the only one finding this development concerning in both the short and long term."
834286641,835,joepie91,2021-05-07T11:26:52Z,"> Telemetry is strictly optional and disabled by default. No data is shared unless you choose to opt-in and enable telemetry.

FYI, while opt-in is a good thing, the interface in the screenshot *still* violates the GDPR - it makes the ""accept"" option more visually attractive, which is not allowed. The accept and reject options must be presented on equal footing, without using 'dark patterns' like attractive colors for the accept button or extra-convincing label text.

Edit: It also doesn't mention *where* it is sending the data to, which is dubious under the GDPR at best."
834287482,835,sandycorzeta,2021-05-07T11:28:05Z,"> > Telemetry is strictly optional and disabled by default.
> 
> So on the prompt window the button for sending telemetry is pretty much highlighted. Yet you state, that it is disabled by default. It makes no sense to me.

Yeah this is concerning too. If they ship it into macOS also, should it have to be the ""Dont Send"" button that should be highlighted? because what i know about Apple ecosystem is they designed it like that and giving no option to tracking."
834287964,835,JShorthouse,2021-05-07T11:28:45Z,"> Most users who were led here by reddit, HN, etc. It would be more fair to survey ""the typical Audacity users"" (what telemetry does, but voluntarily). I think Audacity users care about open source, but a lot of people couldn't care less and just use it because it's free. Or maybe distro maintainers will decide whether or not to use a fork.

I am very sick of this mentality to be very honest.

It is precisely us that should be opposing these changes. As developers we have the responsibility to fully understand the technical and ethical implications of such things and stick up for software users that are less informed than us - users that place all their trust in us.

When I go to the store to buy food I expect it not to contain poison because I trust that the experts in that industry have my best interests in mind, and have protected me against things that I may not know about. ""We can put telemetry in this software and the users will not realise"" is just as true as ""We can put poison in our food and the customer will probably not realise from the ingredients list""."
834288438,835,kernelzeroday,2021-05-07T11:29:26Z,"> > Telemetry is strictly optional and disabled by default. No data is shared unless you choose to opt-in and enable telemetry.
> 
> FYI, while opt-in is a good thing, the interface in the screenshot _still_ violates the GDPR - it makes the ""accept"" option more visually attractive, which is not allowed. The accept and reject options must be presented on equal footing, without using 'dark patterns' like attractive colors for the accept button or extra-convincing label text.
> 
> Edit: It also doesn't mention _where_ it is sending the data to, which is dubious under the GDPR at best.

bump bump bump"
834289490,835,collinalexbell,2021-05-07T11:30:52Z,"> Most users who were led here by reddit, HN, etc. It would be more fair to survey ""the typical Audacity users"" 

These are the typical Audacity users. Audacity users are almost a complete subset of reddit & HN users."
834291949,835,j0lol,2021-05-07T11:33:53Z,"![image](https://user-images.githubusercontent.com/24716467/117443386-f98ca580-af2f-11eb-85d6-67932de378d3.png)
Please make ""Don't send"" the default option, or don't specify a default option. "
834292300,835,h0jeZvgoxFepBQ2C,2021-05-07T11:34:25Z,Don't merge this please.
834292364,835,dvzrv,2021-05-07T11:34:33Z,"> To address the concerns about use of private library versions, the largest part of this pull request is a networking layer built on  top of libcurl. This library is chosen as it is an industry-standard for cross-platform networking. It is exceptionally tested and reviewed by industry experts.

In your clarifications you do not address the security implications that you introduce with vendoring an out-of-date and unpatched version of curl though (which would be the case for macOS and Windows users). Do you plan on releasing every time libcurl has a release? How do you envision to do security advisory tracking?

> The layer on top of it, aka lib-network-manager meant to simplify the development of future features. libcurl is used without any patches. It is possible to use the system-provided version of the library available on the Linux distributions, and we will double-check that this works as expected.

Opening an application to the internet like this is non-trivial and unnecessary attack surface.
The above leads me to the conclusion, that `lib-network-manager` will be used not only for telemetry in the future and I find this very worrying, as this means that while the user can opt-out of telemetry, a vendored libcurl would still be used to talk to e.g. a web shop or whatever it is you envision to do with it.

That thinking about the topic of ""how to build this sanely on a Linux distribution"" came after the fact makes me not very hopeful, that issues with the build system, such as #625 will ever be resolved."
834292659,835,dhoepfl,2021-05-07T11:34:58Z,"The confirmation dialog says:

> We <u>do not</u> collect any personal data or sensitive information such as location or file names or any content of your audio.

… when at the same time the pull request says …

> * Errors, including errors from the sqlite3 engine, as we need to debug corruption issues reported on the Audacity forum
>
> …
> To identify sessions we use a UUID, which is generated and stored on the client machine.
> …
> Both services also record the IP the request is coming from.

So, errors reported “anonymously” can be matched with forum users. Great.

> * Session start and end
>
> …
> We use Yandex Metrica to be able to correctly estimate the daily active users correctly. We have to use the second service as Google Analytics is known to have some really tight quotas.

If you use Yandex to get daily usage, why do you need session start time? If you want to get session duration, why record start/end? Can you name a single feature that would benefit from usage duration information?

> We have to use the second service as Google Analytics is known to have some really tight quotas.

Why would you use GA then?
"
834292886,835,Ph0rk0z,2021-05-07T11:35:17Z,"If this is merged I'm off official builds. I'm sure someone will be providing binaries off here that have the telemetry disabled at compile time.

In the end I have outgoing firewalls on everything anyway and block requests by default. Funny that the first thing you do when audacity is bought out is an unpopular ""feature"" 1/2 the user base is against."
834292989,835,falkTX,2021-05-07T11:35:24Z,"I think Audacity can still come out on top and get back users trust if it closes this PR on the short-term.
The longer this PR is left open, the more people will be outraged and stop using it altogether.

At some point the shitstorm is not worth it.
Only if there are deeper plans for more ""modern"" practices coming after this, which I really, really hope it is not the case.

Please close this PR and show you care about yours users."
834294100,835,ShadowJonathan,2021-05-07T11:37:09Z,"If audacity is going to add telemetry, I’d at least suggest using [matomo ](https://matomo.org/) instead of privacy-unfriendly solutions like Google analytics and similar."
834294589,835,kernelzeroday,2021-05-07T11:37:52Z,"> I think Audacity can still come out on top and get back users trust if it closes this PR on the short-term.
> The longer this PR is left open, the more people will be outraged and stop using it altogether.
> 
> At some point the shitstorm is not worth it.
> Only if there are deeper plans for more ""modern"" practices coming after this, which I really, really hope it is not the case.
> 
> Please close this PR and show you care about yours users.

nah this team will never again be trusted by anyone for anything ever again"
834294625,835,IGBC,2021-05-07T11:37:55Z,"completely off topic but @falkTX are you the guy who makes cadence? If so I really wanna talk to you about the world of jack mangers, you can find ways of contacting me in my bio.

"
834294633,835,Be-ing,2021-05-07T11:37:56Z,"> Can you name a single feature that would benefit from usage duration information?

I would like an answer to this as well. I cannot imagine any way this helps Audacity developers improve the software for users. It only seems intrusive for no benefit."
834295929,835,mbrucher,2021-05-07T11:39:48Z,"Hum... I guess, I'm not going to be using not recommending Audacity anymore."
834296467,835,jowsey,2021-05-07T11:40:38Z,"> nah this team will never again be trusted by anyone for anything ever again

@kernelzeroday You seem to have a habit of thinking you speak for everyone. Your views are quite extreme and I'd prefer if you stopped assuming everyone was as hate and spite-filled as yourself. I'm sure we'd all prefer to come to a respectful middle-ground. 

Edit: I see the irony in saying ""I'm sure we'd all..."" after talking about speaking for everyone. To rephrase, I believe it'd be _better_ for everyone, whether everyone would prefer that or not."
834297698,835,kernelzeroday,2021-05-07T11:42:28Z,"> > nah this team will never again be trusted by anyone for anything ever again
> 
> @kernelzeroday You seem to have a habit of thinking you speak for everyone. Your views are quite extreme and I'd prefer if you stopped assuming everyone was as hate and spite-filled as yourself. I'm sure we'd all prefer to come to a respectful middle-ground.

I sure do buddy and I'll say it again, they fucked up here. If you genuinely think anyone can ever recover from this i have a bridge to sell you"
834298872,835,IGBC,2021-05-07T11:44:02Z,"> > nah this team will never again be trusted by anyone for anything ever again
> 
> @kernelzeroday You seem to have a habit of thinking you speak for everyone. Your views are quite extreme and I'd prefer if you stopped assuming everyone was as hate and spite-filled as yourself. I'm sure we'd all prefer to come to a respectful middle-ground.
> 
> Edit: I see the irony in saying ""I'm sure we'd all..."" after talking about speaking for everyone. To rephrase, I believe it'd be _better_ for everyone, whether everyone would prefer that or not.

Don't worry I flagged his first comment for ""hate speech"" ""inciting violence"" and ""directed threats"" already. An impressive number of rule violations in a single post I might add."
834299889,835,IGBC,2021-05-07T11:45:27Z,"> > > nah this team will never again be trusted by anyone for anything ever again
> > 
> > 
> > @kernelzeroday You seem to have a habit of thinking you speak for everyone. Your views are quite extreme and I'd prefer if you stopped assuming everyone was as hate and spite-filled as yourself. I'm sure we'd all prefer to come to a respectful middle-ground.
> > Edit: I see the irony in saying ""I'm sure we'd all..."" after talking about speaking for everyone. To rephrase, I believe it'd be _better_ for everyone, whether everyone would prefer that or not.
> 
> Don't worry I flagged his first comment for ""hate speech"" ""inciting violence"" and ""directed threats"" already. An impressive number of rule violations in a single post I might add.

Incidentally I did this despite us being on the same side of the argument. that sort of conduct is not good for anyone involved. Just cos we don't like a software decision doesn't mean death threats are justified."
834302222,835,Geofferey,2021-05-07T11:48:48Z,Adding telemetry is a useless act when nearly all your users (Linux distros) are gonna compile from source and create their own packages or downright disable it. All you are doing is shattering peoples faith. You obviously do not care about the previous user base of this application when  you have decided to include telemetry that a majority has clearly expressed they don't want. Who cares if you disabled it by default? In the end you are still leaving room for an opt-out scenario in the future and even more data gathering.  When a company owns a piece of software these things are added for improving your profit not the users experience. 
834305897,835,Tataarujin,2021-05-07T11:53:40Z,"Whew, what a drama. I remember participating in another one, don't remember which one, got a lot of fun. 
crsib is a master troll, CristhianCC and IGBC are your typical github moderation team pet lapdogs.

I just hope Audacity will stay as it is, open source and free for everyone and from any kind of telemetry (which is used for selling to advertisers, not for improving software) and that this topic will never be brought back."
834307609,835,transiient,2021-05-07T11:55:59Z,"This is ridiculous. **It is disabled by default and if you don't want to use it, you can keep it disabled.**

Though I have to agree with some people - you should probably use open source/FOSS analytics tools instead."
834308489,835,CristhianCC,2021-05-07T11:57:11Z,"> 
> 
> Whew, what a drama. I remember participating in another one, don't remember which one, got a lot of fun.
> crsib is a master troll, CristhianCC and IGBC are your typical github moderation team pet lapdogs.
> 
> I just hope Audacity will stay as it is, open source and free for everyone and from any kind of telemetry (which is used for selling to advertisers, not for improving software) and that this topic will never be brought back.

At least, mention me when you talk about me. And thank you, nobody told me i was a pet lapdog, that's kinda flattering. @Tataarujin"
834308821,835,ftpmorph,2021-05-07T11:57:38Z,"> > Can you name a single feature that would benefit from usage duration information?
> 
> I would like an answer to this as well. I cannot imagine any way this helps Audacity developers improve the software for users. It only seems intrusive for no benefit.

It's the type of information advertisers like to see when negotiating how much they'll pay for ad placement."
834309061,835,adryzz,2021-05-07T11:57:56Z,"imo, if you REALLY want to add telemetry, you should add it like this:

- Log locally

- At a successful restart delete the data

- At a successful restart after a crash, ask to send it, and then delete it locally."
834309382,835,j0lol,2021-05-07T11:58:24Z,"Not sure about others, but I for one would prefer to fill in a survey than telemetry. (I will always opt out of telemetry.) Please provide ways for the user to talk about the program instead!"
834309868,835,IGBC,2021-05-07T11:59:04Z,">  IGBC are your typical github moderation team pet lapdogs.

At your service. I do enjoy a good FOSS food fight. Looks like this has just gone back to draft, so I guess we got through to them. Or they got sick of getting 100 emails an hour.

Good work everyone."
834310722,835,Nex4rius,2021-05-07T12:00:21Z,"> 
> 
> This is ridiculous. **It is disabled by default and if you don't want to use it, you can keep it disabled.**

In 6 months its gonna change from disabled by default to enabled and people will be like: ""What are you mad about you can disable it?"".
6 months after that the option will disappear and people are like ""Who cares it wasn't even the default option"".

DO NOT add tracking for an OFFLINE ONLY application."
834311616,835,Voltra,2021-05-07T12:01:41Z,Imagine wanting to edit some audio files and suddenly you have 14 HTTP requests sent out a minute (optimistic I guess)
834312076,835,Frenzoid,2021-05-07T12:02:23Z,"> > IGBC are your typical github moderation team pet lapdogs.
> 
> At your service. I do enjoy a good FOSS food fight. Looks like this has just gone back to draft, so I guess we got through to them. Or they got sick of getting 100 emails an hour.
> 
> Good work everyone.

Yeah, finally, after repating the same thing, and reading the same ""we don't like this PR"" for the 100th time. Its true that the topic deviated, but thats just because everyone were TIRED of repeating themselves.

People have to learn to noticed when something like this happends during a conversation.
Cause when that happends, you stop add anything of value to the conversation."
834312378,835,richardk2016,2021-05-07T12:02:49Z,"The mere existence of Google Analytics in the code is already a violation of the GDPR in the EU. The fact that the software is used in education and schools makes it even more problematic. Even more critical is the fact that the tracking could also capture the data of minors. Anyone (admin or school board responsible) who makes the software available unchecked and explicitly approved (in each individual institution) even just makes himself liable to prosecution under certain circumstances. She (or he) risks a fine and the loss of his job. If you want to see the software disappear into insignificance within a very short time, stay on this path. I work for a school board and - for my own self-protection alone - I will suggest to my superiors that the software be banned immediately in all schools in the state if there is a risk that it MAY contain unlawful tracking. "
834312884,835,ghost,2021-05-07T12:03:26Z,Can't wait to be arrested for using Audacity in the EU.
834313509,835,IGBC,2021-05-07T12:04:18Z,"> > > IGBC are your typical github moderation team pet lapdogs.
> > 
> > 
> > At your service. I do enjoy a good FOSS food fight. Looks like this has just gone back to draft, so I guess we got through to them. Or they got sick of getting 100 emails an hour.
> > Good work everyone.
> 
> Yeah, finally, after repating the same thing, and reading the same ""we don't like this PR"" for the 100th time. Its true that the topic deviated, but thats just because everyone were TIRED of repeating themselves.
> 
> People have to learn to noticed when something like this happends during a conversation.
> Cause when that happends, you stop add anything of value to the conversation.

nah I am only telling people off for posting memes or harrassing other users. Thankfully not much of that today."
834314365,835,TheStranjer,2021-05-07T12:05:31Z,"So if they put this in, who is going to maintain the Audacity fork that lacks telemetry, but is otherwise the same?"
834315186,835,eunakria,2021-05-07T12:06:34Z,"> * At a successful restart after a crash, ask to send it, and then delete it locally.

@adryzz Thing is, that's crash reporting, not telemetry. Crash reporting is still immensely useful, and Audacity's also considering adding it via Breakpad. Telemetry is collecting information about platform, high-level usage context and performance, to help understand how the software is running when everything is working, rather than why it's failed when it has failed.

Telemetry is easier to argue shouldn't be present at all. Crash reporting is way easier to justify. I mentioned before that I find telemetry super useful for my own software, and I don't mind Audacity adding it; they should just be conscious about privacy, more so than they are right now by sending the data off to Google and Yandex.

Otherwise, I totally agree with you."
834315749,835,Tataarujin,2021-05-07T12:07:17Z,"> So if they put this in, who is going to maintain the Audacity fork that lacks telemetry, but is otherwise the same?

Someone who will have the _audacity_ to fork it.

I'll see myself off."
834316288,835,adryzz,2021-05-07T12:07:57Z,"> So if they put this in, who is going to maintain the Audacity fork that lacks telemetry, but is otherwise the same?

i mean it doesn't take much to cherry pick commits to merge..."
834316838,835,Frenzoid,2021-05-07T12:08:37Z,"> > > > IGBC are your typical github moderation team pet lapdogs.
> > > 
> > > 
> > > At your service. I do enjoy a good FOSS food fight. Looks like this has just gone back to draft, so I guess we got through to them. Or they got sick of getting 100 emails an hour.
> > > Good work everyone.
> > 
> > 
> > Yeah, finally, after repating the same thing, and reading the same ""we don't like this PR"" for the 100th time. Its true that the topic deviated, but thats just because everyone were TIRED of repeating themselves.
> > People have to learn to noticed when something like this happends during a conversation.
> > Cause when that happends, you stop add anything of value to the conversation.
> 
> nah I am only telling people off for posting memes or harrassing other users. Thankfully not much of that today.

Thats ok, but you jump too quickly :C. Not everyone posting a meme is insantly a bad user.
Memes are a way of expressing ourselves, and can be used to point out the mood of a conversation before it escalates, its true that we are adults here, but that doesnt mean that the convesation has to be stricly formal."
834317600,835,IGBC,2021-05-07T12:09:35Z,"
> i mean it doesn't take much to cherry pick commits to merge...

This is the sort of work a lot of distros already do. In researching this PR I found that debian have been modifying audacity privately for years just to keep the damn thing working on their OS. "
834317805,835,d-damien,2021-05-07T12:09:52Z,"I can understand the desire to know users OS, as it allows indeed to support more users more effectively, but there are free/libre telemetry and helpdesk support systems.

More generally I have been thinking about the state of free/libre softwares support tooling recently. Often you will see a software great in its own field, but that uses a proprietary chat room system, forum, or telemetry. There should be more collaboration and free projects should offer support to other free projects when possible. You run a free forum ? Offer to run \<other free project\>'s forum."
834317983,835,eunakria,2021-05-07T12:10:07Z,"> So if they put this in, who is going to maintain the Audacity fork that lacks telemetry, but is otherwise the same?

@TheStranjer See the clarification of the PR. Support for telemetry is only enabled by default in the official builds. If you build from source, it won't even ask if it's okay to send data; you're safe and sound.

That said, I'm not sure if Audacity supports reproducible builds. Considering they have all their dependencies included in the main git tree, rather than as submodules or traditional dependencies, I'm a little worried about their architecture. I'm no expert with Audacity (I use it casually and have never made any contributions to it) but this kind of software tends to have certain difficulties with building cleanly and consistently.

**Edit:** It's still concerning to me that they're including intrusive telemetry, but this reply is to clarify there's an official way to disable it from builds altogether. I guess there's solace in at least that."
834318354,835,agateblue,2021-05-07T12:10:41Z,"Just wanted to share some support for the people working on this. I actually think telemetry data could prove extremely useful to understand how the software is used in the wild, and what are the potential pain points.

As long as it's opt-in, disabled by default, and there is a clear communication about what is sent, when, why and to whom, I don't think it's such big deal. And it seems to be the case.

That being said, an other backend than Google Analytics or Yandex for storing and querying the data would be nice, but hey, what good enough alternatives are available out there?"
834319269,835,TheStranjer,2021-05-07T12:11:54Z,"> > So if they put this in, who is going to maintain the Audacity fork that lacks telemetry, but is otherwise the same?
> 
> @TheStranjer See the clarification of the PR. Support for telemetry is only enabled by default in the official builds. If you build from source, it won't even ask if it's okay to send data; you're safe and sound.

@eunakria See the post on incrementalism by @Nex4rius. No ""telemetry."" Hard stop."
834319639,835,BellemareMederic,2021-05-07T12:12:25Z,You cannot said is for dev only when you plug-in Google Analytics ... This monster just snif everything you do and you don't know what its take...
834320113,835,Tataarujin,2021-05-07T12:13:06Z,"> Its where muse group's headquarters are. No malcontent to any Russians intended, I am only pointing out that makes it more likely this where that guy works.

Oh how nice. I'm another russki comrade, just freedom loving one. Gonna go and find this HQ and verbally assassinate everyone there. Wish me luck."
834322355,835,a-dows,2021-05-07T12:16:21Z,oh absolutely not
834322765,835,matu3ba,2021-05-07T12:16:53Z,"> > This is ridiculous. **It is disabled by default and if you don't want to use it, you can keep it disabled.**
> 
> In 6 months its gonna change from disabled by default to enabled and people will be like: ""What are you mad about you can disable it?"".
> 6 months after that the option will disappear and people are like ""Who cares it wasn't even the default option"".
> 
> DO NOT add tracking for an OFFLINE ONLY application.

If this gets merged and you further have to use use audacity, consider using [firejail](https://github.com/netblue30/firejail/blob/master/etc/profile-a-l/audacity.profile) to disable internet access and further restrict folder access in your $HOME. 

I dont know, why @JamesCrook @MartynShaw @Paul-Licameli and @SteveDaulton have not replied to the PRs and who has what access rights to the repo besides them. I will stop following this for now. The main devs should manage this."
834322885,835,waffshappen,2021-05-07T12:17:03Z,"Why is there a plan to send my usage data for Audacity as additional data points to an ever-growing analytics and Telemetry Monster instead of the fabled eighth magnifying glass i was promised Tantacrul?

But seriously: If you do analytics **please** selfhost it. Who has access, how long and when will it be deleted - and even better, how much will be made public so others can benefit - should be mandatory statements - as well as help compliance.

And make ""No"" the highlighted default. I know it sucks and it will lead to less users agreeing (Which effect does the close button/ESC call? Default? None?) to send usage data but that will be the most friendly, agreeable and least resistant way - plus 100% GDPR/DSGVO compliant too.

And while i value the effort to take audacity into the current century with a more consistent design after you applauded the amazing open source community please dont disappoint the same with the first action being telemetry to some of the biggest privacy violating monsters despised by FLOSS out there. We're all rooting for you to do the right thing."
834323989,835,falkTX,2021-05-07T12:18:27Z,"> @TheStranjer See the clarification of the PR. Support for telemetry is only enabled by default in the official builds. If you build from source, it won't even ask if it's okay to send data; you're safe and sound.

As a side effect from this, which was touched by others but only briefly, is that Audacity team will only receive analytics reports from a certain, very specific kind of people.
If new developments and ideas happen because of the results of these analytics, it will be focused only on these people, no way around it.
"
834324064,835,alex-tee,2021-05-07T12:18:33Z,">The only thing software like this needs to collect is when errors occur and crash logs happen, at which point a popup should display at the end of the session or on crash letting them see the log that's about to be sent and asking if they want to report it.

this is how Zrythm does it

![Screenshot from 2021-05-07 13-17-06](https://user-images.githubusercontent.com/3407655/117448316-7fabea80-af36-11eb-8012-b196fab42784.png)

example bug report that gets generated:
https://todo.sr.ht/~alextee/zrythm-bug/507"
834324398,835,ITotalJustice,2021-05-07T12:19:01Z,"> imo, if you REALLY want to add telemetry, you should add it like this:
> 
> * Log locally
> * At a successful restart delete the data
> * At a successful restart after a crash, ask to send it, and then delete it locally.

This is by far the best way. Bonus points for making the logs easy and intuitive to find so the average user can participate in submitting bugs with logs."
834326198,835,collinalexbell,2021-05-07T12:21:13Z,"@ITotalJustice I really like the log local, ask to send approach. I personally would like to see what type of data is being sent as well... There could even be a ""Always send"" option that will cause a window to pop up that announces it is sending the data (along with an option to opt out of the ""Always send"" mode), but otherwise just works in the background."
834328822,835,eunakria,2021-05-07T12:24:34Z,"> @eunakria See the post on incrementalism by @Nex4rius. No ""telemetry."" Hard stop.

@TheStranjer The idea of this being a slippery slope itself seems preposterous to me - as much as you might want to assure yourself with it, companies and projects are not inherently disposed to become evil once they get big. Again, I don't support the way Audacity is implementing telemetry, but I know how useful it can be as someone who includes it in my own software.

*I'm not interested in any profit incentive;* I would leave it out if I didn't gain anything from it. But knowing who my users are and how well my software is performing for them, is incredibly helpful. I expect Audacity feels the same about this.

Google and Yandex software range from cheap to free and are super easy to integrate, but they are ethical monstrosities. I've already spoken against the inclusion of any link to their platforms in Audacity. However, I believe telemetry can absolutely be done ethically and productively.

Being able to gauge Audacity's user base will greatly help them as a platform, I believe, and to this extent, I'll support them. What's so evil about knowing how many users you have and how generally they use your software? It's not going to spiral out of control."
834330448,835,ledoge,2021-05-07T12:26:43Z,">We will consider replacing Google and Yandex with another service if we find one that fulfills our requirements - thanks for the suggestions and keep them coming.

This is ridiculous. Your response to hundreds of users telling you they don't want their data to be shared with the privacy nightmare that is Google shouldn't be ""we'll replace it only if we can find something better"". If you can't find a solution for telemetry that the userbase can be happy with, like KDE's approach, then you shouldn't add telemetry at all. The fact that you're even considering adding Google Analytics at this point clearly shows that you aren't taking this feedback seriously. If you don't do a complete 180 on this, I expect that there'll be a fork that'll split the community."
834330522,835,JShorthouse,2021-05-07T12:26:49Z,">I actually think telemetry data could prove extremely useful to understand how the software is used in the wild, and what are the potential pain points.

How about they just ask their users instead? Like how we found out people's opinions on things for the entirety of human history?

Telemetry is invasive, anti-social, underhanded, and not even an effective tool. No amount of numbers and statistics is ever going to tell you *why* people are doing a certain thing or how they feel using your software. ""90% of people are using this feature"" is completely meaningless when you have no idea if they're pulling their hair out and punching the wall the entire time they're using it."
834330976,835,ghost,2021-05-07T12:27:25Z,"> 
> 
> imo, if you REALLY want to add telemetry, you should add it like this:
> 
>     * Log locally
> 
>     * At a successful restart delete the data
> 
>     * At a successful restart after a crash, ask to send it, and then delete it locally.

THIS. Or at the very least, use a self-hosted, open-source telemetry platform. Not Google Analytics...

I completely understand how this data _could_ be useful to improve Audacity, and I want to assume good faith here. But this is not the way."
834331427,835,ze0ss,2021-05-07T12:27:59Z,"This gets an absolutely big NO from me and almost all other audacity users in this thread, pretty unanimous."
834332998,835,collinalexbell,2021-05-07T12:30:01Z,People will be mentioning this PR for a decade in discussions about telemetry. We are witnessing history here folks.
834333609,835,TheStranjer,2021-05-07T12:30:47Z,"> The idea of this being a slippery slope itself seems preposterous to me

@eunakria If you think foresight is preposterous then that's a you problem."
834340845,835,evrial,2021-05-07T12:39:28Z,"While this thread not locked, hello there!"
834341873,835,marcopavanello,2021-05-07T12:40:41Z,"You don't need to implement telemetry to make better software, take Blender as an example, it has no telemetry and yet it's the best free and open source 3D tool available out there.
You can use community forums to ask what people need and want, report bugs, have transparent discussions etc...
Again, you don't need telemetry."
834342788,835,adolfintel,2021-05-07T12:41:46Z,"Seriously, of all the telemetry and logging solutions out there you had to use F*****G GOOGLE?

I'm not opposed to opt-in telemetry, but come on, at least come up with something that isn't google."
834344487,835,tesfabpel,2021-05-07T12:43:43Z,"I'd prefer not to have telemetry and I hope this PR gets dropped (but I'm not entirely against it if done well), but please in case DO NOT track more data than you REALLY need... You surely don't need file names, IP addresses, UUIDs, or other information that is user-identifying (maybe OS and kernel version are ok by themselves). This could be an issue with Google Analytics or Yandex (it's also not entirely clear why you have to use both, I think there are other ways to do that, maybe something like batching). I hope you'll use some analytics service that it's more privacy-oriented, in case this PR goes on...
Anyway, all Linux distributions build packages from source. Because of that and because telemetry is disabled when building from source, you likely won't receive ANY data from Linux users (I also really doubt distros' package maintainers will enable telemetry on your package) so the data you would receive will surely be incomplete."
834345307,835,mikelupe,2021-05-07T12:44:39Z,"If you take your users seriously and there's need for information about the user's system behavior, simply ask the users. Be it with polling or other services."
834346903,835,obfuscoder,2021-05-07T12:46:21Z,"To reflect on the given reasons why this feature was built in:

1. ""Audacity is widely used across several platforms, but we have no information on the application stability""

On almost all platforms it is possible to catch fatal exceptions and let the user decide whether they want to report that crash. With the permission of the user (and this permission is only for that very crash and not all crashes after that), this crash report can be sent to servers owned by the community instead of sending them to Google&co to further process them and fix the bug.

2. It is difficult for us to estimate the size of the user base accurately.

I'm not sure how this would make Audacity better. You have the download statistics. Those numbers will be significantly higher and closer to the actual user base than the number of users actually agreeing to that telemetry feature. If you want to actually know the number of users, you can ask the user ONCE during installation or start up whether they would like to let this known. Again this information should be going to community servers instead of Google&co. Apart from that, trying to know the exact user base is only good for one thing; letting investors know how much potential customers they have to milk.

3. We need a way to make informed decisions about which OS versions to support. For example, can we raise the minimum version of the macOS to 10.10 to update the wxWidgets to the latest version?

Again, download statistics can help here or an optional questionaire on the download page or once at first startup.

4. We have a known issue with the new file format introduced in Audacity 3.0. We found it with the great help of the community members on our forum. However, there is no way for us to estimate the impact of these issues on users. Is it just a random case? Do we need to rush the work on the recovery tool or help the users one by one? Or do we need to rethink the file format to make it safer and more easily recoverable?

Telemetry does not help with prioritizing bugs. Bugs are usually not visible in telemetry data as bugs have the tendency to be unaccounted for and thus there is no telemetry data to count particular bugs. After all, why adding telemetry to understand a bug, instead of ""just"" fixing it? Also the number of users watching a particular issue (or the already mentioned crash report) will give you enough hints about how important a bug is.
"
834351418,835,ccoenen,2021-05-07T12:51:23Z,"To the poeple suggesting compile-time flags and distributions taking this feature out: Great, you're looking for a solution for **you**. How about we all agree that nobody likes tracking (at best, people are *indifferent* to tracking!) and that we don't want it in any version of Audacity?

If we debate ""opt-in"" vs. ""opt-out"", we've already lost the most important battle. This feature should not be part of the code. Saving Linux builds or self-compiled builds will not be helpful to the general user base of this program. If it's in the default, precompiled windows installer, that's probably used for 60% or more of all people using Audacity. And we're debating to screw them over.

So: no tracking, please. It's not exactly complicated. Not ""opt-in"". Not ""i can compile it away, I am so smart"". No ""we're forking this"". No tracking. Period."
834354552,835,IGBC,2021-05-07T12:54:48Z,">     1. It is difficult for us to estimate the size of the user base accurately.
This plus the measurement of the periods of users use of the software is suspicious. This is classic ""screen hours"" reporting.

The only reason I can see to do this is to determine the ""value"" of the software for a monetization strategy. If you look at https://mu.se the thing they are most proud of is ""100M Downloads"" not how this software has helped Individuals, educators, and Scientific Research for the last 22 years. "
834358022,835,Booteille,2021-05-07T12:58:30Z,"Also, please, don't use a ""dark pattern"" if you decide to add telemetry. The ""Send anonymous data usage"" in blue is leading users to click it without reading, as usual.

Also, ""anonymous"" is a word a bit too strong when we know it's about using Google Analytics... There is no anonymity possible with Google Analytics."
834359042,835,Meriipu,2021-05-07T12:59:34Z,">Saving Linux builds or self-compiled builds will not be helpful to the general user base of this program. If it's in the default, precompiled windows installer, that's probably used for 60% or more of all people using Audacity. And we're debating to screw them over.
> 

I think you have bigger problems than precompiled audacity opt-in telemetry if you are using windows."
834359782,835,russeg,2021-05-07T13:00:17Z,"The Audacity developer should have just implemented this and be done with it, and just let the people complain and do whatever they want. Just look at FileZilla. Tim Kosse gives zero f*s and do whatever he wants and people pretty much have to accept whatever he does 😆. FileZilla has worse stuff than telemetry mind you."
834362288,835,ccoenen,2021-05-07T13:02:55Z,"Both previous posts (Windows, FileZilla) are strawman arguments."
834362435,835,ganzgustav22,2021-05-07T13:03:05Z,Just in case nobody said it before ;) This sucks. 
834363301,835,Fenex330,2021-05-07T13:04:00Z,"> The Audacity developer should have just implemented this and be done with it, and just let the people complain and do whatever they want. Just look at FileZilla. Tim Kosse gives zero f*s and do whatever he wants and people pretty much have to accept whatever he does laughing. FileZilla has worse stuff than telemetry mind you.

This is not how open source projects work in real life. The idea of FLOSS is for people to collaborate together and not one person making egoistical decisions"
834364683,835,SteveDaulton,2021-05-07T13:05:24Z,"> I dont know, why @JamesCrook @MartynShaw @Paul-Licameli and @SteveDaulton have not replied to the PRs

Speaking for myself, a ""work in progress"" pull request is not a QA issue. I shall make my views clear to the development team when or if this work is merged, based on a calm and careful assessment of it as it is at that time. While I understand some of the concerns raised, and while I personally take the issue of user privacy very seriously, I also appreciate the benefits that telemetry can bring ""for users"". 

Having developed many features for Audacity, including TimeLine Quick Play, Split Stereo Track to Mono, the Distortion effect, Bass and Treble effect, Sample Data Import / Export, Label Sounds, Nyquist Plug-in Installer, countless plug-ins and many enhancements, I would LOVE to know which features Audacity users find useful. 

I improved the Pink Noise and Brownian Noise generators, but does anyone use them? Despite asking on the very active Audacity Forum, I have no idea. Was I wasting my time? Could I have brought more value to the Audacity community by doing something else? I have no idea, because asking users to give feedback on the forum does not work. 

What about all the time that I spent adding SBSMS to Change Pitch and Change Tempo? Is that something that people use, or was that a waste of time? I have no idea, I just assume that it might be useful for some, with hardly any user feedback to support that assumption.

Can telemetry be useful in FOSS? Yes I believe that it can, provided that it is opt-in, is transparent about what data is collected, who has access to that data, and what the data is used for. I see, and I am happy about the limited uses of telemetry in FOSS classics such as Firefox. 

I am rather disappointed to see so many negative comments from people that have clearly not even checked if this feature is opt-in or opt-out. I much prefer to see people contributing rather than just criticising. If you really want to help, get involved and contribute (I'm aware that several writers here do actually contribute to FOSS).

I am not going to speculate about the final form of telemetry, if any, that will end up in a future Audacity release. Many of Audacity's features have been through multiple iterations before being suitable for general release, and I have better things to do with my time than speculate about what may or may not be - at least I think I have better things to do.
"
834364727,835,ghost,2021-05-07T13:05:26Z,"grabbing some popcorn

https://youtu.be/FOn_82MKmFg"
834368254,835,lexd0g,2021-05-07T13:09:14Z,yikes wtf
834371298,835,joepie91,2021-05-07T13:12:29Z,"@SteveDaulton 

> Despite asking on the very active Audacity Forum, I have no idea. Was I wasting my time? Could I have brought more value to the Audacity community by doing something else? I have no idea, because asking users to give feedback on the forum does not work.

That's not surprising - most users will likely never look at the forums. A much better approach to this is to have the *software* ask users to fill in eg. a survey. That doesn't require telemetry, and the problem in this case was likely just that users didn't *know* that their feedback was being asked for.

> I am rather disappointed to see so many negative comments from people that have clearly not even checked if this feature is opt-in or opt-out.

That should not be surprising, considering that the PR involves thousands of lines of code, included no explanation on what was going on, and the norm in the software industry is to violate user consent (which this proposal also does, through the use of dark patterns). That's an error on the side of the maintainers who have not communicated effectively, not an error on the side of the users who see a dark cloud descending over their favourite software.

> If you really want to help, get involved and contribute (I'm aware that several writers here do actually contribute to FOSS).

There's not really anything to ""contribute"" when the maintainers of the project have seemingly already decided to do this, without engaging with the community first."
834371638,835,divadsn,2021-05-07T13:12:50Z,"> I am rather disappointed to see so many negative comments from people that have clearly not even checked if this feature is opt-in or opt-out. I much prefer to see people contributing rather than just criticising. If you really want to help, get involved and contribute (I'm aware that several writers here do actually contribute to FOSS).

@SteveDaulton it's not about opt-in or opt-out, it's more about the fact that there are plenty more non-invasive and privacy-friendly (even self-hostable) analytics provider out there than Google Analytics."
834375157,835,Zellfaze,2021-05-07T13:16:23Z,"@Steve as others have stated, much of the concern is about the usage of
Google Analytics and Yandex, along with the violation of the GDPR.

There are also concerns about security by introducing dependencies on
libcurl and by doing downloads in the build scripts.

If they ran their own telemetry servers, fixed the issue with the
opt-in/opt-out dialog and removed the (poorly implemented) dependencies on
things like libcurl people would have been much less upset.

At this point though the cat is likely already out of the bag. The damage
has been done and clearly the dev team has lost a lot of trust with the
community. I suspect walking this back all the way and having a true
discussion with the community it the only way to win back that trust.

This should have never been a PR. This should have been an Issue. It should
have had discussion on the forums. There are so many mis-steps here.

On Fri, May 7, 2021, 09:05 Steve Daulton ***@***.***> wrote:

> I dont know, why @JamesCrook <https://github.com/JamesCrook> @MartynShaw
> <https://github.com/MartynShaw> @Paul-Licameli
> <https://github.com/Paul-Licameli> and @SteveDaulton
> <https://github.com/SteveDaulton> have not replied to the PRs
>
> Speaking for myself, a ""work in progress"" pull request is not a QA issue.
> I shall make my views clear to the development team when or if this work is
> merged, based on a calm and careful assessment of it as it is at that time.
> While I understand some of the concerns raised, and while I personally take
> the issue of user privacy very seriously, I also appreciate the benefits
> that telemetry can bring ""for users"".
>
> Having developed many features for Audacity, including TimeLine Quick
> Play, Split Stereo Track to Mono, the Distortion effect, Bass and Treble
> effect, Sample Data Import / Export, Label Sounds, Nyquist Plug-in
> Installer, countless plug-ins and many enhancements, I would LOVE to know
> which features Audacity users find useful.
>
> I improved the Pink Noise and Brownian Noise generators, but does anyone
> use them? Despite asking on the very active Audacity Forum, I have no idea.
> Was I wasting my time? Could I have brought more value to the Audacity
> community by doing something else? I have no idea, because asking users to
> give feedback on the forum does not work.
>
> What about all the time that I spent adding SBSMS to Change Pitch and
> Change Tempo? Is that something that people use, or was that a waste of
> time? I have no idea, I just assume that it might be useful for some, with
> hardly any user feedback to support that assumption.
>
> Can telemetry be useful in FOSS? Yes I believe that it can, provided that
> it is opt-in, is transparent about what data is collected, who has access
> to that data, and what the data is used for. I see, and I am happy about
> the limited uses of telemetry in FOSS classics such as Firefox.
>
> I am rather disappointed to see so many negative comments from people that
> have clearly not even checked if this feature is opt-in or opt-out. I much
> prefer to see people contributing rather than just criticising. If you
> really want to help, get involved and contribute (I'm aware that several
> writers here do actually contribute to FOSS).
>
> I am not going to speculate about the final form of telemetry, if any,
> that will end up in a future Audacity release. Many of Audacity's features
> have been through multiple iterations before being suitable for general
> release, and I have better things to do with my time than speculate about
> what may or may not be - at least I think I have better things to do.
>
> —
> You are receiving this because you commented.
> Reply to this email directly, view it on GitHub
> <https://github.com/audacity/audacity/pull/835#issuecomment-834364683>,
> or unsubscribe
> <https://github.com/notifications/unsubscribe-auth/ATJASMB7O4V3JJGV6SHIDULTMPQTDANCNFSM44C5SLTA>
> .
>
"
834377549,835,ghost,2021-05-07T13:18:36Z,"> 
> Can telemetry be useful in FOSS? Yes I believe that it can, provided that it is opt-in, is transparent about what data is collected, who has access to that data, and what the data is used for. I see, and I am happy about the limited uses of telemetry in FOSS classics such as Firefox.
> 
> I am rather disappointed to see so many negative comments from people that have clearly not even checked if this feature is opt-in or opt-out. I much prefer to see people contributing rather than just criticising. If you really want to help, get involved and contribute (I'm aware that several writers here do actually contribute to FOSS).
> 

@SteveDaulton many people here agree with you in that telemetry can be really useful, myself included! The biggest problem is _how_ this feature is implemented. No data is anonymous nor can it becollected in an ethical way when sent over to proprietary telemetry platforms owned by giant advertising companies.

But if the data IS anonymous and sent over to an open-source platform you guys DO have control over, and the data collected is sensible and will actually help improve Audacity? Then sure, collect away!

This implementation proposed is not sensible. At the very least it feels rushed. And I think it is important to acknowledge that."
834380287,835,pBergerD,2021-05-07T13:21:08Z,"""Privacy by Design"" and ""Privacy by default"" are basic provisions of the GDPR! What is a tracking tool doing in an audio editor? It can only be used for user research. 
Was the reaction to the Whatsapp/Facebook announcement not seen? Users are switching to other solutions. 
Hopefully we don't have to look for another audio editor....
"
834381720,835,ghost,2021-05-07T13:22:26Z,"I see two paths here, and both of them are equally disgusting.

Path one:
You guys are selling your users' data to corporations, for money.

Path two:
You guys are trying to go public, showing how many users you have to convince corporations to buy the software alongside its user base.


Am I wrong? There are many evidences that are provoking these ideas in my mind. In case I'm wrong, then why would Yandex care of how many users are running Audacity? Why send data directly to Google? "
834382007,835,IGBC,2021-05-07T13:22:42Z,"> > I dont know, why @JamesCrook @MartynShaw @Paul-Licameli and @SteveDaulton have not replied to the PRs
> 
> Speaking for myself, a ""work in progress"" pull request is not a QA issue. I shall make my views clear to the development team when or if this work is merged, based on a calm and careful assessment of it as it is at that time. While I understand some of the concerns raised, and while I personally take the issue of user privacy very seriously, I also appreciate the benefits that telemetry can bring ""for users"".
> 
> Having developed many features for Audacity, including TimeLine Quick Play, Split Stereo Track to Mono, the Distortion effect, Bass and Treble effect, Sample Data Import / Export, Label Sounds, Nyquist Plug-in Installer, countless plug-ins and many enhancements, I would LOVE to know which features Audacity users find useful.
> 
> I improved the Pink Noise and Brownian Noise generators, but does anyone use them? Despite asking on the very active Audacity Forum, I have no idea. Was I wasting my time? Could I have brought more value to the Audacity community by doing something else? I have no idea, because asking users to give feedback on the forum does not work.
> 
> What about all the time that I spent adding SBSMS to Change Pitch and Change Tempo? Is that something that people use, or was that a waste of time? I have no idea, I just assume that it might be useful for some, with hardly any user feedback to support that assumption.
> 
> Can telemetry be useful in FOSS? Yes I believe that it can, provided that it is opt-in, is transparent about what data is collected, who has access to that data, and what the data is used for. I see, and I am happy about the limited uses of telemetry in FOSS classics such as Firefox.
> 
> I am rather disappointed to see so many negative comments from people that have clearly not even checked if this feature is opt-in or opt-out. I much prefer to see people contributing rather than just criticising. If you really want to help, get involved and contribute (I'm aware that several writers here do actually contribute to FOSS).
> 
> I am not going to speculate about the final form of telemetry, if any, that will end up in a future Audacity release. Many of Audacity's features have been through multiple iterations before being suitable for general release, and I have better things to do with my time than speculate about what may or may not be - at least I think I have better things to do.

@SteveDaulton 
I think this response was carefully thought through but ultimately tone deaf. As has been repeated many times in this now unmanageably long thread, we, the community, are telling you, the developers, we don't believe this is an effective or appropriate measure.

We understand that you want feedback about the development direction of the software, and we are telling you the forum should be enough. I am curious why you do not trust the direct feedback from your thousands of active users, to the point you feel you need automated tracking systems to replace that model?

As for tracking in FOSS, IF it is indeed useful it must also be considered how that data can be shared safely and fairly. What segment of users this data truly represents, and how compliance with the myriad of laws surrounding data protection can be abided.  We, the community, have seen no planning or engagement with the community about how to approach these important issues. 

Finally with the introduction of new corporate developers in recent times means __we don't believe you__ when you say this is for the god of the community anymore. This is not helped by the repeated statements from devs that this is optional and anonymous, when frankly the ""opt in"" dialog is already in violation of GDPR, and it is widely accepted by the security community that google analytics is not anonymous. You either fundamentally misunderstand the technology you are trying to implement or your are misleading the community. 

You cannot sidestep these issues "
834385463,835,vxern,2021-05-07T13:25:56Z,"Yes, I would love to have my data collected by Google Analytics and Yandex, processed by them and told that my data is completely anonymous and untraceable. Sure thing! In a FOSS project :)

1:35 like to dislike ratio doesn't show a 'dislike', but an 'overwhelming majority voting against this bad idea'.

The first thousand user's data may be used for development, but the hundreds of thousands of other users' data will be used for data processing and collection, not for enhancing any user's experience.

Get rid of this draft..."
834399770,835,IROdEvO,2021-05-07T13:38:54Z,"I vote against this. Telemetry shouldn't even be optional, it should be kept out of the code completely. HARD NO TO TELEMETRY.
They all start with ""disabled by default"", then they become ""enabled by default"", then parts of telemetry become default, not an option anymore. And more will follow. So, NO to telemetry. 

People have mentioned that the window that asks for opt-in for telemetry has a dark pattern to trick the user to click on the opt-in button. I'd say that's evil."
834399813,835,TZer0,2021-05-07T13:38:57Z,"Hey, the screenshot that has now been added to the PR message includes a [dark pattern](https://www.darkpatterns.org/). This isn't making things better.

Please listen to the community and everyone posting in here. This is not a change people will forget and will forever tarnish the reputation of Audacity."
834402376,835,cadadr,2021-05-07T13:41:18Z,"I am a grad student in linguistics who used Audacity infrequently in the past, but will probably has more uses for it in near future as I'm studying phonology (inter alia). I'll probably also end up teaching on this subject in a few years, so that's were my single comment in this thread will be coming from (I'll refrain from participating otherwise as this is already a huge thread, and back and forth bickering won't add much).

First of all, I'll say as a student/researcher in phonology / phonetics, if this change goes through, I can not in good faith recommend Audacity as a good tool for research to my peers and any students I might have. Among others, I do not trust a now corporate project to stick to its word once tracking gets in to the software, and once that happens, we will ultimately face extra research ethics issues, as our science is based on human subjects who have rights to privacy we must respect.

Secondly, I want to parrot a comment I made on social media as to why I wouldn't trust you with keeping your word in the long run:

> I am fairly happy with what I read [in the updated PR] but I'm also concerned not only because it's Google APIs nevertheless, but it's indicative of a different, less community friendly culture. Telemetry communicates to me that you're taking a more Mozilla like statistics oriented approach. And justifications like

>> We need a way to make informed decisions about which OS versions to support. For example, can we raise the minimum version of the macOS to 10.10 to update the wxWidgets to the latest version?

> or 

>> It is difficult for us to estimate the size of the user base accurately.

> are scary because that implies, incorrectly or not, cutting corners and costs on compatibility instead of inclusive portability and a tendency to indirect monetisation, like ads etc., which will inevitably come with many other (chains of) effects eventually.

> This might well not be the direction they're going now, but so was the case for Mozilla back in 2010. If you told me back then that Firefox would come with trackers and Pocket and Hello and whatnot, I'd laugh in your face. But look where we are now.

> The whole concept of telemetry is anti-communal-software even when not considering the privacy aspects thereof.

My two cents."
834403823,835,boy2mantwicethefam,2021-05-07T13:42:39Z,How audacious!
834404277,835,boy2mantwicethefam,2021-05-07T13:43:05Z,Ah hell someone already made the joke
834404412,835,IGBC,2021-05-07T13:43:12Z,"> How audacious!

after 487 messages these jokes are getting old"
834405519,835,ghost,2021-05-07T13:44:15Z,"> Ah hell someone already made the joke

You tried ¯\_(ツ)_/¯"
834405825,835,Wuzzy2,2021-05-07T13:44:32Z,"While skimming through the source code, this is what I discovered is the information that Audacity will collect:

- client UUID (apparently generated on a per-session basis)
- Your OS name and version
- Audacity name and version
- Version number of wxWidgets
- System language
- when you start Audacity
- when you close Audacity
- when an exception/error occurs
- when you import audio (file format, and whether import succeeded?)
- when you export audio (file format, and whether export succeeded?)
- when you apply an effect
- when some kind of database error occurs?
- when you open a window?
- when you use the analyzer?
- it also appears to store cookies???

(NOTE: this list is based on my own rough review, I didn't look at the first post before! I might also not be 100% correct, it was only a quick and dirty look at the code.)

Both Google Universal Analytics and Yandex Metrica are used. It appears that the collected information is sent directly to Google and Yandex.ru (but not everything appears to be sent to Yandex.ru). This also means they know your IP.
Knowing your IP, in combination with OS name, version, Audacity version, etc. could be used for fingerprinting, similar to browser fingerprinting. There is a chance you could be de-anonymized with this information. Although I don't know if the information would be enough to fully de-anonymize someone, it is certainly in the realm of possibilities.
Also, this PR is called ""BASIC telemetry for the Audacity"". This implies that is is planned to add even more telemetry features in future, thereby increasing the chances of de-anonymization.
The fact that Google and Yandex are used for tracking doesn't make it any better. Google has like a billion tricks up their sleeve to track you. I don't know about Yandex, but they too are a big corporation.
I conclude that all claims of anonymity are VERY questionable. However, with this change, Audacity will lie to the user by claiming that this tracking is completely anonymous.

This is almost certainly a GDPR violation waiting to happen. Someone somewhere in the EU will probably install an Audacity build for an institution but tracking was ""accidentally"" enabled and now they're in trouble. I've already read comments of people who will go full ""scorched earth"" mode and get rid of all Audacity installation because they don't want that even just 1 bit is sent to Google or other tracking companies.
Also, this is certainly a violation of informed consent, since it suggests anonymity while this claim stands on very thin ice.

But let's not overlook the elephant in the room: Overall, this change is obviously completely useless for the user and no user wants this. From the user point of view, this feature is always bad since it has a risk of de-anoymization. In other words, this is an anti-feature. The discussion of opt-in vs opt-out is a distraction. The only reasonable decision here is complete rejection."
834406945,835,xf0e,2021-05-07T13:45:09Z,"rip audacity, good night dear friend."
834409233,835,dadall,2021-05-07T13:46:21Z,"Feel free to have look at https://matomo.org/ for ""clean"" telemetry, if it exists."
834412328,835,ghost,2021-05-07T13:49:10Z,"> While skimming through the source code, this is what I discovered is the information that Audacity will collect:
> 
>     * client UUID (apparently generated on a per-session basis)
> 
>     * Your OS name and version
> 
>     * Audacity name and version
> 
>     * Version number of wxWidgets
> 
>     * System language
> 
>     * when you start Audacity
> 
>     * when you close Audacity
> 
>     * when an exception/error occurs
> 
>     * when you import audio (file format, and whether import succeeded?)
> 
>     * when you export audio (file format, and whether export succeeded?)
> 
>     * when you apply an effect
> 
>     * when some kind of database error occurs?
> 
>     * when you open a window?
> 
>     * when you use the analyzer?
> 
>     * it also appears to store cookies???
> 
> 
> (NOTE: this list is based on my own rough review, I didn't look at the first post before! I might also not be 100% correct, it was only a quick and dirty look at the code.)
> 
> Both Google Universal Analytics and Yandex Metrica are used. It appears that the collected information is sent directly to Google and Yandex.ru (but not everything appears to be sent to Yandex.ru). This also means they know your IP.
> Knowing your IP, in combination with OS name, version, Audacity version, etc. could be used for fingerprinting, similar to browser fingerprinting. There is a chance you could be de-anonymized with this information. Although I don't know if the information would be enough to fully de-anonymize someone, it is certainly in the realm of possibilities.
> Also, this PR is called ""BASIC telemetry for the Audacity"". This implies that is is planned to add even more telemetry features in future, thereby increasing the chances of de-anonymization.
> The fact that Google and Yandex are used for tracking doesn't make it any better. Google has like a billion tricks up their sleeve to track you. I don't know about Yandex, but they too are a big corporation.
> I conclude that all claims of anonymity are VERY questionable. However, with this change, Audacity will lie to the user by claiming that this tracking is completely anonymous.
> 
> This is almost certainly a GDPR violation waiting to happen. Someone somewhere in the EU will probably install an Audacity build for an institution but tracking was ""accidentally"" enabled and now they're in trouble. I've already read comments of people who will go full ""scorched earth"" mode and get rid of all Audacity installation because they don't want that even just 1 bit is sent to Google or other tracking companies.
> Also, this is certainly a violation of informed consent, since it suggests anonymity while this claim stands on very thin ice.
> 
> But let's not overlook the elephant in the room: Overall, this change is obviously completely useless for the user and no user wants this. From the user point of view, this feature is always bad since it has a risk of de-anoymization. In other words, this is an anti-feature. The discussion of opt-in vs opt-out is a distraction. The only reasonable decision here is complete rejection.

And all this for an audio editor! Why in the hell would an audio editor collect so many data if not for selling them to corporations in exchange of money?"
834414248,835,Joe23232,2021-05-07T13:50:56Z,"Want to be extra ethical?

Don't use psychological manipulations by making the ""Send anonymous analytics data"" in blue. Users will be more likely to click on it. It should be a white button instead and make the ""Don't send"" button white.

Better yet listen to the people over here, people don't want this bullshit implemented. I liked Audacity for a reason, because of its open source non-telemetry software which is unlike most other proprietary crap that has spyware bundled with it."
834414513,835,snoozysoft,2021-05-07T13:51:10Z,"Also hey while we're at it, can we talk about how this is going to negatively impact hundreds upon thousands of other computer users who don't know what GitHub is and consequently also cant protest to this egregious privacy violation? Cos that's also pretty cool, huh!

Small edit: I will say also that I'm not fully opposed to the idea of actually basic actually anonymous telemetry for the sake of actually helping development....but frankly, the reasons given are rubbish and as previously mentioned don't really _need_ telemetry. That, and the fact that you're so reluctant to move away from Google/Yandex despite multiple people giving you an absurdly long list of alternatives is ridiculous. Get over yourselves and actually listen to your community."
834424452,835,Termuellinator,2021-05-07T14:00:28Z,"I'm no enemy to telemetry in general and making in opt-in is the only valid option. Having the buttons in a way to guide non-tech users towards opting-in is borderline, but may be ok.
But using google analytics (or any other privacy-denying provider) for that purpose is about the worst idea any open source project can have..."
834426433,835,Joe23232,2021-05-07T14:02:20Z,"> Also hey while we're at it, can we talk about how this is going to negatively impact hundreds upon thousands of other computer users who don't know what GitHub is and consequently also cant protest to this egregious privacy violation? Cos that's also pretty cool, huh!
> 
> Small edit: I will say also that I'm not fully opposed to the idea of actually basic actually anonymous telemetry for the sake of actually helping development....but frankly, the reasons given are rubbish and as previously mentioned don't really _need_ telemetry. That, and the fact that you're so reluctant to move away from Google/Yandex despite multiple people giving you an absurdly long list of alternatives is ridiculous. Get over yourselves and actually listen to your community.

I hope somebody makes a fork out of this honestly!"
834429007,835,Klaex,2021-05-07T14:04:55Z,"> users who don't know what GitHub is cant protest to this egregious privacy violation

Of course they can protest. There is a ""Don't send"" button.

The default happy flow right now is sending your data. Many people unaware of what this means will thus give up their data. I'm sure the developers knew that while making it. This should be the other way around."
834430514,835,pandruszkow,2021-05-07T14:06:26Z,"I don't wish to see telemetry become a broadly accepted feature of open-source software. I am very disappointed that the project is going in this direction.

Please reconsider, since you're risking splitting the community by forcing a telemetry-free fork."
834431938,835,snoozysoft,2021-05-07T14:07:46Z,">
> Of course they can protest. There is a ""Don't send"" button.
>

That implicates they can only protest to this thing when it's already passed and been included in the software. Not good enough, quite frankly. 
"
834432076,835,nicemicro,2021-05-07T14:07:54Z,"> The default happy flow right now is sending your data. Many people unaware of what this means will thus give up their data. I'm sure the developers knew that while making it. This should be the other way around.

As someone who tries to minimize my connections to Google, I'd like to see the dialogue box explicitly mentioning that Google is used for the telemetry, as that would make it a hard pass for me, and probably to others who in general wouldn't oppose sending *some* telemetry, but want to avoid Google."
834432178,835,remi-sc,2021-05-07T14:07:58Z,"> We need a way to make informed decisions about which OS versions to support.

> If you are compiling Audacity from source, we will provide a CMake option to enable the telemetry code. This option will be turned off by default.

I imagine most of Linux distros will have this option disabled - which means that vast majority of their users will not show up in statistics.
Making any OS-specific decisions on such biased data will lead to worse Linux support in the long run. (Especially in the event of corporate interests taking initiative)"
834439804,835,daniarla,2021-05-07T14:15:02Z,"Another case of a greedy company screwing over their users for making a profit.
As other people pointed out, this seems like a move to count the number of users for promoting the company. It is just sad."
834440020,835,pandruszkow,2021-05-07T14:15:15Z,"> Making any OS-specific decisions on such bias data will lead to worse Linux support in the long run. (Especially in the event of corporate interest taking initiative)

Additionally, it would mean that Windows users would always receive a build of Audacity with telemetry baked in from the official channels. Windows users are not accustomed to compiling software from source. If Audacity ever decides to make it this feature mandatory, there is no one there to distribute binaries with this feature patched out."
834445653,835,falkTX,2021-05-07T14:19:56Z,"> If Audacity ever decides to make it this feature mandatory, there is no one there to distribute binaries with this feature patched out.

Automating this with CI (after some initial setup) is trivial.
That would be the main reason for a fork. So people would download Librecity or whatever instead of Audacity.
"
834446879,835,geekredux,2021-05-07T14:21:07Z,"> Due to the large amount of worry about this PR, (which we completely understand), we want to clarify exactly what is going on:
> 
>     1. Telemetry is **strictly optional and disabled by default**.

Am I reading things wrong, or did you just change this after people noticed and called you out? Looks to me like the original default was enabled:
https://github.com/audacity/audacity/pull/835/commits/fefeb2af3bc1cefe8649162b5222521999ba9f47

Usually when a company acquires a popular software project they wait a lot longer to start screwing it up. Hats off to you for hitting the ground running, I guess? Seriously, how could you possibly have expected the news that one of the most popular FOSS projects was going to implement Google analytics (again--originally enabled by default) was going to be accepted any other way?

Edit: Answer is I'm reading this wrong
https://github.com/audacity/audacity/pull/835#issuecomment-834449458

Edit edit: ...as least as far as the timing on the default change. I stand by my rush-to-screw-up opinion.
"
834447689,835,Kellegram,2021-05-07T14:21:50Z,"Data collection is absolutely crucial in software development. Google analytics doesn't just collect data though, it takes your soul with it. Don't ruin your reputation further."
834449458,835,kade-robertson,2021-05-07T14:23:33Z,"> > Due to the large amount of worry about this PR, (which we completely understand), we want to clarify exactly what is going on:
> > ```
> > 1. Telemetry is **strictly optional and disabled by default**.
> > ```
> 
> Am I reading things wrong, or did you just change this after people noticed and called you out? Looks to me like the original default was enabled:
> [fefeb2a](https://github.com/audacity/audacity/commit/fefeb2af3bc1cefe8649162b5222521999ba9f47)
> 
> Usually when a company acquires a popular software project they wait a lot longer to start screwing it up. Hats to you for hitting the ground running, I guess? Seriously, how could you possibly have expected the news that one of the most popular FOSS projects was going to implement Google analytics (again--originally enabled by default) was going to be accepted any other way?

If you look in the actual PR history that change was made before this PR had any related comments on it. Most likely was just a default in development and changed for the actual release."
834450195,835,BigmenPixel0,2021-05-07T14:24:15Z,Tracker in FOSS... This not normal
834451026,835,rubyFeedback,2021-05-07T14:24:58Z,"I think one issue is that not everyone may be aware of the code. I, and many others, can adjust fine; I use 
some ruby scripts or just oldschool GNU sed to automatically eliminate undesired code, then compile 
from source. I do this, by the way, to automatically remove ""Code of Conduct"" files too since they are not
relevant (they are not part of the licence, for example, thus irrelevant propaganda).

When you go to the audacity homepage, though, you can read this, among other entries:

""Developed by a group of volunteers as open source.""

Of course we can ask what EXACTLY is meant with ""open source"". Is ethics included?

The audacity comes with a CODE_OF_CONDUCT.md by the way, yet audacity is currently
stating that ""telemetry"" is ethically and morally acceptable. Well, call me strange, but I 
find tele-sniffing and tele-spying on users much more problematic than a ""code of conduct""
which is already irrelevant to me (since it is not part of the licence, thus it can not be 
enforced).

I would highly recommend the audacity team to reconsider. It is clear that this is 
done for revenue-driven purposes and I think people can somewhat understand
different strategies used by different organization in this regard, which is 
understandably a problem with many open source projects. I am all in favour of 
state-driven aid AS WELL (provided that there are verifiable means to see that
this benefits the taxpayer too), but sneaky-tele-spying is just morally and ethically
inacceptable. The downvotes are very clear, so I think the audacity team should
completely reconsider the approach. I highly recommend dropping that idea.

See the libreoffice team reconsidering their approach in regards to two-class
apartheid (""business"" versus ""regular"" users) a few months ago as an example
to better the situation. And see the qt project for an example how to worsen 
the situation (the kde devs are in denial mode right now but this can not be
maintained in the long run either; nobody wants to be penalized up to 12 
months before patches are available for the open source community. The
kde devs have not understood this yet.)"
834451187,835,tlhackque,2021-05-07T14:25:07Z,"I'm not as worried about analytics as some here - if things devolve, there'll be a pull request to review.

I do have two concerns with the pull request:

 - I agree that the screenshot should be more clearly opt-in - the ""dark pattern"" should become neutral, perhaps with enabling analytics requring a checkbox to enable the ""send data"" button + a button click.  That would make opting-in a positive decision.
 - I am concerned about shipping a private `libcurl`, even unpatched.  `libcurl` releases frequently and has had CVEs.  I don't think Audacity wants to be in the business of tracking `libcurl` and being forced to re-release Audacity on `libcurl`'s schedule.  Make `libcurl` a dependency, and check for a minimum version. This loose coupling will ensure that `libcurl` is as up-to-date as possible; whichever updates first will be used.  `libcurl` has been very good about not breaking APIs, so this is a low risk strategy,  There is nothing (on any OS) that prevents one library (DLL) from depending on or dyamically linking another.
 
I don't understand why you need two analytics services.  Depending on where a user lives, (s)he may be more worried about one or the other.  But both gives the worst of both worlds.  I'd suggest settling on one.  And you might satisfy some concerns if you allowed selection of what is collected.  Eg. a checkbox for ""census data only"" and another for ""usage details"".

[edit: fixed two typos.]"
834451350,835,Maverynthia,2021-05-07T14:25:16Z,"> > I am rather disappointed to see so many negative comments from people that have clearly not even checked if this feature is opt-in or opt-out. I much prefer to see people contributing rather than just criticising. If you really want to help, get involved and contribute (I'm aware that several writers here do actually contribute to FOSS).
> 
> @SteveDaulton it's not about opt-in or opt-out, it's more about the fact that there are plenty more non-invasive and privacy-friendly (even self-hostable) analytics provider out there than Google Analytics.

Also we all know as users that ""default off"" will eventually become ""always on"" as Muse Group slowly gets their tentacles all over it. Free isn't Free if your data is being mined."
834457819,835,dmbaturin,2021-05-07T14:31:03Z,"If you hosted the telemetry collection server yourself, I might opt in. Sending your users' data to a third party is a hard NOPE."
834461501,835,pivotman319-owo,2021-05-07T14:34:33Z,"Audacity is my go-to tool for whenever I need to make a very quick edit to some audio file that I have at hand, but I have one improvement for this PR:

Close it. **Scrap the ENTIRE request.** Don't even think about getting this merged in the future. I want _my_ privacy to be respected."
834461530,835,mindinsomnia,2021-05-07T14:34:34Z,"> > I dont know, why @JamesCrook @MartynShaw @Paul-Licameli and @SteveDaulton have not replied to the PRs
> 
> Speaking for myself, a ""work in progress"" pull request is not a QA issue. I shall make my views clear to the development team when or if this work is merged, based on a calm and careful assessment of it as it is at that time. While I understand some of the concerns raised, and while I personally take the issue of user privacy very seriously, I also appreciate the benefits that telemetry can bring ""for users"".
> 
> Having developed many features for Audacity, including TimeLine Quick Play, Split Stereo Track to Mono, the Distortion effect, Bass and Treble effect, Sample Data Import / Export, Label Sounds, Nyquist Plug-in Installer, countless plug-ins and many enhancements, I would LOVE to know which features Audacity users find useful.
> 
> I improved the Pink Noise and Brownian Noise generators, but does anyone use them? Despite asking on the very active Audacity Forum, I have no idea. Was I wasting my time? Could I have brought more value to the Audacity community by doing something else? I have no idea, because asking users to give feedback on the forum does not work.
> 
> What about all the time that I spent adding SBSMS to Change Pitch and Change Tempo? Is that something that people use, or was that a waste of time? I have no idea, I just assume that it might be useful for some, with hardly any user feedback to support that assumption.
> 
> Can telemetry be useful in FOSS? Yes I believe that it can, provided that it is opt-in, is transparent about what data is collected, who has access to that data, and what the data is used for. I see, and I am happy about the limited uses of telemetry in FOSS classics such as Firefox.
> 
> I am rather disappointed to see so many negative comments from people that have clearly not even checked if this feature is opt-in or opt-out. I much prefer to see people contributing rather than just criticising. If you really want to help, get involved and contribute (I'm aware that several writers here do actually contribute to FOSS).
> 
> I am not going to speculate about the final form of telemetry, if any, that will end up in a future Audacity release. Many of Audacity's features have been through multiple iterations before being suitable for general release, and I have better things to do with my time than speculate about what may or may not be - at least I think I have better things to do.

@SteveDaulton 
I'm happy to voice my support for this telemetry. I have experienced what it's like to be on the other side, developing an application and having access to telemetry, and the benefits are huge. It is not a privacy concern in my opinion, the data being collected is as anonymous as the data being collected about all of us here right now every time we visit a website. There is frankly some paranoia going on in this thread and I suspect this is a ""vocal minority"" venting. More than 99% of audacity users probably don't even have a github account to comment here, let alone care this much about telemetry.

The points you raised Steve about the uses of this anonymous data are great examples of why telemetry is useful. Being able to see real time data on how your changes are making a difference to users, positive or negative, is very valuable and a great tool for a UX focused development approach.

I'd also add you're right about how difficult it is to get feedback from users. Lots of people in this thread have talked about surveys and asking for feedback on forums, but almost no one ever does that and those who do are usually a vocal minority, and it's best not to let the vocal minority drive the direction of development.

Those talking about this being 'data mining' for money are a few fries short of a happy meal. No money will be made from this kind of telemetry. I don't know how the average person here could even think that information about how often an error occurs or how long the average Audacity session is, or which audio effects are the most popular, could be worth anything to anyone.

It feels like a lot of people here are just automatically making the connection between harmless anonymous opt-in telemetry, and Facebook style massive data mining operations for advertisers.

Also thankyou for your great work on Audacity over the years."
834463835,835,Nirei,2021-05-07T14:36:46Z,"Please, do not do this."
834466136,835,daniarla,2021-05-07T14:38:55Z,"The fact that with all this backlash, the new company is still ""forcing"" this PR and is not willing to listen the community is one of the most worrying parts.
This project got here thanks to the contribution of a lot of people, and hearing what they had to say.
They completely turn their backs on the community in like 4 days of developing."
834466207,835,arnavbhatt288,2021-05-07T14:39:00Z,"A completely useless PR for a feature which nobody asked for.
Kindly close it."
834466896,835,Fenex330,2021-05-07T14:39:40Z,Please dont turn OSS into Open Source Spyware
834469971,835,ghost,2021-05-07T14:42:42Z,"> Please dont turn OSS into Open Source Spyware

I will tell you they won't care. With the money they're going to get by selling users' data, who needs morals and _**Audience**_? (possible name for a future fork intended)"
834471396,835,ghost,2021-05-07T14:44:06Z,"This time could be far better spent doing anything else than implementing telemetry. At least it's optional, but PLEASE focus on cleaning up Audacity's UI instead, it's quite daunting to newcomers."
834471750,835,julienbenjamin,2021-05-07T14:44:28Z,"@SteveDaulton I think others have expressed my views to you in a better way than I could right now. Nonetheless, especially after your last post here, I think you should reconsider especially since none of your messages addresses the legal standpoint, such as GDPR for example, where consent is explicitly required and AFAIK, no mechanism is present to handle such a thing in your code.

To be honest, and I know that most people in the FLOSS communities I contribute to, would just stop using a FLOSS project that might contain such ""telemetry"" even before it is implemented. In other words, unless this draft is abandoned in the near future, you will make a lot of users run away from your Audacity. This would be a shame, especially since this project is so good and well-established.

I hope you will take the right decision."
834471986,835,arnavbhatt288,2021-05-07T14:44:43Z,"> > Please dont turn OSS into Open Source Spyware
> 
> I will tell you they won't care. With the money they're going to get by selling users' data, who needs morals and _**Audience**_? (possible name for a future fork intended)

Waiting for a fork to come up :trollface: "
834472156,835,mindinsomnia,2021-05-07T14:44:52Z,"> This time could be far better spent doing anything else than implementing telemetry. At least it's optional, but PLEASE improve Audacity's UX, it's quite daunting to newcomers.

That's why they're adding telemetry, to get useful information to help drive UX improvements?"
834473638,835,ghost,2021-05-07T14:46:25Z,"> > This time could be far better spent doing anything else than implementing telemetry. At least it's optional, but PLEASE improve Audacity's UX, it's quite daunting to newcomers.
> 
> That's why they're adding telemetry, to get useful information to help drive UX improvements?

You could just get useful information by asking for feedback instead of tracking user activity. Have a ""send feedback"" button, reach out to users, etc. There's no need to turn Audacity into spyware."
834473787,835,BitesizedLion,2021-05-07T14:46:35Z,"No, no and no. Don't do this."
834474575,835,DerValiser,2021-05-07T14:47:25Z,"Good Night, Audacity.   Either I will conserve the Version I have got, or I will deinstall."
834477281,835,PureIncompetence,2021-05-07T14:49:49Z,"If the future advertisers, they're going to sell our data to, wanna know about the user count...
Spoiler alert: it decreases drastically in this very moment."
834477558,835,byllgrim,2021-05-07T14:50:06Z,"Well this is bad.
A legend falls."
834477617,835,mindinsomnia,2021-05-07T14:50:10Z,"> > > This time could be far better spent doing anything else than implementing telemetry. At least it's optional, but PLEASE improve Audacity's UX, it's quite daunting to newcomers.
> > 
> > 
> > That's why they're adding telemetry, to get useful information to help drive UX improvements?
> 
> You could just get useful information by asking for feedback instead of tracking user activity?

Majority of users completely ignore any request for user feedback, and the small number who don't, usually try to use it as a means of voicing their strong opinions to affect change in the direction of development, making their feedback less useful. Even when users are being honest and reasonable with their feedback, they usually can not provide the kind of detailed useful information that telemetry can offer."
834478530,835,Jeder321,2021-05-07T14:51:03Z,"> It feels like a lot of people here are just automatically making the connection between harmless anonymous opt-in telemetry, and Facebook style massive data mining operations for advertisers.

@mindinsomnia except that, it's actually a data sellout to google/rest of advertisers/nsa and yandex/russian government, can't believe you say facebook is data mining a lot of data while not acknowledging that google does it for the same scale, if not larger
"
834479721,835,mindinsomnia,2021-05-07T14:52:13Z,"> If the future advertisers, they're going to sell our data to, wanna know about the user count...
> Spoiler alert: it decreases drastically in this very moment.

Which advertisers do you think are going to buy information on which menu items are being clicked the most and which error messages are the most common? Think about this. This data wouldn't even be useful to advertisers. "
834479968,835,sandycorzeta,2021-05-07T14:52:28Z,"> > This time could be far better spent doing anything else than implementing telemetry. At least it's optional, but PLEASE improve Audacity's UX, it's quite daunting to newcomers.
> 
> That's why they're adding telemetry, to get useful information to help drive UX improvements?

Adding the telemetry is **fine**. But relying the data handled to the third party, and even big tech company operating from advertising like Google is **NOT FINE** and Yandex too, even i dont know how good their privacy practice is.

Also dont forget the bad UI decision such as possible ""dark patterns"" in the screenshot dialog too. Not to mention the legal stuff on GDPR."
834480410,835,ghost,2021-05-07T14:52:52Z,"> > > This time could be far better spent doing anything else than implementing telemetry. At least it's optional, but PLEASE improve Audacity's UX, it's quite daunting to newcomers.
> > 
> > 
> > That's why they're adding telemetry, to get useful information to help drive UX improvements?
> 
> You could just get useful information by asking for feedback instead of tracking user activity. Have a ""send feedback"" button, reach out to users, etc. There's no need to turn Audacity into spyware.

Seriously, just talk to your users. Build software that people _want_, not software that makes a number on a dashboard go up."
834480546,835,MarinaGryphon,2021-05-07T14:53:00Z,"> > If the future advertisers, they're going to sell our data to, wanna know about the user count...
> > Spoiler alert: it decreases drastically in this very moment.
> 
> Which advertisers do you think are going to buy information on which menu items are being clicked the most and which error messages are the most common? Think about this. This data wouldn't even be useful to advertisers.


> Yandex would only receive the “application opened” event to help us estimate the size of the user base. "
834481571,835,AnalogFeelings,2021-05-07T14:53:59Z,Yooo its time to never update my audacity again
834481758,835,ghost,2021-05-07T14:54:11Z,"> > > > This time could be far better spent doing anything else than implementing telemetry. At least it's optional, but PLEASE improve Audacity's UX, it's quite daunting to newcomers.
> > > 
> > > 
> > > That's why they're adding telemetry, to get useful information to help drive UX improvements?
> > 
> > 
> > You could just get useful information by asking for feedback instead of tracking user activity?
> 
> Majority of users completely ignore any request for user feedback, and the small number who don't, usually try to use it as a means of voicing their strong opinions to affect change in the direction of development, making their feedback less useful. Even when users are being honest and reasonable with their feedback, they usually can not provide the kind of detailed useful information that telemetry can offer.

What ""detailed useful information"" could you get from storing client UUIDs and making network requests every time a window is opened?"
834485502,835,apache-hb,2021-05-07T14:57:44Z,"Don't make me firewall yet another application. Users shouldn't have to worry about every application on their computer chipping away at their bandwidth caps, especially not an audio application."
834485544,835,eylles,2021-05-07T14:57:46Z,"Welp, to /dev/null audacity goes, ardour is now the only music software worth using on linux."
834485946,835,obfuscoder,2021-05-07T14:58:10Z,"> Adding telemetry is a useless act when nearly all your users (Linux distros) are gonna compile from source and create their own packages or downright disable it.

That's an important point. There will be distro maintainers who will consider disabling this compile flag and so no telemetry data will come from those distros. If the audacity developers will base their focus on this telemetry data, they might think that no one uses the software on those operating systems and they might be inclined to just ignore bug reports or seize to support it entirely.

As some distro maintainers will forsee this problem, they will be inclined to not disable this flag because it might negatively affect the support of their platform.
"
834489299,835,ghost,2021-05-07T15:01:04Z,"> > > > This time could be far better spent doing anything else than implementing telemetry. At least it's optional, but PLEASE improve Audacity's UX, it's quite daunting to newcomers.
> > > 
> > > 
> > > That's why they're adding telemetry, to get useful information to help drive UX improvements?
> > 
> > 
> > You could just get useful information by asking for feedback instead of tracking user activity?
> 
> Majority of users completely ignore any request for user feedback, and the small number who don't, usually try to use it as a means of voicing their strong opinions to affect change in the direction of development, making their feedback less useful. Even when users are being honest and reasonable with their feedback, they usually can not provide the kind of detailed useful information that telemetry can offer.

That doesn't make any sense. The benefits of telemetry are fairly limited, if not against the whole point of free software. And also it's not true as most contributors send a full detailed log of what's wrong."
834490625,835,ghost,2021-05-07T15:02:09Z,"> high-speed internet access and its consequences have been a disaster for humanity

Humanity and its consequences have been a disaster for humanity."
834491474,835,mindinsomnia,2021-05-07T15:02:55Z,"> Adding telemetry is a useless act when nearly all your users (Linux distros) are gonna compile from source and create their own packages or downright disable it.

I think there are some inaccurate assumptions being made here, such as:
A) Assuming the majority of users for audacity are on Linux, far more likely that the majority are on Windows.
B) Drastically over estimating the number of people who can / would compile software from source code.
C) Drastically over estimating the number of people who would care about telemetry so much that they would compile a fork of audacity from source just to remove telemetry which is already opt-in."
834492454,835,winterhell,2021-05-07T15:03:48Z,"Audacity has worked just fine as is for 20 years. There are many venues to report bugs. 
Seeing how many midi files are people exporting or what OS are they using is not going to help you fix any issues. 
You still have time to turn back the ship before it turns into Titanic."
834495717,835,BlueRaccoonTech,2021-05-07T15:06:48Z,"I'm starting to become fearful that viable alternatives for telemetry other than the kind that gives Google/Yandex data are being buried in the sea of messages. Is there any way that such alternatives can be organized into one neat list so that alternatives could actually be explored? I won't disagree with the mere concept of telemetry being included, given it's **always** opt-in, but I will fight back against the notion of willingly handing companies such as Google more data, and I know for a fact alternatives have been offered."
834495890,835,arnavbhatt288,2021-05-07T15:06:59Z,"> > Adding telemetry is a useless act when nearly all your users (Linux distros) are gonna compile from source and create their own packages or downright disable it.
> 
> I think there are some inaccurate assumptions being made here, such as:
> A) Assuming the majority of users for audacity are on Linux, far more likely that the majority are on Windows.
> B) Drastically over estimating the number of people who can / would compile software from source code.
> C) Drastically over estimating the number of people who would care about telemetry so much that they would compile a fork of audacity from source just to remove telemetry which is already opt-in.

Meanwhile you are just underestimating us that we will not make a fork of it and not caring about telemetry at all."
834496459,835,davidfoerster,2021-05-07T15:07:33Z,"> Not to mention the legal stuff on GDPR.

GDPR applies to data that identifies a person or can be uses to identify a person with reasonable certainty. Unless the telemetry collection services track the source IP address, this does not seem to be the case here as none of the listed info relates to a person."
834498496,835,Jeder321,2021-05-07T15:09:32Z,"> > Not to mention the legal stuff on GDPR.
> 
> GDPR applies to data that identifies a person or can be uses to identify a person with reasonable certainty. Unless the telemetry collection services track the source IP address, this does not seem to be the case here as none of the listed info relates to a person.

as someone in this thread said few hours ago, either google or devs are able to ""decrypt"" pseudonymous IDs GA gives so uhhh, thats gdpr breach"
834498662,835,mindinsomnia,2021-05-07T15:09:42Z,"> Meanwhile you are just underestimating us that we will not make a fork of it and not caring about telemetry at all.

What's the point in creating a fork just to remove a feature that is already off by default?

That's like creating a fork of VLC to remove the option to have a custom skin because you don't plan to use one."
834499348,835,Jeder321,2021-05-07T15:10:23Z,"> > Meanwhile you are just underestimating us that we will not make a fork of it and not caring about telemetry at all.
> 
> What's the point in creating a fork just to remove a feature that is already off by default?
> 
> That's like creating a fork of VLC to remove the option to have a custom skin because you don't plan to use one.

there's a point in showing opposition to whatever dumb decision devteam decides to make"
834499445,835,L1ghtn1ng,2021-05-07T15:10:30Z,Have you looked at https://sentry.io/welcome/ as this seems to be what you want you want and would then remove Google and yandex which seems better and you can even host it yourself if I recall correctly
834499743,835,ghost,2021-05-07T15:10:48Z,"
> Meanwhile you are just underestimating us that we will not make a fork of it and not caring about telemetry at all.

I'll make the logo!"
834500565,835,dvzrv,2021-05-07T15:11:34Z,"> If the audacity developers will base their focus on this telemetry data, they might think that no one uses the software on those operating systems and they might be inclined to just ignore bug reports or seize to support it entirely.

The lack of support is already the case also without telemetry, which makes it all the more disappointing that a topic such as this receives so much attention while there are *actual problems to fix* with this application and its build system.

I would love to see improvements on that."
834500614,835,eylles,2021-05-07T15:11:36Z,"> > Adding telemetry is a useless act when nearly all your users (Linux distros) are gonna compile from source and create their own packages or downright disable it.
> 
> That's an important point. There will be distro maintainers who will consider disabling this compile flag and so no telemetry data will come from those distros. If the audacity developers will base their focus on this telemetry data, they might think that no one uses the software on those operating systems and they might be inclined to just ignore bug reports or seize to support it entirely.
> 
> As some distro maintainers will forsee this problem, they will be inclined to not disable this flag because it might negatively affect the support of their platform.

And that's not mentioning the distro mantainers that will just outright remove audacity from the repos, most likely to do that is debian, then they will upload their audacity fork without telemetry, and other distros will follow..."
834500997,835,DerValiser,2021-05-07T15:11:55Z,"> 
> 
> > Meanwhile you are just underestimating us that we will not make a fork of it and not caring about telemetry at all.
> 
> What's the point in creating a fork just to remove a feature that is already off by default?
> 
> That's like creating a fork of VLC to remove the option to have a custom skin because you don't plan to use one.

In 3.2  you will switch it on by default
In 3.3. your tracking will try to search for Files on our discs
In 3.4. we will get annyoing advertisements from 3rd parties, probably with security leaks. 

Any further Questions?  

Audacity is dead for me if just one single line of tracking code is inside. It doesn't matter if it's ""optional"" for a small period of time."
834502158,835,ghost,2021-05-07T15:12:59Z,"> > Meanwhile you are just underestimating us that we will not make a fork of it and not caring about telemetry at all.
> 
> What's the point in creating a fork just to remove a feature that is already off by default?
> 
> That's like creating a fork of VLC to remove the option to have a custom skin because you don't plan to use one.

This is a silly comparison. One is harmful on the long run, while the other is just an aesthetic thing. Also, a certain group called 'suckless' would like to know your position."
834505082,835,gr33nbits,2021-05-07T15:14:20Z,"But why? No, please."
834507358,835,arnavbhatt288,2021-05-07T15:15:20Z,"> > > Meanwhile you are just underestimating us that we will not make a fork of it and not caring about telemetry at all.
> > 
> > 
> > What's the point in creating a fork just to remove a feature that is already off by default?
> > That's like creating a fork of VLC to remove the option to have a custom skin because you don't plan to use one.
> 
> This is a silly comparison. One is harmful on the long run, while the other is just an aesthetic thing.

Also they even wanted telemetry to be ON at the first place.
![unknown](https://user-images.githubusercontent.com/35190743/117471097-07015a00-af47-11eb-9ca3-14976c376419.png)
"
834513451,835,IGBC,2021-05-07T15:18:14Z,"they have been lying repeatedly throughout this entire process. I have concluded in several comments above, that the only meaningful reason to collect the types and volume of data proposed in this PR is for constructing a monetization strategy not supporting feature development. Calling this conclusion paranoid ignores that the developers in question have a history of this exact behavior with MuseScore."
834516456,835,BitesizedLion,2021-05-07T15:21:14Z,"> Mention in the pop-up that Google Analytics and Yandex are used for processing/storing the data.

Or just don't add telemetry :)"
834516747,835,Jeder321,2021-05-07T15:21:30Z,"> Mention in the pop-up that Google Analytics and Yandex are used for processing/storing the data.

thats not enough, either they use self-hosted telemetry, or don't use it at all"
834520264,835,IGBC,2021-05-07T15:25:03Z,"# OK poll time, 
lets find out what people really want:

https://www.strawpoll.me/45241130

I dunno how to make a poll on github"
834520649,835,crashvb,2021-05-07T15:25:27Z,"Are you trying to get people to stop using it, or just encouraging people to fork?"
834521293,835,LonMcGregor,2021-05-07T15:26:05Z,"If this is implemented there is a very real danger that I hope the team avoids:

* Powers users (those that are more likely to be both privacy and technically conscious who may choose to disable telemetry) may use certain obscure features more than other users
* The analytics will, by dint of the above caveat, not reflect features used more often by power users
* This runs the risk of management choosing to cut features because they see them as not being used, and therefore not worthy of the time required to maintain them

I have seen other projects fall into this trap, so I hope the audacity team is aware of this and knows how to avoid it."
834522300,835,marcopavanello,2021-05-07T15:27:01Z,"Just the fact that despite after 2500 dislikes and more than 500 comments all saying we **DON'T** want telemetry, they don't take action says long enough about what kind of people we are dealing with. If we can't fix their minds then there is no more reason to even try to fight against."
834525238,835,tralph3,2021-05-07T15:29:21Z,"I don't understand the outrage. What they're doing is perfectly reasonable and (I think) in good faith. They just want to have data to improve Audacity, and the way they are doing it is the best way. Data is useful, there's no denying that. Knowing how your users use the software is vital to knowing what to even improve, without it, you can only guess or hear the complaints from a minority which may or may not represent the actual problems of the software.

Take into account, this data is **anonymous** and **opt-in**. **PLUS** this is only enabled if you compile from source with the intention of enabling it, most repositories will not even have this in the binary. There are other FLOSS projects which do the same, KDE comes to mind, it also has opt-in telemetry. Telemetry in itself isn't bad, it's only bad if it doesn't respect your privacy, and if you give consent to this, I don't see how your privacy is getting violated.

Also, Audacity is open source, if this actually gets out of hand, a fork will exist with all the crap removed. There's no reason to be alarmed."
834528543,835,Megaf,2021-05-07T15:30:45Z,"If they don't quit with the idea of telemetry then a hostile fork will be made. Splitting the community.

Is it that what you want Audacity?"
834529402,835,pushqrdx,2021-05-07T15:31:08Z,"As a developer I know how valuable knowing some numbers is. And I usually opt-in non invasive telemetry.. BUT this whole PR is somehow shady.. the narrative is changing, clarifications that should've been there are just being added and the choice of Yandex and Google is just sloppy "
834531219,835,falkTX,2021-05-07T15:31:54Z,"> Just the fact that despite after 2500 dislikes and more than 500 comments all saying we **DON'T** want telemetry, they don't take action says long enough about what kind of people we are dealing with. If we can't fix their minds then there is no more reason to even try to fight against.

they are just waiting for this shitstorm to die down and resume operation aftewards.
weekend is coming, so I guess on early next week we get a more definitive answer."
834531610,835,Saragon4005,2021-05-07T15:32:05Z,"> They just want to have data to improve Audacity, and the way they are doing it is the best way. Data is useful, there's no denying that.

I think the main source of outrage is the telemetry provides they are using, it really wouldn't be too hard to process telemetry on their own servers, but instead they are planning to sent this data to *Google* of all people, only Facebook would be a worse choice"
834531779,835,MarinaGryphon,2021-05-07T15:32:09Z,"> I don't understand the outrage. What they're doing is perfectly reasonable and (I think) in good faith. They just want to have data to improve Audacity, and the way they are doing it is the best way. Data is useful, there's no denying that. Knowing how your users use the software is vital to knowing what to even improve, without it, you can only guess or hear the complaints from a minority which may or may not represent the actual problems of the software.
> 
> Take into account, this data is **anonymous** and **opt-in**. **PLUS** this is only enabled if you compile from source with the intention of enabling it, most repositories will not even have this in the binary. There are other FLOSS projects which do the same, KDE comes to mind, it also has opt-in telemetry. Telemetry in itself isn't bad, it's only bad if it doesn't respect your privacy, and if you give consent to this, I don't see how your privacy is getting violated.
> 
> Also, Audacity is open source, if this actually gets out of hand, a fork will exist with all the crap removed. There's no reason to be alarmed.

It will not be anonymous until they switch to a self-hosted telemetry service and stop collecting IPs. "
834532416,835,mindinsomnia,2021-05-07T15:32:24Z,"> Just the fact that despite after 2500 dislikes and more than 500 comments all saying we **DON'T** want telemetry,

Wrong, some of us are in agreement with the need for telemetry, so you're going to have to go through the comments and count up the positive/negative comments."
834535795,835,mindinsomnia,2021-05-07T15:33:50Z,"> I don't understand the outrage.

I'm with you on that. I don't get it either. It feels like a lot of paranoia in this thread."
834539094,835,falkTX,2021-05-07T15:35:27Z,We have come to a point where refusing being tracked and analytics is considered paranoia now... really sad state of affairs :(
834539396,835,julienbenjamin,2021-05-07T15:35:43Z,"> > I don't understand the outrage.
> 
> I'm with you on that. I don't get it either. It feels like a lot of paranoia in this thread.

So I take you did not read much of it."
834539478,835,IGBC,2021-05-07T15:35:48Z,"> > Just the fact that despite after 2500 dislikes and more than 500 comments all saying we **DON'T** want telemetry,
> 
> Wrong, some of us are in agreement with the need for telemetry, so you're going to have to go through the comments and count up the positive/negative comments.

Mind insomnia you and a couple of others are individuals standing against dozens. I respect you for standing by your views in such a public forum, however you should acknowledge the consensus stands against you."
834539822,835,mc776,2021-05-07T15:36:08Z,"The edited OP makes it even more obvious that this is, at best, trying to solve a problem that doesn't exist, at least not nearly to the degree that would make it worth entering into a deal with the google.

I remember a couple years back when GZDoom had telemetry. No Google nonsense, just a very narrow question of how many people were still using some really old OSes and graphics hardware that the devs were struggling to keep supporting. These struggles had been voiced and well known for quite some time before the decision had been made.

*Once that question was settled the GZDoom team got rid of the telemetry.*

I don't see that kind of thinking with this PR. Instead, it just looks like someone wants to add telemetry to this because they think it's a good idea but without any immediate use case in mind, and then tried to come up with justifications for it."
834540771,835,Klaex,2021-05-07T15:36:57Z,"The pop-up could be a lot clearer:

```
We would like to gather information about your usage of Audacity to analyze 
and improve the product.

If you agree, the following data will be stored:
- a unique identifier linked to your Audacity instance
- your IP address
- session start and end events with timestamps
- any errors you encounter
- usage of effects, sound generators and analysis tools
- file formats used when importing and exporting
- your OS type and Audacity version

You do not have to agree to this. If you agree, you can opt-out at any time by 
changing your preference at ""Preferences > Analytics"".

Some or all of this data is processed and stored by Yandex and Google. See our
Privacy Policy for more information.
```"
834541213,835,pushqrdx,2021-05-07T15:37:21Z,"> > I don't understand the outrage.
> 
> I'm with you on that. I don't get it either. It feels like a lot of paranoia in this thread.

Simple, lack of transparency from the start + iffy choice of what to collect and absolutely unnecessary choice of provides like Google and Yandex = outrage"
834542251,835,IGBC,2021-05-07T15:38:16Z,"# Have your say 
lets find out what people really want:

https://www.strawpoll.me/45241130

yes I see the irony in collecting statistics on if people want statistics collected."
834543264,835,julienbenjamin,2021-05-07T15:39:08Z,"> Mention in the pop-up that Google Analytics and Yandex are used for processing/storing the data.

As-per GDPR (at least), they MUST do that and more (consent, etc.)."
834543591,835,marcopavanello,2021-05-07T15:39:25Z,"> > Just the fact that despite after 2500 dislikes and more than 500 comments all saying we **DON'T** want telemetry, they don't take action says long enough about what kind of people we are dealing with. If we can't fix their minds then there is no more reason to even try to fight against.
> 
> they are just waiting for this shitstorm to die down and resume operation aftewards.
> weekend is coming, so I guess on early next week we get a more definitive answer.

This is toxic mentality if they do, because it means they don't care about the transparency of the decisions and are no different than big companies.
Instead, what they could and should do, is discussing these decisions in forums and with people, not decide by themselves what it's best for them."
834543636,835,mindinsomnia,2021-05-07T15:39:28Z,"> # Have your say
> 
> lets find out what people really want:
> 
> https://www.strawpoll.me/45241130
> 
> yes I see the irony in collecting statistics on if people want statistics collected.

I refuse to be tracked by your survey! You'll just sell my data to advertisers!"
834543942,835,SndChaser,2021-05-07T15:39:44Z,"@crsib :

> Due to the large amount of worry about this PR, (which we completely understand), we want to clarify exactly what is going on:

This is a good start, with 3000 people stating they are disapproving, confused or concerned it seems that the initial proposal was less than well considered.

>     1. Telemetry is **strictly optional and disabled by default**. No data is shared unless you choose to opt-in and enable telemetry.

Strictly optional for who?  Implementing an opt-in/opt-out dialog indicates that by default you are expecting this code to be compiled into the application

>     2. Telemetry only works in the builds made by GitHub CI from the official repo (the telemetry URLs are only defined there).
> 
>     3. If you are compiling Audacity from source, we will provide a CMake option to enable the telemetry code. This option will be turned **off** by default.

This seems rather disingenuous.  The vast majority of users do not compile this code themselves.  They get it from an upstream that compiles it for them, therefore the average user will have no way of knowing if this code is compiled into the application until they start it.

> **Why have telemetry at all?**
> 
> Essentially, it’s to help us to identify product issues early:

And this is a valid use case...  HOWEVER, having a valid use case doesn't make the jump to using API's from privacy disrespecting third parties an obvious solution.  Having identified the need and use case the obvious next step should have been to start a conversation how to best implement this feature, and make certain identify:

- Impact of the feature on developers
- Impact of the feature on users
- How to safeguard user information
- What is the chain of custody for the information being gathered
- What is the life cycle for the information
- What features will be available to users to see the information that is being gathered
- What types of transparency are the developers going to maintain around this information

> Regarding the concerns about the choice of providers:
> 
>     1. We do not incorporate cross-site tracking, limiting the ability to identify the user by both Google and Yandex.

Cross-site tracking is not necessary for Google to take the information supplied to them and use it against other sources they gather information from in order to fingerprint the user. This kind of data mining operation is precisely what they have been known to do for years now.


>     3. Google would only receive:
>        a. Session start and end events;
>        b. Errors for debugging;
>        c. File formats used for import and export;
>        d. OS and Audacity versions;
>        e. Use of effects, generators, and analysis tools to prioritize future improvements;

This is more than enough information for Google to use it in their mining operations.

>     4. We will consider replacing Google and Yandex with another service if we find one that fulfills our requirements - thanks for the suggestions and keep them coming.

Did you consider anything else?  I did a quick thought experiment about other common applications that I know that gather information.  What did I come up with?  Well, I'm using FireFox, and I know they gather information all the time.

So, I did a quick double check to see what their documentation / statement is around the information they gather.  They are very clear and transparent: [Telemetry collection and deletion](https://support.mozilla.org/en-US/kb/telemetry-clientid).  I note they have some very carefully stated guidelines surrounding the gathering and use of this information:

> **How long do you keep telemetry data?**

> We keep telemetry data for 13 months.

> **How do I opt out or delete telemetry data?**

> You can opt out of sending any Firefox telemetry information at any time. If you opt out of sending telemetry data, we will also treat this as a request to delete any data we previously collected. Data will be deleted within 30 days after you opt out. 

Your proposal is that you have an on / off switch, with no indication of:

1. Where the information is stored?
2. How long the information is stored?
3. What (if anything) will be done to anonymize the information?
4. Who will have access to the information (including any third parties)?
5. If the user turns off the option later, when will their information be deleted?

Speaking to #3 above, it's definitely necessary as you have stated:

> Both services also record the IP the request is coming from.

The simple FAQ style document from Mozilla addresses a number of these concerns, and links to more in depth information regarding the gathering of this information and all of the technical details of how it is used.  This is the kind of transparency that needs to be included when addressing this kind of situation.

One of the nicer things about Mozilla's implementation is they have a whole, publicly available portal for information surrounding the telemetry they gather: [Mozilla Telemetry Portal](https://telemetry.mozilla.org/) - nothing in your proposal suggests that you would implement anything similar.

Also, very noteworthy: Mozilla has a **whole open source [SDK called GLEAN](https://mozilla.github.io/glean/dev/index.html)** for this application.  This is the kind of implementation that should have been considered before even one line of code was written to try to implement this.,

The big takeaway here, is that as a developer you have misunderstood the practice for implementing a large new feature.  From a technology standpoint it is simple.  The hard part is the **policy, procedures and processes** that are needed to support this feature.  The code is the easy part, it's working with the whole community that is difficult, BUT IT IS ABSOLUTELY CRITICAL."
834545807,835,PureIncompetence,2021-05-07T15:41:31Z,"As they're obviously do not take the concerns of thousands of their users serious - Waiting for Forks to come.
Get ready to become the OpenOffice of audio software."
834546040,835,IGBC,2021-05-07T15:41:44Z,"> I refuse to be tracked by your survey! You'll just sell my data to advertisers!

😆  very good. Yes straw poll collect your IP address for the purposes of ensuring you can't vote twice. However when creating the poll I disabled all other cheat tracking, including cookies. Unlike audacity at least straw poll is upfront about their what data they actually collect.
"
834546723,835,ghost,2021-05-07T15:42:26Z,"I think it's useless keep going. It's clear they won't change their mind, I will stay with my idea that the telemetry has been added to sell data to corporations and maybe one day sell the whole Audacity software, team and users.
Now, everybody is free to believe what they want to believe and keep going, just keep in mind you won't get listened."
834546874,835,pehdfms,2021-05-07T15:42:34Z,"@tralph3 

> They just want to have data to improve Audacity, and the way they are doing it is the best way.

Plenty of major FOSS projects get by without telemetry, this isn't necessary in any way. Even if it were, GA isn't the way to go about it.

> Take into account, this data is anonymous and opt-in. PLUS this is only enabled if you compile from source with the intention of enabling it

Anonymous it ain't. pseudonymous is the word here, the data it sends seems to be easily traceable to a personal profile on google's end. Opt-in and compile flag looks to have been last minute changes just to try to appease the crowd, one being a GDPR requirement in the first place and the second being a very fragile line of security.

> Also, Audacity is open source, if this actually gets out of hand, a fork will exist with all the crap removed. There's no reason to be alarmed.

Forking is the last line of defense against stuff like this. If arguing over it gets it away from being merged upstream, that's in the best interests of (I think) almost everyone involved. "
834549915,835,SteveDaulton,2021-05-07T15:45:33Z,"> lets find out what people really want:
> 
> https://www.strawpoll.me/45241130

:lol: Apologies for being off-topic, but did you read this on the  strawpoll.me site?

""Fandom and our partners use technology such as cookies on our site to store and collect information from your browser to personalize content and ads, provide social media features, and analyze our traffic."""
834550278,835,eylles,2021-05-07T15:45:55Z,"> > Meanwhile you are just underestimating us that we will not make a fork of it and not caring about telemetry at all.
> 
> I'll make the logo!

Make it cute and i'm in!"
834550735,835,ghost,2021-05-07T15:46:24Z,"> > > Meanwhile you are just underestimating us that we will not make a fork of it and not caring about telemetry at all.
> > 
> > 
> > I'll make the logo!
> 
> Make it cute and i'm in!

[fork name]-chan will be the mascot! (please I hope the name will be 'Audience')"
834551069,835,Evrey,2021-05-07T15:46:48Z,"Things i learned in this disrespectful and in its execution illegal PR:

- Audacity shall be dead to me, time to install Ardour.
- Time to uninstall MuseScore and stop composing music until i managed to save the ~500€ for Finale.

Fuck this."
834551144,835,IGBC,2021-05-07T15:46:53Z,"> > lets find out what people really want:
> > https://www.strawpoll.me/45241130
> 
> :lol: Apologies for being off-topic, but did you read this on the strawpoll.me site?
> 
> ""Fandom and our partners use technology such as cookies on our site to store and collect information from your browser to personalize content and ads, provide social media features, and analyze our traffic.""

yea websites be shitty. But there are tools and plugins and browser features for protecting yourself online. Maybe you see why we don't want these same technologies in a native app where no such protections exist?"
834552120,835,mindinsomnia,2021-05-07T15:47:18Z,"> > lets find out what people really want:
> > https://www.strawpoll.me/45241130
> 
> :lol: Apologies for being off-topic, but did you read this on the strawpoll.me site?
> 
> ""Fandom and our partners use technology such as cookies on our site to store and collect information from your browser to personalize content and ads, provide social media features, and analyze our traffic.""

Also this:

>  How do we collect your data?
> Some data are collected when you provide it to us. This could, for example, be data you enter on a contact form.
> Other data are collected automatically by our IT systems when you visit the website. **These data are primarily technical data such as the browser and operating system you are using or when you accessed the page. These data are collected automatically as soon as you enter our website.** 

Strawpoll does literally the very thing this thread is against."
834554004,835,neobenedict,2021-05-07T15:48:07Z,"> 
> 
> > lets find out what people really want:
> > https://www.strawpoll.me/45241130
> 
> :lol: Apologies for being off-topic, but did you read this on the strawpoll.me site?
> 
> ""Fandom and our partners use technology such as cookies on our site to store and collect information from your browser to personalize content and ads, provide social media features, and analyze our traffic.""

Wait until you hear what GitHub collects

> 
> 
> > > lets find out what people really want:
> > > https://www.strawpoll.me/45241130
> > 
> > 
> > :lol: Apologies for being off-topic, but did you read this on the strawpoll.me site?
> > ""Fandom and our partners use technology such as cookies on our site to store and collect information from your browser to personalize content and ads, provide social media features, and analyze our traffic.""
> 
> Also this:
> 
> > How do we collect your data?
> > Some data are collected when you provide it to us. This could, for example, be data you enter on a contact form.
> > Other data are collected automatically by our IT systems when you visit the website. **These data are primarily technical data such as the browser and operating system you are using or when you accessed the page. These data are collected automatically as soon as you enter our website.**
> 
> Strawpoll does literally the very thing this thread is against.

Wait until you hear what data GitHub collects!"
834554577,835,IGBC,2021-05-07T15:48:21Z,"> > > lets find out what people really want:
> > > https://www.strawpoll.me/45241130
> > 
> > 
> > :lol: Apologies for being off-topic, but did you read this on the strawpoll.me site?
> > ""Fandom and our partners use technology such as cookies on our site to store and collect information from your browser to personalize content and ads, provide social media features, and analyze our traffic.""
> 
> Also this:
> 
> > How do we collect your data?
> > Some data are collected when you provide it to us. This could, for example, be data you enter on a contact form.
> > Other data are collected automatically by our IT systems when you visit the website. **These data are primarily technical data such as the browser and operating system you are using or when you accessed the page. These data are collected automatically as soon as you enter our website.**
> 
> Strawpoll does literally the very thing this thread is against.

y'all realise that every time you comment on this you bring more people to my poll

I have got over 250 votes "
834559389,835,mindinsomnia,2021-05-07T15:50:51Z,"> > > > lets find out what people really want:
> > > > https://www.strawpoll.me/45241130
> > > 
> > > 
> > > :lol: Apologies for being off-topic, but did you read this on the strawpoll.me site?
> > > ""Fandom and our partners use technology such as cookies on our site to store and collect information from your browser to personalize content and ads, provide social media features, and analyze our traffic.""
> > 
> > 
> > Also this:
> > > How do we collect your data?
> > > Some data are collected when you provide it to us. This could, for example, be data you enter on a contact form.
> > > Other data are collected automatically by our IT systems when you visit the website. **These data are primarily technical data such as the browser and operating system you are using or when you accessed the page. These data are collected automatically as soon as you enter our website.**
> > 
> > 
> > Strawpoll does literally the very thing this thread is against.
> 
> y'all realise that every time you comment on this you bring more people to my poll
> 
> I have got over 250 votes

With a highly biased sample size of mainly people who already agree with you.

But it's besides the point. The point is, Strawpoll's user tracking is actually worse than what audacity is proposing.
A) It's not even possible to opt out of strawpoll's tracking
B) Strawpoll is actually sending that data to advertisers"
834561165,835,turtlegarden,2021-05-07T15:52:32Z,Are we making a Microsoft Audacity now? Come on.
834561184,835,BitesizedLion,2021-05-07T15:52:33Z,"this is getting kind of ""off-topic"" I feel."
834561258,835,sandycorzeta,2021-05-07T15:52:36Z,"Just to make sure to bump this question from @SndChaser doesnt get dumped because of the conversation

> @crsib :
> 
> > Due to the large amount of worry about this PR, (which we completely understand), we want to clarify exactly what is going on:
> 
> This is a good start, with 3000 people stating they are disapproving, confused or concerned it seems that the initial proposal was less than well considered.
> 
> > ```
> > 1. Telemetry is **strictly optional and disabled by default**. No data is shared unless you choose to opt-in and enable telemetry.
> > ```
> 
> Strictly optional for who? Implementing an opt-in/opt-out dialog indicates that by default you are expecting this code to be compiled into the application
> 
> > ```
> > 2. Telemetry only works in the builds made by GitHub CI from the official repo (the telemetry URLs are only defined there).
> > 
> > 3. If you are compiling Audacity from source, we will provide a CMake option to enable the telemetry code. This option will be turned **off** by default.
> > ```
> 
> This seems rather disingenuous. The vast majority of users do not compile this code themselves. They get it from an upstream that compiles it for them, therefore the average user will have no way of knowing if this code is compiled into the application until they start it.
> 
> > **Why have telemetry at all?**
> > Essentially, it’s to help us to identify product issues early:
> 
> And this is a valid use case... HOWEVER, having a valid use case doesn't make the jump to using API's from privacy disrespecting third parties an obvious solution. Having identified the need and use case the obvious next step should have been to start a conversation how to best implement this feature, and make certain identify:
> 
> * Impact of the feature on developers
> * Impact of the feature on users
> * How to safeguard user information
> * What is the chain of custody for the information being gathered
> * What is the life cycle for the information
> * What features will be available to users to see the information that is being gathered
> * What types of transparency are the developers going to maintain around this information
> 
> > Regarding the concerns about the choice of providers:
> > ```
> > 1. We do not incorporate cross-site tracking, limiting the ability to identify the user by both Google and Yandex.
> > ```
> 
> Cross-site tracking is not necessary for Google to take the information supplied to them and use it against other sources they gather information from in order to fingerprint the user. This kind of data mining operation is precisely what they have been known to do for years now.
> 
> > ```
> > 3. Google would only receive:
> >    a. Session start and end events;
> >    b. Errors for debugging;
> >    c. File formats used for import and export;
> >    d. OS and Audacity versions;
> >    e. Use of effects, generators, and analysis tools to prioritize future improvements;
> > ```
> 
> This is more than enough information for Google to use it in their mining operations.
> 
> > ```
> > 4. We will consider replacing Google and Yandex with another service if we find one that fulfills our requirements - thanks for the suggestions and keep them coming.
> > ```
> 
> Did you consider anything else? I did a quick thought experiment about other common applications that I know that gather information. What did I come up with? Well, I'm using FireFox, and I know they gather information all the time.
> 
> So, I did a quick double check to see what their documentation / statement is around the information they gather. They are very clear and transparent: [Telemetry collection and deletion](https://support.mozilla.org/en-US/kb/telemetry-clientid). I note they have some very carefully stated guidelines surrounding the gathering and use of this information:
> 
> > **How long do you keep telemetry data?**
> 
> > We keep telemetry data for 13 months.
> 
> > **How do I opt out or delete telemetry data?**
> 
> > You can opt out of sending any Firefox telemetry information at any time. If you opt out of sending telemetry data, we will also treat this as a request to delete any data we previously collected. Data will be deleted within 30 days after you opt out.
> 
> Your proposal is that you have an on / off switch, with no indication of:
> 
> 1. Where the information is stored?
> 2. How long the information is stored?
> 3. What (if anything) will be done to anonymize the information?
> 4. Who will have access to the information (including any third parties)?
> 5. If the user turns off the option later, when will their information be deleted?
> 
> Speaking to #3 above, it's definitely necessary as you have stated:
> 
> > Both services also record the IP the request is coming from.
> 
> The simple FAQ style document from Mozilla addresses a number of these concerns, and links to more in depth information regarding the gathering of this information and all of the technical details of how it is used. This is the kind of transparency that needs to be included when addressing this kind of situation.
> 
> One of the nicer things about Mozilla's implementation is they have a whole, publicly available portal for information surrounding the telemetry they gather: [Mozilla Telemetry Portal](https://telemetry.mozilla.org/) - nothing in your proposal suggests that you would implement anything similar.
> 
> Also, very noteworthy: Mozilla has a **whole open source [SDK called GLEAN](https://mozilla.github.io/glean/dev/index.html)** for this application. This is the kind of implementation that should have been considered before even one line of code was written to try to implement this.,
> 
> The big takeaway here, is that as a developer you have misunderstood the practice for implementing a large new feature. From a technology standpoint it is simple. The hard part is the **policy, procedures and processes** that are needed to support this feature. The code is the easy part, it's working with the whole community that is difficult, BUT IT IS ABSOLUTELY CRITICAL.

"
834561914,835,IGBC,2021-05-07T15:53:13Z,"> > > > > lets find out what people really want:
> > > > > https://www.strawpoll.me/45241130
> > > > 
> > > > 
> > > > :lol: Apologies for being off-topic, but did you read this on the strawpoll.me site?
> > > > ""Fandom and our partners use technology such as cookies on our site to store and collect information from your browser to personalize content and ads, provide social media features, and analyze our traffic.""
> > > 
> > > 
> > > Also this:
> > > > How do we collect your data?
> > > > Some data are collected when you provide it to us. This could, for example, be data you enter on a contact form.
> > > > Other data are collected automatically by our IT systems when you visit the website. **These data are primarily technical data such as the browser and operating system you are using or when you accessed the page. These data are collected automatically as soon as you enter our website.**
> > > 
> > > 
> > > Strawpoll does literally the very thing this thread is against.
> > 
> > 
> > y'all realise that every time you comment on this you bring more people to my poll
> > I have got over 250 votes
> 
> With a highly biased sample size of mainly people who already agree with you.
> 
> But it's besides the point. The point is, Strawpoll's user tracking is actually worse than what audacity is proposing.
> A) It's not even possible to opt out of strawpoll's tracking
> B) Strawpoll is actually sending that data to advertisers

so what your saying is....

Statistics are a bad way of judging how the community as a whole feels about your software?"
834562384,835,Qix-,2021-05-07T15:53:39Z,"@mindinsomnia 

>  The point is, Strawpoll's user tracking is actually worse than what audacity is proposing.

I don't use Strawpoll every day to do my job. Strawpoll doesn't care about my usage patterns other than the 3 seconds I took to use their site. I have Privacy Badger and uBlock Origin installed, which thwarts most of what they try anyway.

None of that can be said for Audacity. You're arguing a moot point."
834564722,835,marcopavanello,2021-05-07T15:55:46Z,"@mindinsomnia Are you realizing that you have more dislikes than likes in your posts?
The strawpoll is not biased in any way I see."
834567336,835,arnavbhatt288,2021-05-07T15:58:13Z,"> > > > Meanwhile you are just underestimating us that we will not make a fork of it and not caring about telemetry at all.
> > > 
> > > 
> > > I'll make the logo!
> > 
> > 
> > Make it cute and i'm in!
> 
> [fork name]-chan will be the mascot! (please I hope the name will be 'Audience')

the damn weebs"
834572123,835,IGBC,2021-05-07T16:02:47Z,"# OK poll time,

lets find out what people really want:

https://www.strawpoll.me/45241130

400 responses and counting"
834573904,835,tastytea,2021-05-07T16:04:33Z,@IGBC You're making a poll asking whether it's okay to send data to Google using a site that sends data to Google?
834573980,835,rak1507,2021-05-07T16:04:36Z,"I don't know why people are acting as if this is new, musescore's website has used Yandex for telemetry since at least January 2019. https://musescore.org/en/node/283188"
834574071,835,j0lol,2021-05-07T16:04:42Z,"> # OK poll time,
> 
> lets find out what people really want:
> 
> https://www.strawpoll.me/45241130
> 
> 400 responses and counting

you dont need to keep reposting this"
834574758,835,IGBC,2021-05-07T16:05:24Z,fine :P I will put the results up when it slows down enough
834575178,835,Qix-,2021-05-07T16:05:47Z,"@rak1507

> I don't know why people are acting as if this is new,

I would wager because Audacity is (most likely) used by exponentially more people than MuseScore. Nobody here is suggesting that sending analytics to shady companies is new."
834576049,835,ghost,2021-05-07T16:06:35Z,"> I don't know why people are acting as if this is new, musescore's website has used Yandex for telemetry since at least January 2019. https://musescore.org/en/node/283188

Because we are talking about Audacity here, I guess ¯\_(ツ)_/¯"
834576108,835,Evrey,2021-05-07T16:06:38Z,"@rak1507 You do understand the difference between a damn website running behind uBlock Origin, uMatrix, and more, where *we* are in control over what code runs, somewhat, and a compiled executable that can do whatever it wants to, right?"
834577547,835,rakshazi,2021-05-07T16:08:07Z,"May be use sentry.io (it's open source, you can selfhost it) for the data, described in PR? It's privacy friendly and (IMO) perfect fit for such case."
834577751,835,rak1507,2021-05-07T16:08:21Z,"I think I put it the wrong way, I'm just pointing out that they've always been pretty shady."
834578816,835,tilda,2021-05-07T16:09:26Z,"> May be use sentry.io (it's open source, you can selfhost it) for the data, described in PR? It's privacy friendly and (IMO) perfect fit for such case.

Sentry wouldn't work for this, it's only for error reporting AFAIK."
834585377,835,eylles,2021-05-07T16:16:20Z,"> > > > > Meanwhile you are just underestimating us that we will not make a fork of it and not caring about telemetry at all.
> > > > 
> > > > 
> > > > I'll make the logo!
> > > 
> > > 
> > > Make it cute and i'm in!
> > 
> > 
> > [fork name]-chan will be the mascot! (please I hope the name will be 'Audience')
> 
> the damn weebs

Are more likely to fork software."
834592067,835,rakshazi,2021-05-07T16:23:59Z,"> > May be use sentry.io (it's open source, you can selfhost it) for the data, described in PR? It's privacy friendly and (IMO) perfect fit for such case.
> 
> Sentry wouldn't work for this, it's only for error reporting AFAIK.

Nope, you can report both errors and custom events, here is link to the doc page of sentry CLI, but the same for any platform with sentry SDK: https://docs.sentry.io/product/cli/send-event/

We literally used that for tracking user base count and ""open app home screen"" events for mobile apps in one of private projects, because we don't want to send our users data to google analytics or yandex (app)metrica"
834593197,835,SndChaser,2021-05-07T16:25:07Z,"> Have you looked at https://sentry.io/welcome/ as this seems to be what you want you want and would then remove Google and yandex which seems better and you can even host it yourself if I recall correctly

I'd be cautious of this one...  I don't see anything licenses, and I don't see any clear statements about how data is handled if it isn't self-hosted.  IOW - it would be possible to encounter many similar issues that we have with Google and Yandex now...  And the fact that this isn't an open source project gives me quite a bad feeling about it being used in an open source project."
834595864,835,BitesizedLion,2021-05-07T16:27:55Z,"> > Have you looked at https://sentry.io/welcome/ as this seems to be what you want you want and would then remove Google and yandex which seems better and you can even host it yourself if I recall correctly
> 
> I'd be cautious of this one... I don't see anything licenses, and I don't see any clear statements about how data is handled if it isn't self-hosted. IOW - it would be possible to encounter many similar issues that we have with Google and Yandex now... And the fact that this isn't an open source project gives me quite a bad feeling about it being used in an open source project.

https://github.com/getsentry/"
834598802,835,pauldavisthefirst,2021-05-07T16:30:46Z,"> Things i learned in this disrespectful and in its execution illegal PR:
> 
>     * Audacity shall be dead to me, time to install Ardour.

As the original/lead dev of Ardour, I appreciate the sentiment, but it should be made clear that Audacity is an audio file editor, and Ardour is a DAW. Although their functionality overlaps somewhat, they are entirely different sorts of programs, and one does not replace the other (at least, not necessarily). 

Also in the interest of full disclosure, builds of Ardour from ardour.org (the only ones we recommend and support) will contact ardour.org (not google) when you start the application and send it your OS and current Ardour version. We use this to notify you of new releases. We necessarily know your IP address when you do this (because that's how the internet works). We do store this information, but do nothing else with it: ardour.org has no idea who you are or what you are doing with Ardour (and we don't want to know either)."
834600905,835,Lothrazar,2021-05-07T16:32:58Z,"Making an audacity app steal data and send it off to random third parties is pointless. Why would anyone want this

This provides zero value to the end user, is a huge potential risk, and its VERY bad public relations

Why? Just why"
834602926,835,poetaster,2021-05-07T16:34:54Z,"Ok, although I hate google enough to have moved entirely to SFOS (look at my repos), I certainly understand why this is being done. As long as it is opt-in, I'm ok with that. I never go anywhere near those settings and I've been using Audacity from the beginning. 

Thanks Muse and Audacity teams for your work! "
834602980,835,tilda,2021-05-07T16:34:57Z,"> > > May be use sentry.io (it's open source, you can selfhost it) for the data, described in PR? It's privacy friendly and (IMO) perfect fit for such case.
> > 
> > 
> > Sentry wouldn't work for this, it's only for error reporting AFAIK.
> 
> Nope, you can report both errors and custom events, here is link to the doc page of sentry CLI, but the same for any platform with sentry SDK: https://docs.sentry.io/product/cli/send-event/
> 
> We literally used that for tracking user base count and ""open app home screen"" events for mobile apps in one of private projects, because we don't want to send our users data to google analytics or yandex (app)metrica

Thanks for the correction, might not be too bad of a solution then.

> > Have you looked at https://sentry.io/welcome/ as this seems to be what you want you want and would then remove Google and yandex which seems better and you can even host it yourself if I recall correctly
> 
> I'd be cautious of this one... I don't see anything licenses, and I don't see any clear statements about how data is handled if it isn't self-hosted. IOW - it would be possible to encounter many similar issues that we have with Google and Yandex now... And the fact that this isn't an open source project gives me quite a bad feeling about it being used in an open source project.

You do bring up a good point. I looked into [their repository](https://github.com/getsentry/sentry) and it appears the code is licensed under the ""Business Source License"" which explicitly says it is not an open source license. The license changes from this ""BSL"" to Apache 2.0 after 3 years AFAIK, which is not ideal. So maybe Sentry is not the move here."
834603395,835,asdf8dfafjk,2021-05-07T16:35:25Z,Because of the FUD around telemetry- making it optional would mean most half-informed people will turn it off (most of them being on Linux). Thus audacity will have no way to track linux usage hurting it's progress on Linux. I propose making it mandatory and impossible to turn off but with anonymization and less data points.	 	 
834605521,835,j0lol,2021-05-07T16:37:46Z,"> Because of the FUD around telemetry- making it optional would mean most half-informed people will turn it off (most of them being on Linux). Thus audacity will have no way to track linux usage hurting it's progress on Linux. I propose making it mandatory and impossible to turn off but with anonymization and less data points.

if it cannot be turned off people will just disallow audacity internet access with a firewall"
834606647,835,ne-vlezay80,2021-05-07T16:39:01Z,"```
ip netns add audacity
ip netns exec sudo -u $SUDO_USER audacity
```"
834608079,835,ne-vlezay80,2021-05-07T16:39:59Z,"For OpenBSD:
```
route -T255 exec audacity
```"
834611167,835,andrewthetechie,2021-05-07T16:43:17Z,"I'm sure continued comments are going to get lost in the giant flood of folks already commenting here, but this is a bad idea :TM: as currently implemented. 

Since you are attempting this ostensably to collect user feedback/needs, I'll make my feedback very clear. If this PR is merged, I will no longer use Audacity and will find another solution. I will also no longer reccomend Audacity to friends/colleagues due to this stance on user privacy.

If this PR was revised to meet some of the suggestions of others in the thread (using a self-hosted and secured telemetry system, being clearer about what data is being collected, making opt-out the default) I would re-consider my stance. However, the trust has already been broken in my opinion and now I would have to cautious about every future change to Audacity being a change that violates user privacy."
834611829,835,SndChaser,2021-05-07T16:44:00Z,"@pauldavisthefirst :

> Also in the interest of full disclosure, builds of Ardour from ardour.org (the only ones we recommend and support) will contact ardour.org (not google) when you start the application and send it your OS and current Ardour version. We use this to notify you of new releases. We necessarily know your IP address when you do this (because that's how the internet works). We do store this information, but do nothing else with it: ardour.org has no idea who you are or what you are doing with Ardour (and we don't want to know either).

Hi Paul,

Thanks for wading into this messy PR to comment on some of these items.  I don't think the kind of ""check-in"" system is something that most would object to...  By implementing this feature in a way that is respectful to your users.

However, I wondered if you could provide some more feedback to help clarify some of the things about how Ardour went about implementing this feature?  Things I would be curious to see added to this conversation would include:

1. How transparent is this feature implementation to users?
2. Is there any end-user documentation surrounding the implementation of the feature? (IE, what's gathered, how long it's kept, how it's used, etc.)
3. Were there any internal discussions before the decision was made to implement this feature?
4. Were there any public conversations before this feature was implmented?
5. What is the data retention policy surrounding this information?
6. Were there any steps taken in light of regulations that could influence how this information is kept?
7. What procedures are followed to keep this information secure?

I do find it a little disheartening to hear that Ardour is storing the IP address.  It  would seem to me that during a check-in it would be possible to notify users of updates, and once that is done then the IP address is not really needed and could be scrubbed from the stored information.  If you are looking to build more usage data, then an anonymized UUID should be used instead of the IP address.


EDIT: Changed: """"check-in"" system is something that anyone would object to.."" To """"check-in"" system is something that most would object to.."""
834613227,835,IGBC,2021-05-07T16:45:34Z,">  I don't think the kind of ""check-in"" system is something that anyone would object to...

22% of respondants polled state they object to any form of network communication: https://www.strawpoll.me/45241130/r"
834615117,835,SndChaser,2021-05-07T16:47:52Z,"> > I don't think the kind of ""check-in"" system is something that anyone would object to...
> 
> 22% of respondants polled state they object to any form of network communication: https://www.strawpoll.me/45241130/r

I should have said *most* instead of any.  Obviously 22% is not a majority.  And, a sample size of less than 1000 against a user base (at least according to the forum) of over 150,000 isn't quite significant."
834616399,835,hexathos,2021-05-07T16:49:34Z,Looking forward to a fork of the pre-tracking audacity ... 
834617735,835,reowens,2021-05-07T16:51:33Z,"You are absolutely insane. Don’t worry, I won’t ever be using Audacity ever again. You took the trust we had in your software and flushed it down the toilet. "
834619674,835,Qix-,2021-05-07T16:54:42Z,"@Sciss 

> > I do find it a little disheartening to hear that Ardour is storing the IP address
>
> I don't know where you hear that?

Right here: https://github.com/audacity/audacity/pull/835#issuecomment-834598802

> We necessarily know your IP address when you do this (because that's how the internet works). **We do store this information**

Emphasis mine."
834621296,835,BitesizedLion,2021-05-07T16:56:56Z,"Audacity hasn't needed Telemetry in the past, and it doesn't need it now.

The fact that it's opt-in would make it useless any way, because the majority of your users wont go and opt-in I'm pretty sure."
834621523,835,tilda,2021-05-07T16:57:15Z,"> @Sciss
> 
> > > I do find it a little disheartening to hear that Ardour is storing the IP address
> > 
> > 
> > I don't know where you hear that?
> 
> Right here: [#835 (comment)](https://github.com/audacity/audacity/pull/835#issuecomment-834598802)
> 
> > We necessarily know your IP address when you do this (because that's how the internet works). **We do store this information**
> 
> Emphasis mine.

It's likely that the IP address being stored is in web server logs, etc. nginx, etc logs IP addresses in access logs by default."
834622705,835,Qix-,2021-05-07T16:59:05Z,"@tilda Please read the original comment. They explicitly store this information along with the user's OS. It is deliberate, not a mis-configuration.

Even if it is web server logging, that doesn't make it OK."
834624099,835,immibis,2021-05-07T17:01:19Z,"Holy crap this is a lot of drama. I'm gonna just state my opinion:

* It is possible for analytics to be okay, because ""analytics"" is a very broad word. The word ""analytics"" includes things that are okay and also things that aren't.
* I have no problem with the developers of any program knowing someone is using their program on Linux, or on x64 Gentoo Linux
* I have no problem with the developers of any program knowing people use their program XX hours per day on average
* I have no problem with the developers of any program knowing that people are using certain plugins more than others
* The above information can be gotten without having a concept of sessions
* The above information can be gotten without linking data together. There would be no reason to need to know that people who start Audacity at a certain time of day are more likely to use a certain plugin.
* I wonder how useful the above information actually is
* I would be worried about the developers of a program knowing exactly when I'm using it.
* I would be worried about the developers of a program knowing in precise detail what I'm using it for (e.g. sending audio data to the server)
* I would be worried about the developers of a program linking together all that data and building a user profile.
* Google is permanently untrustworthy. If it would just collect the above-mentioned data and calculate statistics for the Audacity developers, that would be okay. But I doubt that it does just that. There is no transparency about what Google does with your data. Not even the Audacity developers would know. Same for other large advertising companies.
* You guys (you know who you are) are making a mountain out of a molehill considering the program asks you whether you'd like to enable analytics when you start it up. It's like you saw the word ""telemetry"" and just rushed in to attack the developers. Sheesh, cut it out.
* The fact that a program has telemetry *that you turned off* is a really dumb reason to avoid using the program.
* People who are irrationally pissed off are more likely to be commenting in this thread, than people who aren't. They are a ""vocal minority"""
834624926,835,pauldavisthefirst,2021-05-07T17:02:40Z,"   
> * How transparent is this feature implementation to users?

It can be disabled if running from the command line. If the system is not online, or has a firewall blocking the communication, Ardour continues normally and without delay (it is done in a separate thread, and can fail with no impact). 

> * Is there any end-user documentation surrounding the implementation of the feature? (IE, what's gathered, how long it's kept, how it's used, etc.)

There is not.

> * Were there any internal discussions before the decision was made to implement this feature?

There were.
 
> * Were there any public conversations before this feature was implmented?

With the core user group, on IRC. There may or may not have been some discussion on the user mailing list - I don't recall.

> * What is the data retention policy surrounding this information?

The information is not associated with any user ID at ardour.org and so cannot be deleted in connection with a GDPR-style request. Making it deletable on request would mean associating it in someway with a user ID, which we will not do. We currently retain all such ""pings"" back to 2013.

> * Were there any steps taken in light of regulations that could influence how this information is kept?

I researched this when the GDPR passed, and do not believe that it is affected by it.
 
> * What procedures are followed to keep this information secure?

The usual procedures that we follow to make ardour.org itself secure, nothing more. There is an unpublicized URL that provides an aggregate summary of the data, but we rarely use it because the DB query takes too long to execute. We already have the general message that Windows and Linux users are about equally sized groups, with macOS significantly smaller, and to be honest the information coming in likely only serves to reinforce that. In that sense, we would not lose much at this point by not storing the data at all.

"
834625883,835,Qix-,2021-05-07T17:04:17Z,"@pauldavisthefirst

> In that sense, we would not lose much at this point by not storing the data at all.

You'd win a lot of points making this change in the near future, given the timing. Just a thought.

I've been looking to switch away from Cubase. Maybe Ardour can be my next destination."
834626680,835,SndChaser,2021-05-07T17:05:34Z,"> Because of the FUD around telemetry- making it optional would mean most half-informed people will turn it off (most of them being on Linux). Thus audacity will have no way to track linux usage hurting it's progress on Linux. I propose making it mandatory and impossible to turn off but with anonymization and less data points.

Bravo! You've won the award for the most irrational and stupifying dumb comment in this conversation. (1) Linux users tend to be much more technical, and much better informed than the general user base, (2) such a move would likely get Audacity removed from most Linux distributions, (3) a fork would likely be inevitable, (4) the harm to the reputation of Audacity would be irreparable, (5) there would be a good chance that this kind of move could find itself in a regulatory quagmire of GDPR, CCPA, and others.

This would absolutely guarantee that Audacity would go the way of OpenOffice.org.

Hmm, I think I like the name ""LibreAudio"" for the fork.... ;)"
834628099,835,pauldavisthefirst,2021-05-07T17:07:56Z,"> (2) such a move would likely get Audacity removed from most Linux distributions,

As long as it can be disabled at compile time, this is exceedingly unlikely. Linux distributions (AFAIK) all build Ardour with the --no-phone-home configure-time option. It's not an issue."
834628266,835,immibis,2021-05-07T17:08:14Z,"> Bravo! You've won the award for the most irrational and stupifying dumb comment in this conversation. (1) Linux users tend to be much more technical, and much better informed than the general user base, (2) such a move would likely get Audacity removed from most Linux distributions, (3) a fork would likely be inevitable, (4) the harm to the reputation of Audacity would be irreparable, (5) there would be a good chance that this kind of move could find itself in a regulatory quagmire of GDPR, CCPA, and others.

I get the impression that comment was deliberately inflammatory (i.e. ""trolling"")"
834629976,835,SndChaser,2021-05-07T17:11:12Z,"> > I do find it a little disheartening to hear that Ardour is storing the IP address
> 
> I don't know where you hear that? Without forestalling an answer by Paul, what seems 

Paul's original comment:

> We necessarily know your IP address when you do this (because that's how the internet works). We do store this information

Maybe I am reading that too tightly, but ""store this information"" would indicate storing the IP address.

> version. IP addresses are part of making an HTTPS query, other than that they are not stored or processed in any form.

Which is how it should be. It could just have been the wording of Paul's comment that lead me to incorrectly believe that the IP address is being stored.  If it isn't, then the feature is working the way I would hope most other developers (like you) would handle it."
834630549,835,pauldavisthefirst,2021-05-07T17:12:12Z,"> I've been looking to switch away from Cubase. Maybe Ardour can be my next destination.

For every person who tries Ardour and loves it, there's someone who emails me and says ""this is complete garbage, I can't even believe that you think this is usable"". For every person who says ""I used to use Logic, but Ardour is so much more intuitive"", someone emails ""this program is f***ing impossible to use, it's not intuitive at all, i'm never using it again"". I long ago stopped caring - we work for the people who like Ardour, everybody else has a great choice of amazing DAWs to work with (and prefer)."
834631569,835,IGBC,2021-05-07T17:13:59Z," 1000 votes and the results seem pretty stable so I am happy to post them:

![Screenshot_2021-05-07 Audacity PR #835](https://user-images.githubusercontent.com/8123843/117485029-cd891880-af5f-11eb-9cd1-d51e75d8be54.png)

These strawpolls are perpetual (I can't close it) so you can still vote https://www.strawpoll.me/45241130/
 "
834631600,835,Qix-,2021-05-07T17:14:02Z,"@pauldavisthefirst I understand. Having worked on development of a DAW myself, I'm always interested in trying new ones. Cubase is pretty bad for how I work, and it's glitchy to boot. Updates are expensive.

You might not care, but I do. I also care about not being tracked."
834632064,835,InterVi,2021-05-07T17:14:45Z,"already have a fork, without spyware?"
834632706,835,SndChaser,2021-05-07T17:15:50Z,">never using it again"". I long ago stopped caring - we work for the people who like Ardour, everybody else has a great choice of amazing DAWs to work with (and prefer).

Count me as one of those people who loves Ardour.  I've used it for numerous recording projects (of my weird, out there noise sound stuff), and used it for rough mastering other people's works.  It's a brilliant tool when used in the manner it was designed to be used.

Audacity has it's place in audio toolkits as a quick record and edit tool, right alongside Ardour.  They both have their places and uses."
834633075,835,pauldavisthefirst,2021-05-07T17:16:25Z,"> Which is how it should be. It could just have been the wording of Paul's comment that lead me to incorrectly believe that the IP address is being stored.

The IP address is stored. We consider it less identifying than a UUID, and wanted a way to count pings from the ""same address"" in order to differentiate 1-time ""testing the waters"" from repeat usage. But again, we've pretty much reached ""stable information"" - someone who has used it more than 3 times fires up a version they got from us about every 2.4 minutes, with at least once such user in almost every country on earth, windows & linux equal, macOS trailing. There's not a lot more we will ever glean from this data, so we may indeed stop storing any of it."
834637795,835,ceulig,2021-05-07T17:24:40Z,"Just to add a thought to the whole discussion: At this point, the tracking and data collection, no matter how well meaning or not, hardly matters, the damage is already done. Open Source projects live through the community, and though the contribution of enthusiasts. Even the mention of something that makes the community lose trust in the development process and the software will negatively impact the outcome. This isn't just passionately discussed here, but at multiple places, and that will all impact the future of Audacity. The outcome will not be a net positive. Trust is a fickle thing in knowledgeable IT people... The best thing to do is for the people responsible to admit this to themselves and to the community, salvage what trust in the project remains, and maybe consider what Open Source in general and Audacity in particular really needs to thrive in the long term."
834638000,835,SndChaser,2021-05-07T17:25:01Z,"@pauldavisthefirst 

> The IP address is stored. We consider it less identifying than a UUID, and wanted a way to count pings from the ""same address"" in order to differentiate 1-time ""testing the waters"" from repeat usage. But again, we've pretty much reached ""stable information"" - 

That's regrettable.  Hopefully this is a topic that might be re-considered in the future.  IMO - I think the idea of using the check-in system is useful, and I think it would be possible to anonymize a UUID.  The reason IP's aren't anonymous is precisely what you commented on below:

> someone who has used it more than 3 times fires up a version they got from us about every 2.4 minutes, with at least once such user in almost every country on earth, windows & linux equal, macOS trailing. There's not a lot more we will ever glean from this data, so we may indeed stop storing any of it.

Gleaning the locations is what should be anonymized.  It is something that could be derived during the communication and stored, instead of storing the IP address itself.

Just a bit of feedback.  And, for what it's worth, I don't think gather the information you've described is a violation of anyone's privacy, it's good usage / demographic information.

I would still like to hear more about the other items I asked about if you have time to discuss them.

Thanks again!"
834638226,835,fractalf,2021-05-07T17:25:27Z,"If you **must** do telemetry, at least make it go to your own servers. How hard can it be, sounds like a simple REST API connected to a db. "
834639267,835,immibis,2021-05-07T17:27:08Z,"Those who hate tracking enough to never use a program again because it adds some analytics as an opt-in feature: Why the heck are you commenting on GitHub, a Microsoft website?"
834639701,835,julienbenjamin,2021-05-07T17:27:50Z,"> If you **must** do telemetry, at least make it go to your own servers. How hard can it be, sounds like a simple REST API connected to a db.

You know as well as I do, if they were as clean, thoughtful, or even just willing to do so, this is how they would have gone from the start. Consider the big picture: this is done on purpose."
834640227,835,julienbenjamin,2021-05-07T17:28:42Z,"> Those who hate tracking enough to never use a program again because it adds some analytics as an opt-in feature: Why the heck are you commenting on GitHub, a Microsoft website?

You are free to offer an alternative.

Also, this is where the draft started, so..."
834641043,835,immibis,2021-05-07T17:30:08Z,"> Just to add a thought to the whole discussion: At this point, the tracking and data collection, no matter how well meaning or not, hardly matters, the damage is already done... Even the mention of something that makes the community lose trust in the development process and the software will negatively impact the outcome.

On the contrary. What usually happens in these cases is everyone forgets about the whole thing by next week, analytics go in, no users are lost, because it turns out people actually don't care about analytics very much and they care about using the software a lot more. This happens *despite* the number of complaints in the PR."
834646470,835,BitesizedLion,2021-05-07T17:39:52Z,"> > Just to add a thought to the whole discussion: At this point, the tracking and data collection, no matter how well meaning or not, hardly matters, the damage is already done... Even the mention of something that makes the community lose trust in the development process and the software will negatively impact the outcome.
> 
> On the contrary. What usually happens in these cases is everyone forgets about the whole thing by next week, analytics go in, no users are lost, because it turns out people actually don't care about analytics very much and they care about using the software a lot more. This happens _despite_ the number of complaints in the PR.

And then they end up switching the default to it being enabled by default :)"
834649901,835,Wuzzy2,2021-05-07T17:45:41Z,"Currently, this PR has 130 thumbs up vs 2692 thumbs down, which is a laughable 5% approval."
834650262,835,viktorvarheit,2021-05-07T17:46:14Z,"Goodbye, Audacity"
834650698,835,IGBC,2021-05-07T17:46:55Z,"> Currently, this PR has 130 thumbs up vs 2692 thumbs down, which is a laughable 5% approval.

Lines up roughly with the statistics I collected"
834650987,835,liamengland1,2021-05-07T17:47:25Z,"> Those who hate tracking enough to never use a program again because it adds some analytics as an opt-in feature: Why the heck are you commenting on GitHub, a Microsoft website?

![](https://thenib.com/wp-content/uploads/2019/08/mister-gotcha-4-9faefa-1.jpg)

"
834653546,835,hibiii,2021-05-07T17:51:31Z,"[Original comment](https://github.com/audacity/audacity/pull/835#issuecomment-834603395)
> Because of the FUD around telemetry- making it optional would mean most half-informed people will turn it off (most of them being on Linux). Thus audacity will have no way to track linux usage hurting it's progress on Linux. I propose making it mandatory and impossible to turn off but with anonymization and less data points.

Demonizing your very own target audience, implying they are luddites and ignorant, very cool. 👍 Don't forget mandatory surveillance is a magnet for legal trouble. If you merge this, it'll be no better than using Audition, at least Adobe has monetary incentive to add features."
834654331,835,Be-ing,2021-05-07T17:52:39Z,"> I would like to see a clear, unambiguous commitment now that you will not use Google Analytics nor Yandex.

I'm still waiting. I posted this 7 hours ago. This should not be hard, nor require much internal discussion. That fact that there has been no response on this simple matter in 7 hours does not give me confidence that the future of Audacity is in good hands."
834654863,835,marcopavanello,2021-05-07T17:53:30Z,"> **Why have telemetry at all?**
> 
> Essentially, it’s to help us to identify product issues early:
> 
>     1. Audacity is widely used across several platforms, but we have no information on the application stability.
> 
>     2. It is difficult for us to estimate the size of the user base accurately.
> 
>     3. We need a way to make informed decisions about which OS versions to support. For example, can we raise the minimum version of the macOS to 10.10 to update the wxWidgets to the latest version?
> 
>     4. We have a known issue with the new file format introduced in Audacity 3.0. We found it with the great help of the community members on our forum. However, there is no way for us to estimate the impact of these issues on users. Is it just a random case? Do we need to rush the work on the recovery tool or help the users one by one? Or do we need to rethink the file format to make it safer and more easily recoverable?

@crsib Have you considered the following points?
1. If you have no information about the application stability it's probably because the application is already stable enough (?) and as a consequence people are not reporting a lot of bugs.
2. Why would you need to estimate the size of the user base accurately?
3. Open a thread about the switch here https://forum.audacityteam.org/ and ask for help to the community for testing.
4. Take your time for testing, solving issues isn't necessarily easy. Discuss these decisions with the community themselves. Though, a telemetry system won't help you fix this knows 3.0 issue."
834660766,835,jakecausier,2021-05-07T18:03:06Z,Is there something wrong with having a bug reporter (upon crashing) instead of integrated tracking?
834662288,835,immibis,2021-05-07T18:05:39Z,"> Currently, this PR has 130 thumbs up vs 2692 thumbs down, which is a laughable 5% approval.

among people who bother to pay attention to it. There is a sampling bias there.

> Goodbye, Audacity

bets on this person installing it again within a week?

Seriously, these kinds of controversies have been rehashed over and over and over and over and over and over and ... and they always have the exact same outcome: nothing. If people care, which they do not, they will fork the project and the fork will gain traction over the original, but it won't because they do not.

Reacting with thumbs down doesn't prevent it from happening, it just tags you as the kind of person who thinks reacting with thumbs down prevents something from happening."
834663518,835,IGBC,2021-05-07T18:07:44Z,"> among people who bother to pay attention to it. There is a sampling bias there.

so... you don't expect there to be sampling biases in the tracking data, like no data being able to be collected from Linux due to how its packaged?"
834663615,835,falkTX,2021-05-07T18:07:54Z,"> If people care, which they do not, they will fork the project and the fork will gain traction over the original, but it won't because they do not.

Speak for yourself.

I care enough that if this is merged, I will maintain a version with no tracking code enabled.
Then figure out CI so there are builds for win/mac without them too.

Just because other people do not care (usually out of ignorance) you do not have to follow.
Lead by example, make the world a better place, and all that...

Not everyone is the same, some people actually do want to do good stuff and have ethics about it.

EDIT: most of the CI stuff seems to be in https://github.com/audacity/audacity/blob/master/.github/workflows/cmake_build.yml
Then triggered via github actions? I never used those, but seems similar to travis.
Might be a good exercise to get familiar with these tools.
"
834668107,835,crashvb,2021-05-07T18:15:24Z,"> On the contrary. What usually happens in these cases is everyone forgets about the whole thing by next week, analytics go in, no users are lost, because it turns out people actually don't care about analytics very much and they care about using the software a lot more. This happens _despite_ the number of complaints in the PR.

Even if the PR is merged, the people who care will look for alternative solutions and / or find methods to disable the telemetry anyways (patches, jailing, egress rules, etc).  ... Which kinda defeats the purpose of the telemetry in the first place, as it will only be available for a subset of the overall user-base, and likely only serve to complement other kinds of metrics (popularity contests, download counts, PR participation, etc).

... While I'd agree that protesting alone does not work (... alternative proposals tend to do better), it's not a totally a wasted effort; after all, the decision to make the feature opt-out was **a calculated one**, and implies that the data belongs to them, unless you're smart enough to stop them."
834669404,835,simonsan,2021-05-07T18:17:35Z,"> If you **must** do telemetry, at least make it go to your own servers. How hard can it be, sounds like a simple REST API connected to a db.

https://opentelemetry.io/"
834671617,835,AndreiSva,2021-05-07T18:21:15Z,I still don't understand why using Google Analytics would be a good idea. It takes little effort to set up a a self hosted telemetry.
834674850,835,AndreiSva,2021-05-07T18:26:24Z,"> If you are compiling Audacity from source, we will provide a CMake option to enable the telemetry code. This option will be turned off by default.

I doubt many distributions will go out of their way to enable that option. If this PR gets merged the people who actually have the telemetry enabled is so low that it completely defeats the point of having telemetry in the first place."
834688004,835,falkTX,2021-05-07T18:47:07Z,"Something curious I found.
The recent changes on their wiki mention a few updates on the analytics documentation page made today https://alphamanual.audacityteam.org/man/Special:RecentChanges

They still keep insisting that this is all annonymous. From https://alphamanual.audacityteam.org/man/Analytics_Preferences
> It is anonymous. There is understandable concern that this is intended to collect personal information. It really isn't.

The use of UUID, IP and a few other details makes it really pseudonymous at best. Granted, they do not intend to record personal data, but end up helping facilitating that."
834688303,835,immibis,2021-05-07T18:47:40Z,"> > On the contrary. What usually happens in these cases is everyone forgets about the whole thing by next week, analytics go in, no users are lost, because it turns out people actually don't care about analytics very much and they care about using the software a lot more. This happens _despite_ the number of complaints in the PR.
> 
> Even if the PR is merged, the people who care will look for alternative solutions and / or find methods to disable the telemetry anyways (patches, jailing, egress rules, etc). ... Which kinda defeats the purpose of the telemetry in the first place, as it will only be available for a subset of the overall user-base, and likely only serve to complement other kinds of metrics (popularity contests, download counts, PR participation, etc).
> 
> ... While I'd agree that protesting alone does not work (... alternative proposals tend to do better), it's not a totally a wasted effort; after all, the decision to make the feature opt-out was **a calculated one**, and implies that the data belongs to them, unless you're smart enough to stop them.

All this stuff? It's what people say they'll do, every time it's happened in the past. Almost always, it doesn't happen. You don't have to agree or disagree, because reality agrees.

BTW since it prompts you on startup, there is no difference between opt-out and opt-in. You just call it opt-out to make it sound worse.

> The use of UUID, IP and a few other details makes it really pseudonymous at best. Granted, they do not intend to record personal data, but end up helping facilitating that.

I'll note there is no way to avoid recording IP. However, the UUID is totally unnecessary. So is the timing and order of events. All they really  want to know is: how long was the app used in total, and how many times was each option used, over a period of say a week."
834689200,835,Be-ing,2021-05-07T18:49:10Z,"> I'll note there is no way to avoid recording IP.

Yes there is. Don't put it in the logs."
834690202,835,immibis,2021-05-07T18:50:52Z,"> > I'll note there is no way to avoid recording IP.
>
> Yes there is. Don't put it in the logs.

There's no way for an end user to know whether it's logged or not. They could say they're not logging it, but then log it anyway."
834691844,835,dpedu,2021-05-07T18:53:24Z,"Congratulations, you've proposed the most unpopular change in the history of this project.

> Dear all, Due to the large amount of worry about this PR, (which we completely understand), we want to clarify exactly what is going on

But at least you're aware of the concern. Will you act on it?

Give it up or be forked."
834692080,835,falkTX,2021-05-07T18:53:49Z,"> > > I'll note there is no way to avoid recording IP.
> > 
> > 
> > Yes there is. Don't put it in the logs.
> 
> There's no way for an end user to know whether it's logged or not. They could say they're not logging it, but then log it anyway.

If you never send analytics data, there is nothing to record ;) ;)"
834692944,835,Be-ing,2021-05-07T18:55:17Z,"> There's no way for an end user to know whether it's logged or not. They could say they're not logging it, but then log it anyway.

That's true. We'd have to take their word for it, which requires trusting them. Speaking for myself, my trust for Muse Group is hanging by a thread at this point. What they need to do to *start* rebuilding it is to immediately, unambiguously commit to not using Google Analytics nor Yandex."
834703302,835,notpushkin,2021-05-07T19:06:41Z,"Personally, I'm not against **strictly optional, disabled by default** telemetry if you specify which services (Google? Yandex?) you're using right in the box as opposed to the privacy policy link on the screenshot. Right now it's like you're ashamed of using Google (which you should) and hiding it (which isn't good).

If you don't want to be ashamed and still roll analytics, please try to set up your own analytics software (there are a few options, from Matomo to Plausible to rolling your own script that logs events in a table and using things like Metabase to build reports from that). It's really easy nowadays and a capable server should cost like $20/mo, so that shouldn't be that big of a deal."
834708636,835,immibis,2021-05-07T19:09:53Z,FYI for devs: you've been brigaded from Reddit. https://www.reddit.com/r/programming/comments/n6kxm8/psa_audacity_pr_to_add_telemetry_sharing_user/
834710563,835,y4my4my4m,2021-05-07T19:13:16Z,"> FYI for devs: you've been brigaded from Reddit. https://www.reddit.com/r/programming/comments/n6kxm8/psa_audacity_pr_to_add_telemetry_sharing_user/

I dont come from reddit and I oppose those changes.

What do they need my ip address for if it's to help debug stuff?

Please, lol."
834711947,835,orenwatson,2021-05-07T19:15:40Z,I found out from a non-programming related discord. I recommend you salvage what is left of your and Tantacrul's reputation.
834712930,835,klardotsh,2021-05-07T19:17:26Z,"I don't come from Reddit (I heard about this via a Mastodon followee) and I still think this PR is actively harmful to Audacity, its users, and the free audio community broadly - both if merged, and frankly, at this point, even if it's not, in light of what seems to be a lack of willingness to change course to address the plethora of community concerns. I would feel this way whether I'd read zero or a million words of commentary around this thread and the underlying implementation.

Furthermore, ""brigading"" is a fairly loaded term to use for what was someone sharing a link. This is the internet. Links are shared all the time - it's the literal entire point."
834713197,835,sirocyl,2021-05-07T19:17:57Z,"> FYI for devs: you've been brigaded from Reddit. https://www.reddit.com/r/programming/comments/n6kxm8/psa_audacity_pr_to_add_telemetry_sharing_user/

It's more than Reddit, I see this issue's popped up on /g/ a bit ago, and it's been getting passed around IRC, Mastodon, Twitter, Matrix, Telegram and Discords here and there.

It is not a small issue, and I'm surprised comments have not been restricted to contributors here yet."
834713800,835,dpedu,2021-05-07T19:19:00Z,"> It's more than Reddit, I see this issue's popped up on /g/ a bit ago, and it's been getting passed around IRC, Mastodon, Twitter, Matrix, Telegram and Discords here and there.

 > It is not a small issue, and I'm surprised comments have not been restricted to contributors here yet.

Turns out that when an open-source project does something wildly unpopular, the word spreads."
834714438,835,IGBC,2021-05-07T19:20:09Z,The only project that would get a stronger reaction than Audacity would probably be if the Linux Kernel tried to do something similar. Audacity is very proud of how many users their app has. A lot of those users feel that the FOSS values of the project are very important.
834714743,835,nathanfranke,2021-05-07T19:20:41Z,I hope y'all are connected to github with a vpn and throwaway account
834715903,835,karthanistyr,2021-05-07T19:22:41Z,"guys, you're in the news https://www.theregister.com/2021/05/07/audacity_telemetry"
834715918,835,IGBC,2021-05-07T19:22:42Z,"Now that things have quietened down I think its important to remember this is the first battle in a long war for who controls the interests of Audacity. People stating that the devs will push this change through quietly have plenty of cases to back them up. From here on out the community needs to ruthlessly review every single PR going into this project and every single commit going into Master.

Until they give up or the money runs out."
834716673,835,karthanistyr,2021-05-07T19:23:59Z,"> guys, you're in the news https://www.theregister.com/2021/05/07/audacity_telemetry

Excerpt: 

> 'A massive middle finger': Open-source audio fans up in arms after Audacity opts to add telemetry capture
> Move comes days after firm acquired by Muse Group"
834716896,835,klardotsh,2021-05-07T19:24:27Z,"> I hope y'all are connected to github with a vpn and throwaway account

[Whataboutism](https://en.wikipedia.org/wiki/Whataboutism) adds nothing of value to this, or any, discussion. We can go down that rabbit hole all day and it will still do nothing but waste everyone's time."
834717045,835,sirocyl,2021-05-07T19:24:45Z,"> > It's more than Reddit, I see this issue's popped up on /g/ a bit ago, and it's been getting passed around IRC, Mastodon, Twitter, Matrix, Telegram and Discords here and there.
> 
> > It is not a small issue, and I'm surprised comments have not been restricted to contributors here yet.
> 
> Turns out that when an open-source project does something wildly unpopular, the word spreads.

I'm neither surprised nor disappointed - so far the discussion has remained, for the most part, civil here - and in case y'all missed it (I did) - there is a statement made in the OP above, about the use of telemetry, library cruft and what not.

While I'm glad they addressed it, I'm still unhappy with the decision to push forward as it is - though, I would be incredibly relieved if they saw it fit to work out a self-hosted telemetry service to use on public builds.

Another option IMO, would be to entirely separate telemetry-enabled builds on the Audacity download page, and gate that behind a strict privacy policy, for compliance's sake.
This makes it an opt-in proposition at download time - and, at first-run.
That way, users deploying Audacity en masse, which can ***not*** have Telemetry on their network for understandable reasons, can continue using a supported version of Audacity, rather than a fork or a build from source."
834717510,835,immibis,2021-05-07T19:25:35Z,"> > FYI for devs: you've been brigaded from Reddit. https://www.reddit.com/r/programming/comments/n6kxm8/psa_audacity_pr_to_add_telemetry_sharing_user/
> 
> I dont come from reddit and I oppose those changes.
> 
> What do they need my ip address for if it's to help debug stuff?
> 
> Please, lol.

cause it's impossible to send anything over the internet without an IP address...?"
834718368,835,y4my4my4m,2021-05-07T19:27:07Z,"> > > FYI for devs: you've been brigaded from Reddit. https://www.reddit.com/r/programming/comments/n6kxm8/psa_audacity_pr_to_add_telemetry_sharing_user/
> > 
> > I dont come from reddit and I oppose those changes.
> > 
> > What do they need my ip address for if it's to help debug stuff?
> > 
> > Please, lol.
> 
> cause it's impossible to send anything over the internet without an IP address...?

They don't need to log it."
834718826,835,immibis,2021-05-07T19:27:54Z,"> They don't need to log it.

Correct, but there is no way to prove they aren't logging it, so we have to assume they are anyway"
834719428,835,sirocyl,2021-05-07T19:29:04Z,"@crsib small request - could you specify what requirements you're looking for specifically, perhaps in a new issue report, for a non-Google/non-Yandex and/or self-hosted telemetry service?
The community has answers, but this PR comment space is getting crowded for sure.
> 4. We will consider replacing Google and Yandex with another service if we find one that fulfills our requirements - thanks for the suggestions and keep them coming.
"
834720332,835,nnnn20430,2021-05-07T19:30:45Z,"> FYI for devs: you've been brigaded from Reddit. https://www.reddit.com/r/programming/comments/n6kxm8/psa_audacity_pr_to_add_telemetry_sharing_user/

It's not brigading when it's the wider free software community/users responding..."
834723486,835,Be-ing,2021-05-07T19:36:03Z,"> Another option IMO, would be to entirely separate telemetry-enabled builds on the Audacity download page, and gate that behind a strict privacy policy, for compliance's sake.
This makes it an opt-in proposition at download time - and, at first-run.
That way, users deploying Audacity en masse, which can not have Telemetry on their network for understandable reasons, can continue using a supported version of Audacity, rather than a fork or a build from source.

I think this is a great idea. Several users have already mentioned that they are responsible for usage of Audacity in educational settings. In schools, universities, governmental agencies, companies, and other institutions with mass deployments of computers, it would be easier for them to use Audacity without a shred of doubt about compliance with institutional and legal policies if https://audacityteam.org hosts official builds with the telemetry not even compiled into the binary. In a mass deployment, it would be inconvenient to ensure that the checkbox for telemetry is disabled on every single computer. With GitHub Actions, this would be really easy to implement using the matrix feature."
834725862,835,svfrd,2021-05-07T19:40:11Z,NACK
834728848,835,crashvb,2021-05-07T19:44:47Z,"> All this stuff? It's what people say they'll do, every time it's happened in the past. Almost always, it doesn't happen. You don't have to agree or disagree, because reality agrees.

... some people actually do care, and things can change. To think otherwise is feed into complacency. What people do and say matters. (If all this is for not, then what is the point of the PR -- or this dialog -- in the first place; just merge and be done with it).

> BTW since it prompts you on startup, there is no difference between opt-out and opt-in. You just call it opt-out to make it sound worse.

No, I'm calling it opt-out because it, in-fact, requires end users to ""opt out"" (the shinny blue default button in the mockup ;) , aside from the other comments about config defaulting) ... If the opt-out model sounds worse to you, that is inferred.

Would things change so much if users were required to check a box to **enable** telemetry; perhaps with the same catchy rationale above it?  ... yes, it would, because most users will not read the message, and as a consequence, telemetry would not be collected. The whole point of defaulting **on** is to collect information from those uses who indifferent, not paying attention, or are uninformed.

I think it is more appropriate, and in better taste, to produce software in an ethical manner and air on the side of caution for people who might not know any better, then it is to aggregate metrics.

(... a different way of saying it, with using that other phrase ...)"
834732927,835,immibis,2021-05-07T19:51:25Z,"> ... some people actually do care, and things can change. To think otherwise is feed into complacency. What people do and say matters. (If all this is for not, then what is the point of the PR -- or this dialog -- in the first place; just merge and be done with it).

I'll believe it when I see your fork become more popular.
"
834733973,835,crashvb,2021-05-07T19:53:08Z,"> > ... some people actually do care, and things can change. To think otherwise is feed into complacency. What people do and say matters. (If all this is for not, then what is the point of the PR -- or this dialog -- in the first place; just merge and be done with it).
> 
> I'll believe it when I see your fork become more popular.

oh, you got me there, maybe I should change the way I think about the world ..."
834734712,835,falkTX,2021-05-07T19:54:26Z,"> I'll believe it when I see your fork become more popular.

That is the thing, it doesnt have to.
For something to become a success, all it takes is 1 person using it and being grateful for it.

VSCodium is a thing for those that need to run VSCode (say the rest of the team is using the same tool and has a defined workflow for it) but are not ok with all the tracking and EULA associated with it.
VSCodium is never going to be more popular than VSCode, but because people use it, in my opinion it is already a success.

It serves a purpose and serves it well.
Those that care will find it and use it.

The developers that fork and create such projects are not interested on popularity contests, but about being useful."
834736760,835,AndreiSva,2021-05-07T19:57:43Z,"> > ... some people actually do care, and things can change. To think otherwise is feed into complacency. What people do and say matters. (If all this is for not, then what is the point of the PR -- or this dialog -- in the first place; just merge and be done with it).
> 
> I'll believe it when I see your fork become more popular.

VScode is still more popular than VScodium.
"
834736855,835,IGBC,2021-05-07T19:57:53Z,"> VSCodium

Ooh where do I download that? Need that."
834737540,835,AndreiSva,2021-05-07T19:59:03Z,@IGBC https://vscodium.com/
834737579,835,orenwatson,2021-05-07T19:59:08Z,"But the thing is, unlike audacity, most people think of VScode as being a free tier of a Microsoft product, not as a OSS product.
Therefore, expectations are exponentially lower, given M$'s ancient reputation"
834738640,835,x-0n,2021-05-07T20:00:57Z,"Dear obviously confused committer,

I'm not from Reddit. I'm a random guy who knows Audacity exists, simply because it's one of the most well-known, most complete and most appreciated FLOSS alternatives to proprietary software.

Please consider to stop fucking with it. You're making it worse. Go back to your shitty commercial offerings that noone has ever heard about and stuff all your shitty telemetry, antipatterns and UI redesigns in there. In other words, kindly fuck off.

Best regards,
The Internet"
834743169,835,IGBC,2021-05-07T20:08:37Z,"Oh yea my favourite thing about this Muse takeover is they have promised to ""fix"" the GUI. 😆 

The GUI in audacity may not be pretty (and there's a couple of bugs) but its one of the most straight forward and intuitive interfaces I have ever used. In fact I have seen it be used as a case study for good interface layout before.

Making it pretty doesn't make it better. "
834748865,835,Be-ing,2021-05-07T20:19:25Z,"@SteveDaulton:
> I improved the Pink Noise and Brownian Noise generators, but does anyone use them? Despite asking on the very active Audacity Forum, I have no idea. Was I wasting my time? Could I have brought more value to the Audacity community by doing something else? I have no idea, because asking users to give feedback on the forum does not work.

I suggest taking a perspective more like these developers:

@pauldavisthefirst:
> For every person who tries Ardour and loves it, there's someone who emails me and says ""this is complete garbage, I can't even believe that you think this is usable"". For every person who says ""I used to use Logic, but Ardour is so much more intuitive"", someone emails ""this program is f***ing impossible to use, it's not intuitive at all, i'm never using it again"". I long ago stopped caring - we work for the people who like Ardour, everybody else has a great choice of amazing DAWs to work with (and prefer).

@falkTX:
> The developers that ... create such projects are not interested on popularity contests, but about being useful.

Please don't base your decisions on whether to continue support for a feature or operating system on necessarily unrepresentative numbers. Drop support for features when maintaining them becomes an obstacle to moving forward with the rest of the project. It doesn't matter if one person or ten million people use the feature. If it needs to go, it needs to go. If not, keep it."
834749174,835,SndChaser,2021-05-07T20:20:02Z,"Hi @pauldavisthefirst 

The majority of this response is very useful... I'll just add a few follow up comments where there might be some more interest:

> > * Is there any end-user documentation surrounding the implementation of the feature? (IE, what's gathered, how long it's kept, how it's used, etc.)

> There is not.

It would be a good idea if there were...  Say the way Mozilla approaches it: [Telemetry collection and deletion](https://support.mozilla.org/en-US/kb/telemetry-clientid)

> > * Were there any public conversations before this feature was implemented?

> With the core user group, on IRC. There may or may not have been some discussion on the user mailing list - I don't recall.

That's at least some consideration of the user base. :)

> > * What is the data retention policy surrounding this information?
> 
> The information is not associated with any user ID at ardour.org and so cannot be deleted in connection with a GDPR-style request. Making it deletable on request would mean associating it in someway with a user ID, which we will not do. We currently retain all such ""pings"" back to 2013.

Now that is something that I would suggest could be improved.  As noted in the Firefox document I linked above, they keep the data for 13 months, while removing IP addresses every 14 days.

> > * Were there any steps taken in light of regulations that could influence how this information is kept?

> I researched this when the GDPR passed, and do not believe that it is affected by it.

From what I've read (from documents like [Intersoft Consulting's](https://gdpr-info.eu/issues/personal-data/) guide), they tend to view ""personal data"" in the broadest terms possible.  Since IP addresses can be used to compel information from a service provider, it is generally regarded as personal information.  Just some food for thought.


> > * What procedures are followed to keep this information secure?
> 
> The usual procedures that we follow to make ardour.org itself secure, nothing more. There is an unpublicized URL that provides an aggregate summary of the data, but we rarely use it because the DB query takes too long to execute. We already have the 

IMO - while the fact that this URL only presents aggregate information is good, having an unpublished URL that is public facing (if it is, in fact public facing) is not.  This is an attack surface that someone who found the URL could use to try to gain access to the database itself.

> general message that Windows and Linux users are about equally sized groups, with macOS significantly smaller, and to be honest the information coming in likely only serves to reinforce that. In that sense, we would not lose much at this point by not storing the data at all.

Yes, you mentioned this in other posts.  Personally, I don't see the issue with gathering such information as it might be of use for other purposes (ie, identifying which versions of Ardour are still in wide use, identifying which platforms are most active - like you have already stated, how often Ardour is being used, and possibly a lot more).  I think the main point is to (a) secure the information as strongly as possible, and (b) keep the information as anonymous as possible.

It sounds like these were considerations when it was first implemented.  If anything, I would suggest that this topic could be re-investigated to update things to more current standards.

It's this kind of thinking that should be present in this PR that I think many of us are not seeing / reading... My hope is that this discussion might provide more of an example to MuseCorp about what users would like to see discussed about such an implementation."
834752823,835,NWPlayer123,2021-05-07T20:26:56Z,"> Essentially, it’s to help us to identify product issues early

The fact that they're calling it a product means it's already dead to me as FOSS, telemetry or not."
834753366,835,SndChaser,2021-05-07T20:27:55Z,"> > (2) such a move would likely get Audacity removed from most Linux distributions,
> 
> As long as it can be disabled at compile time, this is exceedingly unlikely. Linux distributions (AFAIK) all build Ardour with the --no-phone-home configure-time option. It's not an issue.

Hi Paul,

I was responding to the person that stated the telemetry should be left on permanently with no option to disable it.  This would not be acceptable to most distributions."
834754088,835,IGBC,2021-05-07T20:28:41Z,"> > Essentially, it’s to help us to identify product issues early
> 
> The fact that they're calling it a product means it's already dead to me as FOSS, telemetry or not.

Amen, to that, I have been waiting for someone to say this for the last 24H"
834754912,835,SndChaser,2021-05-07T20:29:51Z,"> > Bravo! You've won the award for the most irrational and stupifying dumb comment in this conversation. (1) Linux users tend to be much more technical, and much better informed than the general user base, (2) such a move would likely get Audacity removed from most Linux distributions, (3) a fork would likely be inevitable, (4) the harm to the reputation of Audacity would be irreparable, (5) there would be a good chance that this kind of move could find itself in a regulatory quagmire of GDPR, CCPA, and others.
> 
> I get the impression that comment was deliberately inflammatory (i.e. ""trolling"")

Probably, but I figured there was a chance he was serious so I thought a serious response was worthwhile."
834757641,835,car1ox,2021-05-07T20:34:53Z,"F in the chat for old good Audacity.
What's a good name for the fork?"
834758248,835,SndChaser,2021-05-07T20:35:57Z,"> F in the chat for old good Audacity.
> What's a good name for the fork?

I postulated LibreAudio earlier...  Borrowing from LibreOffice forking off of OpenOffice.org"
834758755,835,car1ox,2021-05-07T20:36:55Z,"F in the chat for old good Audacity.
What's a good name for the fork?"
834758776,835,Be-ing,2021-05-07T20:36:57Z,"> How about ""Audacious""?

That's already [a thing](https://audacious-media-player.org/)."
834758781,835,SndChaser,2021-05-07T20:36:57Z,"> > F in the chat for old good Audacity.
> > What's a good name for the fork?
> 
> How about ""Audacious""?

There's an audio player named Audacious."
834761310,835,IGBC,2021-05-07T20:41:29Z,"I say we call it Audacity.

You know cos we have the Audacity to call it Audacity.

(Yea I know I know, I am going)"
834762457,835,Sciss,2021-05-07T20:43:42Z,"Audacity Origin ;-)

__Edit:__ But jokes aside, I thought _Audience_ was pretty nice, if there is no conflict with existing software."
834762946,835,GiovanH,2021-05-07T20:44:34Z,Glad to see this made a draft.
834763098,835,IGBC,2021-05-07T20:44:51Z,It should probably get some practical and boring name like LibreAudio until someone can come up with a good pun.
834763688,835,IGBC,2021-05-07T20:45:56Z,"> Glad to see this made a draft.

Baby steps: next get the PR closed altogether

Then get @crsib removed from the list of people with write access altogether. "
834764930,835,IGBC,2021-05-07T20:48:10Z,"> It should probably get some practical and boring name like LibreAudio until someone can come up with a good pun.

@spacekatia (not in the topic) came up with Audacium (Audacity and Chromium stuck together)"
834766910,835,jxu,2021-05-07T20:50:01Z,Maybe this is a situation where a benevolent dictator leadership model would've helped. Torvalds would've rightfully cursed these changes out.  
834769730,835,IGBC,2021-05-07T20:51:28Z,"Stallman is the counterpoint of when a benevolent dictator goes wrong however. Finding a truly benevolent dictator is hard.

Frankly I prefer the rust model where everyone even the lead devs are held to a set of community rules and processes for implementing changes, its a model where no one is above the law, and no one's voice is permitted to be louder than anyone else's (within practical reason). 

It's not perfect but it significantly reduces the amount of drama in the rust world.

(so far the discussion has been polite please don't flame me on this one)"
834771731,835,Be-ing,2021-05-07T20:52:30Z,"I agree that this pull request should be closed at this point. Any alternative implementation should start fresh in a new pull request *after* discussing with the community how to do it in an acceptable way.

I'm still waiting on an unambiguous statement that Audacity will not use Google Analytics nor Yandex."
834772506,835,processor286,2021-05-07T20:53:30Z,"> F in the chat for old good Audacity.
> What's a good name for the fork?

Audiocity ?"
834773917,835,IGBC,2021-05-07T20:55:50Z,"> > F in the chat for old good Audacity.
> > What's a good name for the fork?
> 
> Audiocity ?

I feel we need another poll 😆 "
834773920,835,jxu,2021-05-07T20:55:50Z,Call it Cacophony lol
834776107,835,Sciss,2021-05-07T20:59:47Z,"It would probably be wise to discuss a possible fork, its naming etc. somewhere else? The thread gets out of hand, and project maintainers (somewhat rightfully) could close/ lock it at some point. It could be on the Audacity user forum, or better suggestions?"
834776652,835,spacekatia,2021-05-07T21:00:48Z,"> F in the chat for old good Audacity.
> What's a good name for the fork?

could call it animocity (portmanteau of animosity and audacity)"
834776872,835,IGBC,2021-05-07T21:01:08Z,"> It would probably be wise to discuss a possible fork, its naming etc. somewhere else? The thread gets out of hand, and project maintainers (somewhat rightfully) could close/ lock it at some point. It could be on the Audacity user forum, or better suggestions?

Oh I thought the point of having it here was to remind the dev's we are not going away. this isn't over just cos the thousands of tryhards from reddit and HN have stopped

"
834778088,835,jxu,2021-05-07T21:03:16Z,"I presume we haven't had an ""official response"" from either Muse group or Debian/Arch/other distro maintainers yet. "
834778550,835,Qix-,2021-05-07T21:04:07Z,@jxu They are working on one. That much has been confirmed.
834780181,835,jxu,2021-05-07T21:06:49Z,"Given that all of the Muse group people have not even considered removing Google and Yandex, the most controversial sticking points, I'm not hopeful. "
834780544,835,marcopavanello,2021-05-07T21:07:25Z,"ohoh what about ANA ?
It stands for Ana is Not Audacity :)
Or even Audacity is Not Audacity if you will."
834780746,835,spacekatia,2021-05-07T21:07:47Z,"> F in the chat for old good Audacity.
> What's a good name for the fork?

duplicity is another neat one, a constant reminder of why people started the fork (also because it's a duplicate of audacity)"
834780848,835,Be-ing,2021-05-07T21:07:56Z,"> Given that all of the Muse group people have not even considered removing Google and Yandex, the most controversial sticking points, I'm not hopeful.

They are considering it. They have not committed to not using Google Analytics and Yandex."
834781022,835,SndChaser,2021-05-07T21:08:16Z,"> Seriously, these kinds of controversies have been rehashed over and over and over and over and over and over and ... and they always have the exact same outcome: nothing. If people care, which they do not, they will fork the project and the fork will gain traction over the original, but it won't because they do not.

I would suggest you look at the community you are addressing this to: LibreOffice is the result of a fork from OpenOffice.org when Oracle took it over and started making changes that met with major disapproval.

The Maria Database came about from the same situation with Oracle taking over MySQL.

NeoVim came about because some users felt that the development speed and direction of Vim wasn't moving in the right direction (it wasn't even an issue was controversial as this one).

You should learn some history about the open source world.  There is a long history of projects being forked when there are issues that developers have ignored their users feedback.

> Reacting with thumbs down doesn't prevent it from happening, it just tags you as the kind of person who thinks reacting with thumbs down prevents something from happening.

No, reacting with a thumbs down is an indicator that your comment doesn't deserve support because it is a deeply flawed and ignorant argument."
834782088,835,AndreiSva,2021-05-07T21:10:02Z,"> NeoVim came about because some users felt that the development speed and direction of Vim wasn't moving in the right direction (it wasn't even an issue was controversial as this one).

Vim and NeoVim are co-existing just fine."
834782700,835,nikitalita,2021-05-07T21:11:06Z,"""We do not incorporate cross-site tracking, limiting the ability to identify the user by both Google and Yandex.""
This is misleading. If information is sent to either of these websites along with your IP, it's identifiable, period. It is easily correlated with you via the gobs and gobs of data they already have on you (Yandex more so if you're Russian). This is what they're good at, this is their bread and butter. 

And people know this. I will never opt into telemetry with them as the service provider, and so will many, many, many other people who use this app, which will limit the usefulness of this. If you switched to to a self-hosted solution, I'd definitely feel more comfortable with it. I recognize the utility and usefulness of telemetry in designing helpful applications, but there are tremendous privacy concerns that come with it, and using Google or Yandex is a non-starter for a huge swath of your userbase."
834783205,835,IGBC,2021-05-07T21:12:01Z,"> > Given that all of the Muse group people have not even considered removing Google and Yandex, the most controversial sticking points, I'm not hopeful.
> 
> They are considering it. They have not committed to not using Google Analytics and Yandex.

They are still not addressing the main points though: why are they collecting the data they chose, why didn't they include the community, and why do they think this is apropriate way of collecting information about their __Community__ (not product)

my poll which has now over 1400 responses shows that 50% of respndants don't support the idea of any tracking at all. https://www.strawpoll.me/45241130/r yet no response on this matter from Audacity or Muse."
834784428,835,IGBC,2021-05-07T21:14:07Z,"I think I should restate what I said directed at a developer earlier:

> 
> I think this response was carefully thought through but ultimately tone deaf. As has been repeated many times in this now unmanageably long thread, we, the community, are telling you, the developers, we don't believe this is an effective or appropriate measure.
> 
> We understand that you want feedback about the development direction of the software, and we are telling you the forum should be enough. I am curious why you do not trust the direct feedback from your thousands of active users, to the point you feel you need automated tracking systems to replace that model?
> 
> As for tracking in FOSS, IF it is indeed useful it must also be considered how that data can be shared safely and fairly. What segment of users this data truly represents, and how compliance with the myriad of laws surrounding data protection can be abided. We, the community, have seen no planning or engagement with the community about how to approach these important issues.
> 
> Finally with the introduction of new corporate developers in recent times means we don't believe you when you say this is for the god of the community anymore. This is not helped by the repeated statements from devs that this is optional and anonymous, when frankly the ""opt in"" dialog is already in violation of GDPR, and it is widely accepted by the security community that google analytics is not anonymous. You either fundamentally misunderstand the technology you are trying to implement or your are misleading the community.
> 
> You cannot sidestep these issues"
834785286,835,SndChaser,2021-05-07T21:15:37Z,"> > NeoVim came about because some users felt that the development speed and direction of Vim wasn't moving in the right direction (it wasn't even an issue was controversial as this one).
> 
> Vim and NeoVim are co-existing just fine.

Exactly... This was less of an issue like this one, there was just a feeling that there needed to be a different direction for the development.  LibreOffice and OpenOffice are co-existing as well...but I'd guess the user base for OOorg is a lot smaller now."
834793721,835,immibis,2021-05-07T21:30:51Z,"> I would suggest you look at the community you are addressing this to: LibreOffice is the result of a fork from OpenOffice.org when Oracle took it over and started making changes that met with major disapproval.
> 
> The Maria Database came about from the same situation with Oracle taking over MySQL.

You will note that in these cases, the main developers of the project moved to the fork."
834800275,835,SndChaser,2021-05-07T21:42:54Z,"> It should probably get some practical and boring name like LibreAudio until someone can come up with a good pun.

Thanks for calling my suggestion boring and practical... LOL"
834800882,835,IGBC,2021-05-07T21:43:59Z,"Oh **** I didn't even see someone else made the same suggestion, sorry @SndChaser "
834801183,835,falkTX,2021-05-07T21:44:32Z,"they are not addressing this and will not address it because it is all pretty normal for them.
musescore already added google analytics, so this was the obvious next step. just integrating the new acquisition onto the same toolset they have in place.

the responses here are the exception, not the norm.
I bet some of them are baffled to what is going on, doesnt make sense to them.

I personally have very little hopes of google analytics being taken out. it is now the modus operandi of businesses and corporations. in order to grow in userbase, understand which areas need attention, generally bringing ""value"" to the ""product"" :nauseated_face: they take analytics as a necessity.

this is a hard clash of ideals between corporate attitude and free, open-source ethos.
not everyone shares the same ideals of, for example, blender's author when he says he has no interest on money.
a recommended watch https://www.youtube.com/watch?v=qJEWOTZnFeg
"
834801199,835,SndChaser,2021-05-07T21:44:33Z,"> Oh **** I didn't even see someone else made the same suggestion, sorry @SndChaser

It's alright, I was genuinely laughing...."
834803380,835,IGBC,2021-05-07T21:48:37Z,"> this is a hard clash of ideals between corporate attitude and free, open-source ethos.
> not everyone shares the same ideals of, for example, blender's author when he says he has no interest on money.
> a recommended watch https://www.youtube.com/watch?v=qJEWOTZnFeg

@falkTX Well stated, but it's our job to show muse their corporate mindset will not get them very far here. Audacity's roots are in the scientific community, that its where it grew from. I doubt many users are interested in the Musings or wills of our corporate overlords.

(pun intended)"
834807190,835,SndChaser,2021-05-07T21:55:34Z,"> > I would suggest you look at the community you are addressing this to: LibreOffice is the result of a fork from OpenOffice.org when Oracle took it over and started making changes that met with major disapproval.
> > The Maria Database came about from the same situation with Oracle taking over MySQL.
> 
> You will note that in these cases, the main developers of the project moved to the fork.

In those cases that is true.  But there are lots of other cases where the original developer left a project, and others took over by forking the project.  

My point was that the concept of forking a project due to disagreements over development trajectories is not unusual in the open source world.  Whether the original developers move over, or if the fork gains the same following as the original was not really the point...  Addressing the lack of understand of the person I was responding to was the point."
834808106,835,davidhealey,2021-05-07T21:57:16Z,Boo
834808145,835,mc776,2021-05-07T21:57:20Z,"> 
> 
> > It should probably get some practical and boring name like LibreAudio until someone can come up with a good pun.
> 
> Thanks for calling my suggestion boring and practical... LOL

Boring and practical and easy to remember and on-brand and self-explanatory... is good name"
834810966,835,SndChaser,2021-05-07T22:02:37Z,"> > > It should probably get some practical and boring name like LibreAudio until someone can come up with a good pun.
> > 
> > 
> > Thanks for calling my suggestion boring and practical... LOL
> 
> Boring and practical and easy to remember and on-brand and self-explanatory... is good name

I was just making a joke based on the OpenOffice.org -> LibreOffice transition...  But it might just stick. :)"
834811079,835,j0lol,2021-05-07T22:02:48Z,"> > I would suggest you look at the community you are addressing this to: LibreOffice is the result of a fork from OpenOffice.org when Oracle took it over and started making changes that met with major disapproval.
> > The Maria Database came about from the same situation with Oracle taking over MySQL.
> 
> You will note that in these cases, the main developers of the project moved to the fork.

in these cases, the older projects are also more well known! please can we discuss forks as a last resort, because most people **will not ever** switch to your new audacity fork meaning they will not see the benefits of an audacity fork"
834812702,835,IGBC,2021-05-07T22:05:45Z,"![Screenshot_2021-05-07 Audacity PR #835](https://user-images.githubusercontent.com/8123843/117512910-6fbcf680-af88-11eb-864a-07b45c41dba1.png)
The poll I created is at 1500 votes, now representing 1% an equivalent of the alleged user base on the forum. The statistics remain unchanged 50% of responses state a firm no to any form of tracking.
as always the poll is available at https://www.strawpoll.me/45241130/r"
834813052,835,SndChaser,2021-05-07T22:06:25Z,"> > > Have you looked at https://sentry.io/welcome/ as this seems to be what you want you want and would then remove Google and yandex which seems better and you can even host it yourself if I recall correctly
> > 
> > 
> > I'd be cautious of this one... I don't see anything licenses, and I don't see any clear statements about how data is handled if it isn't self-hosted. IOW - it would be possible to encounter many similar issues that we have with Google and Yandex now... And the fact that this isn't an open source project gives me quite a bad feeling about it being used in an open source project.
> 
> https://github.com/getsentry/

Right, this doesn't use an Open Source license in my opinion: https://github.com/getsentry/sentry/blob/master/LICENSE

In fact to quote the license:

> The Business Source License (this document, or the ""License"") is not an Open
Source license. However, the Licensed Work will eventually be made available
under an Open Source License, as stated in this License.

P.S. I see that someone else replied to this earlier....I'm still catching up on comments since I was away for a couple of hours.  (Hopefully caught up now.)
"
834815012,835,nicemicro,2021-05-07T22:10:02Z,"This just occurred to me, and I'm not sure whether anyone mentioned it already: if the telemetry is using methods and services that goes against the conscious of most privacy minded folks, it would mean that most Linux distributions will build Audacity without it for their repositories, and that will result in no user data from Linux.
Wouldn't it just defeat the purpose of the telemetry from the start then?"
834815648,835,nicolasdanelon,2021-05-07T22:11:10Z,Just edit you `/etc/hosts` and no google analytics for you.
834821499,835,logan2611,2021-05-07T22:22:01Z,"> Just edit you `/etc/hosts` and no google analytics for you.

You shouldn't have to do that"
834822265,835,nicolasdanelon,2021-05-07T22:23:30Z,"> 
> 
> > Just edit you `/etc/hosts` and no google analytics for you.
> 
> You shouldn't have to do that

you keep using ad blockers?"
834823493,835,logan2611,2021-05-07T22:26:02Z,"> > > Just edit you `/etc/hosts` and no google analytics for you.
> > 
> > 
> > You shouldn't have to do that
> 
> you keep using ad blockers?

Yes, and I shouldn't have to. I use adblockers because I do not support super annoying and laggy ads, not to mention the tracking that comes with almost all of them. I strongly prefer websites that don't have ads at all. You did nothing to address my point whatsoever"
834834673,835,Amolith,2021-05-07T22:47:31Z,"@nicemicro 
> if the telemetry is using methods and services that goes against the conscious of most privacy minded folks, it would mean that most Linux distributions will build Audacity without it for their repositories, and that will result in no user data from Linux.

With this PR, telemetry would only be included in the official releases built through the GitHub CI system; Linux distributions building Audacity from source on their own infrastructure won't include the telemetry bit *at all*. This means the project wouldn't get *any* data from *any* Linux user installing it through their package manager in the first place. On one hand, I'm glad that none of my personal data would get sent to Google and Yandex. On the other hand, I'm pretty sure that means they wouldn't get potentially useful information from a significant chunk of their users so the collected data is incomplete.

Ignoring the privacy concerns for a moment, this functionality just seems badly implemented in its current state."
834838040,835,SndChaser,2021-05-07T22:53:53Z,"> @Amolith 

> GitHub CI system; Linux distributions building Audacity from source on their own infrastructure won't include the telemetry bit _at all_. This means the project wouldn't get _any_ data from _any_ Linux user installing it through their package manager in the first place. On one hand, I'm glad that none of my personal data would get sent to Google and Yandex. On the other hand, I'm pretty sure that means they wouldn't get potentially useful information from a significant chunk of their users so the collected data is incomplete.

Incomplete is an understatement.  From a statistical point of view it would be an invalid data set, which would be no basis for making any decisions (technical or otherwise).

> Ignoring the privacy concerns for a moment, this functionality just seems badly implemented in its current state.

Worse than badly implemented.  It seems broken by design."
834869857,835,AndreiSva,2021-05-07T23:46:09Z,Maybe this PR is more targeted towards windows and Mac OS users?
834872543,835,HeyBanditoz,2021-05-07T23:50:05Z,"Seems like this could skew data a bit.

On 5/7/2021 17:46, AndreiS wrote:

> Maybe this PR is more targeted towards windows and Mac OS users?
>
> —
> You are receiving this because you commented.
> Reply to this email directly, [view it on GitHub](https://github.com/audacity/audacity/pull/835#issuecomment-834869857), or [unsubscribe](https://github.com/notifications/unsubscribe-auth/ABZZJCFJYCDFMNZM32CI2BTTMR3VJANCNFSM44C5SLTA)."
834887247,835,Blu3wolf,2021-05-08T00:11:22Z,"> Reacting with thumbs down doesn't prevent it from happening, it just tags you as the kind of person who thinks reacting with thumbs down prevents something from happening.

So, I gather you hadn't spotted the number of new forks then. "
834891815,835,AuroraNemoia,2021-05-08T00:17:59Z,"I've used Audacity all my life, since I was like 6 years old. I'm now 22. (take my data, mine it I don't care) and I did so on Windows. I've also run Linux exclusively for quite a few years. But these days, the only times telemetry genuinely annoys me is if it gets in my way. If I can turn off the targeted advertising that results from my data being collected. I don't care.

The way analytics are being approached in this case is at best useless and at worse worrying. [like stated in this comment](https://github.com/audacity/audacity/pull/835#issuecomment-834521293).

I don't agree with the foam at the mouth raging mentality of ""Audacity is dead, let's make a fork now."" (call it audavillage since you're reclused away from the city) I think I understand what happened here.

An attempt at a useful feature was made by a community member who was well-intentioned, But did not know how to handle these things properly. Using proprietary obscure services like Google Analytics and Yandex Metrics. As well as explicitly storing records of IPs and UUIDs.

The main developer of Ardour has popped up in this thread and mentionned how Ardour uses (used) anonymized telemetry to get a better idea of the divide in operating systems amongs their users. This is useful info. THAT CAN BE GUESSED FROM PEOPLE DOWNLOADING THE APP.

I will say, a manual analytics feature that lets you get a full system report including data about Audacity to put into a bug report would be useful. But automated background analytics aren't. Recurring data can only ever be used for engagement metrics useless to development.

I realize this is a mess of a comment. sorry.

I wish the best to the Audacity Team."
834900047,835,eylles,2021-05-08T00:30:41Z,"so, who's starting the preventive, no telemetry fork of audacity?"
834918254,835,polyjitter,2021-05-08T00:58:41Z,"People who are focusing on there being analytics, and not the specificities of analytics being provided by large, known to disrespect privacy megacorps, are massively missing the point and proving they don't actually understand why anyone was originally concerned about analytics in general, and are just jumping on what they perceive to be a cool fad.

**Analytics can be great tools for developers** for a multitude of reasons (although I don't agree with her stated approach to invasive telemetry, @TripingPC has brought up some good ones, and I find @SndChaser's reply [here](https://github.com/audacity/audacity/pull/835#issuecomment-834543942) to be perfect in every way), but **the use of Google and Yandex tools is concerning and egregious, and goes against the very foundational ethical philosophies of a FLOSS application.**

I really, HIGHLY hope the Audacity team takes into consideration why going with these tools is harmful. If they aren't quite sure, I'm sure many people in their community are more than welcome to help them understand. 

Though I would [suggest they consider what has been said in this comment, because it is indeed a very valid concern.](https://github.com/audacity/audacity/pull/835#issuecomment-834521293)"
834926949,835,mcilrain,2021-05-08T01:11:45Z,"Anyone who posts a pro-analytics comment who does not wish to
immediately out themselves as a hypocrite should include their IP address in their comment.

Either it is ""safe and anonymous information"" or it isn't, you can't have it both ways."
834944231,835,AndreiSva,2021-05-08T01:39:52Z,"@mcilrain Here's mine: 127.0. 0.1

:)"
834950793,835,heliophane,2021-05-08T01:50:02Z," > It should probably get some practical and boring name like LibreAudio until someone can come up with a good pun.


Libredacity, but that sounds weird lol
"
834954093,835,eylles,2021-05-08T01:54:58Z,"> > It should probably get some practical and boring name like LibreAudio until someone can come up with a good pun.
> 
> Libredacity, but that sounds weird lol

Audience - Audio Editor with the audacity to listen to it's users"
834960893,835,Zuyoutoki,2021-05-08T02:04:31Z,"> Audience - Audio Editor with the audacity to listen to it's users

I'd rather not see a fork, but that name would be a fun one :^)"
834964414,835,SndChaser,2021-05-08T02:09:06Z,"@polyjitter 

> **Analytics can be great tools for developers** for a multitude of reasons (although I don't agree with her stated approach to invasive telemetry, @TripingPC has brought up some good ones, and I find @SndChaser's reply [here](https://github.com/audacity/audacity/pull/835#issuecomment-834543942) to be perfect in every way), but **the use of Google and Yandex tools is concerning and egregious, and goes against the very foundational ethical philosophies of a FLOSS application.**

Thanks for the vote of confidence on my comment...it certainly took a while to put it together, and I still feel like I could have done some more...  Like gathering more policies around telemetry in other open source projects just to provide more examples that handle it appropriately."
834969949,835,Be-ing,2021-05-08T02:16:34Z,"I have changed my opinion. There should be zero telemetry in Audacity whatsoever, even if it is collected and stored in an anonymized, consentful way. @workedintheory has already demonstrated that he [will use it as a weapon against people with legitimate concerns](https://github.com/Xmader/musescore-downloader/issues/5#issuecomment-704372864):

> There are more than 12 million members of the community and it is growing at a rate of thousands per day. The number of people complaining about the particular issue of not having a more flexibility with variants of CC [Creative Commons] licenses is less than 50. This issue is not quite as large of an issue as you perceive it to be.

@workedintheory, you may think less than 50 people complaining is irrelevant. You are wrong. 50 people complaining is actually *a lot*.

It is your capitalist mindset that is irrelevant. You can't buy trust. What has your money done for Audacity? You've hired at least one new developer (@crsib) who has no history of contributing to Audacity. The only reference I can find of @crsib contributing to FOSS is a link to a [nonexistent repository](https://bitbucket.org/crsib/mani) from his LinkedIn profile. Now some of the first code he writes for Audacity sets off this shitstorm?

I'm not saying you shouldn't hire anyone who doesn't have a prior history in FOSS to work on Audacity -- that would amplify existing biases -- but did you even consider looking for FOSS audio developers to hire? When RedHat hires the Fedora Project Leader, they don't just hire any random programmer. They hire someone from the community and who they hire is subject to the advise and consent of the volunteer elected representatives of the Fedora community, as specified in [written policy](https://docs.fedoraproject.org/en-US/council/).

Did you even know that @falkTX recently started asking for financial support for his work? I'm not trying to speak for @falkTX; I don't know if he would even want the job. But it sure seems you didn't ask or were even aware that he was seeking financial support to work on FOSS audio software. And now through your mismanagement, he's prepared to maintain a fork and make your investment in the Audacity trademark worthless.

You've gone about this all wrong. You need to understand that the community is in charge here, not you, and come to us humbly, asking how to make amends and build trust. The first step would be closing this pull request and committing to not adding any telemetry to Audacity. A second step could be setting your new hires to work addressing longstanding complaints from the wider FOSS community about Audacity forking dependencies and making it hard to integrate Audacity's build system with Linux distributions' packaging policies. Audacity does not exist in a vacuum. It is far bigger than the regular contributors and active users on the forum. It is one part of a large ecosystem of interdependent software."
834974557,835,asdf8dfafjk,2021-05-08T02:22:30Z,"> > Because of the FUD around telemetry- making it optional would mean most half-informed people will turn it off (most of them being on Linux). Thus audacity will have no way to track linux usage hurting it's progress on Linux. I propose making it mandatory and impossible to turn off but with anonymization and less data points.
> 
> Bravo! You've won the award for the most irrational and stupifying dumb comment in this conversation. (1) Linux users tend to be much more technical, and much better informed than the general user base, (2) such a move would likely get Audacity removed from most Linux distributions, (3) a fork would likely be inevitable, (4) the harm to the reputation of Audacity would be irreparable, (5) there would be a good chance that this kind of move could find itself in a regulatory quagmire of GDPR, CCPA, and others.
> 
> This would absolutely guarantee that Audacity would go the way of OpenOffice.org.
> 
> Hmm, I think I like the name ""LibreAudio"" for the fork.... ;)

You sound retarded and self obsessed so I am not going to reply to individual points. Now go watch your netorare "
834976188,835,coreyreichle,2021-05-08T02:24:34Z,"Gah, I saw this happening as soon as I saw the Muse announcment.

No.  No analytics, unless wholly self hosted.

But also, most linux distros will build this without analytics, so your data will be near useless, as a large userbase IS linux users.

Just a bad PR from the user story phase, right up to the systems architecture phase, and then still a bad PR in the user acceptance phase."
834988630,835,coreyreichle,2021-05-08T02:40:36Z,"> > or decides to simply make Audacity proprietary
> 
> Let's not get hyperbolic here. Audacity is licensed under the GPLv2. Nobody can make it proprietary.

Ah, I see you didn't follow the VitualBox and MySQL debacles, huh?"
834989926,835,HeyBanditoz,2021-05-08T02:42:19Z,"> 
> 
> > > or decides to simply make Audacity proprietary
> > 
> > 
> > Let's not get hyperbolic here. Audacity is licensed under the GPLv2. Nobody can make it proprietary.
> 
> Ah, I see you didn't follow the VitualBox and MySQL debacles, huh?

And then came MariaDB"
834990255,835,geekredux,2021-05-08T02:42:46Z,"> To address the concerns about use of private library versions, the largest part of this pull request is a networking layer built on top of libcurl. This library is chosen as it is an industry-standard for cross-platform networking. It is exceptionally tested and reviewed by industry experts. The layer on top of it, aka lib-network-manager meant to simplify the development of future features. libcurl is used without any patches. It is possible to use the system-provided version of the library available on the Linux distributions, and we will double-check that this works as expected.

PR description keeps getting updated in a way that suggests there is no interest in dropping the telemetry. They just keep doubling down on why what they're doing is okay.

It's not okay. My audio editing app does not need ""cross-platform networking"", and it certainly doesn't need a layer on top of that for ""future features"".
"
834992606,835,turtlegarden,2021-05-08T02:45:53Z,"> I have changed my opinion. There should be zero telemetry in Audacity whatsoever, even if it is collected and stored in an anonymized, consentful way. @workedintheory has already demonstrated that he [will use it as a weapon against people with legitimate concerns](https://github.com/Xmader/musescore-downloader/issues/5#issuecomment-704372864):
> 
> > The number of people complaining about the particular issue of not having a more flexibility with variants of CC [Creative Commons] licenses is less than 50. This issue is not quite as large of an issue as you perceive it to be.
> 
> You may think less than 50 people complaining is irrelevant. You are wrong. It is your capitalist mindset that is irrelevant. You can't buy trust. What has your money done for Audacity? You've hired at least one new developer (@crsib) who has no history of contributing to Audacity. The only reference I can find of @crsib contributing to FOSS is a link to [nonexistent repository](https://bitbucket.org/crsib/mani) from his LinkedIn profile. Now some of the first code he writes for Audacity sets off this shitstorm?
> 
> I'm not saying you shouldn't hire anyone who doesn't have a prior history in FOSS to work on Audacity -- that would amplify existing biases -- but did you even consider looking for FOSS audio developers to hire? When RedHat hires the Fedora Project Leader, they don't just hire any random programmer. They hire someone from the community and who they hire is subject to the advise and consent of the volunteer elected representatives of the Fedora community, as specified in [written policy](https://docs.fedoraproject.org/en-US/council/).
> 
> Did you even know that @falkTX recently started asking for financial support for his work? I'm not trying to speak for @falkTX; I don't know if he would even want the job. But it sure seems you didn't ask or were even aware that he was seeking financial support to work on FOSS audio software. And now through your mismanagement, he's prepared to maintain a fork and make your investment in the Audacity trademark worthless. You've gone about this all wrong. You need to understand that the community is in charge here, not you, and come to us humbly, asking how to make amends and build trust. The first step would be closing this pull request and committing to not adding any telemetry to Audacity. A second step could be setting your new hires to work addressing longstanding complaints from the wider FOSS community about Audacity forking dependencies and making it hard to integrate Audacity's build system with Linux distributions' packaging policies. Audacity does not exist in a vacuum. It is far bigger than the regular contributors and active users on the forum. It is one part of a large ecosystem of interdependent software.

I agree, **no telemetry at all** should be in Audacity. If this PR gets accepted, many people like me and people who value privacy will stop using Audacity and MuseScore (and both will both likely be forked). Prepare to become OpenOffice.org if this gets accepted! Also, if you disagree, please put your IP, email, and your Unix username below. It will be annonymized, I swear :)"
834997136,835,coreyreichle,2021-05-08T02:49:03Z,"> > 5,506 lines of code
> 
> Most of that code is from vendored dependencies. The changes to the Audacity code are quite small.

Nevertheless, they are now part of the Audacity maintenance, since they are included.  Bugs in the ""vendor dependencies"" are now bugs in Audacity."
834999781,835,zeronobody0,2021-05-08T02:52:23Z,"Does anyone know any good software alternatives that don't include telemetry? I heard about ardour somewhere, is it legit?"
835004419,835,HeyBanditoz,2021-05-08T02:58:22Z,">
>
> Does anyone know any good software alternatives that don't include telemetry? I heard about ardour somewhere, is it legit?

Ardour is a bit overkill.

On 5/7/2021 20:52, SirAxolot wrote:

> Does anyone know any good software alternatives that don't include telemetry? I heard about ardour somewhere, is it legit?
>
> —
> You are receiving this because you commented.
> Reply to this email directly, [view it on GitHub](https://github.com/audacity/audacity/pull/835#issuecomment-834999781), or [unsubscribe](https://github.com/notifications/unsubscribe-auth/ABZZJCEX5L2OVKNWRRWC7U3TMSRPTANCNFSM44C5SLTA)."
835014624,835,mc776,2021-05-08T03:02:01Z,"@SirAxolot I'm on their website now https://ardour.org/support_expectations.html and I thought I read something about some limited telemetry I don't recall what exactly, I can't find it on the site, and it might not even be real (but even if it was, it was nothing of the sort that's being proposed in this PR).

And yeah, this program does look like overkill for a lot of us, but hey if we gotta drop something on such short notice to trade it for something that's even more, that's certainly a more pleasant surprise than dropping it for something less!"
835020149,835,eylles,2021-05-08T03:03:54Z,"Well, ardour is a full fledged DAW (Digital Audio Workstation), of course it will be overkill compared to audacity, which is an Audio Editor, that's why if a PR like this, or something similar gets merged the only course of action is fork as there's no other good FOSS program to fill in audacity's use case, that of a ""simple"" Audio Editor."
835054327,835,sam-ka,2021-05-08T03:42:19Z,"As long as Audacity **commits** to never enable telemetry by default in the future, I have no problem with this. I don't want Audacity to become another Firefox."
835058364,835,nico-abram,2021-05-08T03:48:24Z,"@crsib there is a typo in this commit message https://github.com/audacity/audacity/pull/835/commits/e420e0f68f6dd6faf9359bb61a26ae122f10ee40
Also, I found a bug:
https://github.com/crsib/audacity/blob/telemetry/libraries/lib-network-manager/CookiesList.cpp#L67
This seems to have been copypasted from [here](https://github.com/crsib/audacity/blob/telemetry/libraries/lib-network-manager/CookiesList.cpp#L54-L56), I think you meant to use `trailingSemicolon` and not `semicolonPosition` in the npos check (As-is it looks like it can lead to bad things (tm) if the first semicolon is found and the ""Expires="" semicolon isn't, leading to `cookieString.substr (expiresPosition, trailingSemicolon - std::string::npos)`)


I'll stop using Audacity if this PR gets merged. Have a nice day"
835085744,835,ciriousjoker,2021-05-08T04:34:30Z,"I generally agree with this PR and I would argue it's probably better to implement it anyway against the backlash depending on the risk of creating a fork.

The thing is, the upvote/down vote ratio is highly skewed because the sample size is not all Audacity users but only the ones who are outraged by this. The ones in favor will probably not click on articles about this and search the PR afterwards and also upvote (like I did).

Sure, in this bubble the shit storm is big, but the bubble in general is fairly small and I doubt that this would be such a controversial PR if every Audacity user had to vote on this before they could launch Audacity again.

As for the ""pro-people leave your ip address!"":
No I won't, because I don't have to. You also don't have to opt into telemetry.

To conclude:
The community can still create a fork if this gets out of hand, but as of now I don't see why this PR alone would warrant it.

EDIT: Please explain the downvotes on this comment."
835087545,835,MCterra10,2021-05-08T04:37:49Z,"> 
> 
> Anyone who posts a pro-analytics comment who does not wish to
> immediately out themselves as a hypocrite should include their IP address in their comment.
> 
> Either it is ""safe and anonymous information"" or it isn't, you can't have it both ways.

it's off by default and completely opt in. I honestly don't understand the issue. if you don't like it, you literally don't have to *do anything* to not share your data, because it *isn't*.
My IP is also 49.183.159.93 by the way, not that this does anything because the security risk of a simple IP address is greatly overstated anyway."
835093943,835,HeyBanditoz,2021-05-08T04:51:15Z,"> EDIT: Please explain the downvotes on this comment.

Lol.
"
835095133,835,Mazianni,2021-05-08T04:53:46Z,"> EDIT: Please explain the downvotes on this comment.

No, just like I don't have to opt in to telemetry."
835102365,835,serebit,2021-05-08T05:08:18Z,"> To address the concerns about use of private library versions, the largest part of this pull request is a networking layer built on top of libcurl. This library is chosen as it is an industry-standard for cross-platform networking. It is exceptionally tested and reviewed by industry experts. The layer on top of it, aka lib-network-manager meant to simplify the development of future features. libcurl is used without any patches. It is possible to use the system-provided version of the library available on the Linux distributions, and we will double-check that this works as expected.

At this point, your justification rings hollow. I will make no claims about your motives for making this change, but I will say that you've already significantly damaged the trust that the community has in the people making the decisions for this software. Continuing to double down is only making things worse. Drop this patch, take a step back, and evaluate the situation. You're only digging yourselves deeper. I get that you want to gauge how the people using Audacity actually use the software, but this was never the way to do it.

Edit: It's also rather telling that you're even concerned with complaints about the use of private library versions. I'm sure a couple people here have voiced that concern, but the primary issue isn't the version of libcurl that's being included, it's the fact that libcurl is being included at all. It's the fact that you intend on adding *more* networking to an offline audio editor in the future. If you want to keep Audacity the same and not anger the people who use it, you're going about it the wrong way."
835126943,835,eylles,2021-05-08T06:01:45Z,"> I generally agree with this PR and I would argue it's probably better to implement it anyway against the backlash depending on the risk of creating a fork.
> 
> The thing is, the upvote/down vote ratio is highly skewed because the sample size is not all Audacity users but only the ones who are outraged by this. The ones in favor will probably not click on articles about this and search the PR afterwards and also upvote (like I did).
> 
> Sure, in this bubble the shit storm is big, but the bubble in general is fairly small and I doubt that this would be such a controversial PR if every Audacity user had to vote on this before they could launch Audacity again.
> 
> As for the ""pro-people leave your ip address!"":
> No I won't, because I don't have to. You also don't have to opt into telemetry.
> 
> To conclude:
> The community can still create a fork if this gets out of hand, but as of now I don't see why this PR alone would warrant it.
> 
> EDIT: Please explain the downvotes on this comment.

welp, if this kind of karen tier comment is the support for this PR..... then there's no other way around, fork, and fork hard! :D"
835130141,835,chrismahoney,2021-05-08T06:08:10Z,"@CiriousJoker
> 
> EDIT: Please explain the downvotes on this comment.

The general lack of empathy you’ve displayed for people using audio software for reasons extremely outside of your use case or opposite of your geography. That same lack of empathy could ricochet through a general software tool that millions of people use for reasons entirely outside your understanding of human communication in general."
835136313,835,logan2611,2021-05-08T06:19:52Z,"> it's off by default and completely opt in. I honestly don't understand the issue. if you don't like it, you literally don't have to _do anything_ to not share your data, because it _isn't_.

The issue is that:
A. It uses closed source telemetry providers that are well known to data mine
B. The telemetry is not that useful considering that basically no Linux build will include it enabled

> My IP is also 49.183.159.93 by the way, not that this does anything because the security risk of a simple IP address is greatly overstated anyway.

It's not necessarily a security issue, it's a privacy issue.
"
835140299,835,jayaddison,2021-05-08T06:27:38Z,"A meta-concern:

If lots of apps decide that telemetry is important (even if it is disabled by default, with informed consent, and limited to sharing genuinely relevant data), then users are not going to have the time to stay aware of what information they are sending, to whom, and how to disable the items that they no longer wish to share.

This is similar to the situation that cookie consent banners have arrived in.  Many websites may follow the rules, but the overall effect is that users are overwhelmed and lack sufficient agency to be confident about how their data is used.

A scalable solution for the user population might require something more like a system settings dialog, where users could select what kind of information they are comfortable sharing, with the ability to add exceptions for specific types of application and/or data brokers.

Providing the ability for users to accurately vote with their data that way would help to create a telemetry/analytics data market, and increase the value of user data, encouraging data providers and application authors to play by the rules and maintain trust.

On a personal note: in the long term, I think some level of data sharing is beneficial for people.  It's difficult to exist entirely as an island.  But not everyone feels safe or ready to share - especially when it is in a digital, nebulous way that their senses cannot detect.  So we should always offer no sharing of data -- real privacy -- as a default, while explaining and showing the benefits (and drawbacks) that others experience from participating."
835143113,835,mcilrain,2021-05-08T06:33:08Z,"> My IP is also 49.183.159.93 by the way

How did you enjoy [PRED-313 (JAV porn) that you downloaded using BitTorrent a week ago?](https://iknowwhatyoudownload.com/en/peer/?ip=49.183.159.93)

"
835144474,835,jxu,2021-05-08T06:35:43Z,I don't want to have to use Audacity through a VPN sheesh
835144586,835,Be-ing,2021-05-08T06:35:56Z,"I am sad to see @JamesCrook and @Paul-Licameli actively supporting this at the top of this pull request. I would like to hear your responses to the criticism here. Is this something you really want, or was this imposed by @workedintheory / Ultimate Guitar / Muse Group? Where did the decision to implement this come from and why is there nothing publicly available about the proposal before any code was written? If you really think sending data about Audacity users to Google and Yandex is okay, well, thanks for Audacity, but I can't trust you anymore."
835148384,835,mindinsomnia,2021-05-08T06:43:00Z,"> > My IP is also 49.183.159.93 by the way
> 
> How did you enjoy [PRED-313 (JAV porn) that you downloaded using BitTorrent a week ago?](https://iknowwhatyoudownload.com/en/peer/?ip=49.183.159.93)

Ya know most people have dynamic IP addresses that change regularly right? My IP address changes almost every day."
835148432,835,Eschryn,2021-05-08T06:43:05Z,"> You've gone about this all wrong. You need to understand that the community is in charge here, not you, and come to us humbly, asking how to make amends and build trust. The first step would be closing this pull request and committing to not adding any telemetry to Audacity. A second step could be setting your new hires to work addressing longstanding complaints from the wider FOSS community about Audacity forking dependencies and making it hard to integrate Audacity's build system with Linux distributions' packaging policies. Audacity does not exist in a vacuum. It is far bigger than the regular contributors and active users on the forum. It is one part of a large ecosystem of interdependent software.

Also friendly reminder to the new Team Members, that in case of a fork - Audacity could actually die like OpenOffice did - it's gonna be a race then I suppose"
835149001,835,polyjitter,2021-05-08T06:44:08Z,"> > My IP is also 49.183.159.93 by the way
> 
> How did you enjoy [PRED-313 (JAV porn) that you downloaded using BitTorrent a week ago?](https://iknowwhatyoudownload.com/en/peer/?ip=49.183.159.93)

While this is admittedly incredibly funny as a response, it isn't really the gotcha you think it is. 

Analytics does not inherently mean collecting and storing data on IP addresses. There's plenty of useful data to be provided without any of that stuff being recorded. In fact, quite truthfully I don't know what analytics solution, third party or homegrown, WOULD provide that, since I can't see it as useful data in any way.

And if you're concerned about the mere connection to another party revealing said address, well... I hope you never visit the website for Audacity, or downloaded prebuilt binaries, or used any application that uses a P2P system, or used any centralized package repository on Linux. Or, uh, accessed the internet in general really.

This isn't a problem with analytics, this is just inherently how internet traffic works. Any time a project will provide some sort of connection, they will see your IP. That's downloads, that's websites, that's selfhosted git, that's extension managers, that's repositories, that's support communications. 

An IP address is inherently public information, which is why you should be careful with what you do about it. If you're going to do embarrassing or illegal stuff that is trackable via IP, use a VPN. That's basic knowledge and this person being sloppy with downloading pornography doesn't indicate that this is a ""privacy concern"". Sometimes we ARE responsible for our own actions.

Google and Yandex should not be trusted for analytics because of way too many other privacy concerns. And opt-out is a dark pattern. Opt-in analytics, through a solution that is both open source and privacy oriented, can provide useful information to improve an application and pinpoint issues and where things are failing. 

Keep in mind crash logs are technically a type of analytics..."
835149574,835,mindinsomnia,2021-05-08T06:45:19Z,"> > You've gone about this all wrong. You need to understand that the community is in charge here, not you, and come to us humbly, asking how to make amends and build trust. The first step would be closing this pull request and committing to not adding any telemetry to Audacity. A second step could be setting your new hires to work addressing longstanding complaints from the wider FOSS community about Audacity forking dependencies and making it hard to integrate Audacity's build system with Linux distributions' packaging policies. Audacity does not exist in a vacuum. It is far bigger than the regular contributors and active users on the forum. It is one part of a large ecosystem of interdependent software.
> 
> Also friendly reminder to the new Team Members, that in case of a fork - Audacity could actually die like OpenOffice did - it's gonna be a race then I suppose

Not really. OpenOffice died because the original project's development slowed down to a crawl while the fork developed faster than OO ever did.

That would not be the case with a fork of audacity done purely remove an **opt-in** setting. The fork would likely be playing catch-up with the original constantly. A better comparison would be something like Firefox and the fork Waterfox."
835150339,835,MarinaGryphon,2021-05-08T06:46:58Z,"> > > You've gone about this all wrong. You need to understand that the community is in charge here, not you, and come to us humbly, asking how to make amends and build trust. The first step would be closing this pull request and committing to not adding any telemetry to Audacity. A second step could be setting your new hires to work addressing longstanding complaints from the wider FOSS community about Audacity forking dependencies and making it hard to integrate Audacity's build system with Linux distributions' packaging policies. Audacity does not exist in a vacuum. It is far bigger than the regular contributors and active users on the forum. It is one part of a large ecosystem of interdependent software.
> > 
> > 
> > Also friendly reminder to the new Team Members, that in case of a fork - Audacity could actually die like OpenOffice did - it's gonna be a race then I suppose
> 
> Not really. OpenOffice died because the original project's development slowed down to a crawl while the fork developed faster than OO ever did.
> 
> That would not be the case with a fork of audacity done purely remove an **opt-in** setting. The fork would likely be playing catch-up with the original constantly. A better comparison would be something like Firefox and the fork Waterfox.

So your solution is playing chicken with the FOSS community rather than listening to criticism?"
835150446,835,eylles,2021-05-08T06:47:12Z,"welp, if the dev team is in support of this form of telemetry.... you know what time it is

![image](https://user-images.githubusercontent.com/33670677/117529787-e3fe9680-af96-11eb-883c-068345a58744.png)
"
835152464,835,mindinsomnia,2021-05-08T06:51:10Z,"> > > > You've gone about this all wrong. You need to understand that the community is in charge here, not you, and come to us humbly, asking how to make amends and build trust. The first step would be closing this pull request and committing to not adding any telemetry to Audacity. A second step could be setting your new hires to work addressing longstanding complaints from the wider FOSS community about Audacity forking dependencies and making it hard to integrate Audacity's build system with Linux distributions' packaging policies. Audacity does not exist in a vacuum. It is far bigger than the regular contributors and active users on the forum. It is one part of a large ecosystem of interdependent software.
> > > 
> > > 
> > > Also friendly reminder to the new Team Members, that in case of a fork - Audacity could actually die like OpenOffice did - it's gonna be a race then I suppose
> > 
> > 
> > Not really. OpenOffice died because the original project's development slowed down to a crawl while the fork developed faster than OO ever did.
> > That would not be the case with a fork of audacity done purely remove an **opt-in** setting. The fork would likely be playing catch-up with the original constantly. A better comparison would be something like Firefox and the fork Waterfox.
> 
> So your solution is playing chicken with the FOSS community rather than listening to criticism?

A few hundred angry Karen's ranting on a GitHub issue does not equate to the entire community surrounding Audacity.

I'd be quite willing to bet that the majority of Audacity users don't care. Remember we still live in a world where more people use Facebook than desktop Linux. The concerns expressed here are extremist in nature and niche."
835153688,835,Be-ing,2021-05-08T06:53:32Z,"> Not really. OpenOffice died because the original project's development slowed down to a crawl while the fork developed faster than OO ever did.
That would not be the case with a fork of audacity done purely remove an opt-in setting. The fork would likely be playing catch-up with the original constantly. A better comparison would be something like Firefox and the fork Waterfox.

Take a look at the [contributors on GitHub](https://github.com/audacity/audacity/graphs/contributors). It's mostly 4 people. This situation has attracted a huge amount of attention, including by skilled software developers, some of whom (like myself) have years of experience building complex audio software. We have the means to fork Audacity and take it in a different direction even if those 4 developers stick with Muse Group. It would be really sad if it came to that. I don't want it to go that way. They haven't merged this, nor any telemetry, yet. They can start building trust by:

1. Committing to not adding telemetry to Audacity.
2. Explaining how the decision to implement this was made.
3. Work with the community to change their decision making process to ensure nothing like this happens again.
"
835153918,835,ciriousjoker,2021-05-08T06:53:57Z,"@eylles Very helpful to insult my comment as ""Karen tier"" just because you disagree without explaining why.

---

@chrismahoney I don't understand what you mean by that, can you elaborate?
I sometimes use Audacity to cut up songs or voiceovers, but I don't need it professionally or on any major capacity. Isn't that the average use case for this software?

What does my geography (Germany) have to do with any of this or am I missing a metaphor?

I get that my opinion of ""don't take the backlash too seriously"" is not very popular, but I really couldn't understand what the backlash is about.

Extra dependencies and networking is a completely separate concern, but that doesn't seem to be the issue judging from the comments. I feel like most commenters are just enraged because their open source ethos clashes with the desire to make data driven decisions by using telemetry.

Since the tracking is optional and opt in, nothing changes for the user, so aside from technical considerations, how could this possibly be bad?

I honestly don't get that and I'd like to understand it.

---

@logan2611 
A: Only data from consenting users would be included in the data set though.

B: Windows/Mac isn't affected by this and I would guess that that's still the majority of the users because at least for Windows there isn't really a good alternative (don't know for mac)."
835154921,835,Cyanic76,2021-05-08T06:55:51Z,Why does telemetry literally gets added to every single thing? Don't you think we're getting tracked enough like that? Why do you want to know everything? You should not see what we're doing and how we're using the app.
835155079,835,polyjitter,2021-05-08T06:56:08Z,"> A few hundred angry Karen's ranting on a GitHub issue does not equate to the entire community surrounding Audacity.
> 
> I'd be quite willing to bet that the majority of Audacity users don't care. Remember we still live in a world where more people use Facebook than desktop Linux. The concerns expressed here are extremist in nature and niche.

I'm sorry you feel that way, but all software has ethical and moral ramifications. Those creating and using FLOSS software are going to be incredibly interested in being both ethical and moral in the software that is produced, since FLOSS values are foundationally about software that is honest about itself and does as little harm as possible, while being open and available for all. 

Closed source, third party analytics solutions do not fall within those goals and leave the door for plenty of abuse, not necessarily from the Audacity developers, but from providing more compilable data for a megacorp entity that is known to use software unethically, providing data to governments and other corporations that might seek to do harm to marginalized people and communities.

This is absolutely a justified conversation to be having, even though the toxicity in some places is rather unwelcomed and disappointing."
835155522,835,Be-ing,2021-05-08T06:57:02Z,"@CiriousJoker

> I honestly don't get that and I'd like to understand it.

Then read the 800+ comments explaining that above. Yes, all of them. It does not seem that you have."
835156904,835,mindinsomnia,2021-05-08T06:59:54Z,"> I don't want to have to use Audacity through a VPN sheesh

Then... Don't turn on the **opt-in** telemetry, and you won't have to. Simple."
835159591,835,MarinaGryphon,2021-05-08T07:05:19Z,"> Since the tracking is optional and opt in, nothing changes for the user, so aside from technical considerations, how could this possibly be bad?

Have you heard of Goodhart's Law, @CiriousJoker? If you switch from ""listening to community feedback and trying to make choices that satisfy people"" to ""trying to maximise some telemetry metric as a proxy for community satisfaction,"" then that metric will rapidly become useless for that purpose.

Besides, making development decisions based off of Big Data:tm: is setting yourself up for failure, especially with open-source software. If your contributors don't have full and unrestricted access to the data you're making decisions off of, then you're going to be undercutting them at every turn. At that point, a fork would be inevitable.

> Then... Don't turn on the opt-in telemetry, and you won't have to. Simple.

Some people having telemetry on and others not means that the people with telemetry off will be silenced for being concerned about privacy. Given that these people often (but not always) use similar platforms, it might lead to support for those platforms being underestimated, as well as other annoying incorrect estimations/evaluations caused by this confounding factor. That means it'll mean the data collected is inaccurate and, well, that just defeats the purpose, doesn't it?"
835162389,835,bkimmett,2021-05-08T07:10:34Z,"I might as well throw in my two cents: I like my privacy.

If you include telemetry, I'd prefer it to be an option in the settings, which is only enabled when the user navigates to it and turns it on (NOT ever prompting on startup, etc.)"
835163173,835,Xyz39808,2021-05-08T07:12:08Z,"Privacy concerns are not ""extremist in nature and niche."""
835163964,835,logan2611,2021-05-08T07:13:48Z,"@CiriousJoker

> A: Only data from consenting users would be included in the data set though.

Yes.

> B: Windows/Mac isn't affected by this and I would guess that that's still the majority of the users because at least for Windows there isn't really a good alternative (don't know for mac).

Windows and Mac users are affected by this since they are the only people to have builds that have telemetry in them. As mentioned by several other people, this degrades the value of the telemetry as a large portion of the user base just isn't included. 

I'm not against telemetry, I just don't think that this PR is doing it right. In my opinion, it should be self hosted, completely transparent and as anonymous as possible. Ideally there would also be a way to toggle what is collected, but not a lot of projects do that.

"
835165635,835,y4my4my4m,2021-05-08T07:17:09Z,"> > Anyone who posts a pro-analytics comment who does not wish to
> > immediately out themselves as a hypocrite should include their IP address in their comment.
> > Either it is ""safe and anonymous information"" or it isn't, you can't have it both ways.
> 
> it's off by default and completely opt in. I honestly don't understand the issue. if you don't like it, you literally don't have to _do anything_ to not share your data, because it _isn't_.
> My IP is also 49.183.159.93 by the way, not that this does anything because the security risk of a simple IP address is greatly overstated anyway.

Good old ""i have nothing to hide so i dont care for privacy""

Edit: https://github.com/y4my4my4m/audacity-without-telemetry
Starting on this because, guess we'll have to, feel free to join in."
835166402,835,chrismahoney,2021-05-08T07:18:40Z,"> I'd be quite willing to bet that the majority of Audacity users don't care. Remember we still live in a world where more people use Facebook than desktop Linux. The concerns expressed here are extremist in nature and niche.

This is all the more reason to care as somebody that cares enough to be replying here.

Quick thought: I always thought it was subversive for Audacity to have the name that it does, as if the open source community had the audacity to release a professional competitor to crap like Cool Edit Pro -> Adobe Audition. I _never_ expected the name to carry such irony where there was audacity enough to square up against that community by acquiring the software, this is just weird."
835169819,835,ciriousjoker,2021-05-08T07:24:58Z,"@MarinaGryphon 
I haven't heard of this law but it's an interesting read. However, I don't think it applies here. I don't think the goal of this telemetry is to get metrics to optimize for but rather to understand which effects & features are most popular (and then optimize those depending on real feedback and needs).

I definitely think the data should be public and that self hosted analytics should be used instead of Google/Yandex. Much of the outrage seems to be about telemetry in general though and not just the provider choice, that's why I was confused.

Also, you could normalize the statistics if you know how many users you have for each platform (which they probably have data on already)."
835172722,835,Be-ing,2021-05-08T07:30:00Z,"> Also, you could normalize the statistics if you know how many users you have for each platform (which they probably have data on already).

You fundamentally cannot get representative statistics of how many people use software on Linux. This is a feature, not a bug. Linux users get most of their software through their distribution's package manager, not the application developer."
835179331,835,ciriousjoker,2021-05-08T07:41:27Z,"> You fundamentally cannot get representative statistics of how many people use software on Linux. This is a feature, not a bug. Linux users get most of their software through their distribution's package manager, not the application developer.

Do you think there's a disparity between feature popularity? As for bug reports, Linux users will report them and include logs themselves, but Windows/Mac users probably won't. In that case, it just improves Windows/Mac bug reporting without affecting the already good Linux bug reporting.

I doubt that the inaccuracy of the data set actually impacts the quality given the specific type of data collected."
835198341,835,mc776,2021-05-08T08:12:46Z,"Yay, the thumbs down finally broke 3000!

> Privacy concerns are not ""extremist in nature and niche.""

I'm immediately reminded of this one story:
https://www.islam21c.com/politics/does-spying-make-you-feel-safer/

> Umar said, “This is the house of Rabi’ah ibn Umayyah ibn Khalaf, and they are inside drinking wine right now! What do you think?” Abdur Rahman said, “Indeed, I think we have done what Allah has prohibited for us. Allah Almighty said, ‘Do not spy,’ (49:12) and we have spied on them.” Umar turned away and he left them alone.

And then that whole bit with Noah and Ham...
(Not that I think the techy computery crowd that'd be on this thread would be all that interested in theological moralizings of these old dead white(according to the US census!) men, just a not-quite-random example of the value of privacy being recognized even before the Industrial Revolution)"
835201167,835,msmuenchen,2021-05-08T08:17:21Z,"> You fundamentally cannot get representative statistics of how many people use software on Linux. This is a feature, not a bug.

You can, using telemetry, that is the entire point of this PR. What has gone utterly bad is the *how* part. Why Google and Yandex of all places, instead of using stuff like Firefox's Telemetry infrastructure, is beyond me."
835205365,835,Sciss,2021-05-08T08:24:39Z,"> there's no other good FOSS program to fill in audacity's use case, that of a ""simple"" Audio Editor

I think there are few other audio editors out there. I use my own, [Eisenkraut](https://github.com/Sciss/Eisenkraut), but that hardly covers even a fraction of the functionality of Audacity (for example, doesn't offer volume breakpoint editor or independent tracks, doesn't feature Nyquist etc.), it's basically constrained to what I need in my work, though I'm open to additions."
835215898,835,hondogitsune,2021-05-08T08:43:49Z,"> 
> Those who hate tracking enough to never use a program again because it adds some analytics as an opt-in feature: Why the heck are you commenting on GitHub, a Microsoft website?
> 

Whataboutism, strawman argument and  false equivalence in one post! Just because platform A does thing X, platform B doing X doesn't make it right. Besides browsers sandbox a lot internally, have adblockers and scriptblockers because people disliked telemetry this much.  

Such smokescreens only derail any meaningful discussions.
"
835244902,835,jxu,2021-05-08T09:33:23Z,"> Yay, the thumbs down finally broke 3000!
> 
> > Privacy concerns are not ""extremist in nature and niche.""
> 
> I'm immediately reminded of this one story:
> https://www.islam21c.com/politics/does-spying-make-you-feel-safer/
> 
> > Umar said, “This is the house of Rabi’ah ibn Umayyah ibn Khalaf, and they are inside drinking wine right now! What do you think?” Abdur Rahman said, “Indeed, I think we have done what Allah has prohibited for us. Allah Almighty said, ‘Do not spy,’ (49:12) and we have spied on them.” Umar turned away and he left them alone.
> 
> And then that whole bit with Noah and Ham...
> (Not that I think the techy computery crowd that'd be on this thread would be all that interested in theological moralizings of these old dead white(according to the US census!) men, just a not-quite-random example of the value of privacy being recognized even before the Industrial Revolution)

Thank you, now I have religious justification why this PR is bad.

Without getting into the weeds about morality, there seems to be a widely agreed upon right to privacy as a human right. "
835246913,835,ktomk,2021-05-08T09:37:02Z,"> 1. Telemetry is strictly optional and disabled by default.

If this would be strictly optional and disabled by default for users of a free software, this would be an isolated, non-mainline branch that would never be filed as a pull request against trunk.

As @crsib likely is a knowledgeable software developer it is highly likely that they know how software works and what the consequences are and how this is _not_ in favor to Audacity users.

> (which we completely understand)

Sure otherwise this PR would have never been filed, despite even stayed open longer than 48 hours.

---

There is better utility for users doing bug reports than telemetry even on less accessible platforms . So if you really feel about improving that, could you elaborate what makes you, @CiriousJoker want adding Telemetry to Audacity to enable users?

Telemetry is not user participation in a software project. It's the opposite. And it is really hurting to see it here, as free software development has the potential to actually give answer to such problems, like the support problem in commercial software development."
835250737,835,Atulin,2021-05-08T09:43:45Z,"Don't know if it's been mentioned yet and I don't feel like reading all those hundreds of comments, so I'm gonna mention it here: the screenshot makes the ""accept"" button more pronounced. A common dark pattern, sure, but one that stands against GDPR regulations. Might want to rethink that."
835253882,835,ghost,2021-05-08T09:49:28Z,"Telemetry is unnecessary for a project like this. If Audacity crashes for someone, they can just create a new issue about it. If you don't want to support a specific OS version, create an issue and let the community decide.

> Just to reiterate, telemetry is completely optional and disabled by default.

Your concept literally shows that the ""Send usage data"" is the focused button, which is nothing but a dark pattern. With this layout, the majority of users will not make a conscious choice and instead choose the big blue button on the right."
835254026,835,ktomk,2021-05-08T09:49:46Z,"> Don't know if it's been mentioned yet and I don't feel like reading all those hundreds of comments, so I'm gonna mention it here: the screenshot makes the ""accept"" button more pronounced. A common dark pattern, sure, but one that stands against GDPR regulations. Might want to rethink that.

While rethinking, perhaps _privacy by design_ is important as this is the actual software development and it affects the design of the software (which includes the user interface (UI) but goes far beyond it, like how the code is organized, which libraries are used or taken in etc.).

Only given thought, the user is actually the primary  concern of the developers here.

> (which we completely understand)"
835263738,835,IGBC,2021-05-08T10:07:22Z,Reminder: Poll https://www.strawpoll.me/45241130/r
835264553,835,diovudau,2021-05-08T10:08:50Z,"Screenshot: Please note that ""Personal data or sensitive information"" includes the IP address.  If you collect it you cannot write what you are currently writing.
See also: https://ec.europa.eu/info/law/law-topic/data-protection/reform/what-personal-data_en

Also, what others say: This is still a ""dark design pattern"".  "
835266571,835,Frenzoid,2021-05-08T10:12:25Z,"> Reminder: Poll https://www.strawpoll.me/45241130/r

Quite offtopic, but i think it would be a great idea for github to implement some sort of poll system for this kind of debates over PRs.

It would be extremly useful."
835267745,835,ccoenen,2021-05-08T10:14:30Z,"Also, a unique identifier will always make it pseudonymous at best, and this cannot be called anonymous then.

But this is not the point I want to emphasize. The whole practice of tracking should not be included here (or pretty much anywhere)."
835277756,835,Nytelife26,2021-05-08T10:31:26Z,"> A few hundred angry Karen's ranting on a GitHub issue does not equate to the
> entire community surrounding Audacity.

> I'd be quite willing to bet that the majority of Audacity users don't care.
> Remember we still live in a world where more people use Facebook than
> desktop Linux. The concerns expressed here are extremist in nature and niche.

This is probably the most disappointing response to these concerns I
have seen in quite some time. ""They've already taken my freedom and
privacy anyway, so what's the point?"" is a truly upsetting stance to
see. Not caring is not the same as agreeing. We cannot knowingly stand
by and allow others to spy on people without their explicit consent.
And honestly, they don't need to be spied on anyway.

Our concern is more that despite this data collection being utterly
useless, they're still doing it anyway - and not for the reasons they
say, either. It is quite evidently just for the sake of data mining, as
evidenced by their choice to use closed source platforms owned by
companies that are quite literally known for selling people's digital
existence around like it's nothing.

These things have ethical issues attached, and really paints a bad
image on the character of the new maintainers. If, as a community, we
cannot trust the new maintainers to make decisions with our best
interests at heart, and it seems that they pertain more to computer
industry than computer science, we are left with no choice but to
express how we feel and work for change.
"
835284024,835,mindinsomnia,2021-05-08T10:41:47Z,"> We cannot knowingly stand by and allow others to spy on people

It's not spying. It's telemetry. They do not care what's on your PC or what your name is, or what your favourite colour is. They are recording stats only relevant to Audacity. The data is anonymous. No personal information is collected. We're talking about the same kind of information that almost every website, **including this one**, gather about usage patterns already. There is nothing nefarious about this, it's just useful information for product managers to make decisions about the direction of a project.

> without their explicit consent.

What part of ""opt-in"" does everyone in this thread find so hard to understand?
Just so we're clear, in case there's any confusion, ""opt-in"" is short for ""opting in"", opting is to make a choice.
Opt-in means that this will be off by default.
Telemetry will not be enabled unless **you** deliberately choose to enable it, and go do so.

So you can relax. No one will be spying on you. Take off the tin foil hat.

"
835287660,835,Sciss,2021-05-08T10:48:00Z,"> So you can relax. No one will be spying on you. Take off the tin foil hat.

Can we stop using the term telemetry, and call it what it is: tracking. And stop to be naive that a for-profit company's only goal is to improve the software? They need to make it profitable, so this is the entry point to connecting it to future paid subscription cloud whatever service AND/OR selling behavioural data to whoever can use them to build whatever models, if not for advertising then perhaps to build a better commercial product. Point.

And as for networking at all or not - stop reading here if you just think this is tinfoil hat - an audio editor is also a journalistic tool. Why on earth do you want to open the possibility that as soon as the ""basic telemetry"" has been extended in some future version, the data thus obtained (not necessarily by the vendor, but whoever manages to hack the connection) can be used to identify people who have been editing particular sounds, interviews, whatever.

There is simply no good reason to add this."
835290439,835,Blu3wolf,2021-05-08T10:52:52Z,"> > You fundamentally cannot get representative statistics of how many people use software on Linux. This is a feature, not a bug.
> 
> You can, using telemetry, that is the entire point of this PR. What has gone utterly bad is the _how_ part. Why Google and Yandex of all places, instead of using stuff like Firefox's Telemetry infrastructure, is beyond me.

You can't, as has been explained at least 4 times above. It's FOSS, and (many of) the downstream users strip out tracking. 

Has anyone got a promising fork yet?"
835291066,835,ElementW,2021-05-08T10:53:57Z,"> The data is anonymous. No personal information is collected.

The data is not anonymous in any legal sense that is compliant with GDPR and other consumer protection laws worldwide; the data processor is Google Analytics and/or Yandex, both of which will record a variety of data and metadata including IP addresses, which are not only pseudonymous but considered personally identifiable information. While not ""personal"" in a sense, when you're a major advertising company already collecting lots of user data, crossing information and finding out who you are is trivial.

> We're talking about the same kind of information that almost every website, **including this one**, gather about usage patterns already. There is nothing nefarious about this, it's just useful information for product managers to make decisions about the direction of a project.

The mere fact there exist websites that may not comply does not make your argument valid. 

> What part of ""opt-in"" does everyone in this thread find so hard to understand?
> Telemetry will not be enabled unless **you** deliberately choose to enable it, and go do so.

Dark patterns are frowned upon (see PR description), and implicit tracking acceptance (see code) is not consent (see [fungiboletus' comment](https://github.com/audacity/audacity/pull/835/files#r628124998)).
"
835293820,835,Blu3wolf,2021-05-08T10:58:43Z,"> Dark patterns are frowned upon (see PR description), and implicit tracking acceptance (see code) is not consent (see [fungiboletus' comment](https://github.com/audacity/audacity/pull/835/files#r628124998)).

This is mistaken. Dark patterns are not frowned upon - they are illegal. 57 Mil might be small change for Google - would be it small change for Musecore?"
835295775,835,dvzrv,2021-05-08T11:02:08Z,"@mindinsomnia The [ad hominems](https://en.wikipedia.org/wiki/Ad_hominem) towards people in this discussion voicing their concerns on *who* (e.g. Google and Yandex) will be using your data besides the project maintainers/developers (e.g. Muse Group) in a closed system - that is used to collect large amounts of data based on profiles, which are (also) derived from an IP address and can be identified across many websites and locations - is not helping your point across at all.
Please do not conflate that with the topic of *if* there is some form of tracking/telemetry.

Trying to discredit other people's factual assertions based on an [appeal to tradition](https://en.wikipedia.org/wiki/Appeal_to_tradition) (e.g. ""everyone is being tracked by everything by now anyways"") or an [appeal to hypocrisy](https://en.wikipedia.org/wiki/Tu_quoque) (e.g. ""why are you even using github, it also tracks you?"") is not providing any valid argument *for* this PR being merged."
835296052,835,ElementW,2021-05-08T11:02:39Z,"> This is mistaken. Dark patterns are not frowned upon - they are illegal.

Unfortunately not everything that's usually considered dark patterns are explicitly made illegal. I'm not very well versed on GDPR legalese but I'm not sure a ""default/highlighted action button"" of accepting is an illegal dark pattern in this instance."
835301684,835,thecodechemist99,2021-05-08T11:12:28Z,"What happened to the IPs? **In the original post you mentioned both services collecting IP information.** This isn‘t mentioned any more in the updated post, but I find this a bit suspicious. I honestly doubt that there is a way to disable that. So please be honest and mention it! I don't like this way of dealing wih criticism.
That‘s also opposing the statement in the screenshot – **IPs are both personal data and yield to an estimated location information**."
835303450,835,joepie91,2021-05-08T11:15:40Z,"@ElementW 

> Unfortunately not everything that's usually considered dark patterns are explicitly made illegal. I'm not very well versed on GDPR legalese but I'm not sure a ""default/highlighted action button"" of accepting is an illegal dark pattern in this instance.

It is."
835317707,835,Tharn,2021-05-08T11:41:14Z,"The toll for the introductory post counts 3750 negative emojis and 252 positive emojis. Those are pretty staggering numbers, and if you can't see the writing on the wall and continue with this implementation **against the will of 93% of your userbase**, we will have to assume that Audacity is no longer fit to serve its user's needs and instead serves Muse, Google and Yandex. We had a good run, folks."
835322375,835,netstx,2021-05-08T11:49:14Z,"Telemetry, CLAs... Closed source incoming?"
835325573,835,Sciss,2021-05-08T11:55:30Z,"> @ElementW
> 
> > Unfortunately not everything that's usually considered dark patterns are explicitly made illegal. I'm not very well versed on GDPR legalese but I'm not sure a ""default/highlighted action button"" of accepting is an illegal dark pattern in this instance.
> 
> It is.

Well, to be sure, companies are doing their best to ""interpret"" the boundary here. Attached is the cookie selection of one of Germany's national newspapers. Tell me if you don't find it obvious that you ""should"" click the black button (""accept all data collection"").

![Screenshot from 2021-05-08 13-04-52](https://user-images.githubusercontent.com/131300/117538116-e8619880-b004-11eb-89db-844ee33556fa.png)
"
835327771,835,falkTX,2021-05-08T12:00:25Z,"> Has anyone got a promising fork yet?

I am waiting on an official response from Audacity team before doing any work on that.
Let's give them the benefit of the doubt, you know.. innocent until proven guilty.
Sure, not a lot of hope for them to go in the right direction, but surprises happen sometimes.
"
835334588,835,mikelupe,2021-05-08T12:16:27Z,"I would vote to support the falkTX fork, if it will be necessary. "
835336024,835,ghost,2021-05-08T12:20:05Z,"> I am waiting on an official response from Audacity team before doing any work on that.

Please, call it **Audience** and I promise I will work on the logo if you need one!"
835343791,835,j0lol,2021-05-08T12:39:18Z,"off topic but i feel like github could really do with threads (similar to how reddit does it?) because the amount of different discussion in these replies is very overwhelming
also my poor inbox........ "
835350229,835,cadadr,2021-05-08T12:54:13Z,"> > Has anyone got a promising fork yet?
> 
> I am waiting on an official response from Audacity team before doing any work on that.
> Let's give them the benefit of the doubt, you know.. innocent until proven guilty.
> Sure, not a lot of hope for them to go in the right direction, but surprises happen sometimes.

@falkTX Man, call it ""honesty"" if you go ahead with that, pwweease ;P"
835357725,835,MCterra10,2021-05-08T13:11:39Z,"> 
> 
> > My IP is also 49.183.159.93 by the way
> 
> How did you enjoy [PRED-313 (JAV porn) that you downloaded using BitTorrent a week ago?](https://iknowwhatyoudownload.com/en/peer/?ip=49.183.159.93)

😂 thanks I did have a good chuckle ahaha
sadly not me though, since I'm on CG nat and several hundred connections share my IP at any one time."
835361859,835,Bauxitedev,2021-05-08T13:21:59Z,"![michael-jackson-eating-popcorn-gif](https://user-images.githubusercontent.com/31383123/117540784-1cdb5180-b011-11eb-8485-b8ab42967d13.gif)
"
835367921,835,collinalexbell,2021-05-08T13:38:04Z,"I think this a good time to take a hard stance against automatic upload of tracked data (""telemetry"" is a word used to sugar coat). "
835369925,835,SteveDaulton,2021-05-08T13:44:13Z,"> Is telemetry opt-in only or do users have to disable it manually once they update to the next release?

It is opt-in.
On first run with this PR, you are asked if you would like to opt in. It is a binary choice, opt in or opt out. Your choice is remembered and you are not prompted again, but can change choice option in Preference settings should you wish to."
835371682,835,SteveDaulton,2021-05-08T13:49:54Z,"> This nonsence, but still no bug fixes to Jack support.... Really?

Jack support is broken in Audacity 3.0.2.
I fixed it here: https://github.com/audacity/audacity/commit/b4b5cc812483b311627bba48e26b91ae389ce713

A bit too late now, but I wish that GitHub users would observe basic GitHub etiquette."
835375773,835,SteveDaulton,2021-05-08T14:01:41Z,"> Disabled by default, a user must manually and without nagging explicitly opt-in to telemetry themselves.

Yes it is opt-out by default.
There is a one time dialog  that asks if you would  like to opt-in. If you choose not to opt in, that's it, no nags."
835377528,835,SteveDaulton,2021-05-08T14:06:42Z,"> It's not opt-in if the default is on.
> 
> https://github.com/audacity/audacity/pull/835/files#diff-38452b2ab9b100d5046eb855410add20e6158dbc69533301bfc15f6d0913d3efR93-R94

That's not correct. You are misreading the code. It is opt out by default. Telemetry is only enabled if you explicitly opt in.
If you don't believe me, please test it yourself."
835378995,835,falkTX,2021-05-08T14:10:52Z,"> > Disabled by default, a user must manually and without nagging explicitly opt-in to telemetry themselves.
> 
> Yes it is opt-out by default.

This is misleading.
The current pop-up has the ""yes"" more prominently than the ""no"".

![image](https://user-images.githubusercontent.com/1334853/117542218-a25e0200-b00f-11eb-8712-88ffc25fae8a.png)

This is a GDPR violation. And makes it look as the ""yes"" should be default and preferred.
Please change that.

Also there is some oddity with https://github.com/audacity/audacity/pull/835/files#r628437539 where while the tracking preference is set to false at the start, later on the fallback value is true.

"
835379483,835,petersampsonaudacity,2021-05-08T14:12:29Z,"> 
> 
> > Is telemetry opt-in only or do users have to disable it manually once they update to the next release?
> 
> It is opt-in.
> On first run with this PR, you are asked if you would like to opt in. It is a binary choice, opt in or opt out. Your choice is remembered and you are not prompted again, but can change choice option in Preference settings should you wish to.

As Steve says - and if you use Tools > Reset Configuration that will turn off the sending of Analytics as part of its factory reset of Preferences (I QA tested that bit a couple of days ago)
"
835379546,835,IGBC,2021-05-08T14:12:42Z,"> > This nonsence, but still no bug fixes to Jack support.... Really?
> 
> Jack support is broken in Audacity 3.0.2.
> I fixed it here: [b4b5cc8](https://github.com/audacity/audacity/commit/b4b5cc812483b311627bba48e26b91ae389ce713)

My apologies at the time of writing I did not know my distro was stuck on v2.4.1. (the v3 won't build on most Linux distros, including Archlinux) You guys should look into de-vendoring wxWidgets

Incidentally that doesn't change the fact that this PR is utter nonsense (not to mention complete unmaintainable spaghetti code) anyway you guys can do so much better than bending over and letting a megacorp feast on your users.
"
835380324,835,petersampsonaudacity,2021-05-08T14:15:07Z,"> This is misleading.
> The current pop-up has the ""yes"" more prominently than the ""no"".

That is likely to be changed (as one of the QA testers involved I pointed that out to the Developer as part of my initial feedback)

"
835380631,835,IGBC,2021-05-08T14:16:06Z,"![image](https://user-images.githubusercontent.com/8123843/117542352-2912df00-b010-11eb-98ce-f8b486a6201b.png)
BTW reposting the latest results cos the Devs are lurking

Over 2000 responses in less than 24h. 50% of people don't want tracking. About 91% of people don't want Google tracking."
835381580,835,asdf8dfafjk,2021-05-08T14:19:10Z,"It might help the authors to ignore the shitstorm by drawing an analogy with teh following tweet. 

https://twitter.com/bgolus/status/1080213166116597760 

Point is some linux people are perenially outraged and the one's clamoring about forks are also the ones with EXACTLY 0 PRs.

I do hope that you make the telemetry non-intrusive, only for essential use cases and mandatory so that correct data is collected. Please ignore the FUD-stricken sheeple."
835382110,835,IGBC,2021-05-08T14:20:58Z,"> > > Disabled by default, a user must manually and without nagging explicitly opt-in to telemetry themselves.
> > 
> > 
> > Yes it is opt-out by default.
> 
> This is misleading.
> The current pop-up has the ""yes"" more prominently than the ""no"".
> 
> ![image](https://user-images.githubusercontent.com/1334853/117542218-a25e0200-b00f-11eb-8712-88ffc25fae8a.png)
> 
> This is a GDPR violation. And makes it look as the ""yes"" should be default and preferred.
> Please change that.
> 
> Also there is some oddity with https://github.com/audacity/audacity/pull/835/files#r628437539 where while the tracking preference is set to false at the start, later on the fallback value is true.

@falkTX also forgot to mention as has been repeated ad-infanitum throughout this PR ""anonymous"" is a misleading statement. It is not accepted that Googles session UUID's are anonymous and it is known that these cookies can be correlated with other data points in googles database to ""de-anonymise"" the user and determine who it is exactly. Sometimes the cookie and IP is enough for this process, for example if the user is using any google service from the same computer at the same time."
835382819,835,falkTX,2021-05-08T14:23:30Z,"> Point is some linux people are perenially outraged and the one's clamoring about forks are also the ones with EXACTLY 0 PRs.

Now into personal / group attacks here?

Please, stop this nonsense. Just because some of us have 0 PRs in audacity does not mean we do not matter or should not have a say in the matter.
As a developer, I take as personally responsibility to lead by example.
Common folks do not completely understand the implications of analytics and tracking. If they see some developers being okay with it, they will just trust it and go along with it as well.
What a terrible example we give to these people.

Also, just because some of us have not directly contributed to Audacity, doesn't mean we are not involved.
Some people here maintain the backends Audacity ends up talking to, to be more specific, JACK.

What an awful statement to make...

"
835383332,835,IGBC,2021-05-08T14:25:15Z,"> It might help the authors to ignore the shitstorm by drawing an analogy with teh following tweet.

@asdf8dfafjk I really don't know why you're on the side of pro-tracking. I checked, your're not shown to have ever contributed to Audacity on your profile. What do you stand to gain from having yet another program listening to your activity? I mean maybe you believe this is going to help move development forward, but in the lengthy and heated discussion over the last 2 days I think it has been over stated by developers of various projects that the benefits of tracking is dubious at best.

So I have to ask, what's your angle here?"
835384298,835,snoozysoft,2021-05-08T14:28:28Z,">
> Point is some linux people are perenially outraged and the one's clamoring about forks are also the ones with EXACTLY 0 PRs.
> 
> I do hope that you make the telemetry non-intrusive, only for essential use cases and mandatory so that correct data is >collected. Please ignore the FUD-stricken sheeple.
>

Hi, I'm someone who uses Windows as their main OS and doesn't do any coding of any kind. A while back it turns out that I've had to make a GitHub account just for the sake of reporting bugs, problems or even adding in my own two cents to crap like this PR purely because it actively affects me, the end user. As the person who is using the app, I feel I have a right to kick up a fuss when something that is overtly shitty and bad is trying to get into the application I use at least once every week. 

Stop making broad sweeping generalizations and stop trying to shut down everybody's right to speak out against things. Part of the beauty of community run and developed software like Audacity is that people like us (in theory) get a say in what does or doesn't get added to the program. "
835384880,835,zearp,2021-05-08T14:30:21Z,"With over 3000 thumbs down it is clear what people think about this. It's an audio editor, it shouldn't make any network connections at all. Let alone track users, specially when the tracking is done with parties like Google and Yandex. I don't care if it's opt-in or opt-out, tracking users doesn't belong in an open source audio editor."
835385336,835,Mazianni,2021-05-08T14:31:57Z,"Hello, I am also an end user on Windows.

I don't want any telemetry, thank you!

>It might help the authors to ignore the shitstorm by drawing an analogy with teh following tweet.

>https://twitter.com/bgolus/status/1080213166116597760

>Point is some linux people are perenially outraged and the one's clamoring about forks are also the ones with EXACTLY 0 PRs.

>I do hope that you make the telemetry non-intrusive, only for essential use cases and mandatory so that correct data is >collected. Please ignore the FUD-stricken sheeple.

What a terrible way to dismiss an entire segment of community by comparing apples to oranges. Audacity is FOSS for audio manipulation, not a game that more or less failed to meet it's own goals.

I suggest you learn the difference, otherwise I'd be seriously concerned about your contributions."
835385375,835,IGBC,2021-05-08T14:32:06Z,"> t's an audio editor, it shouldn't make any network connections at all.

Second"
835385777,835,snoozysoft,2021-05-08T14:33:30Z,"> 
> Hi, I'm someone who uses Windows as their main OS
>

Also, just getting this in now before some smartarse tries to make a strawman over it AGAIN: yes, I'm using Windows and yes, it is indeed Windows 10. However, when I installed the OS, I took an extra hour to remove 90% of the crap that it comes with and disabled pretty much all of the telemetry and extraneous bullshit in it. Me using Windows does not make my argument against this PR any less valid, nor does the fact that I don't write code."
835387023,835,vaaas,2021-05-08T14:37:30Z,"Privacy is a universal human right, so if you don't respect it, there's no reason to respect you. You broke ""etiquette"" the moment you tried turning a FOSS project into a spyware delivery platform for a russian panopticon."
835388078,835,sam-ka,2021-05-08T14:40:52Z,"> mandatory so that correct data is collected.

@asdf8dfafjk I don't think Muse acquired Audacity only to purposefully destroy its userbase. Muse is not in the position to force anyone to do anything. If they want to retain their userbase and avoid another LibreOffice/OpenOffice situation, they have no choice but to respect their users wishes by honoring the preferences. 

Also, please don't use personal insults as a way to voice your disagreement."
835388812,835,charims,2021-05-08T14:43:18Z,How is telemetry looking on this PR? Seems a lot of people have given very useful feedback. 
835389784,835,IGBC,2021-05-08T14:46:24Z,"I have collected statistics which show a large number of people don't want statistics collected. Of course opponents to this view who are pro data collection seek to discredit my poll by claiming that data collection is biased and provides an incomplete view, so cannot be trusted for making a decisions about data collection. https://www.strawpoll.me/45241130/r"
835400394,835,eylles,2021-05-08T15:20:42Z,"Here's an easy way the audacity fork can get a quick development the original lacks, upstream the patches from every distro, that will even make it easier for the fork's adoption."
835401083,835,IGBC,2021-05-08T15:22:58Z,"TBH regardless of the outcome of this PR I am tempted to contribute to the dependency de-vendoring of any fork that emerges, so I can get some bug fixes on Arch."
835407005,835,brandonhs,2021-05-08T15:43:27Z,"As a developer, I can understand the want to add telemetry. This does not change the fact that the public has obviously spoken. Listen to them. _They_ are your users. I personally believe that adding things like telemetry in this form is a gateway to more data. The fact that they are using google makes this far worse.

Adding a custom _networking_ library to an _offline_ audio editor has got to raise some eyebrows, including mine. Take a step back, and listen to these comments. Simply put, you would lose a large portion of your users, including myself.

To those who are pro telemtry, I can once again understand why it seems like this will be a good change. As I said previously, this can be a gateway into more data collection. A counter argument to this is that _we already live in a world which collects our data, what would one more app do?_ As a user of audacity, I can say **I simply don't want an audio editor I use in my free time as a hobby, to have data on me in any way**. Especially if it is sent to google.

Please take a step back and reconsider this PR."
835423668,835,ghost,2021-05-08T16:39:28Z,"### PUBLIC APPEAL
**of NGO
«Ukrainian Liberation»**

**_Dear representatives of:
• Free Software Foundation;
• «Muse Group» company;
• Community of the «Audacity» project;
• Free Software Community;
• other concerned communities and organizations!_**

---
Our NGO is deeply concerned by the implementation of telemetry in the code of free audio software «Audacity». In our opinion, such actions not only restricts anyone’s natural right to liberty, but it also threatens to split the «Audacity»’s Community.
At the beginning of May of this year, several international media reported that free and open-source audio software «Audacity» was bought by the «Muse Group» company on April 25th, 2021. [Here](https://www.prosoundnetwork.com/business/audacity-acquired-by-muse-group) is one of the articles as an example.

Around the same time, the following [post](https://github.com/audacity/audacity/pull/835) appeared on «GitHub». The post was made by a user [crsib](https://github.com/crsib), who, judging by the context, is a representative of the «Muse Group» company, aka new owners of the «Audacity». In this post, Mr. @crsib (or according to the information from the personal profile on «GitHub», Dmitrii Viedienko, from Saint-Petersburg, Russian Federation), is justifying the implementation of telemetry.

Specialists from the PR department of the NGO «Ukrainian Liberation» analyzed the text of the post and found not only contradictions but also signs of manipulation, which, according to our NGO, were included. Below you can find the results of our analysis of the crsib's post, which we received tonight from our PR specialists:

> «0) “Telemetry is **strictly optional and disabled by default**. No data is shared **unless you choose to opt-in and enable telemetry**”, but at the same time, “It is difficult for us to estimate the size of the user base accurately” which raises the question: if the telemetry is disabled by default, how is it supposed to help estimate the size of the user base if most of the user base will never enable it?
> 1) “We do not incorporate cross-site tracking, limiting the ability to **identify the user by both Google and Yandex**”, but the next thing we read is:
> • „Yandex would only **receive the ‘application opened’** event to help us estimate the size of the user base“;
> • „Google would only receive:
> 		a. Session start and end events;
> 		b. Errors for debugging;
> 		c. File formats used for import and export;
> 		d. OS and Audacity versions;
> 		e. Use of effects, generators, and analysis tools **to prioritize future improvements**“.
> — which makes us think: what is this collection of information, if not an attempt to identify the user's machine (that is, the user himself)? Specifically, we are concerned about point ""e"", where the alleged informational text is trying to explain the situation. The form of an information message _excludes_ such verbal constructions by definition.
> 2) „We will **consider replacing Google and Yandex** with another service if we find one that fulfills our requirements - **thanks for the suggestions and keep them coming**“. In our subjective opinion, this message is intended primarily to convince the general public that telemetry is the only acceptable way to gather information (same can be seen in the next paragraph, which we will come to). „Audacity“ like any other free software, has a powerful Community, that submits dozens, hundreds, or maybe even thousands (due to the popularity of the program) of bug reports on „GitHub“, thematical forums, and other similar platforms. Manipulation, which, in our subjective opinion, the new owners used, questions the effectiveness of this method of communication at the level ""developer-user"", which in all previous years has been effective and efficient, leading to the conclusion, that individual and/or legal entities responsible for the development of „Audacity“ do not trust users, their bug reports, and prefer to collect information on their own by means that are completely unacceptable both from the point of view of the community of FSF and from the standpoint of common sense. The last sentence, in bold, is, in our opinion, an attempt to please the Community (thank you, you're doing great, we value your opinion, - but then, again, it's unclear why they picked „Yandex“ and „Google“ with no prior discussion with, you know, the Community).
> 3) „Audacity is widely used across several platforms, but **we have no information on the application stability**“ — going back to what was said above, how about numerous bug reports and other similar feedback accumulated during the entire existence of the program?.. In our subjective opinion, here it’s the same as in the previous paragraph: it seems that the Community is not trusted, all user messages about errors and crashes of the program are not seen as a sufficient source for developers.
> 4) „We **need a way to make informed decisions about which OS versions to support**. For example, **can we raise the minimum version of the macOS to 10.10 to update the wxWidgets to the latest version?**“ — again, in our subjective opinion, manipulation (same as in paragraphs 2 and 3: we have forums, Community, reports, and messages about bugs).
> 5) „We have a **known issue** with the new file format introduced in Audacity 3.0. We found it **with the great help of the community members on our forum. However, there is no way for us to estimate the impact of these issues on users. Is it just a random case? Do we need to rush the work on the recovery tool or help the users one by one? Or do we need to rethink the file format to make it safer and more easily recoverable?**“ — here the author of the initial post not only promotes the ultimate need for telemetry but also admits his (or somebody else’s) incompetence as a programmer. In other words, we believe that in this message the author or authors of the initial post admit that they do not understand how to correct the error mentioned in the post, and therefore, as they say, they introduce telemetry».

It is important to note, that specialists from the PR department of the NGO «Ukrainian Liberation» do not claim their conclusions to be the only possible truth. They should be perceived taking into account that every person (or group of people united by one idea, like our NGO, for example) are entitled to their own opinion, even if it is not correct.

But let’s go back to the initial issue.

[«Muse Group»](https://www.musegrp.com/) is a company that has representatives in Hong Kong, Shanghai, and Sydney, Australia.

You can also contact them via messengers, which are far from the free software (""wechat"" and ""weibo"").

The author of the initial post on «GitHub» under the nickname crsib is from Russian Federation, the «Muse Group» company is (as we might guess) from China. In our opinion, both of these countries can hardly be called completely free and democratic. We are doing our best to leave the political and territorial aspects out of this conversation, but here we are forced to dwell on this point. We sincerely apologize to the Community for emphasizing this, but we believe that without a full and comprehensive understanding of the situation, it will be hard to understand the conclusion that we came to. Moreover, [«Wikipedia» agrees with us. In turn, it refers to authoritative sources and their studies from different years, such as this one from the «Freedom House»](https://en.wikipedia.org/wiki/Freedom_in_the_World). In our opinion, this partly explains the use of non-free platforms «Yandex» (Russia) and «Google» to collect the data, as well as why there has been no previous discussion with the Community.

(By the way, we still are not fully sure, how (and from whom) the abovementioned «Muse Group» **bought a free and open project «Audacity»**. We are asking the representatives to provide an explanation regarding this issue. This letter should also be considered as a request for relevant public information from the «Muse Group» company: **how and from whom is it possible to purchase a free and open project?**)

All the above cannot help but cause significant concern about the future of «Audacity» - an audio editor that we all know, love, and actively use.

Without resorting to any subjective analysis, we ask members of the Community to pay attention to the history of activity of the user crsib on the «GitHub». We deliberately do not draw any conclusions.

This situation with the «Audacity» brought another split in the community, all this despite the still-fresh memory of «The Code of Conduct» among Linux kernel developers, and, as we see it, bullying of RMS and FSF, which, in general, causes new conflicts in our Community (NGO «Ukrainian Liberation» considers itself a part of the Community, because we fully share its values and spread them at our home country, Ukraine, as much as we are allowed to by current social, political, economic and other circumstances).

NGO «Ukrainian Liberation» also expresses its deep concern at the reaction of individual users to this situation. Everywhere we see proposals to create a fork of «Audacity» based on the latest available version, free from telemetry. We believe that this measure is acceptable, but it is extreme (when all other solutions failed). It will inevitably deepen the division in the Community, as such an approach has both active supporters and opponents. Unfortunately, people often forget that the Idea is more important than people and their personal opinions. We are convinced that the fork at this stage will lead to two parallel programs - free and imbued with telemetry - and then the «Audacity» Community will simply split in two, three, and so on. NGO «Ukrainian Liberation» believes that this is what supporters of non-free components in the software want. This will significantly weaken us.
In our opinion, we still have a chance to save our favorite program. With this goal, we introduce the hashtag #saveaudacity. We would like to ask those who agree with our position and our concerns to spread the information about the situation with the «Audacity» by using this (or any others, at the discretion of the Community) hashtag. As an NGO, we see our main current task in spreading awareness and objective information that, unfortunately, is relevant to the «Audacity» audio editor.

We call on the Community to understand our concerns and to help us. FSF Community has always been strong in unity, but today we are divided over political, gender, racial, and all sorts of other stereotypes that do not apply and are not even related to the Free Software. Some individuals believe that their opinion is more important than the Idea of Freedom and Unity of Community. With all due respect, we find this position destructive.

We ask the Community for help also because we do not have programmers among our volunteers, and we cannot conduct an audit of the «Audacity» code for backdoors and vulnerabilities included (or not included).

**Please, help.**

-----
_The entire text of this Appeal is a purely subjective opinion about the situation from representatives of NGO «Ukrainian Liberation». This text does not claim to be an undeniable truth and objectivity. We deliberately do not draw any conclusions, leaving this prerogative to the Community. Without blaming anyone, we present our vision of a situation that might differ (and might be different) from objective reality.

With this letter, we ask FSF to assess the situation with «Audacity» and, if there is such legal possibility, start integrating NGO «Ukrainian Liberation» into the FSF as an associate member or any other form that will allow us to interact and fight together against modern challenges. We understood [the call](https://framatube.org/videos/watch/be21cdc4-5783-4c20-8f3f-49eb3d7aa91d) of RMS perfectly and we strive to be useful. Only together we can stand and fight against those who bring evil and discord. We are open to a conversation:  ukrliberation@mail2tor.com. We will view letters in English, Ukrainian, Russian, and Belarusian._

**_With sincere respect
and with apologies
for excessive emotionality —_**

_**Bohdan Kovalchuk,
Chairman (№0) of the NGO «Ukrainian Liberation»,
as well as the entire team of this NGO.**_

-----
**Original PDF file with a signature and a stamp of NGO ""Ukrainian Liberation"" [is available on our website](https://ukrliberation.org.ua/docs/0-21.pdf).**

**Translated from Ukrainian by [Dara Sereda.](seredache2000@tutanota.com)**

-----
### CAUTION!!!
**We were extremely mistaken with tagging the wrong ""Muse Group"" (thanks to POLYJITTER and others it had been noticed). I would like to also note, that words about location in China were not meant to hurt or upset anyone, as they had no intent to  spread racial stereotypes. We were trying to make a comment about the non-free policies that the country leads. 
We won't change the initial text, as we fully acknowledge our mistake. Thank you, attentive readers, who were able to catch inaccuracies in the text and help us fix them! 
**We think that this is an awesome example of how the Community can work together!**
Here is the correct link to the [correct MUSE group](https://mu.se/).
The ""Muse Group"" situated in China, Hong Kong and also Syndey, Australia, — please accept our sincere apologies. That was 100% our mistake. That happens when emotions of people got the best of us. We are terribly messed up with a couple of Muse Groups.
Sorry everyone, who feel harmed with the previous post.**
### Please, ignore all written about ""Muse Group"" from China — the innocent one."
835426487,835,BitesizedLion,2021-05-08T16:48:52Z,"@ngo-ukrainian-liberation Is this a known organization? I've never heard of you before, just seems like you want to slither your way into the FSF?"
835427426,835,orenwatson,2021-05-08T16:51:57Z,"> 
> 
> @ngo-ukrainian-liberation Is this a known organization? I've never heard of you before, just seems like you want to slither your way into the FSF?

They have a youtube channel active since 2017."
835427934,835,BitesizedLion,2021-05-08T16:53:46Z,"> > @ngo-ukrainian-liberation Is this a known organization? I've never heard of you before, just seems like you want to slither your way into the FSF?
> 
> They have a youtube channel active since 2017.

Doesn't really mean much."
835428380,835,ghost,2021-05-08T16:55:36Z,"> > @ngo-ukrainian-liberation Is this a known organization? I've never heard of you before, just seems like you want to slither your way into the FSF?
> 
> They have a youtube channel active since 2017.

We are done with ""YouTube"" now, just like any other proprietary platform. And (we hope) that's our so-called ""contribution"" to the GitHub, which now belongs to Microsoft®©™. :-)"
835438250,835,polyjitter,2021-05-08T17:28:13Z,"> The author of the initial post on «GitHub» under the nickname crsib is from Russian Federation, the «Muse Group» company is (as we might guess) from China. In our opinion, both of these countries can hardly be called completely free and democratic. We are doing our best to leave the political and territorial aspects out of this conversation, but here we are forced to dwell on this point. We sincerely apologize to the Community for emphasizing this, but we believe that without a full and comprehensive understanding of the situation, it will be hard to understand the conclusion that we came to.

@ngo-ukrainian-liberation No, they're just a corporation, and corporations are known to have unethical interests in the pursuit of profit. People's nationalities don't dictate their value or worthiness. You're xenophobic and racist. Stay focused"
835439497,835,ghost,2021-05-08T17:32:00Z,@ngo-ukrainian-liberation https://www.musegrp.com/ is not the Muse Group that acquired Audacity - it's https://mu.se/
835442360,835,polyjitter,2021-05-08T17:40:15Z,"> @ngo-ukrainian-liberation https://www.musegrp.com/ is not the Muse Group that acquired Audacity - it's https://mu.se/

Indeed - and it appears the correct Muse Group is in Limassol, Cyprus:

https://www.linkedin.com/company/muse/

Hardly any worthwhile information for inflammatory personal smearing.

All I'm saying is the argument that nationality = how bad or good someone is, kinda doesn't hold very much weight when you can't even research your hate correctly..."
835443870,835,collinalexbell,2021-05-08T17:44:03Z,"Since this is making network connections now, will I be able to order pizza with just a voice recording?"
835445481,835,snarfblam,2021-05-08T17:48:17Z,"> 
> 
> > It's not opt-in if the default is on.
> > https://github.com/audacity/audacity/pull/835/files#diff-38452b2ab9b100d5046eb855410add20e6158dbc69533301bfc15f6d0913d3efR93-R94
> 
> That's not correct. You are misreading the code. It is opt out by default. Telemetry is only enabled if you explicitly opt in.
> If you don't believe me, please test it yourself.

Read the code again.

`S.Id (wxID_YES).AddButton (acceptButtonTitle)->SetDefault ();`

The default button in the UI is opt-in. You could be forgiven for not even noticing the other button; it is so inconspicuous. This is what everyone is referring to as a ""dark pattern"" and a GDPR violation. If you simply hit enter or the space bar, or click the only button that jumps out at you, you unwittingly opt in. You can't use any software or any websites any more without getting hit at least once and probably repeatedly with a nagging pop-up asking you to subscribe, agree, register, enable a ""feature"", etc. etc. etc. It's beyond tiresome. I can't even tell you how many websites I've set up cosmetic filtering rules and custom styles on to wholly disable this kind of functionality. We all do the same thing: get rid of the nag as fast as possible with as little thought as possible, because ultimately our attention and productivity does have a budget. 

While I'm on a rant, I might was well pile this on. For them to so quickly try to slide something in under the radar that's not at all innocuous or consistent with preceding philosophy, and to only present community-oriented messaging after being called out in a very public way, is beyond a red flag. It speaks volumes about how they intend to operate and how they conceptualize the users. It tells us they intend to get away with whatever they can. That damage is already done. Even doing a 180 now doesn't change that.

I am *wholly* against any kind of telemetry. Not only is its usefulness dubious, but I consider that to be beside the point. I don't want to be surveilled. I don't want data about me to be collected, compiled, tracked and analyzed. Not by a person, not by a machine. Not personally, not pseudonymous, not anonymously. Not for profit-oriented reasons, and not for ostensibly constructive reasons. That's not why I downloaded the software. It's not something I'm volunteering to do. It's not something I will ever offer any kind of honest, genuine consent to.

I don't necessarily think telemetry is a thing that shouldn't exist at all. I think it should be a separate software component that has to be added and enabled affirmatively by a user. Approach it that way and find out how much value the users really find in telemetry. "
835448514,835,yonderbread,2021-05-08T17:55:34Z,"> Since this is making network connections now, will I be able to order pizza with just a voice recording?

At least that would be kinda helpful."
835448756,835,collinalexbell,2021-05-08T17:56:09Z,"The comments on the PR is a hormesis response. It is a dose dependent over reaction to software tracking. Non one complains about tracking in VS Code, because it already had it. Add a little bit of tracking to a well known standalone open source desktop app and bam, here comes the ""overeaction"" meant to inoculate the system (open source software as a whole) to worse intrusions. 

These comments, while they may seem like an overreaction to some, are a REALLY good thing for the community and I hope that the moderates who are OK with some telemetry can see why this discussion, in this format, with this intensity, is important."
835449358,835,falkTX,2021-05-08T17:57:39Z,"> Non one complains about tracking in VS Code, because it already had it

What a bunch of crap.
All the people that made https://github.com/VSCodium/vscodium/ would like a word.
"
835449766,835,StarWitch,2021-05-08T17:58:35Z,"@kuberlog Actually, the fact that VSCode is Chromium-based and has tons of telemetry built into it is part of the reason why I still use `vim`. 

@falkTX Thanks for pointing out that fork! I'm gonna try it out."
835450855,835,ghost,2021-05-08T18:01:17Z,@polyjitter **THANK YOU!!!** It's been corrected above. ;-)
835451639,835,ghost,2021-05-08T18:03:11Z,"### CAUTION!!!
We were extremely mistaken with tagging the wrong ""Muse Group"" (thanks to POLYJITTER and others it had been noticed). I would like to also note, that words about location in China were not meant to hurt or upset anyone, as they had no intent to  spread racial stereotypes. We were trying to make a comment about the non-free policies that the country leads. 
We won't change the initial text, as we fully acknowledge our mistake. Thank you, attentive readers, who were able to catch inaccuracies in the text and help us fix them! 
**We think that this is an awesome example of how the Community can work together!**
Here is the correct link to the [correct MUSE group](https://mu.se/)."
835451767,835,ghost,2021-05-08T18:03:30Z,"> The comments on the PR is a hormesis response. It is a dose dependent over reaction to software tracking. Non one complains about tracking in VS Code, because it already had it. Add a little bit of tracking to a well known standalone open source desktop app and bam, here comes the ""overeaction"" meant to inoculate the system (open source software as a whole) to worse intrusions.
> 
> These comments, while they may seem like an overreaction to some, are a REALLY good thing for the community and I hope that the moderates who are OK with some telemetry can see why this discussion, in this format, with this intensity, is important.

@kuberlog Only the **closed-source** version of VSCode (i.e. the one you download from Microsoft) has tracking. If you compile it from source, it's free of it."
835451806,835,brandonhs,2021-05-08T18:03:37Z,"> The comments on the PR is a hormesis response. It is a dose dependent over reaction to software tracking. Non one complains about tracking in VS Code, because it already had it. Add a little bit of tracking to a well known standalone open source desktop app and bam, here comes the ""overeaction"" meant to inoculate the system (open source software as a whole) to worse intrusions. 
> 
> 
> 
> These comments, while they may seem like an overreaction to some, are a REALLY good thing for the community and I hope that the moderates who are OK with some telemetry can see why this discussion, in this format, with this intensity, is important.

@kuberlog I understand your point, but the fact is vscode already had it. As someone said, vscode uses chromium which is well known to use telemetry and collect user data by default. That is once again known and documented to be a part of the vscode model. This differs from audacity, which for the 20+ years it had been around, has never even had networking."
835452447,835,orenwatson,2021-05-08T18:05:26Z,"Is museCY Holding LTD. a nonprofit, and if so, where is it registered as one?"
835454933,835,ghost,2021-05-08T18:11:30Z,"### The ""Muse Group"" situated in China, Hong Kong and also Syndey, Australia, — please accept our sincere apologies. That was 100% our mistake. That happens when emotions of people got the best of us. We are terribly messed up with a couple of Muse Groups.
Sorry everyone, who feel harmed with the previous post.
Please, ignore all written about ""Muse Group"" from China — the innocent one."
835456903,835,orenwatson,2021-05-08T18:16:40Z,"It seems that MuseCY Holding LTD is a for-profit corporation. Does Muse own the trademark ""Audacity"" or any other intellectual property related thereto?"
835457298,835,Be-ing,2021-05-08T18:17:39Z,"> Also, just because some of us have not directly contributed to Audacity, doesn't mean we are not involved.
Some people here maintain the backends Audacity ends up talking to, to be more specific, JACK.

Likewise, I have contributed to several parts of the infrastructure that Audacity depends on, sometimes working directly with Audacity users to fix bugs affecting us both:
  * [PipeWire](https://gitlab.freedesktop.org/pipewire/pipewire/-/issues/788)
  * [PortAudio](https://github.com/PortAudio/portaudio/pull/504)
  * [libsndfile](https://github.com/libsndfile/libsndfile/issues/470)

So just because I don't have any commits in the Audacity code repository does not mean I have not contributed anything to Audacity before.

Ironically, the Audacity developers' bad habit of forking dependencies [created an obstacle to getting one of those bug fixes out to users](https://bugzilla.redhat.com/show_bug.cgi?id=1939749#c6)."
835460254,835,alexonelifer,2021-05-08T18:25:51Z,"Hello there!
The initial post by Ukrainian Liberation was deleted and the account was banned, so some people might not see the changes that were added. 
Here they are:
### CAUTION!!!
We were extremely mistaken with tagging the wrong ""Muse Group"" (thanks to POLYJITTER and others it had been noticed). I would like to also note, that words about location in China were not meant to hurt or upset anyone, as they had no intent to spread racial stereotypes. We were trying to make a comment about the non-free policies that the country leads.
We won't change the initial text, as we fully acknowledge our mistake. Thank you, attentive readers, who were able to catch inaccuracies in the text and help us fix them!
We think that this is an awesome example of how the Community can work together!
Here is the correct link to the correct MUSE group.
The ""Muse Group"" situated in China, Hong Kong and also Syndey, Australia, — please accept our sincere apologies. That was 100% our mistake. That happens when emotions of people got the best of us. We are terribly messed up with a couple of Muse Groups.
Sorry everyone, who feel harmed with the previous post.
Please, ignore all written about ""Muse Group"" from China — the innocent one."
835461095,835,Sciss,2021-05-08T18:28:09Z,"Please stay focused, don't feed oder replicate trolls, refrain from all-caps or all-bold, avoid ad hominems, ableist slurs etc."
835461679,835,alexonelifer,2021-05-08T18:29:38Z,"> Please stay focused, don't feed oder replicate trolls, refrain from all-caps or all-bold, avoid ad hominems, ableist slurs etc.

Thank you, corrected)
"
835471049,835,orenwatson,2021-05-08T18:54:30Z,"Did the person ""Aaron Spike"" who created the Audacity Logo, assign the copyright to it to Tony Berman of  Berman Entertainment and Technology Law? There is a trademark registration for the Audacity Logo under that name.

What is the connection between Tony Berman and MuseCY Holding LTD.?"
835474591,835,an3k,2021-05-08T19:04:10Z,"If you want telemetry ... don't use Google or Facebook or Apple or Microsoft or Yandex (WTF?) or similar.

You can do a one-time check at the first start after a fresh installation or update to gather the information you want after the user allows it. You can write that code yourself.

I wonder how people before that telemetry non-sense knew what work to prioritise, what OS version to drop and so on ..."
835484246,835,SteveDaulton,2021-05-08T19:34:21Z,"> Did the person ""Aaron Spike"" who created the Audacity Logo, assign the copyright to it to Tony Berman of Berman Entertainment and Technology Law? There is a trademark registration for the Audacity Logo under that name.

Firstly, this has nothing to do with this pull request. It is not a code review in any shape or form, is unrelated to this pull request and does not belong here on GitHub.

Secondly, the current version of the Audacity logo was not created by Aaron Spike, it was created by me, using Gimp, and I have  the original Gimp files to prove it.

Thirdly, yes, Audacity has permission to use the logo that I created, just  as Audacity had permission to use the older logo on which it was based, and the even older version on which that was based."
835485487,835,orenwatson,2021-05-08T19:39:10Z,"> is unrelated to this pull request

I would say that this inquiry is related to the pull request, since this pull request may result in a fork, and the legal issues regarding using the original Audacity logo in said fork."
835489633,835,jacobthehammer,2021-05-08T19:53:41Z,"It has all been said already, but I feel that an additional voice in opposition to this PR may help somewhat. I've been using Audacity since elementary school in 2005. It's been installed on any system where I've needed to record audio. It would be trivial for me or anyone else to switch to a fork that doesn't include telemetry. I use Pale Moon and VSCodium for that explicit reason. It's true that most people won't care. Chrome is still the dominant browser after all. But enough people clearly do care that I hope this PR gets closed soon, rather than merged. If it is merged it will take me three package manager commands to switch to something else and never look back. "
835489871,835,ghost,2021-05-08T19:54:24Z,"Since the CMake option to enable telemetry is opt-in (disabled by default), removing telemetry from Audacity is as simple as building it without including any telemetry-related options.

In case the Audacity team merges this PR, I made a repository that will automatically build the app without telemetry (work in progress): https://github.com/SpheeresX/audacity-notrack"
835493256,835,AndreiSva,2021-05-08T20:05:24Z,"> Since the CMake option to enable telemetry is opt-in (disabled by default), removing telemetry from Audacity is as simple as building it without including any telemetry-related options.
> 
> In case the Audacity team merges this PR, I made a repository that will automatically build the app without telemetry (work in progress): https://github.com/SpheeresX/audacity-notrack

That is actually an argument against this PR. The vast majority of Linux distributions will compile audacity with the option disabled therefore missing the point of having telemetry in the first place."
835494887,835,Isolator70,2021-05-08T20:10:26Z,Basically I think optional (opt in) telemetry to improve Audacity is OK. But why the hell with this Google crap? It is exactly the opposite the FLOSS community want to have.
835496535,835,ghost,2021-05-08T20:16:09Z,"> That is actually an argument against this PR. The vast majority of Linux distributions will compile audacity with the option disabled therefore missing the point of having telemetry in the first place.

Windows (and MacOS?) users download the build (with telemetry built-in) from Audacity's website, and these operating systems hold the majority of the OS market share."
835506183,835,Be-ing,2021-05-08T20:46:05Z,"I have a suggestion for a more respectful approach to telemetry. Instead of doing this blanket telemetry on Audacity users minus those who are using Linux distribution packages, do limited scope remote usability tests on people who explicitly want to contribute to Audacity. For example [read in Tantacrul voice]:

> We're trying to declutter the main toolbar. We think it probably has too many magnifying glasses, but we don't know which ones people use frequently. We won't remove any of the features there, but we are considering moving them to a menu or another part of the user interface so they don't distract you from features that are used frequently. 
> We want your help to figure out which magnifying glasses people actually do use. All you have to do to participate is download these builds and use Audacity as you normally do. When you close these builds of Audacity, it will send us data about which magnifying glasses you clicked. We plan to collect this data over the next two weeks, then we will open a forum thread/GitHub issue/whatever discussion medium to discuss how to interpret it and how we could improve the design of Audacity. If you want to stop participating in this experiment at any time, you can go to Edit -> Preferences -> Telemetry and disable the data collection. Alternatively, you can uninstall the build and reinstall the official release build from https://www.audacityteam.org/download/ The builds are signed with the GPG key available here [link to public key].
> This data is sent encrypted over SSL to our server at https://telemetry.audacityteam.org/ where you can see the aggregated, anonymous data and download a copy in the machine-readable CSV/JSON/whatever format so you can do your own analyses. No IP addresses nor any kind of personally identifiable information are included in the recorded data. The source code for these builds is available at [link to Git branch in code repository] and the code running on the telemetry server is available at [link].

If you take this approach, I think you could actually get Linux users to enthusiastically participate. If you start by doing your best to respect users' consent and privacy, I think you could get much more useful data and use it to improve Audacity."
835507125,835,nico-abram,2021-05-08T20:48:34Z,"> 
> 
> > Did the person ""Aaron Spike"" who created the Audacity Logo, assign the copyright to it to Tony Berman of Berman Entertainment and Technology Law? There is a trademark registration for the Audacity Logo under that name.
> 
> Firstly, this has nothing to do with this pull request. It is not a code review in any shape or form, is unrelated to this pull request and does not belong here on GitHub.
> 
> Secondly, the current version of the Audacity logo was not created by Aaron Spike, it was created by me, using Gimp, and I have the original Gimp files to prove it.
> 
> Thirdly, yes, Audacity has permission to use the logo that I created, just as Audacity had permission to use the older logo on which it was based, and the even older version on which that was based.

Is ""permission to use the logo"" the same as ""permission to trademark the logo""?"
835513964,835,SndChaser,2021-05-08T21:06:22Z,"# Data Collection vs Telemetry in Audacity

Audacity PR #835 is a mess on many levels. Problems that exist with this PR are
stated reasons for implementing telemetry:

- Lack of stability information.
- Unknown userbase size.
- Development and support decisions.
- Resolving a known issue with unknown impact on users.

In addition, the stated information that will be gathered via a telemetry
interface are stated as:

- Application open information (Yandex)
- Session start / end events (Google)
- Debug information / errors (Google)
- File format information (Google)
- Operating System Version (Google)
- Audacity version (Google)
- Other tools used by the user (Google)
- IP Address (Google & Yandex)

The vast majority of this information, however does not need to be gathered
using telemetry, and in fact, using telemetry would likely lead  to mis-leading
information or a lot of unusable information being gathered that would not
assist the development process.

Before going into the reasons telemetry is not appropriate for addressing the
majority of this information, consideration should be given to how telemetry is
generally used in large open source projects.

## Telemetry in Open Source

There are projects that use Telemetry.  However, in many cases the
implementation of Telemetry is well documented, and frequently goes through an
exhaustive approval process before being implemented.

The following provides an overview of telemetry handling in several open source
projects.

### Case: The Linux Foundation

**The Linux Foundation** introduced their [Telemetry data collection and usage
policy](https://www.linuxfoundation.org/telemetry-data-policy/) in October 
of 2019.  The policy makes it clear that there are many items that need to be
considered before implementations are approved.  These considerations include
(but are not limited to):

1. Individual data privacy: does the data track or identify the user? If it
   doesn't could it still include personal information that is subject to laws
   and regulations?

2. Data confidentiality: does the data result in any business-sensitive
   information being sent to the project, or a third party? If there was a
   consent dialog, what guarantees that the user was authorized to grant
   consent?

3. Awareness of collection: does the software guarantee that no data is gathered
   before consent has been given?  Is it opt-out or opt-in? Can the consent
   notice be bypassed?

4. Security of the collection mechanism: does the ""phone home"" mechanism itself
   open security vulnerabilities to the application? Is there still a
   vulnerability if the user does not opt-in to the data gathering?

In order to deal with all of this information, the Linux Foundation requires
member applications submit to a review by providing:

- The specific data to be collected.
- Demonstrate the data is fully anonymized, and does not contain any data about
  an end user, or information that could be sensitive.
- The manner in which users are notified of the details of the data collection,
  use and distribution. Meeting requirement of consent before information is
  gathered.
- The manner in which the information is to be stored and use by the project.
- Security mechanisms used to ensure the collection of information will no
  result in unintentional collection, or security vulnerabilities.

Following all this guidance, the information is submitted to a review panel of
The Linux Foundation's legal team for review.

### Case: KDE

The KDE project introduced telemetry into their Plasma environment approximately
a year ago.  In so doing, they developed a [Telemetry
Policy](https://community.kde.org/Policies/Telemetry_Policy) that is applied to
all applications in the KDE environment.  This is a rough summary of the policy:

- Transparency:
    - Data is shared in a way that (a) is easy to understand, (b) is precise and
      complete, (c) is locally available without network connection.
    - Any changes to the gather must be highlighted during the release
      announcement.

- Control:
    - Telemetry is **always** opt-in. It is off by default, and only enabled by
      explicit user action.
    - Telemetry settings can be changed at any time, and are prominent in the
      user interface of the application.
    - Telemetry settings are independent of any other settings, features or
      functionality.
    - Applications must honor system-wide telemetry settings.
    - Detailed documentation must be provided on the operation of the Telemetry
      settings.

- Anonymity:
    - Nothing that is considered personal information is gathered, especially
      where regulations such as the GDPR are concerned.
    - No unique devices, installation or user ID's are used.
    - Data is stripped of any unnecessary details, and downsampled appropriately
      before transmission.
    - Network operation data (such as IP Addresses) are not stored with the
      telemetry data.

- Minimalism:
    - Only gather the absolutely minimal information needed.
    - Collected data must have a clear purpose.
    - Data is downsampled to the maximum extent possible before transmission.
    - Relevant correlations between individuals bit of data should be computed
      at the source whenever possible.
    - Data collection is stopped when corresponding questions have been
      answered.

- Privacy:
    - Never transmit any user content, or hints at user content (ie, file names,
      URL's, etc.)
    - Gather only system information specific to the installation / environment
      **independent** of how the application/machine/installation is used.
    - Gather statistical usage data of an installation / application.

In order to use telemetry information in a KDE project, all of the above must be
met, and a public review is passed.  This review process is repeated for every
release if there are any changes to the information being gathered.  Received
data is regularly audited for violations of this policy. If there is a
violation, the data is deleted and collection is suspended until compliance can
be re-established.  To date, only [four KDE
applications](https://community.kde.org/Telemetry_Use) use telemetry data.

### Case: GitLab

On October 23rd of 2019 GitLab announced that they were making [changes to their
Terms of Service](https://gitlab.com/gitlab-org/gitlab/-/issues/34833) that
included the addition of JavaScript on their website that would gather
information to be used by GitLab and possibly sent to third parties.  The code
would be both open source and proprietary.

They stated that they would update their Privacy Policy to indicate what
information was being gathered, and where it was being sent.

Users of GitLab immediately took to the issue that was opened to track the
announcement and wrote a number of messages of concern about the information
that was being gathered, and the lack of control about how the information was
being used.

On October 29th, GitLab sent out a letter that explained the following:

> So, what happened? In an effort to improve our user experience, we decided to implement user behavior tracking with both first and third-party technology. Clearly, our evaluation and communication processes for rolling out a change like this were lacking and we need to improve those processes. But that’s not the main thing we did wrong.

> Our main mistake was that we did not live up to our own core value of collaboration by including our users, contributors, and customers in the strategy discussion and, for that, I am truly sorry. It shouldn’t have surprised us that you have strong feelings about opt-in/opt-out decisions, first versus third-party tracking, data protection, security, deployment flexibility and many other topics, and we should have listened first.

### Other Cases

In an earlier post I documented the policies, processes and information gathered
by Firefox, including the Glean tool the Mozilla foundation specifically created
for gathering this information.

Something that wasn't discussed as a significant point was Firefox's
transparency and user's control in terms of their telemetry gathering.  Any user
can see what information has been sent to Mozilla without having to dig through
their Telemetry Portal.  Just open ""about:telemetry"", and the last two weeks of
pings is available for users to see and verify that none of the information
being sent to Mozilla is sensitive.  Also users have a degree of control over
what information is being gathered through a series of check boxes available in
the Privacy & Security portion of the Preferences menu.

* * * 

Also contained in the comments on this PR is a discussion with one of the main
developers of Ardour, in which we discuss the information that they gather, and
the limited usefulness of this information, and the processes and decision
making that went into adding it to Ardour.

### Telemetry Conclusion

When implemented properly in large projects, there is far more consideration
given to the process and procedures needed to make certain that appropriate
safeguards are implemented to protect end user's privacy and anonymity.  Further,
the consideration for safeguarding against sensitive information being
communicated is also required. On top of this, legal and / or public review of
telemetry information being gathered is a routine process in these projects.

When the input of the community is not considered, problems such as that issues
that GitLab created for themselves do serious damage to their perception in the
community.

## Data Collection in Open Source

There is actually a long history of data collection in open source projects.
Where data collection differs from telemetry is often in the frequency and / or
the amount of detailed information that is gathered.

### OS Hardware Profiles

Ubuntu, several of the \*BSD distributions, and others have been
building hardware profile databases for years.  This is typically done as a
one-time, completely voluntary data collection performed during the Operating
System installation.

An example of this is the [NYC\*BUG
dmesgd](https://dmesgd.nycbug.org/index.cgi?do=index) which has allowed users to
upload copies of their dmesg logs into a database since 2004.  All of the
information contained in the database is anonymized, there is no personally
identifying information.

System76 and RedHat Enterprise Linux take a different approach.  They include
tools that are used only on the basis of support needs.  These tools gather
system logs, hardware profiles, detailed configuration information and system
coredumps into a single file.  This file is then attached to support requests
through a secured system.

Ubuntu has made one of the more controversial implementations of data collection
via it's Ubuntu Report tool.  It gathers system information and sends reports to
Ubuntu including: Ubuntu version, OEM/Manufacturer, Device model number, BIOS
info, CPU details, GPU details, Installed RAM, Partition Info, Display(s)
details, Auto-login status, Live Patching status, Desktop environment, Display
server, and Timezone.

While not containing direct personally identifying information, some of the
information could be sensitive in a number of environments.  The user is
prompted during installation to disable (opt-out) of the data collection, and is
allowed to preview the data before it is sent, while making the decision. The
data gathering system is a standalone package that can be completely removed
from the system in environments where having installed would be deemed an issue.

### Application Crash Reporting

Numerous systems, including Ubuntu, RedHat Enterprise Linux, and others have
features that can be enabled to allow semi-automated submission for crash
reports with debug information.  This allows targeted collection of information
which the user likely feels more comfortable in submitting the information.

Additionally, this can be used much in the same way as the System76 and RedHat
tools for generating logs and debug information that the user can submit as part
of a support request.

### Software Popularity

Ubuntu, Debian, Arch Linux, and other distributions contain a package which is
not installed or enabled by default that allow users to send information about
the applications they are using on their system.

The information is restricted to: package name, how recently it has been used,
and how recently it has been updated.  This approach keeps to the approach of
sending minimal information, devoid of personally identifying information.

Since this software is not activated unless specifically installed by the end
user or system administrator, there is a fairly high confidence that potentially
sensitive information is not being communicated.

### Data Collection Conclusion

There is a long standing tradition of data collection when it comes to the open
source world.  However, many Linux distributions have taken a stance of data
gathering on an ""as needed"" basis (with the notable exception of Ubuntu).

Systems like \*BSD's NYC\*BUG are completely voluntary, and users specifically
take the time to upload log files by their own choice.

Tools like those provided by RedHat Enterprise Linux and System76 are
specifically designed to be used in tracing problems and resolving issues.  They
are only used at  the discretion of the end user or system administrator who is
seeking support.

Popularity polling is a system that has been made available in several
distributions, however it is typically not installed by default.  Instead users
that are willing to share information about their usage habits may install and
enable this functionality.

The only notable substantial outlier (at lest that I know of) with regards to
data collection is Ubuntu, which installs a default collection system.  This
system, however, allows the user to opt-out on the first boot of their system
after installation.  It also offers the user the chance to actually see the
information that is gathered to be sent to Canonical before it is sent.

## Audacity's Telemetry Justification

This brings us back to the proclaimed need for telemtry in Audacity.  First
let's look at the reasons:

### Lack of stability information

It's difficult to see how telemetry information as proposed would be able to
affect this without gathering a lot of information about the environment in
which the user is operating their system.  The declared ""OS"" information would
certainly be more than just the OS version?  It would be necessary to know a
lot of information about the underlying hardware configuration.  Gathering such
detailed information (such as system board, cpu, firmware version, disk
configuration, ram, etc.) could be considered by many users to be sensitive
information.

A better indicator for stability issues would be to have a reporting system that
allowed users to submit reports when instability actually occurs.  This targets
the information to specific issues, instead of having an overly broad collection
of information that makes the location of this information like finding a needle
in a haystack.

### Unknown userbase size

This is probably one of the least worthwhile arguments put forward for the
addition of telemetry information. The problem with this justification is that
the implementation of telemetry collection is broken by design.

This is a feature that the user has the choice to disable by default.  That
alone guarantees a level of inaccuracy of the information being gathered.  To
make matters worse, there is the option to compile the application without
enabling telemetry at all.

In this situation the information gathered by telemetry is very likely to be
highly inaccurate.  It will never be clear which Linux distributions disable
telemetry during package builds.  It will never be clear what percentage of the
user base opt's out of the telemetry when they are offered the option.

There are much better ways to gather this information.  As noted in the
**Software Popularity** section, many Linux distributions already collect
anonymized information regarding package installation and usage.  This
information is often freely available from the distributions.

Outside of the Linux ecosystem many of the distribution points for packages
(including, I would believe) GitHub and Audacity's own websites keep download
statistics for the package.  Many of these sites also gather client platform
information during the download process.

Overall these sources of information would paint a more accurate picture than
relying on the automated gathering of information with unknown levels of
accuracy.

### Development and support decisions.

Development and support decisions that are based on potentially highly flawed
statistics from telemetry gathering (as outlined in **Unknown userbase size**)
will likely lead to bad decision making, and only serve to disenfranchise a
portion of the current user base.

Directly polling the user base is a far better way to gather information about
the direction to take for development.  Audacity has a support forum with over
150,000 users, and several mailing lists with a high number of users.  Certainly
users that are so invested in the software to take the time to sign up for a
forum, or add their email address to an email list are the users that should be
targeted for development decisions.

Other ways of gathering information could be open, public, anonymous polls
operated from Audacity's website.

### Resolving a known issue with unknown impact on users.

This is a situation where it is difficult to understand how this information
could be used in resolving an issue.  First, it is something that really
shouldn't be the basis for making a decision on whether to resolve an issue or
not.

The primary motivation for resolving an issue should be whether or not there is
a security assessment.  Any features that is not working as designed needs to be
assessed in the light of potential risk to the stability of a users system.  This
is first and foremost.  The higher the chance that a issue can be exploited by
any potential bad actor the higher the need to fix the issue.

Basing the decision to resolve an issue on the basis of user impact is the wrong
way to go about supporting an issue.  User impact should be considered to be
equal to a threat assessment when users report the issue, and document the
severity as having a significant impact on the user base.

## The Proposed Telemetry Implementation

As stated earlier, the proposed implementation of telemetry in Audacity is
highly problematic.  But the nature of the problems with the chosen path here
are much deeper.

### Inaccurate Information

As stated above, the information being gathered is very likely to be highly
inaccurate due to numerous factors.  The number of users that will opt-out of
telemetry will never be known.  The number of downloads that have been built
with the telemetry completely disabled will never be known.

Because of these fundamental flaws, the data should be considered GIGO (garbage
in, garbage out).

### Lack of Policy Information

No consideration, or research appears to have been done to develop a Privacy
Policy that can be applied to telemetry information.  Large open source projects
like **The Linux Foundation**, **KDE**, and **Firefox** have developed processes
for the approval of telemetry implementation that involve legal and public review
before any implementation is made.

There is no process proposed by the Audacity team to ensure that the information
being gathered conforms to any regulatory requirements.

### Choice of Third Party Service Providers

Many security and privacy experts warn of using Google and Yandex's systems.
These systems are known to be used for extensive data mining.  The implementation
of these systems gather personally identifiable information (at a minimum IP
addresses) through Audacity is not an acceptable standard.

### The lack of consideration of Open Source Alternatives

At a minimum there are three Open Source alternatives that should be considered
for the implementation of a telemetry system.  The three that are known at this
time are [Mozilla Glean](https://github.com/mozilla/glean),
[Matomo](https://matomo.org/) and
[Plausible Analytics](https://github.com/plausible/analytics) all of these options are
open source licensed tools, and have statements of GDPR compliance.  Several of
them also cover CCPA and PECR compliance as well.

## Conclusion

This document has attempted to do the kind of research that the Audacity team
should have done before beginning work on implementing telemetry in Audacity.
This research has included:

- Looking at successful telemetry implementations in large open source projects
- Looking at a case where a large open source project went wrong with changes to
  their telemetry implementation
- Looking at alternative data collection techniques that could be implemented to
  largely the same effect as the proposed telemetry implementation
- Looking at the deep flaws in the proposed telemetry implementation
- Looking at the lack of communication around the proposed telemetry
  implementation
- Looking at alternative choices for implementing a telemetry system that would
  be more respectful of user privacy
- Looking at alternatives for gathering some of the information outside of using
  telemetry

Because of of all of the concerns outlined in this document, it is proposed that
the implementation of Telemetry in Audacity be set aside until a more thorough
investigation and discussion can take place that will address many of the issues
raised in this document.

This document was researched and written in under 12 hours.  The Audacity Team
should recognize that just the amount of issues brought up with a very short
review dictates that there are issues that need a lot more research in order to
be properly and thoroughly addressed.
"
835514908,835,Qix-,2021-05-08T21:08:58Z,@SndChaser I wish comments could be pinned or something. That is a great writeup.
835515480,835,SndChaser,2021-05-08T21:10:30Z,"> @SndChaser I wish comments could be pinned or something. That is a great writeup.

Thanks.  I was inspired last night when someone else pointed to one of my comments as ""perfect"" and I kept thinking ""there's so much more that should be documented about this issue..."""
835518468,835,rob-sanders,2021-05-08T21:18:24Z,"> > @SndChaser I wish comments could be pinned or something. That is a great writeup.
> 
> Thanks. I was inspired last night when someone else pointed to one of my comments as ""perfect"" and I kept thinking ""there's so much more that should be documented about this issue...""

Can you dump the markdown under a repository like

https://github.com/SndChaser/audacity-data-collection

so the rest of us don't lose it in this increasingly unmanageable thread? As has been noted a few times here there's a tendency for threads like this to cycle endlessly."
835519537,835,aaaaaa123456789,2021-05-08T21:21:09Z,"> > > @SndChaser I wish comments could be pinned or something. That is a great writeup.
> > 
> > 
> > Thanks. I was inspired last night when someone else pointed to one of my comments as ""perfect"" and I kept thinking ""there's so much more that should be documented about this issue...""
> 
> Can you dump the markdown under a repository like
> 
> https://github.com/SndChaser/audacity-data-collection
> 
> so the rest of us don't lose it in this increasingly unmanageable thread? As has been noted a few times here there's a tendency for threads like this to cycle endlessly.

I'll point out that it will look better rendered as actual Markdown, where the hard line breaks will be treated as just spaces."
835524848,835,SndChaser,2021-05-08T21:34:15Z,"@rob-sanders 

> Can you dump the markdown under a repository like
> 
> https://github.com/SndChaser/audacity-data-collection
> 
> so the rest of us don't lose it in this increasingly unmanageable thread? As has been noted a few times here there's a tendency for threads like this to cycle endlessly.

Sure: https://github.com/SndChaser/AudacityTelemetryComments

I'll add for @aaaaaa123456789, the files are the original Markdown versions of the document and a couple of comments I posted earlier."
835528192,835,rob-sanders,2021-05-08T21:42:31Z,"@SndChaser Great, thank you. I think the link has a good chance of staying current as the thread rolls on."
835533582,835,polyjitter,2021-05-08T21:55:14Z,Excellent further input! Put a lot of things way more eloquently than I ever could.
835579210,835,jahway603,2021-05-08T23:50:09Z,Why are you ruining one of the best pieces of audio software available?
835590089,835,tilda,2021-05-09T00:22:49Z,popping in to say @SndChaser you did a really good job with that comment and i really appreciate what you said :)
835592881,835,SndChaser,2021-05-09T00:29:29Z,"> popping in to say @SndChaser you did a really good job with that comment and i really appreciate what you said :)

Thank you @tilda ."
835594845,835,IGBC,2021-05-09T00:33:49Z,"I am seeing some great summaries and it really feels like the debate is wrapping up?

Yet I am still seeing code review about coding style in the god damn chat. Why are we still doing this, can we wrap this up and get this god damned PR closed, please. 

Based on the lack of engagement from the OP I don't think even the Devs wanna touch this thing anymore, so maybe, reviewer's, you should call it a night, I think you might be wasting your time at this point?"
835595113,835,jahway603,2021-05-09T00:34:25Z,Closing this will resolve Issue #846 
835595483,835,IGBC,2021-05-09T00:35:19Z,"Well...

#846 is subtle"
835599860,835,BenBE,2021-05-09T00:46:07Z,"> I am seeing some great summaries and it really feels like the debate is wrapping up?

Yes. To sum up those summaries: Just don't do it!

> Yet I am still seeing code review about coding style in the god damn chat. Why are we still doing this, can we wrap this up and get this god damned PR closed, please.

Sorry about nitpicking those details. Didn't know when I started my review that it was so bad I barely could count review comments in one hand even without nagging about the style.

But yes: Please close this PR.

> Based on the lack of engagement from the OP I don't think even the Devs wanna touch this thing anymore, so maybe, reviewer's, you should call it a night, I think you might be wasting your time at this point?

It's one point simply chiming in to the discussion stating your opinion, but some slightly different when you had a closer look at the subject matter beforehand. Gives that comment a completely different weight. And yes: Could have called it a day, just reviewing the UI changes."
835600688,835,Reaper10,2021-05-09T00:48:18Z,"https://opentelemetry.io/
this is better"
835601389,835,SndChaser,2021-05-09T00:50:09Z,"@BenBE

> It's one point simply chiming in to the discussion stating your opinion, but some slightly different when you had a closer look at the subject matter beforehand. Gives that comment a completely different weight. And yes: Could have called it a day, just reviewing the UI changes.

I personally appreciate the thorough code review.  Just the excessive whitespace and EOL comments tell me that the coding standards for this project are not being adhered to by the new developers.

And, pointing out the actual issues in the code where the telemetry and network-manager implementation are concerned undermine numerous claims made by the original submitter of this PR."
835606071,835,BitesizedLion,2021-05-09T01:02:27Z,The fact that this is still ongoing blows my mind.
835610435,835,Be-ing,2021-05-09T01:14:21Z,"> Just the excessive whitespace and EOL comments tell me that the coding standards for this project are not being adhered to by the new developers.

I opened a new issue to discuss automated code formatting: #847."
835616069,835,weatherman2095,2021-05-09T01:29:59Z,"I'm appalled to see that despite significant user feedback, this PR still hasn't been rejected.

As written, there are legal, security and privacy problems with this PR. The vendoring of so many dependences is also a pretty terrible code-smell.

Additionally, telemetry that will be disabled by the overwhelming majority of distros means that any data gathered will be inconclusive at best, if not outright misleading. There is no good argument for proceeding."
835625837,835,orenwatson,2021-05-09T01:57:34Z,"Who is Spyrou Kyprianou, the person who apparently purchased the Audacity trademark from Dominic Mazzoni in 29 december 2020?"
835630718,835,Nex4rius,2021-05-09T02:12:04Z,"This change is like **literally** 40 times more controversial than the second most controversial change **ever** and its still not rejected. unbelievable.
<img src=""https://i.imgur.com/TCoUN8C.png"">"
835641313,835,jacobthehammer,2021-05-09T02:41:34Z,"> This change is like **literally** 40 times more controversial than the second most controversial change **ever** and its still not rejected. unbelievable.

Has anyone made a joke about the audacity of the situation? "
835641778,835,Be-ing,2021-05-09T02:43:10Z,"> Has anyone made a joke about the audacity of the situation?

Only like 5 times already."
835642006,835,SndChaser,2021-05-09T02:44:00Z,"> > Has anyone made a joke about the audacity of the situation?
> 
> Only like 5 times already.

I think that's a conservative estimate of the audacious level of audacity puns..."
835646260,835,orenwatson,2021-05-09T02:59:02Z,"https://assignments.uspto.gov/assignments/q?db=tm&sno=78352743
Why was there a 4 month gap between the trademark apparently being purchased and the announcement of this ""acquisition""?"
835688351,835,seredache,2021-05-09T05:15:24Z,"Hello everyone and I am bagging for a piece of your attention.

Yesterday (UTC+3) NGO ""Ukrainian Liberation"" made a [Public Appeal](https://ukrliberation.org.ua/docs/0-21.pdf) trying to get some information from the “Muse Group” company and bring attention of Community to the topic, and after we posted it we found out (BTW, **with the help of attentive readers** – NGO ""Ukrainian Liberation"" says ""Thank you!"" once again for that), that **we tagged the wrong company**, the [wrong](https://www.musegrp.com/en/) ""Muse Group"". The right one is [here](https://mu.se/). 

We were shocked and ashamed of our mistake, and we added the correct link to the website along with an apology within the first 30 minutes. Unfortunately, by that time the post was already blocked and we are not sure how many of you were able to see it. Now the account is also flagged (we are not sure why), but we are waiting for a Feedback from the Support Team. 

Now to the interesting part. 

This mistake got us thinking: how could 7 people who were checking the article did not notice such a mistake? 

Well, it turns out that all 7 people were using [DuckDuckGo](https://duckduckgo.com/), which, if you search for “Muse Group”, shows the other company. Now, despite our principles of not using Google at all, we tried using [Google](https://www.google.com/) for the same search, and viola! It was on the first search page, right after [""Muse"" rock band](https://en.wikipedia.org/wiki/Muse_(band)).

While looking at results from DuckDuckGo (BTW, we tried a lot of different requests like [this](https://duckduckgo.com/?q=muse+group&t=hc&va=u&ia=web), [this](https://duckduckgo.com/?q=%22muse+group%22%2B%22audacity%22&t=hc&va=u&ia=web), [this](https://duckduckgo.com/?t=ffab&q=%22muse+group%22%2B%22audacity%22%2B%22official+website%22&ia=web), [this](https://duckduckgo.com/?q=%22muse+group%22%2B%22audacity%22%2B%22website%22&t=ffab&ia=web), etc.) we found [a Wikipedian article](https://wikipedian.net/en/Muse_Group-0246428048) in which it is said that the ""Muse Group"" was founded a few days before they bought ""Audacity"". 

We decided to use ""[Wayback Machine](http://web.archive.org/)"" to look what was up with their website before. We found out that the website ""mu.se"" used to [belong to some Swedish company or a group of people not connected to ""Audacity"" or any other free software at all](https://web.archive.org/web/20190116125440/http://www.mu.se/). 

And now you can easily see that the first news of just-created ""Muse Group"" was [posted in 10-01-2021](https://mu.se/newsroom/tpost/su6elie391-musescore-36-introduces-new-fonts-and-en), but the point is that the website ""mu.se"" itself [required authorization to check it's content even in March, 2021](https://web.archive.org/web/20210316092542/http://mu.se/). The ""Newsroom"" place of the website ""mu.se"" has [only one snapshot on ""Wayback Machine"" even today (dated by March, the 7th)](https://web.archive.org/web/20210507125351/https://mu.se/newsroom).

We were not the only one who noticed this situation, so here is [a pretty neat article](https://www.gearnews.com/free-recording-software-audacity-acquired-by-firm-behind-musescore-and-ultimate-guitar/) about it.

We are not going to make any conclusions. That’s up to the Community.

By the way, NGO ""Ukrainian Liberation"" would like to apologize for a terrible mistake they made. Here's what Bohdan Kovalchuk, the №0 of NGO ""Ukrainian Liberation"", says:

> We checked our appeal and our conclusions about seven or eight times, but did not take into account that Google shows completely different results than DuckDuckGo. This is one hundred percent our mistake, and I want to apologize once again to the Community, to the ""Music Groups"", which we mentioned in the publication. Unfortunately or fortunately, the principles on which the Ukrainian Liberation NGO is based do not allow us to conduct research using (in our opinion) unethical search platforms. Now our account is flagged, or banned, or something like that, and we don't understand why. Excuse us, please. We tried to influence the situation until it was too late. We have already suffered the enormous moral consequences of our mistake and are morally ready for the next ones. I hope that our unfortunate mistake will be a lesson not only for us (it has already become a great lesson for us...), but also for those members of the Community who will continue to try doing a little research and understand what is happening. We are sorry. Please, forgive us, but we can't promise that it won't happen again: we are only humans, there are only seven of us in the organization. Thanks.

By the way, [there is an updated version of NGO's Public Appeal](https://ukrliberation.org.ua/docs/0-21.pdf). If you're still seeing the previous one, just refresh the page. 

And the last interesting for today: a user @orenwatson had just uploaded a comment just above this one. You may want to check it also. ;-)

However, the question remains open: **how and from whom could an open, free Audacity project be purchased?** It is really very interesting for us.

---

UPD (12:00 AM, UTC+3): Here are [public apologies to the ""wrong"" ""Muse Group""](https://ukrliberation.org.ua/docs/3-21.pdf) written by Bohdan Kovalchuk, NGO ""Ukrainian Liberation"".

---

_Thank you very much for your attention and sorry for bothering the Community._"
835690489,835,jxu,2021-05-09T05:21:55Z,My speculation is that an open source project can be taken over by paying off or sneaking into contributor positions. Intel and NSA have tried multiple times to push out old leadership and sneak in vulnerabilities into Linux.
835691210,835,orenwatson,2021-05-09T05:24:29Z, I have been given confirmation from Dominic Mazzoni (by Email) that he did indeed sell the trademark. The 4 month gap has not been explained however.
835691790,835,seredache,2021-05-09T05:26:13Z,"> I have been given confirmation from Dominic Mazzoni that he did indeed sell the trademark. The 4 month gap has not been explained however.

That is strange."
835695309,835,orenwatson,2021-05-09T05:37:46Z,"In that case, it is likely that any fork of the project, that uses the name ""audacity"" would be subject to trademark lawyers sending cease and desist letters and other such amoral behaviour."
835706808,835,Be-ing,2021-05-09T06:20:01Z,"There can be legitimate uses of networking in an audio application, for example Mixxx can lookup music metadata on MusicBrainz at the user's explicit request with each network connection. But seeing the reckless way this pull request vendors libcurl and now seeing that there has been literally no response from any maintainer on a pull request fixing a security vulnerability (#700) for *6 months* until a [bizarre comment](https://github.com/audacity/audacity/issues/699#issuecomment-835332181) today, I am awfully concerned about any networking functionality added to Audacity. If you add *any* networking functionality, gate it all behind a CMake option so networking libraries are not even built or linked."
835707273,835,mcilrain,2021-05-09T06:21:46Z,"Can't sue who you can't find.

Misappropriation of open-source projects is a breach of social contract in which case there is no moral obligation to adhere to laws when obtaining a resolution."
835723397,835,AlphaHot,2021-05-09T07:19:45Z,I'm against. I will create my own fork
835744726,835,Be-ing,2021-05-09T08:33:31Z,"> no response from any maintainer on a pull request fixing a security vulnerability (#700) for 6 months

Unfortunately, looking at the open pull requests and issues, this seems to be the norm here. I was shocked to learn that such a widely used application is maintained by so few people. I thought the Mixxx team was tiny but it has more people and is a much more niche application. I understand the Audacity team has limited capacity, but how could the team grow if you ignore people who are trying to help? The least you could do when someone opens a pull request is leave a quick comment like ""Hi, thanks for contributing! We're really busy working on X, Y, and Z right now so it may be a bit before we're able to review this. Feel free to ping us in a couple weeks if we don't respond.""

This makes it even more concerning that you have hired a new developer with little to no background in FOSS. It's not like they're hiding. A quick web search can find [results](https://lists.linuxaudio.org/listinfo/linux-audio-dev/) easily."
835745430,835,deeprest,2021-05-09T08:35:56Z,This reminds me of a song I heard called [TELEMETRY SHOULD NOT BE ADDED TO THIS GREAT PROJECT](https://github.com/audacity/audacity/issues/846)
835758578,835,jxu,2021-05-09T09:15:20Z,"It would be ironic if an angry fork attracted more developers than the original project purely out of spite

"
835759201,835,Be-ing,2021-05-09T09:17:14Z,"> It would be ironic if an angry fork attracted more developers than the original project purely out of spite

It would not be purely out of spite. It would also be because the original developers have been negligent at fostering the growth of the developer community."
835762717,835,Apep-the-snek,2021-05-09T09:27:31Z,"What is this masonic horseshit? you'll just be forked.
Congrats, you accomplished absolutely nothing, except pissing people off!"
835766472,835,Be-ing,2021-05-09T09:40:10Z,"Maybe we should write a new audio editor in Rust instead of forking Audacity. That way we would not have to deal with forked dependencies and a hacky build system.

.
.
.

I'm only half joking."
835771035,835,Blu3wolf,2021-05-09T09:58:48Z,"Now, that would be well described by ""the audacity"". "
835772456,835,domsson,2021-05-09T10:06:24Z,"It is important for the people pushing for this feature to realize that the backlash they are getting is not just due to the implementation details or ""tinfoil hats"" being against telemetry out of principle. The context matters.

Audacity was very recently ""acquired"" by Muse Group, a company that was just recently founded itself. However, neither the [Audacity website](https://www.audacityteam.org/audacity-musescore-announcement/), nor the [Muse Group website](https://mu.se/), nor [Tantacrul's video](https://youtu.be/RMWNvwLiXIQ) properly explain how that was done or what that even means. There is hardly any information on who is behind Muse Group. The [Wikipedia page on Muse Group](https://en.wikipedia.org/wiki/Muse_Group) currently seems quite fishy and also does not give any details. When a free, open source project that has existed for about 20 years is suddenly, and without any explanation, taken over by a company, that is reason for concern in itself.

A community developed free and open source project does not have any financial interests, so the intention is simply in creating the _best_ software possible. A company naturally has to put financial interests first, so the focus _will_ shift to create the most _profitable_ software, not necessarily the _best_ software. With this, there comes the danger of paid-for features, monetizing of user data, dropping of cross-platform compatibility and many other worrying issues for the existing user base. Hence, Muse Group should be very aware of the fact that people will watch closely as to what changes they are pushing for.

With this context in mind, it should be clear that a pull request with 5500+ lines of new code and dependencies, which came out of the blue, without any prior consultation with the community, from a developer who is obviously associated with Muse Group, but has previously not contributed to the project, is reason for concern. However, if the pull request was a long sought-after feature, that would probably be okay. That is not the case, however. Instead, this pull request implements a feature that not only _no one_ has ever asked for, but it is also one that has serious negative legal and moral implications. Not only because it is about tracking user's data, but also because it attempts to do so in an atrocious way. 

Add on top that the positive benefits of this are, at best, questionable, while the potential issues are huge. To name just a few, more code means more potential bugs and security vulnerabilities, more need for QA, bug fixing and maintenance, bigger download size, harder packaging for Linux distributions and many more.

Therefore, this is not just about whether or not someone agrees to the collection of usage data. This is about a questionable over-take of an open-source project, about horrible decisions and timing, horrible implementation and horrible communication all bundled up into one huge disaster. Even if this pull request will not be merged due to the pressure of the community, the trust in Muse Group and the future of the Audacity project has already sustained damage that most likely can not be repaired.

If you want to fix this, don't just replace Google with Matomo. If you want to fix this, don't just remove this pull request. If you want to fix this, you need to answer _a lot_ of questions and expose the motivations and details behind the overtake, this feature and many more. You owe it to a project that has been successful for twenty years. You owe it to a loyal and hard-working community. You owe it to us. You owe it to yourself."
835774612,835,seredache,2021-05-09T10:18:40Z,"> It is important for the people pushing for this feature to realize that the backlash they are getting is not just due to the implementation details or ""tinfoil hats"" being against telemetry out of principle. The context matters.
> 
> Audacity was very recently ""acquired"" by Muse Group, a company that was just recently founded itself. However, neither the [Audacity website](https://www.audacityteam.org/audacity-musescore-announcement/), nor the [Muse Group website](https://mu.se/), nor [Tantacrul's video](https://youtu.be/RMWNvwLiXIQ) properly explain how that was done or what that even means. There is hardly any information on who is behind Muse Group. The [Wikipedia page on Muse Group](https://en.wikipedia.org/wiki/Muse_Group) currently seems quite fishy and also does not give any details. When a free, open source project that has existed for about 20 years is suddenly, and without any explanation, taken over by a company, that is reason for concern in itself.
> 
> A community developed free and open source project does not have any financial interests, so the intention is simply in creating the _best_ software possible. A company naturally has to put financial interests first, so the focus _will_ shift to create the most _profitable_ software, not necessarily the _best_ software. With this, there comes the danger of paid-for features, dropping of cross-platform compatibility and many other worrying issues for the existing user base. Hence, Muse Group should be very aware of the fact that people will watch closely as to what changes they are pushing for.
> 
> With this context in mind, it should be clear that a pull request with 5500+ lines of new code and dependencies, which came out of the blue, without any prior consultation with the community, from a developer that is obviously associated with Muse Group, but has previously not contributed to the project, is reason for concern. However, if the pull request was a long sought-after feature, that would probably be okay. That is not the case, however. Instead, this pull request implements a feature that not only _no one_ has ever asked for, but it is also one that has serious negative legal and moral implications. Not only because it is about tracking user's data, but also because it attempts to do so in an atrocious way.
> 
> Add on top that the positive benefits of this are, at best, questionable, while the potential issues are huge. To name just a few, more code means more potential bugs and security vulnerabilities, more need for QA, bug fixing and maintenance, bigger download size, harder packaging for Linux distributions and many more.
> 
> Therefore, this is not just about whether or not someone agrees to the collection of usage data. This is about a questionable over-take of an open-source project, about horrible decisions, horrible implementation and horrible communication all bundled up into one huge disaster. Even if this pull request will not be merged due to the pressure of the community, the trust in Muse Group and the future of the Audacity project has already sustained damage that most likely can not be repaired.
> 
> If you want to fix this, don't just replace Google with Matomo. If you want to fix this, don't just remove this pull request. If you want to fix this, you need to answer _a lot_ of questions and expose the motivations and details behind the overtake, this feature and many more. You owe it to a project that has been successful for twenty years. You owe it to a loyal and hard-working community. You owe it to us. You owe it to yourself.

Bravo."
835777069,835,mcilrain,2021-05-09T10:33:35Z,"This pull request still hasn't been denied? I don't see any reason for the hold-up.

Regardless of the outcome of this discussion if the governance of this project is inactive then a fork is necessary."
835778117,835,Be-ing,2021-05-09T10:39:53Z,"> Add on top that the positive benefits of this are, at best, questionable, while the potential issues are huge. To name just a few, more code means more potential bugs and security vulnerabilities, more need for QA, bug fixing and maintenance, bigger download size, harder packaging for Linux distributions and many more.

Add on top a history of forking dependencies and not even trying to upstream patches, responding rather flippantly to Linux packagers' concerns (#625), and [causing problems](https://bugzilla.redhat.com/show_bug.cgi?id=1939749#c6) which end up falling on the developers of other applications sharing dependencies to resolve."
835779266,835,M-Reimer,2021-05-09T10:46:14Z,"> But seeing the reckless way this pull request vendors libcurl and now seeing that there has been literally no response from any maintainer on a pull request fixing a security vulnerability (#700) for _6 months_ 

Actually that's a huge message on its own. Noone cares to have a look at fixing a security vulnerability but there is time to create pull request for telemetry. Honestly I don't think that this is only to improve anything for users but to prepare some ""pay with your data"" shit like with many other services out there. And even if the introduction is honest the priority list is really really bad. Why is ""implement telemetry"" higher in the list than ""fix security vulnerabilities"". I can tell you something about user preferences even without any telemetry in place: Your users want to have security vulnerabilities fixed with top priority!"
835779364,835,falkTX,2021-05-09T10:46:49Z,"Would be great if the trollish comments would stop..
This is a serious matter.
The more of them there are, the less inclined everyone else is from participating in an actual, honest, serious discussion.

The whole thing might just be ignored because most people commenting do so in a very unfriendly manner.
Some anger is understandable, but if we are not civil and decent it is unreasonable to ask the other party to be that for us.
"
835784477,835,mcilrain,2021-05-09T11:15:13Z,"> Would be great if the trollish comments would stop..

Stupid pull requests beget stupid comments."
835785719,835,illwieckz,2021-05-09T11:22:46Z,"I would suggest to rename the PR as _Make possible for users to help the project by contributing anonymous usage if they want to_, this way the answers of people responding _I'm against_ with epidermal reaction like if they were on twitter would look funny at best.

I can understand how the original title can be triggering when not reading the explanations that came after the title, but well, as a people I believe we can read more than 140 characters…"
835787812,835,mcilrain,2021-05-09T11:35:07Z,"> I would suggest to rename the PR as _Make possible for users to help the project by contributing anonymous usage if they want to_, this way the answers of people responding _I'm against_ with epidermal reaction like if they were on twitter would look funny at best.

Please read the discussion, it has already been established that the information being sent is not anonymous."
835790791,835,Be-ing,2021-05-09T11:52:27Z,"Here is yet another point against adding any networking capabilities to Audacity whatsoever. Audacity uses a vendored copy of FFmpeg. As documented in issue #398, Audacity was using FFmpeg version 2.2.2 until pull request #741 was merged only 4 days ago. FFmpeg 2.2.2 was [released 2014-05-04](https://git.videolan.org/?p=ffmpeg.git;a=shortlog;h=n2.2.2).

Remember that [recent blog post](https://signal.org/blog/cellebrite-vulnerabilities/) by the lead developer of Signal demonstrating a proof-of-concept exploit in widely used software? It strongly implied that was accomplished by exploiting a vulnerability in an old version of FFmpeg from 2012, likely with a specially formatted media file. That was exploited to achieve execution of arbitrary code by the attacker.

Considering Audacity is an extremely widely used application, there would be a lot of incentive for a malicious actor to use it to launch an attack on Audacity users' computers. The Audacity maintainers (not merely the new people from Muse Group) have already demonstrated they are not trustworthy for maintaining the security of Audacity. Adding a novel attack surface, especially in a very reckless way by vendoring libcurl, is a horrible idea. "
835793044,835,Be-ing,2021-05-09T12:05:01Z,"> Why is ""implement telemetry"" higher in the list than ""fix security vulnerabilities"".

No new dependencies should be added to Audacity before cleaning up this mess with vendored dependencies. This should be the very top priority above any new features or UX improvements because it is crucial for security."
835793562,835,falkTX,2021-05-09T12:07:42Z,"Security does not pay bills and does not make for flashy news. So it ends up ignored most of the time, until a leak of some sorts happen.
This is a systemic problem."
835794008,835,Be-ing,2021-05-09T12:10:08Z,"Speaking of Signal, do you think it uses telemetry? Is it unusable crap?

(Please don't take this off topic debating the merits of Signal versus other messaging systems. That's not the point here.)"
835794267,835,falkTX,2021-05-09T12:11:26Z,"wtf has that to do with anything, or relevant at all?
you are part of the problem here, please shut up"
835796555,835,Be-ing,2021-05-09T12:23:48Z,I apologize for bringing that last point up. It's not very relevant. Please don't respond to it and drag this off topic.
835814939,835,zearp,2021-05-09T14:08:58Z,When will a decision be made about this PR? I'm very curious how the maintainers weight the over 3000 thumbs down this PR has received.
835815593,835,ghost,2021-05-09T14:12:46Z,"> When will a decision be made about this PR? I'm very curious how the maintainers weight the over 3000 thumbs down this PR has received.

If you have the monitor upside down you could see it as over 3000 thumbs up for something you can't understand."
835827377,835,jg777,2021-05-09T15:19:55Z,"> When will a decision be made about this PR? I'm very curious how the maintainers weight the over 3000 thumbs down this PR has received.

Wow, the users are ASKING you NOT to do this and NONE of the Audacity Team seems to care about its users, so now you're going to go through with it?"
835828070,835,turtlegarden,2021-05-09T15:24:26Z,"To Muse Group:

People are ready to maintain fork of Audacity if this PR‌ gets accepted. Most of your users do _not_ want telemetry either! Therefore, if this PR gets accepted, _your investment in Audacity would be near useless_. That's all."
835829214,835,turtlegarden,2021-05-09T15:31:08Z,"A lovely thing about OSS: there are things called _forks_ which branch off the original project! Many people do this when the original project goes awry (such as LibreOffice and MATE, forks of OpenOffice.org and GNOME 2). This project is close to going haywire and _**MANY**_ people stated that they **will** fork and maintain Audacity if this PR gets accepted. So, if you want to maintain a large user base, Muse Group, close this PR and you won't become OpenOffice.org soon."
835844840,835,marcopavanello,2021-05-09T17:04:52Z,"They are now probably thinking about ways to get around this telemetry thing and implement something else that satisfies their business model needs.
They clearly showed us their mentality regarding not caring about people and ultimately, about the community.
Mentalities like that are hard to change, they are generally toxic.
It's obvious that we as users who care about privacy need alternatives to edit our whale, monkey, voice and other personal recordings.
So also if they won't commit this patch, I've had enough about their disrespectful and not engaging behavior towards humans.

**Get this shit that has nothing to do with an audio program out of here**."
835845422,835,jpellegrini,2021-05-09T17:08:18Z,"> ways to get around this telemetry thing

I'd guess it's more like ""trying to assess the impact of a fork, and how likely it would be that it happens"", and ""what Plan B would be like if it happens"".
I don' trust that they'll do anything good (kind of pessimistic, but anyway...) and I'm ready to start using a fork.

I only remember one case in which a company reverted a decision to include telemetry in free software -- Gitlab."
835850652,835,jg777,2021-05-09T17:39:43Z,"Audacity is music software, which does not need or require a network stack.
Audacity is NOT a web browser, which does need and require a network stack."
835859628,835,DaVince,2021-05-09T18:32:21Z,"> They clearly showed us their mentality regarding not caring about people and ultimately, about the community.

I keep seeing this argument but the simple truth is:

* This pull request is a draft, not some guaranteed merge action.
* The developers taking their time to think about the best course of action from here on out. Not immediately responding to the dogpiling that's going on in this PR, shouldn't be misconstrued as ""they don't care"", especially considering how helpful the community at large has been (speaking as a lurker).

AFAIK, some of the people involved in this PR actually read every single post here, and are evaluating how to tackle the telemetry issue in a way that would work out for both the devs and the users."
835859697,835,Qix-,2021-05-09T18:32:47Z,"I just got banned off of the Audacity discord. Not for being rude, pushy, or invasive - but for pointing out that their ""good luck finding people to maintain a fork"" comments were a little strange and disconcerting.

I really, _really_ wanted to assume negligence instead of malintent, and tried to have an open conversation with the maintainers. I was met with rudeness, snyde comments, pompous behavior (""good luck, you can't just take over a 20 year project so easily"", ""good luck finding translators"", etc.).

# The devs have no interest in listening to anyone. Let's fork it already."
835860346,835,Qix-,2021-05-09T18:36:31Z,"@DaVince 

> This pull request is a draft, not some guaranteed merge action.

It was not a draft when it was posted. It was converted to one after the initial backlash.

This was also requested directly by Tantacrul, the new owner of Audacity, and coded/submitted by a Muse Group employee.

They have every intent to merge this."
835860713,835,ghost,2021-05-09T18:38:51Z,"> their ""good luck finding people to maintain a fork"" comments

@Qix- Did they really say that? There's not even a need to maintain any fork - all it takes to disable telemetry is to build Audacity from source and distribute the clean binaries."
835862558,835,Qix-,2021-05-09T18:50:07Z,"@SpheeresX Yes. It's not paraphrasing, either."
835863881,835,DaVince,2021-05-09T18:57:53Z,"> @DaVince
> 
> > This pull request is a draft, not some guaranteed merge action.
> 
> It was not a draft when it was posted. It was converted to one after the initial backlash.
> 
> This was also requested directly by Tantacrul, the new owner of Audacity, and coded/submitted by a Muse Group employee.
> 
> They have every intent to merge this.

If they had every intent, it would not have been reverted to a draft. Don't think they're not taking this seriously."
835864192,835,turtlegarden,2021-05-09T18:59:33Z,"> > their ""good luck finding people to maintain a fork"" comments
> 
> @Qix- Did they really say that? There's not even a need to maintain any fork - all it takes to disable telemetry is to build Audacity from source and distribute the clean binaries.

This is true, however more antifeatures will _likely_ be added (and in that case, fork time!)."
835864444,835,Qix-,2021-05-09T19:01:05Z,@DaVince They are not taking it seriously. Tantacrul said in the discord that he's waiting for this to blow over.
835865019,835,DaVince,2021-05-09T19:04:08Z,"> @DaVince They are not taking it seriously. Tantacrul said in the discord that he's waiting for this to blow over.

How is that any indication of them not taking it seriously? That's a wise course of action when you're being dogpiled on. Meanwhile, it creates some space to rethink how to tackle the feature instead.

I feel like I'm contributing too many posts to this way-too-long PR already, and I'm not sure it's going anywhere, so I'm pulling out of this conversation. But maybe keep a basic modicum of trust that the people who have been working on this project for years are out to find the right solution that works for everyone."
835865078,835,SndChaser,2021-05-09T19:04:24Z," @DaVince

> If they had every intent, it would not have been reverted to a draft. Don't think they're not taking this seriously.

I'm reading the reversion to a draft state as more of WIP cycle as coding errors / issues are worked out.  I am not seeing this as the intent to revert the code completely and close out this PR."
835865271,835,xTibor,2021-05-09T19:05:43Z,Apart from the legal/privacy/ethical issues what concerns me the most they are giving zero response to the technical concerns raised in the code reviews. That alone convinces me to support whatever popular non-Muse fork emerges.
835865636,835,Qix-,2021-05-09T19:07:36Z,"> But maybe keep a basic modicum of trust that the people who have been working on this project for years are out to find the right solution that works for everyone.

That's exactly what I did, and they gave me every reason to believe this is not some innocent ordeal."
835866087,835,SndChaser,2021-05-09T19:09:59Z,"
> But maybe keep a basic modicum of trust that the people who have been working on this project for years are out to find the right solution that works for everyone.

The only way to ""...find the right solution..."" would be to start from scratch.  The code that is being worked on is flawed from it's initial intent, and is broken by design.  Those are issues that cannot be coded around."
835866165,835,Be-ing,2021-05-09T19:10:34Z,"> But maybe keep a basic modicum of trust that the people who have been working on this project for years are out to find the right solution that works for everyone.

That trust has already been broken for many. It is up to the maintainers (old and new) to work towards restoring it. I have suggested multiple times throughout this discussion specific steps they could take to build trust. I am awfully concerned that they have not taken any of those steps in days. The most basic step would be a simple comment saying that they commit to not using Google Analytics nor Yandex. All that takes is one sentence. And that's just the first step to demonstrate this is going in the right direction."
835868839,835,Be-ing,2021-05-09T19:24:24Z,"> Tantacrul said in the discord that he's waiting for this to blow over.

This is a bad idea. This will not blow over until a response is provided. If it is a bad response, it will blow up even bigger."
835871371,835,jg777,2021-05-09T19:37:47Z,"Again, for those that aren't ""developers"", in software development you don't add code that is not necessary to the main functionality of the application. This PR is attempting to turn a really great and working perfectly fine right now ""audio application"" INTO a ""web browser"" (with who knows what down the road and a bunch of **new security issues as it using your network**) Currently this software does not use the network or internet."
835871928,835,falkTX,2021-05-09T19:40:34Z,"> @DaVince They are not taking it seriously. Tantacrul said in the discord that he's waiting for this to blow over.

can you post a screenshot of this please?

I disagree with discord ToS, so I cannot join."
835872687,835,orenwatson,2021-05-09T19:45:04Z,"Tantacrul must have said that after he kicked me from his discord, as I did not see it."
835872750,835,Qix-,2021-05-09T19:45:24Z,"> can you post a screenshot of this please?

Nope. I was banned. I know for a fact some others in this thread are in there and can post some screenshots, however (assuming they haven't also been banned). I won't tag them so as to not 'out' them to the hostile Audacity team.

I encourage them to copy the logs and take screenshots, though. Conversations in there would be very interesting to the people here, and I don't want to be the one shouting out hearsay."
835872940,835,falkTX,2021-05-09T19:46:27Z,"> Again, for those that aren't ""developers"", in software development you don't add code that is not necessary to the main functionality of the application. This PR is attempting to turn a really great and working perfectly fine right now ""audio application"" INTO a ""web browser""

adding network features does not mean making it a browser. browsers nowadays are a full OS, with not just networking, font and image rendering, but also audio and video playback, camera and usb access, gps and others sensors, p2p communication, screensharing... errr what else, whatever the main PC can do, the browser will likely do it too (maybe not now, but in due time for sure)"
835873323,835,Qix-,2021-05-09T19:48:29Z,"Nevermind, I forgot I took a screenshot of an older conversation yesterday that had (some of) the relevant bits.

# EDIT: They are trying to censor this. Please don't let them.

![image](https://user-images.githubusercontent.com/885648/117585849-eb4bae80-b114-11eb-8af3-62857ef40244.png)


---

Here is what was edited into this comment.

> [Moderated: I'm 100% certain that you do not own the copyright on that conversation, and I'm astounded, given the current context, that you feel it's OK to redact your own identity in that picture while displaying personal identifiable information about others.]

Conversation cannot be copyrighted, and everyone knows who each of the un-censored people are as they are maintainers of this project and/or celebrities (in the case of Tantacrul). I protected the non-maintainers who were trying to raise concern with you and have a conversation before you banned us, because they are _not_ well known people and _not_ celebrities. I've not revealed anything other than your intent - much less private information. Those named on there do not even give your Discord IDs, in which you need the nonce number in order to contact anyway.

Don't be dumb."
835873845,835,domsson,2021-05-09T19:51:00Z,"First, if it is true that they are really waiting for this to ""blow over"", then I think it is likely that they will eventually close this PR for further comments. We should probably agree on an alternative place to keep the conversation going pretty soon, so that killing the conversation here will not kill the conversation in general.

Second, can someone link to the mentioned Discord? I could not find an Audacity Discord or a mention of such anywhere."
835873873,835,orenwatson,2021-05-09T19:51:08Z,"Also, At this point it would be wise for us to create our own discord or channel for communication, as this PR's comment section is of course subject to being potentially deleted by Muse Group."
835873926,835,falkTX,2021-05-09T19:51:22Z,"thanks! though that is a bit unclear/dubious about intentions.

letting things cool down is always a good thing, dont make decisions or say things under pressure.

we should still press them for a proper response to all of this though. their community deserves better than this"
835874066,835,orenwatson,2021-05-09T19:52:08Z,"Perhaps an IRC channel on say Freenode, rather than a discord?
"
835874142,835,jxu,2021-05-09T19:52:40Z,is it possible to archive all comments in this PR? A lot of useless comments (admittedly I contributed a few) but some very good ones as well
835874177,835,falkTX,2021-05-09T19:52:52Z,"> Perhaps an IRC channel on say Freenode, rather than a discord?

#audacity already exists, we can use that?"
835874381,835,Qix-,2021-05-09T19:53:58Z,"> thanks! though that is a bit unclear/dubious about intentions.

Yes, of course. All I can say is, it's clear (to me) based on the _rest_ of the very long conversation that took place in there (aside from that screenshot) that they aren't doing it as a ""cooldown"" period. They're actively hiding from the problem and waiting for things to quiet down enough to move forward.

This was also clear to me as the development discussion about this PR was still taking place in the development channels by both the OP as well as the rest of the maintainers, talking about changes being made to the code in order to merge it later.

> is it possible to archive all comments in this PR?

Yes, sort of. https://web.archive.org/web/*/https://github.com/audacity/audacity/pull/835"
835875942,835,jrmoore,2021-05-09T20:02:09Z,"I'd like to give my two cents on the matter, being an Audacity user but also a software engineer.

I don't think telemetry per se is a bad thing, for me it wildly depends on how it's done and what for. There are always cases of abuse, whether it be overreaching forcing it on people without an option to opt-out (e.g., the way Microsoft does it with Windows 10 for example) or the myriad of trackers many websites employ to track users actions so advertisers can target them better (where the worse possible outcome would be a price hike on something because they'd know that particular user would buy it because it's important for them).

But, when used for the betterment of the product itself it's something really useful and metrics of all kinds are present in all phases of software development, even during prototyping. I'm going to simplify things, but lets say you have two low fidelity prototypes for a new program, you present them to a series of (willing) participants and see how they use them, how long it takes them to accomplish tasks, what their opinions are, there's a whole lot of things that can be measured there already!

Afterwards you get to see how they did, which was more effective, more efficient, more intuitive, etc. This is as old as 1986, when John Brooke created his System Usability Scale thing. Then there'd be high level prototypes, more interviews, different kinds of metrics, etc.

All of that before an actual app is even done! Obviously not everybody does things that way, and I'm kind of going off track, but I wanted to let you all know that metrics can be useful towards creating a good program.

The thing is, how would you translate that to a finished product already? Or an ongoing one? Obviously forcing participation is not the way to go (imagine someone approaching you in the street making you use their prototype or else), and doing it surreptitiously is even worse.

So in my eyes, whatever is done (generally speaking, not talking about Audacity concretely), should be done with the consent of the users and ideally be an opt-in situation. From what I read over at @crsib's original post it would be opt-in and disabled by default, so if that's the case so far so good for me.

Now, what to track actually? Because that's a slippery slope, broadly speaking you'd want to keep it to a minimum, but tracking things that would be important for the betterment of the app itself.

To my mind comes Microsoft again, any of you remember the changes Office had throughout its versions? The amount of toolbars it used to have and how things changed with Office 2007? (That's when the ribbon was introduced, which has come a long way since then too, but that's another matter).

They had an enormous amount of data from real users, already prior to introducing the ribbon, but I mention it because I remember seeing a presentation on what led to the creation of the ribbon (MIX08 it was, I think there are videos in YouTube for those willing to see it and I'd highly recommend them even if they're dated) and all that data was really useful! They allowed them to know which functions where used more, which weren't used at all, which where so hidden people didn't even know about (think about it, what do we use in an office suite and what is it capable of doing haha).

All that came from telemetry, same with how many steps it took to do something and waaaaay more things (I'd say they captured way too much, but that's not the general point I'm trying to make).

Being able to see that your users use a function a lot, but it's hidden under several clics may make you think ""okay, let's see if we can make it more accessible, more intuitive"". Or maybe, ""wow, they're really using that function and we're even working on it that much, let's do some sprints on it and see how we could improve it"".

Or even, ""oh... many users are making that mistake before accomplishing what they wanted to do, should we do something about it?"" (because you could see correlation of actions too, where you click at one moment and where you click next). It's another tangent, but in my experience the first thing that comes to my mind is the ""exporting"" to PNG for example in GIMP, I'd go to ""Save"" or ""Save as"" instead many times.

After all that I've said, my position on telemetry would be good, I like things I use the most to be priorized over others maybe. Besides, Audacity being open source, we (or those with knowledge and inclination) can know what's being measured so we don't have to trust it's going to be something when it's not. Yes, it's a big pull request, and it's just that, a request open for comments one way or another and I'm sure the whole thing would be refined before shipping it in a subsequent release (if it's integrated that is).

Plus, if it's off by default there's nothing to worry about in my mind for those who don't want to take part into shaping the next versions. And if it ended up overreaching or whatever there would also be the possibility of building some binaries without the telemetry code (e.g., if using Google's and/or Yandex's systems is unacceptable).

The bottom line is, just don't think of metrics as a bad thing, at least acknowledge they can be used for good too. Yes, many times they're used for not so amicable things like those examples I wrote at the beginning, but not always. And while doing surveys like I mentioned is also another possibility, it isn't as representative of the real usage and certainly not as informative for developers.

As long as Audacity remains open source and the focus is to improve its usability, user experience, interface, etc. I'm good for it.

PS. Sorry for the long text, I started writing and it ended up being massive."
835876156,835,HeyBanditoz,2021-05-09T20:03:14Z,"I found this, which may help: https://stackoverflow.com/questions/16198351/get-list-of-comments-from-github-pull-request

On 5/9/2021 13:52, jxu wrote:

> is it possible to archive all comments in this PR? A lot of useless comments (admittedly I contributed a few) but some very good ones as well
>
> —
> You are receiving this because you commented.
> Reply to this email directly, [view it on GitHub](https://github.com/audacity/audacity/pull/835#issuecomment-835874142), or [unsubscribe](https://github.com/notifications/unsubscribe-auth/ABZZJCCLI2KFFJ33Q5V2FRLTM3RZTANCNFSM44C5SLTA)."
835877943,835,Qix-,2021-05-09T20:12:41Z,"I took the liberty of archiving the first ten pages (~~up until and including the comment above me~~ updated with some newer comments) on web archive. They're in JSON format but at least they won't be deleted.

1. https://web.archive.org/web/20210509200616/https://api.github.com/repos/audacity/audacity/issues/835/comments?per_page=100
2. https://web.archive.org/web/20210509200704/https://api.github.com/repos/audacity/audacity/issues/835/comments?per_page=100&page=2
3. https://web.archive.org/web/20210509200823/https://api.github.com/repos/audacity/audacity/issues/835/comments?per_page=100&page=3
4. https://web.archive.org/web/20210509200831/https://api.github.com/repos/audacity/audacity/issues/835/comments?per_page=100&page=4
5. https://web.archive.org/web/20210509200837/https://api.github.com/repos/audacity/audacity/issues/835/comments?per_page=100&page=5
6. https://web.archive.org/web/20210509200852/https://api.github.com/repos/audacity/audacity/issues/835/comments?per_page=100&page=6
7. https://web.archive.org/web/20210509200853/https://api.github.com/repos/audacity/audacity/issues/835/comments?per_page=100&page=7
8. https://web.archive.org/web/20210509200849/https://api.github.com/repos/audacity/audacity/issues/835/comments?per_page=100&page=8
9. https://web.archive.org/web/20210509200941/https://api.github.com/repos/audacity/audacity/issues/835/comments?per_page=100&page=9
10. https://web.archive.org/web/20210509204502/https://api.github.com/repos/audacity/audacity/issues/835/comments?per_page=100&page=10"
835879195,835,Qix-,2021-05-09T20:19:04Z,"Welp that was quick. They [deleted](https://github.com/audacity/audacity/pull/835#issuecomment-835873323) the screenshot. Oh no! Anyway.

Lol @ the comment about ""copyright"", and yes, I'm going to show the names (not handles) of the maintainers of the project. Might I suggest reading this article: https://en.wikipedia.org/wiki/Streisand_effect

- Here it is mirrored on Imgur. https://i.imgur.com/y5zVq02.jpg
- Here it is archived. https://web.archive.org/web/20210509201749/https://i.imgur.com/y5zVq02.jpg

I suppose I'll be blocked from posting here soon. I'll update the thread in @SndChaser's repository if I am.

EDIT: Just a few minutes after the screenshot was posted and they censor my comment the PR is closed. Okay."
835880578,835,jxu,2021-05-09T20:25:37Z,@Qix- and I was going to do the low-tech method of expanding all the comments and saving a raw HTML file :P Your method is a lot more programmatic
835880865,835,crsib,2021-05-09T20:27:00Z,Over 3000 thumbs down? We're closing this PR. We've taken on board 'no Google' and 'no Yandex' and Muse are now looking for a good alternative (thanks to those who recommended other open source solutions by the way). Please understand that this will take a little time to organize and a concrete plan will be published soon - at any rate this week.
835881034,835,falkTX,2021-05-09T20:27:43Z,"I will be setting up a fork soon too then, thank you for closing.
"
835881156,835,jxu,2021-05-09T20:28:15Z,"> Over 3000 thumbs down? We're closing this PR. We've taken on board 'no Google' and 'no Yandex' and Muse are now looking for a good alternative (thanks to those who recommended other open source solutions by the way).

Thank you "
835881632,835,Qix-,2021-05-09T20:30:34Z,"@falkTX You're the most qualified to fork IMO, and a number of us have mentioned you in discord already hoping you'd fork too. Can you do so really quick even if it's not a modified version so that we can star/watch?

EDIT: nevermind, forked here: https://github.com/KXStudio/audacity"
835881725,835,tilda,2021-05-09T20:31:00Z,"> Over 3000 thumbs down? We're closing this PR. We've taken on board 'no Google' and 'no Yandex' and Muse are now looking for a good alternative (thanks to those who recommended other open source solutions by the way). Please understand that this will take a little time to organize and a concrete plan will be published soon - at any rate this week.

Thank you for making an effort to listen to the community somewhat!"
835882011,835,NWPlayer123,2021-05-09T20:32:28Z,"> 
> 
> > They clearly showed us their mentality regarding not caring about people and ultimately, about the community.
> 
> I keep seeing this argument but the simple truth is:
> 
>     * This pull request is a draft, not some guaranteed merge action.
> 
>     * The developers taking their time to think about the best course of action from here on out. Not immediately responding to the dogpiling that's going on in this PR, shouldn't be misconstrued as ""they don't care"", especially considering how helpful the community at large has been (speaking as a lurker).
> 
> 
> AFAIK, some of the people involved in this PR actually read every single post here, and are evaluating how to tackle the telemetry issue in a way that would work out for both the devs and the users.

""The devs"" managed to work on Audacity for 20 years without needing telemetry, or networking features at all. If a brand new developer is going to introduce new features, libraries, and bloat, there better be a damn good reason for it."
835882133,835,BitesizedLion,2021-05-09T20:33:00Z,"> > > They clearly showed us their mentality regarding not caring about people and ultimately, about the community.
> > 
> > 
> > I keep seeing this argument but the simple truth is:
> > ```
> > * This pull request is a draft, not some guaranteed merge action.
> > 
> > * The developers taking their time to think about the best course of action from here on out. Not immediately responding to the dogpiling that's going on in this PR, shouldn't be misconstrued as ""they don't care"", especially considering how helpful the community at large has been (speaking as a lurker).
> > ```
> > 
> > 
> > AFAIK, some of the people involved in this PR actually read every single post here, and are evaluating how to tackle the telemetry issue in a way that would work out for both the devs and the users.
> 
> ""The devs"" managed to work on Audacity for 20 years without needing telemetry, or networking features at all. If a brand new developer is going to introduce new features, libraries, and bloat, there better be a damn good reason for it.

Yes! I 1000% agree with what you are saying"
835882157,835,SndChaser,2021-05-09T20:33:07Z,"@crsib 

> Over 3000 thumbs down? We're closing this PR. We've taken on board 'no Google' and 'no Yandex' and Muse are now looking for a good alternative (thanks to those who recommended other open source solutions by the way). Please understand that this will take a little time to organize and a concrete plan will be published soon - at any rate this week.

I hope you look at some of the comments here a lot more carefully, I have seen some rather extensive work (some of which I did myself) that indicates there were a lot more issues with the underlying concepts that you were trying to achieve with this code.  There really needs to be a concerted effort to understand the implications that adding a set of features such as telemetry involve, not just the technological aspect."
835882492,835,falkTX,2021-05-09T20:34:32Z,"> @falkTX You're the most qualified to fork IMO, and a number of us have mentioned you in discord already hoping you'd fork too. Can you do so really quick even if it's not a modified version so that we can star/watch?

Still need to check and investigate the CI build.
In any case keep an eye on https://kx.studio/News/ and I will be announcing it there when there is something to see.
I had forked for my personal GH account, but it is better to use https://github.com/KXStudio/audacity.

The main question now is if it is possible to keep the audacity name as-is (because the build will be identical, as-is, just with no tracking).
As much as Muse Group want to be good people, I think that might be crossing a line on my side.

@crsib is it okay to keep audacity name for builds which are identical in every way except tracking completely disabled?"
835883452,835,Qix-,2021-05-09T20:38:40Z,"@falkTX You'll probably need to change the name. Audacity is [GPL license](https://github.com/audacity/audacity/blob/master/LICENSE.txt), and as someone else in the Discord (not mentioning who) pointed out, ""Audacity"" is trademarked. That trademark changed ownership sometime last year and they took 4 months to announce it. The deal of the trademark transfer was not really outlined per my knowledge.

Perhaps you don't 'need' to, but you certainly want to - especially since Muse Group doesn't seem to be cooperative with the OSS community."
835883575,835,Be-ing,2021-05-09T20:39:20Z,"> @crsib is it okay to keep audacity name for builds which are identical in every way except tracking completely disabled?

Better yet, do you commit to providing official release builds for all supported operating systems built without tracking/telemetry? I am aware that you do not currently provide official Linux builds but work on this in progress (#843). Do you commit to providing official Linux builds built without tracking when you introduce official Linux builds? This is easy to do with GitHub Actions' matrix feature. If you need help with that I am happy to help.

I for one think we will probably not need a fork if this is done."
835889342,835,ghost,2021-05-09T21:05:08Z,"> > @crsib is it okay to keep audacity name for builds which are identical in every way except tracking completely disabled?
> 
> Better yet, do you commit to providing official release builds for all supported operating systems built without tracking/telemetry? I am aware that you do not currently provide official Linux builds but work on this in progress (#843). Do you commit to providing official Linux builds built without tracking when you introduce official Linux builds? This is easy to do with GitHub Actions' matrix feature. If you need help with that I am happy to help.
> 
> I for one think we will probably not need a fork if this is done.

I'm working on this in case they will add some form of telemetry (which based on what @crsib said, they will): https://audacity-notrack.github.io/"
835889454,835,marcopavanello,2021-05-09T21:05:37Z,"What part of ""NO TELEMETRY"" don't you understand?
Telemetry means collection of users' data, this has no place in a Free/Libre world.
Despite at least 90% (EDIT: the majority) of the comments saying ""we don't want telemetry"" and then you saying ""Muse are now looking for a good alternative"" explained everything: You are not listening to the community.

And for the record, ""looking for an alternative"" is not a winning point for us, it's a losing one in which it's clear now that we completely lost power of choice over this amazing program."
835890192,835,falkTX,2021-05-09T21:08:43Z,"> Despite at least 90% of the comments saying ""we don't want telemetry"" and then you saying ""Muse are now looking for a good alternative"" explained everything: You are not listening to the community.

to be fair, a few expressed consent of telemetry with self-hosted servers being ok.
there is a division on this specific issue."
835890969,835,NathanDreamweaver,2021-05-09T21:11:52Z,"The right amount of telemetry tracked in a manner that is fair and can be trusted could do good, this is just not it. Perhaps something as ""simple"" as a ""Send crash report"" button if Audacity crashes."
835891369,835,Be-ing,2021-05-09T21:13:34Z,"I want to reiterate my concern for how the decision to even start working on this was made and how this pull request has been handled. It is *not* normal for FOSS projects to have no public discussion of major changes to the code before any code is written. If you do not make significant changes to your decision making process, including how the roadmap for development is decided, you should anticipate more contentious pull requests like this. Again, I strongly recommend that every Audacity maintainer, old and new, read all three of these blog posts about the Rust community's growth through a highly contentious issue:
https://aturon.github.io/tech/2018/05/25/listening-part-1/
https://aturon.github.io/tech/2018/06/02/listening-part-2/
https://aturon.github.io/tech/2018/06/18/listening-part-3/

Furthermore I want to reiterate my earlier suggestion to enable telemetry/tracking only in special builds made for enthusiastic testers who specifically want to provide this data to assist in the development of Audacity. @unfa mentioned this idea in his [YouTube video](https://www.youtube.com/watch?v=jK7eHuGDAtM) about this as well. I think these users would accept much more invasive data gathering for these special builds than average users, which could help you get better information to improve Audacity. You could also likely get Linux users to participate in this."
835897075,835,domsson,2021-05-09T21:35:47Z,"> Over 3000 thumbs down? We're closing this PR. We've taken on board 'no Google' and 'no Yandex' and Muse are now looking for a good alternative (thanks to those who recommended other open source solutions by the way). Please understand that this will take a little time to organize and a concrete plan will be published soon - at any rate this week.

This is rather frustrating. While it is appreciated that the PR has finally been closed, your take-away is worrying. The vast majority of comments here has made it clear that tracking and the code bloat that comes with it is neither needed nor wanted. But you're basically saying outright that you will have another stab at this. What you _should_ take on board instead:

- no tracking, full stop
- no huge PR without any prior discussion
- no features that no one has ever asked for
- no unnecessary code bloat"
835897610,835,SndChaser,2021-05-09T21:37:57Z,"@falkTX 

> to be fair, a few expressed consent of telemetry with self-hosted servers being ok.
> there is a division on this specific issue.

Yes, I think there might be a better way to move forward and make a tool that could accomplish the Audacity Team's goals without infringing on other's privacy.

My thought is what if instead of being built into the application directly, there was an extension system.  The extension system could allow the user to install things like a ""support tool"" that only provides crash reporting / debug info.  A ""feedback tool"" could provide more usage based information.  A ""cloud export tool"" could enable users to be able to send files to whatever cloud based storage they wanted. (This last item is something that Steve Daulton mentioned being requested by users before.)

The idea is that having this kind of system would keep this code off users systems unless they **specifically** decided to download and install it.

Of course, this doesn't directly address the infrastructure side of things...that is another issue that needs to be worked on."
835898440,835,Be-ing,2021-05-09T21:41:27Z,"> My thought is what if instead of being built into the application directly, there was an extension system.

Extensions add complexity. It is an annoying maintenance burden to keep API/ABI compatibility between the host application and externally maintained/installed extensions. I suggest using compile options with CMake instead."
835900157,835,SndChaser,2021-05-09T21:48:57Z,"@Be-ing 

> Extensions add complexity. It is an annoying maintenance burden to keep API/ABI compatibility between the host application and externally maintained/installed extensions. I suggest using compile options with CMake instead.

It does add complexity, however it has many advantages:

1. There's no lock-in on platforms where users generally don't build the code on their own (ie, Mac and Windows)
2. It doesn't require access to GitHub to submit new extensions
3. It puts more control over the code that's installed on their system in the user's hands.
3. A marketplace type system could take some pressure off the developers to chase after features that they don't feel should be in the Audacity core
4. It could provide Muse Group / Others with a way to provide ""value added"" add-ons
"
835900576,835,polyjitter,2021-05-09T21:50:46Z,"> The right amount of telemetry tracked in a manner that is fair and can be trusted could do good, this is just not it. Perhaps something as ""simple"" as a ""Send crash report"" button if Audacity crashes.

Crash reports are indeed a form of analytics and telemetry, so I hope everyone fighting against any form of analytics and telemetry are willing to debug based on hearsay..."
835901489,835,falkTX,2021-05-09T21:54:31Z,"> > The right amount of telemetry tracked in a manner that is fair and can be trusted could do good, this is just not it. Perhaps something as ""simple"" as a ""Send crash report"" button if Audacity crashes.
> 
> Crash reports are indeed a form of analytics and telemetry, so I hope everyone fighting against any form of analytics and telemetry are willing to debug based on hearsay...

You can use coredumps for when an application crashes and save them locally.
It is then up to the user to upload those, or not.

Users can have a choice if we give it to them.
"
835903339,835,Martin-Eckleben,2021-05-09T22:01:40Z,"Mentioned this on a twitter post from a linux mag asking tantacrul to give an interview.
Got blocked.
![image](https://user-images.githubusercontent.com/1571683/117588317-dd9d2580-b122-11eb-9df7-a7441f380b07.png)
"
835904332,835,SndChaser,2021-05-09T22:05:34Z,"@falkTX 
> You can use coredumps for when an application crashes and save them locally.
> It is then up to the user to upload those, or not.
> 
> Users can have a choice if we give it to them.

That's why I like the idea of an extension system...it gives the user the choice... Kind of the ultimate ""opt-in"" - it doesn't exist until the user adds it...  If they decide they don't want it, they remove it."
835904630,835,Qix-,2021-05-09T22:06:37Z,"@Tantacrul why did you ban users from your official discord when they were trying to have a conversation with the maintainers?

I'm seeing a pattern here.

---

![image](https://user-images.githubusercontent.com/885648/117588494-ec380c80-b123-11eb-8a32-3285c1879b88.png)

You should probably not speak this way to an army of people who are upset with you for violating their privacy. Good thing Github edits are public, though.

EDIT: he deleted the comment, lol. [Saved that too.](https://github.com/SndChaser/AudacityTelemetryComments/issues/2#issuecomment-835905864)."
835905166,835,Martin-Eckleben,2021-05-09T22:08:31Z,"> 
> 
> > Mentioned this on a twitter post from a linux mag asking tantacrul to give an interview.
> > Got blocked.
> 
> Ha. Yeah, you were following all my conversations and posting the same nonsense on all of them. I felt like not having to put up with that so I blocked you.

I posted two comments.
Not like I spewed conspiracy theory or spammed."
835908590,835,tsilvs,2021-05-09T22:20:05Z,"As a contributor to a project with such a large audience Tantacrul needs to have better developed soft skills.

Definitely this situation is a stressful one, but stress management is a helpful feat still. Crucial even.

Otherwise we can't really completely trust someone this unstable."
835909694,835,Be-ing,2021-05-09T22:23:32Z,"I opened a new issue to discuss how to clean up Audacity's dependency management: #853.

I think everything that needs to be said about this issue has been said already. I suggest locking the discussion now."
835910537,835,Qix-,2021-05-09T22:25:54Z,"@be-ing Consider x-posting to the fork. https://github.com/KXStudio/audacity

EDIT: Issues aren't enabled yet actually - @falkTX can you fix that?"
835911713,835,SndChaser,2021-05-09T22:29:35Z,"> As a contributor to a project with such a large audience Tantacrul needs to have better developed soft skills.
> 
> Definitely this situation is a stressful one, but stress management is a helpful feat still. Crucial even.
> 
> Otherwise we can't really completely trust someone this unstable.

Everyone needs to back down.  This PR is closed.  It's back to the drawing board to see where things go...  Muse Group now have a chance to address the concerns that have been brought up in this PR.  There is no reason to target anyone on the dev team."
835913219,835,efeklisov,2021-05-09T22:34:06Z,"> Definitely this situation is a stressful one, but stress management is a helpful feat still. Crucial even.

I’d even say Tantacrucial!
(Sorry)


On a serious note, I also think that telemetry should be implemented as an optional plugin or available only in a separate build for enthusiasts. Matters like supporting old OSX systems can be resolved with a poll."
835917857,835,BitesizedLion,2021-05-09T22:46:54Z,"This whole ""muse group"" situation is really sketchy in my opinion."
835921181,835,zearp,2021-05-09T22:54:25Z,I'm glad the maintainers have closed this for now. I do hope they come to their senses and abandon this idea completely. There is no need for tracking or a network stack in an audio editor.
835923381,835,Tantacrul,2021-05-09T22:59:02Z,"Incidentally, I'm doing what I can to make sure each of the community's requests are being heard but bear in mind that although I may be heading up the design and prioritisation of features, I'm not all-powerful and the solutions are not in my gift to give. That goes for the creator of this PR too. Best I can do is try to push for an outcome that will please as many people as possible."
835938323,835,geekredux,2021-05-09T23:29:42Z,"> Best I can do is try to push for an outcome that will please as many people as possible.

The PR votes and this comment thread seem to have made what that would be pretty clear. Thanks for the follow-up.

Edit: @Tantacrul, I will encourage you to clarify what your role on the Audacity project is, though. Your YouTube announcement video title declares you to be ""in charge of Audacity"", and your Twitter bio says you are ""the head of MuseScore and Audacity"". Both suggest that if you decided there should not be telemetry or a network layer added to Audacity, it would indeed be a gift you could give.
"
835959358,835,Be-ing,2021-05-10T00:07:22Z,"> a concrete plan will be published soon

Where will this be published? The Audacity forum (if so, in what category)? In a new GitHub Issue? One of the email lists?"
835979978,835,turtlegarden,2021-05-10T00:34:11Z,"This is closed, but this does _**NOT**_ mean that the Muse Group will not add telemetry. Tantacrul requested telemetry in the Muse Group Discord server (Discord? FOSS? Doesn't match at all!) so I do not believe they will give up."
835996960,835,eunakria,2021-05-10T00:56:15Z,"@foreverxml fwiw Discord is super common even among FOSS communities. It has a lot of issues, including its nature, being so vehemently proprietary that they've even spoken against client modifications like BetterDiscord that are based on the code of the official application, but hey, we're on GitHub, which is also almost completely proprietary.

Discord's a really useful place to get friends together and build communities and communicate, whatever its nature in licensing, and it's a perfectly valid choice for people who want half-decent, sustainably scaling chat, so I think that picking on it is a little undue.

That said, yeah, @Tantacrul definitely needs to offer a statement of clarification on this. The whole situation feels more than a little uncomfortable."
836040128,835,orenwatson,2021-05-10T01:20:21Z,"I would also like a full explanation given ideally to the press, perhaps the Register for example, of:
- the origins of Muse Group, a for-profit corporation in Cyprus
- who really are their primary shareholders
- how they bought the trademark ""audacity"" and
- what happened between buying the trademark at end of Dec 2020 and announcing this at April 2021."
836069326,835,Tantacrul,2021-05-10T02:10:54Z,"> > Best I can do is try to push for an outcome that will please as many people as possible.
> 
> The PR votes and this comment thread seem to have made what that would be pretty clear. Thanks for the follow-up.
> 
> Edit: @Tantacrul, I will encourage you to clarify what your roll on the Audacity project is, though. Your YouTube announcement video title declares you to be ""in charge of Audacity"", and your Twitter bio says you are ""the head of MuseScore and Audacity"". Both suggest that if you decided there should not be telemetry or a network layer added to Audacity, it would indeed be a gift you could give.

Sure. I propose the roadmap and many of the features (with help from others on our team) and I work with the community who collaborate on these things in addition to their own goals. I've been doing the same thing for MuseScore for a while now. However, because I'm in charge of Audacity and MuseScore, this does not mean that I run Muse. I work for Muse. Regarding Telemetry: this is a requirement that Muse have for every app in their ecosystem so they can determine how the changes we make are performing. I did not (as someone said above) 'request' it.

Now that this telemetry thing has kicked off, I'm trying my best to achieve a resolution that annoys as few people as possible. Then I want to get back to the roadmap so everyone can see what things we are planning and have the opportunity to comment on them. All I'm interested in is working on the design and feature set of Audacity.

Someone else is asking why we only announced recently, having started in late November. Answer is easy: transitions take time. A team needed to be hired. Skills needed to be learned. We needed to get to know the community and we all had to do a lot of research. Also... that announcement video took about a month to write and edit too.

I know I'm not answering every question people have asked here. I feel it's best to first get to the telemetry announcement as fast as possible and take it from there. The announcement _should_ happen this week."
836074105,835,jxu,2021-05-10T02:19:14Z,"Just because Muse owns the name of Audacity does not mean the community will have to automatically follow along, especially for self imposed nonsense like ""this is a requirement that Muse have for every app in their ecosystem so they can determine how the changes we make are performing."" 

I hope distro maintainers make the right choice and patch out or use a fork getting rid of this nonsense."
836074340,835,bkimmett,2021-05-10T02:19:37Z,"> Regarding Telemetry: this is a requirement that Muse have for every app in their ecosystem so they can determine how the changes we make are performing. I did not (as someone said above) 'request' it.

And here we arrive at why all this got started: this was requested by Muse Group.

However, it looks like Muse Group may have to come to understand that the community that uses Audacity does not want this.

Perhaps they'll have to arrive at a compromise? Or simply back down, in this case."
836079472,835,SndChaser,2021-05-10T02:27:53Z,"@Tantacrul

> Regarding Telemetry: this is a requirement that Muse have for every app in their ecosystem so they can determine how the changes we make are performing. I did not (as someone said above) 'request' it.

> Now that this telemetry thing has kicked off, I'm trying my best to achieve a resolution that annoys as few people as possible. 

I tried earlier to make certain that the depth of this issue is understand from the perspective of the open source community by providing a set of cases.  I'm afraid that document got buried in the landslide of comments on here.  Please have a read through the copy here: https://github.com/SndChaser/AudacityTelemetryComments/blob/main/DataCollectionVsTelemetry.md

It's a long document, nearly 10 pages, and yet it really on scratches the surface of how divisive the topic of telemetry is in the open source community.  I understand that Muse Group's primary applications so far have been on mobile platforms, and non-open source.  The concept of how to work with the open source community at large is a very foreign concept (I am, in fact, surprised things didn't blow up this way with the MuseScore community).

My best suggestion to the Muse Group is to slow things down...  Make small changes first, go through the backlog of issues, PR's and bugs.... Tackle those first while doing research to understand how to tackle larger changes in a way that will work for the community at large.
"
836085393,835,Tantacrul,2021-05-10T02:37:02Z,"> @Tantacrul
> 
> > Regarding Telemetry: this is a requirement that Muse have for every app in their ecosystem so they can determine how the changes we make are performing. I did not (as someone said above) 'request' it.
> 
> > Now that this telemetry thing has kicked off, I'm trying my best to achieve a resolution that annoys as few people as possible.
> 
> I tried earlier to make certain that the depth of this issue is understand from the perspective of the open source community by providing a set of cases. I'm afraid that document got buried in the landslide of comments on here. Please have a read through the copy here: https://github.com/SndChaser/AudacityTelemetryComments/blob/main/DataCollectionVsTelemetry.md
> 
> It's a long document, nearly 10 pages, and yet it really on scratches the surface of how divisive the topic of telemetry is in the open source community. I understand that Muse Group's primary applications so far have been on mobile platforms, and non-open source. The concept of how to work with the open source community at large is a very foreign concept (I am, in fact, surprised things didn't blow up this way with the MuseScore community).
> 
> My best suggestion to the Muse Group is to slow things down... Make small changes first, go through the backlog of issues, PR's and bugs.... Tackle those first while doing research to understand how to tackle larger changes in a way that will work for the community at large.

Wow. Thanks!

I apologise but I did miss this. Incidentally, there was some anger on the MuseScore forums too although we actually announced it upfront, which I feel came across as much more transparent. In this instance, a communication error led to a first-pass PR being made public which wrong-footed us all and prevented us from announcing it first to gauge reactions. It looked bad when it was discovered like it was."
836087112,835,geekredux,2021-05-10T02:39:48Z,"> Regarding Telemetry: this is a requirement that Muse have for every app in their ecosystem so they can determine how the changes we make are performing. I did not (as someone said above) 'request' it.

Hoo-boy, that's not going to appease anyone at all. But thanks for the response, @Tantacrul."
836091284,835,SndChaser,2021-05-10T02:46:27Z,"@Tantacrul
> I apologise but I did miss this. Incidentally, there was some anger on the MuseScore forums too although we actually announced it upfront, which I feel came across as much more transparent. In this instance, a communication error led to a first-pass PR being made public which wrong-footed us all and prevented us from announcing it first to gauge reactions. It looked bad when it was discovered like it was.

No apology necessary, I figured it might have been buried, or I posted it when you were (possibly) sleeping. ;)

Yes, clear communication is always a good first step.  IMO - there will always be noise around a topic this controversial, it's something that really should be expected. That puts the onus on the proposers to really approach the topic with serious and deliberate forethought.  That's something that didn't happen in this case."
836093515,835,asdf8dfafjk,2021-05-10T02:50:05Z,"While I'm sad that you have succumbed to the telemetry FUD vocal-sheeple-crowd that would not get the best feature prioritised, I wonder if anyone has recommendations (on unrelated note) to allow only whitelisted apps to connect to the network?	 "
836105118,835,Be-ing,2021-05-10T03:09:47Z,"I'll bring in a quote from [someone who might know a thing or two about managing a huge FOSS project](https://www.tag1consulting.com/blog/interview-linus-torvalds-open-source-and-beyond-part-2) (emphasis mine):
> The other big thing is that you have to be open. And I mean that in multiple ways. It's really easy to create some kind of ""clique"" of people, where you have an inner cabal that discusses things in private, and then you see really only the end result (or the fringe work) in the open, because all the important stuff happened inside a company or within a core group of people, and outsiders have a hard time breaking into that clique, and often have a hard time even seeing what is going on in that core group because it was so private and exclusive.
> It's one of the reasons I really like open mailing lists. Not some ""by invitation"" list. Not something you even have to sign up to participate in. Really open. And pretty much all the development discussions should be there.
> And finally, I think ""open"" is important in the sense of honesty. You don't want to play politics behind peoples back. *Be open about your motivations, be open about why you do things and what you do.* You don't have to like everybody you work with, and they don't have to like you, but *if people are open about what they are aiming for and what they do*, you don't necessarily have to always be best buddies - the most important thing is that you can trust each other.
> Because trust matters. A lot.

There has been a lack of transparency about what exactly the motivations for introducing telemetry are. If you are open about what exactly you are trying to accomplish, and start the discussion there rather than starting with 5500 lines of code already written, we may be able to help you figure out a way to do it in a way that is acceptable to the community. The caveat is that if your goals are directly opposed to the community's interests, we'd have to go our separate ways. So let's start with identifying what are the goals that might be accomplished using telemetry. From there, we can discuss the least invasive way to do that. That's how you can build trust. You may be surprised how much you can learn with a more focused approach to collecting data. It may be easier to find the needles when the haystack isn't so big."
836109757,835,SndChaser,2021-05-10T03:17:14Z,"@Tantacrul

Hopefully you are still lurking...  An issue that really should be worked on before telemetry is even approached again is de-vendoring the libraries that are being included in Audacity.  This is actually a massive issue....even bigger than I realized until a few minutes ago.

Currently there are only three of the top 100 Linux distributions shipping Audacity 3.x (Fedora, Mageia and OpenSUSE).  There are literally 97 other distributions out there that are still shipping Audacity 2.x (including: Arch, Debian, Ubuntu, Manjaro, and Mint).  Even if telemetry had been added it would have been irrelevant in the Linux world because the vast majority of the distributions can't ship the 3.x releases as they are because there are issues building it.

The reason is because Audacity is relying on specific libraries that they are bundling with the application, instead of working with the current releases of those libraries.  This mistake was going to be made again in this PR by vendoring libcurl as part of the implementation for the network-manager layer.

The likely reason this happened is because many of these libraries aren't natively part of Windows and MacOS.  So, the vendoring approach was taken in order to handle those platforms.

The way to fix this isn't going to be easy... The approach that would likely be the best would be to (a) de-vendor the libraries, (b) modify the build system to produce Flatpaks versions for MacOS and Windows.  This way the Flatpaks can include the libraries (and the most current version of them), while Linux versions can build against the native libraries. (At least this is my initial idea for fixing it -- others may have better ideas.)

"
836112638,835,Be-ing,2021-05-10T03:21:35Z,@SndChaser please take the discussion about devendoring dependencies to #853.
836117684,835,Qix-,2021-05-10T03:29:21Z,"> I apologise but I did miss this.

Not to stir the pot, but @SndChaser's comment was posted directly in the Audacity discord group within minutes of you interacting with the very same channel.

Going to be blunt: I don't believe you. I think you saw it and either chose not to read it, or you're trying to save face.

Of course nobody can read minds, so this is pure speculation. Either way, none of this is sitting right with me. It really feels like Muse is trying to save face here whilst still trying to keep ulterior motives under wraps.

The trust is permanently gone."
836119092,835,orenwatson,2021-05-10T03:31:39Z,"I will emphasize that Muse is in no position to ""require"" telemetry in a free software program, as all users are empowered to take and modify this software as we see fit, by the GNU GPLv2. Therefore, if we do not want telemetry, there will be no telemetry"
836122245,835,illwieckz,2021-05-10T03:36:31Z,"> > I would suggest to rename the PR as _Make possible for users to help the project by contributing anonymous usage if they want to_, this way the answers of people responding _I'm against_ with epidermal reaction like if they were on twitter would look funny at best.
> 
> Please read the discussion, it has already been established that the information being sent is not anonymous.

@mcilrain I'm not sure many people reacting there are knowing how GitHub works. This is a pull request, and then, a draft. If the data was not as anonymous as the stated goal said, then what people must ask for the proposed draft to be rewritten, or submit proposed change to fix the issue. Some people submitted suggestions indeed. I'm all concerned by those google and other things I've seen, but eh, that's a PR, the concern would be if that gets merged unmodified, not if the details of the implementation are made open to discussion…

There are clearly communication mistakes and problematic things in the former proposed draft, but here we are not on twitter and things are expected to be discussed politely and _edited_… We're not there to do crowded harassment and satisfy our own ego building-up our feeling of being better at judging this or that.

We're there to _help_ people making good software, including how to properly protect user data. That's because we are expected to _help_ the place is open to discussion. If pull-request threads were not for helping, GitHub would just be another social emotion dealing platform."
836124789,835,Be-ing,2021-05-10T03:40:45Z,@illwieckz please don't jump in at the end of a long contentious discussion ignoring even the most recent comments.
836127853,835,illwieckz,2021-05-10T03:45:49Z,"@Be-ing this is indeed addressing recent comments [like the one by asdf8dfafjk](https://github.com/audacity/audacity/pull/835#issuecomment-836093515) one hour ago: by reminding this is GitHub, it also means this is even not a place to ask for firewall recommendations…"
836132456,835,Cheeseless,2021-05-10T03:53:30Z,"@illwieckz this being GitHub has no bearing on the reality that the new maintainers of the project have no reason not to accept this PR outside of the outcry that is being raised, seeing as the whole telemetry package is being added on their command. 

If the acceptance or rejection of this PR was actually based on the soundness of its content in relation to creating good software, it would have been rejected fast enough to not receive any comments at all.

And telemetry has now been indicated, by @Tantacrul, to be a required component according to Muse. This means that unless they choose to listen due to this outcry, the telemetry will be added, which invalidates any claim you are making about GitHub's functionality being relevant to the situation."
836134301,835,illwieckz,2021-05-10T03:56:35Z,"> this being GitHub has no bearing on the reality that the new maintainers of the project have no reason not to accept this PR outside of the outcry that is being raised, seeing as the whole telemetry package is being added on their command.

I'm aware of this. I have read many of the comment there. But that's weird, people are acting like if they were on facebook, the best example being @Be-ing just downvoting comments because of not being happy when seeing this or that comment he probably didn't expected, despite I just [confirm what he said](https://github.com/audacity/audacity/pull/835#issuecomment-836105118) 40 minute ago and my comments were an addition on that topic so we are just agreeing…

This is not a place for the concern of being happy or unhappy."
836138239,835,Cheeseless,2021-05-10T04:03:19Z,"@illwieckz I think you make a fundamental misunderstanding about the nature of GitHub, and that of software development as well. Not all decisions that go into creating software are technical, they are often done on the basis of personal preference, intentional constraints, morals, ethics, and even financial interest.

At the end of the day, every tool humankind uses is an attempt to gain the means to happiness. That a modification to one such tool causes this level of unhappiness, no matter what the underlying reason may be, is plenty enough to take such a minimally intrusive action as making a comment on a PR on GitHub.

You're right, this isn't Facebook or Twitter. But that does not mean that projects are not driven by human goals, and therefore human emotions."
836139590,835,Be-ing,2021-05-10T04:05:42Z,I don't think a philosophical discussion about the nature of GitHub is helping anything right now.
836148778,835,illwieckz,2021-05-10T04:21:26Z,"> I think you make a fundamental misunderstanding about the nature of GitHub, and that of software development as well.  […] You're right, this isn't Facebook or Twitter. But that does not mean that projects are not driven by human goals, and therefore human emotions.

I know very well what you've said, [I even do conferences on those topics](https://unvanquished.net/building-a-community-as-a-service/) and [I know a bit about software development](https://github.com/illwieckz). It looks like most of the reactions about what I said are more focused on what people believe about me and less about what I said… I'm not there to discuss that. I have said what I assumed was useful to say in the matter of making this a better place for making useful contributions on the topic, not to start a thread about the nature of my own feelings, that was pretty the contrary, I wanted to lower the effect of feelings on the discussion. It looks like I can't help lowering the biases induced by feelings, then see you again."
836163545,835,orenwatson,2021-05-10T04:44:00Z,"I don't think that there is anything irrational or emotional in not wanting software to send user data to Google and Yandex. I think this is a matter of morality. It is immoral to send user data to exploitative ad networks-- even if they don't realize that it is a bad idea to click a ""yes"" button to doing so; as you are then attempting to exploit their trust in you."
836164526,835,Be-ing,2021-05-10T04:45:32Z,The Audacity maintainers have already agreed to not send data from Audacity users to Google Analytics or Yandex. So I don't think discussing that point any further is helpful.
836168146,835,orenwatson,2021-05-10T04:50:40Z,"The fact is, that they currently send data from Musescore users to ad networks."
836169499,835,illwieckz,2021-05-10T04:52:34Z,"So, what about renaming this PR the same way the PR description was edited? This would help lowering the misunderstanding from outside people to better focus on topic.

I suggested to rename to something like ”Make possible for users to help the project by contributing anonymous usage if they want to” instead of “Basic telemetry for the audacity”. This would help to make the thread constructive.

And if such suggested title doesn't fit well what is done, it means what is left to do is known, which is constructive as well."
836170211,835,orenwatson,2021-05-10T04:53:35Z,"The data sent is not anonymous, by the legal definition in GDPR."
836170906,835,Be-ing,2021-05-10T04:54:34Z,Okay I think it's time to lock this discussion. Nothing is being added anymore that hasn't been repeated many times already.
836171307,835,kneekoo,2021-05-10T04:55:09Z,"> 1. Telemetry is **strictly optional and disabled by default**. No data is shared unless you choose to opt-in and enable telemetry.

Awesome! Opt-in is the right way to do telemetry.

> ![image](https://user-images.githubusercontent.com/2660628/117440186-6312b100-af3c-11eb-884e-3db660a0cc1f.png)

This is bad. Anyone who worked in IT for a reasonable amount of time knows how people tend to click highlighted buttons. Telemetry should be neutral, so don't highlight any button.

> 1. Audacity is widely used across several platforms, but we have no information on the application stability.

This is poorly phrased. The first half mentions usage by platform, while the second half mentions stability. Did you mean ""stability by platform"", so based on the combination of usage and stability you know how to set priorities in fixing issues?

> 2. It is difficult for us to estimate the size of the user base accurately.

This is bad. Opt-in telemetry will never tell you anything accurate about the true size of the user base.

> 3. We need a way to make informed decisions about which OS versions to support. For example, can we raise the minimum version of the macOS to 10.10 to update the wxWidgets to the latest version?

Nice, this is a valid reason for telemetry. At the same time, you still can't tell if the collected telemetry is representative. This is why doing telemetry right is critical if you want more data - and it's still not fleshed out properly.

> 4. We have a known issue with the new file format introduced in Audacity 3.0. We found it with the great help of the community members on our forum. However, there is no way for us to estimate the impact of these issues on users. Is it just a random case? Do we need to rush the work on the recovery tool or help the users one by one? Or do we need to rethink the file format to make it safer and more easily recoverable?

This looks like the wrong approach because new features for version X don't warrant the effort of adding telemetry. They're supposed to be tested by the community, especially by those who can provide quality feedback.

> 1. We do not incorporate cross-site tracking, limiting the ability to identify the user by both Google and Yandex.

Why use these in the first place? An opt-in mechanism will limit the number of reports from the get go, because most people don't want telemetry features enabled. Why not start a telemetry service of your own, and see how it scales?

> 2. Yandex would only receive the “application opened” event to help us estimate the size of the user base.
> 3. Google would only receive:
>    a. Session start and end events;
>    b. Errors for debugging;
>    c. File formats used for import and export;
>    d. OS and Audacity versions;
>    e. Use of effects, generators, and analysis tools to prioritize future improvements;

These are fundamentally wrong. If someone enables telemetry and chooses Yandex, it means you only get the ""application opened"" event, which is useless in determining anything useful about Audacity's performance, stability and environment (OS). This makes it look like you want to determine market share more than anything.

> 4. We will consider replacing Google and Yandex with another service if we find one that fulfills our requirements - thanks for the suggestions and keep them coming.

This is completely wrong. Surely you are aware that feeding data into data-hogging companies is unacceptable for a lot of people. The point of telemetry should be to improve the development process, so if you want to maximize the amount of useful data to enable that, make the right choice from the beginning. Why complicate things by working with two different platforms, then migrate to another? It takes time and effort to handle those, so do that for your own service, which will also make more people happy and forthcoming with the telemetry feature.
"
836200904,835,StarWitch,2021-05-10T05:36:45Z,"For UX issues such as a UI where nobody can find a specific tool, telemetry won't tell you a single damn thing unless you're doing extremely invasive eye- or mouse-tracking, and frankly, I'm not even sure if robust libraries exist for such a thing on anything that isn't an Electron app. It will not actually help anything insofar as UX improvements any more than asking for feedback or doing proper first-time user testing. For crashes and bugs, there's always the classic crash reporter that so many apps already use.

You know what telemetry *is* useful for, though? Market share. I guarantee that Ultimate Guitar wants telemetry because it makes them look good to potential investors by demonstrating how much of a ""market share"" their new ""brand"" (Audacity) has, and how much time people spend using the app. Anyone who has actually worked with telemetry data knows this, including myself. In a very distant second, it can tell you if anyone is actually using a niche platform and if it's worth supporting at all - but again, that's mostly a side-effect of knowing your market share rather than a direct benefit.

Leave the telemetry at the door, apologize, and hope the FOSS community forgives the project over the next year. Maybe even consider removing telemetry from MuseScore as a sign of good-will.

If _not adding telemetry_ is unacceptable, then we can effectively consider this app ""free as in beer"" rather than ""free as in freedom"" as it's clear that this project no longer belongs to the community with a company shepherding it, but to a business more interested in taking over projects and talking down to the community. More of a Google than a Linux Foundation."
836220360,835,Sciss,2021-05-10T06:00:51Z,"> So, what about renaming this PR the same way the PR description was edited? This would help lowering the misunderstanding from outside people to better focus on topic.
> 
> I suggested to rename to something like ”Make possible for users to help the project by contributing anonymous usage if they want to” instead of “Basic telemetry for the audacity”. This would help to make the thread constructive.
> 
> And if such suggested title doesn't fit well what is done, it means what is left to do is known, which is constructive as well.

No because the hundreds of comments and thousands of downvotes belong to this PR as it was posed (and even before its text was made ""more nice""). The PR is closed. Start over with a new discussion of the planned changes."
836244433,835,illwieckz,2021-05-10T06:33:08Z,"The actual edited PR description also quotes the original PR description, nothing prevents the poster to do the same with the title.

Anyway, you're right, this PR is closed. So my PR title suggestion is now more about the title of the PR to be created after this one, and such talk must happen before the creation of the next PR, obviously.

From such clear statement about intentions (and not about means only like the initial PR title) it becomes possible de produce both a roadmap and ways to control the objectives are met."
836320657,835,domsson,2021-05-10T07:52:39Z,"> Regarding Telemetry: this is a requirement that Muse have for every app in their ecosystem so they can determine how the changes we make are performing. I did not (as someone said above) 'request' it.

-- [Tantacrul](https://github.com/audacity/audacity/pull/835#issuecomment-836069326)

> For UX issues such as a UI where nobody can find a specific tool, telemetry won't tell you a single damn thing unless you're doing extremely invasive eye- or mouse-tracking [...]. You know what telemetry _is_ useful for, though? Market share. I guarantee that Ultimate Guitar wants telemetry because it makes them look good to potential investors by demonstrating how much of a ""market share"" their new ""brand"" (Audacity) has, and how much time people spend using the app.

 -- [StarWitch](https://github.com/audacity/audacity/pull/835#issuecomment-836200904)

@StarWitch 
Thank you very much, this hits the nail on the head.

@Tantacrul 
Please see the above. That's what a lot of people here assume, simply because it logically makes sense. If we just look at the [Muse Group's product](https://mu.se/muse-products) page, we can see they indeed do love to boast numbers. This is something you _have_ to be open about, even if that means the community will disagree. Further, one huge question that is still on the table is _how_ Muse Group has even ""acquired"" Audacity, a free and open source project. Are the core maintainers, or some of them, now on Muse Group's pay roll? Who exactly is Muse Group and what is their vision for Audacity? What rights and power does Muse Group have over Audacity, exactly? All of this is confusing and should be cleared up - it is _directly_ relevant to the discussion at hand. For example, what if Muse Group won't back down about tracking, but the community won't either? 


"
836352962,835,famiu,2021-05-10T08:21:11Z,"> Further, one huge question that is still on the table is how Muse Group has even ""acquired"" Audacity, a free and open source project. Are the core maintainers, or some of them, now on Muse Group's pay roll? Who exactly is Muse Group and what is their vision for Audacity? What rights and power does Muse Group have over Audacity, exactly? All of this is confusing and should be cleared up - it is directly relevant to the discussion at hand. For example, what if Muse Group won't back down about tracking, but the community won't either?
>
This. Exactly how does one ""acquire"" a GPL project? Because from my understanding, it belongs to the contributors and only to the contributors."
836355997,835,illwieckz,2021-05-10T08:23:56Z,"> Further, one huge question that is still on the table is how Muse Group has even ""acquired"" Audacity, a free and open source project. Are the core maintainers, or some of them, now on Muse Group's pay roll? Who exactly is Muse Group and what is their vision for Audacity?

This is one of the most important questions about the future of Audacity.

For example, in 2010 the owner of the Nexuiz name sold it to a company, but the actual developers of the Nexuiz open source game were in fact contributors from the community and not involved in the deal. The new owner of the Nexuiz name released a game in 2012… without success, even Xbox 360 servers were shut down in 2013… Those who were developers of the original Nexuiz game before the selling of the name had to continue the development under another name ([Xonotic](https://xonotic.org/)) since the name was acquired by the other company. But while Xonotic is still more popular than the new Nexuiz the name transfer deal was about, it never recovered its visibility and reputation (even the French Wikipedia deleted the Xonotic page [three times](https://fr.wikipedia.org/wiki/Xonotic) because of lack of visibility). I even met people who mistakenly believed Xonotic was the non-community project…

Another story with similar effects even if the turn of events was different: old time contributors to OpenOffice had to pick a new name ([LibreOffice](https://www.libreoffice.org/)) when Oracle acquired the name in 2010 as part of Sun's catalog without interest for the development of the software itself. 10 years later, I've heard that there is still people to download outdated OpenOffice, as much as the ones downloading LibreOffice. I even met people not knowing about LibreOffice this year.

So, someone got the Audacity name, but what about the community?

I'm not in favor of a fork, because if Muse Group owns the Audacity name, the fork will never recover the decade old reputation of Audacity and recognition, there may even be people deleting the pages about the community fork every three years on third-party website like Wikipedia because of lack of reputation (so, chicken and egg problem). And the Audacity-named software would just lose all the contributions, owning the name of a dead project, like owning dead Nexuiz and dead OpenOffice.

This would be bad for Muse Group, bad for Audacity developers, bad for Audacity users. A fork would be bad for everyone and it would hurt the world for decades.

So, the real problem is, how to make Muse Group and Audacity community reconcile themselves. Maybe Muse Group may give up on this or that data that is not worth the loose of the contributors and users for example, and well, as people we may help Muse Group to know what must not be done and what is best to do. For sure I would not recommend users to give up on data protection. It's often better to know less about users but to keep the users.

On the other hand there is probably a place for an opt-out way to contribute some anonymous usage data to help making the software better, but yes that must be opt-out and truly anonymous."
836466532,835,domsson,2021-05-10T09:33:01Z,"> This. Exactly how does one ""acquire"" a GPL project? Because from my understanding, it belongs to the contributors and only to the contributors.

> This is one of the most important questions about the future of Audacity.

I agree and have therefore opened an [issue asking for clarification on the acquisition](https://github.com/audacity/audacity/issues/855). That should be a better place to discuss this topic than a closed PR for a tracking feature.
"
836481550,835,ewanm89,2021-05-10T09:46:26Z,"> 10 years later, I've heard that there is still people to download outdated OpenOffice, as much as the ones downloading LibreOffice. I even met people not knowing about OpenOffice this year.

Urm, outdated? Personally I prefer Libreoffice, but after oracle screwed it up for a few years it went to Apache foundation, most recent stable release: 4.1.9 (February 7, 2021; 2 months ago)"
836482661,835,jxu,2021-05-10T09:47:02Z,"How to ""acquire"" an open source project: buy out all the people who have
commit access

On Mon, May 10, 2021, 5:33 AM Julien ***@***.***> wrote:

> This. Exactly how does one ""acquire"" a GPL project? Because from my
> understanding, it belongs to the contributors and only to the contributors.
>
> This is one of the most important questions about the future of Audacity.
>
> I agree and have therefore opened an issue asking for clarification on
> the acquisition <https://github.com/audacity/audacity/issues/855>. That
> should be a better place to discuss this topic than a closed PR for a
> tracking feature.
>
> —
> You are receiving this because you were mentioned.
> Reply to this email directly, view it on GitHub
> <https://github.com/audacity/audacity/pull/835#issuecomment-836466532>,
> or unsubscribe
> <https://github.com/notifications/unsubscribe-auth/AB46VXQXSRXMSKSI6BH4JKLTM6R6PANCNFSM44C5SLTA>
> .
>
"
836556673,835,IGBC,2021-05-10T11:02:35Z,OK this PR is closed. But its link has been plastered all over the internet. I suggest to the devs this thread be locked. As I see it being a hotbed for drama for the foreseeable future.
836589805,835,ccoenen,2021-05-10T11:38:39Z,"I would like to highlight one post by @SndChaser which might also have been lost to the torrent of comments:

https://github.com/audacity/audacity/pull/835#issuecomment-835897610

The suggestion to make this not a compile-time decision but a plugin makes this much more OK for me. I am on the ""absolutely not tracking period"" train, and I think that that suggestion above can suit _both things at the same time_. The main Codebase would not be doing any networking. But people (and not just developers!) could opt-in to tracking very transparently.

I also think that crash reporting should be equally decoupled from the main codebase, if technically possible.
"
836604025,835,GalGreenfield,2021-05-10T11:54:16Z,"I haven't read the whole thread, but @crsib have you considered using other analytics solutions that don't sell user data? There are various such existing solutions."
836687462,835,StarWitch,2021-05-10T13:16:54Z,"@domsson Wow, I hadn't actually seen that site. It does not surprise me at all that download numbers and market share and put above the actual features of the apps. It is very clear where their priorities lie just from this, and their main site only confirms this.

Audacity may very well be in the slaughtering house now.

And please, core contributors, don't paint me or others in this thread as some kind of ""outsiders"" to Audacity. I've personally casually used it as a tool for over a decade. For you to turn around and tell your userbase that their opinions don't matter is extremely damning concerning the direction of this whole conversation and the FOSS community in general."
836967886,835,eevvoor,2021-05-10T16:59:04Z,I have used audacity for decades and am very disappointed.
837050025,835,asdf8dfafjk,2021-05-10T17:55:42Z,"OMG, this is the most hilarious virtue signaling thread I have seen in my entire life. Look at the bold statement making basement dwelling famiu. 

> This. Exactly how does one ""acquire"" a GPL project? Because from my understanding, it belongs to the contributors and only to the contributors.

Everyone, lest  this be forgotten, it's important to know  that famiu has, you guessed, exactly 0 commits. https://github.com/audacity/audacity/pulls/famiu. 

I hope all toxic losers who are in this thread (I guess all telemetry FUD spreaders) are losers like him. "
837052668,835,ccoenen,2021-05-10T17:57:26Z,"Not all contributions are code, you know? Also, GPL/AGPL and pretty much any other license is not about developers. It's about giving the general population rights. Look for the ""four basic freedoms"", if you need clarification."
837063121,835,IGBC,2021-05-10T18:03:58Z,"> I have used audacity for decades and am very disappointed.

This PR was rejected, before your comment, what are you disappointed about?"
837067858,835,tilda,2021-05-10T18:06:57Z,can this just be locked already? there's not much else anyone can really contribute to the discussion...
837072787,835,illwieckz,2021-05-10T18:10:08Z,"@asdf8dfafjk

> Everyone, lest this be forgotten, it's important to know that xxxx has, you guessed, exactly 0 commits.

You talked about commits on this project, but some people there only have like a handful of commits in a single repo and a handful of issues created on the whole GitHub over 10 years, others only have code related to school evaluations… And may have said others do not understand how GitHub works or how software development works…

This is what happens when people confuses GitHub with Twitter."
837073059,835,Martin-Eckleben,2021-05-10T18:10:17Z,"> 
> 
> OMG, this is the most hilarious virtue signaling thread I have seen in my entire life. Look at the bold statement making basement dwelling famiu.
> 
> > This. Exactly how does one ""acquire"" a GPL project? Because from my understanding, it belongs to the contributors and only to the contributors.
> 
> Everyone, lest this be forgotten, it's important to know that famiu has, you guessed, exactly 0 commits. https://github.com/audacity/audacity/pulls/famiu.
> 
> I hope all toxic losers who are in this thread (I guess all telemetry FUD spreaders) are losers like him.

@IGBC is that you drunk again? :D
(https://github.com/audacity/audacity/pull/856#issuecomment-836856813)

I had a good laugh I have to say :))
"
837110093,835,IGBC,2021-05-10T18:33:29Z,"@Martin-Eckleben  Nah I only have the one account, that one wasn't me. Besides I am _anti_ tracking @asdf8dfafjk is firmly pro."
837322132,835,jxu,2021-05-10T20:51:56Z,I'm disappointed I wasn't the target of a clearly troll personal attack on my commit history. 
837522369,835,famiu,2021-05-11T00:01:11Z,"> OMG, this is the most hilarious virtue signaling thread I have seen in my entire life. Look at the bold statement making basement dwelling famiu.
> 
> > This. Exactly how does one ""acquire"" a GPL project? Because from my understanding, it belongs to the contributors and only to the contributors.
> 
> Everyone, lest this be forgotten, it's important to know that famiu has, you guessed, exactly 0 commits. https://github.com/audacity/audacity/pulls/famiu.
> 
> I hope all toxic losers who are in this thread (I guess all telemetry FUD spreaders) are losers like him.

Oh wow. it seems nobody hugged you while you were growing up... That's just sad, buddy. It would be nice though if you kept that shitty personality of yours to yourself, that would save yourself a lot of embarassment"
837653043,835,turtlegarden,2021-05-11T02:17:26Z,"> OMG, this is the most hilarious virtue signaling thread I have seen in my entire life. Look at the bold statement making basement dwelling famiu.
> 
> > This. Exactly how does one ""acquire"" a GPL project? Because from my understanding, it belongs to the contributors and only to the contributors.
> 
> Everyone, lest this be forgotten, it's important to know that famiu has, you guessed, exactly 0 commits. https://github.com/audacity/audacity/pulls/famiu
> 
> I hope all toxic losers who are in this thread (I guess all telemetry FUD spreaders) are losers like him.

Oh wow! You work for Microsoft or something? Because there's reason to worry about ""annonymous"" telemetry (hint: not annonymous). Also, please keep your horrible personality to yourself. This is GitHub, and not Twitter."
837843122,835,julienbenjamin,2021-05-11T05:25:45Z,"> @asdf8dfafjk
> 
> > Everyone, lest this be forgotten, it's important to know that xxxx has, you guessed, exactly 0 commits.
> 
> You talked about commits on this project, but some people there only have like a handful of commits in a single repo and a handful of issues created on the whole GitHub over 10 years, others only have code related to school evaluations… And may have said others do not understand how GitHub works or how software development works…
> 
> This is what happens when people confuses GitHub with Twitter.

Or moved to GitLab after Github got bought."
838475883,835,turtlegarden,2021-05-11T13:27:40Z,"Yep, time to close this. But will it be closed?"
838662260,835,RubenKelevra,2021-05-11T15:16:50Z,"I don't see why there is so much backslash. We have this on browsers, which do process much more private informations than an audio editor.

It's opt-in anyway. If you don't want to share data either don't opt-in or compile it for yourself without the module :) "
838680722,835,falkTX,2021-05-11T15:27:28Z,"Read the backlog if you want to know why.
Not all of us are complicit and don't care. The amount of add-ons needed to make browsing the web a proper experience clearly shows browsers are not a model to follow.
"
838783331,835,BenBE,2021-05-11T16:25:27Z,"> I don't see why there is so much backslash.

Because the negative aspects very much outweigh the downsides. Read the discussion for more details.

> We have this on browsers, which do process much more private information than an audio editor.

And even with browsers there are enough people quite angry with the situation. But given the implications there (about 4 days for custom builds to remove tracking, when building from source on your own hardware and not everybody can manage this) there's unfortunately not much alternatives to choose from. But that's a different topic.

> It's opt-in anyway.

That's what the PR officially says. The actual patch had several issues that inverted this logic and thus made it active by default as well as anti-patterns that coerced the user to just click thru to enable it.

Oh, and that telemetry was neither anonymous (use of known advertiser services) nor was it limited to actual telemetry only: The PR includes an UUID per user, thus allows for tracking of installations.

> If you don't want to share data either don't opt-in or compile it for yourself without the module :)

Which brings us back to the browsers: Have you actually tried to build Audacity from source? Do you think this is a sustainable solution for the average user?

Overall there are much better alternatives to baking telemetry directly into the core application. One for example is having telemetry added by a plugin that the user consciously installs. This also has the advantage that everything the telemetry monitors would also be available by official APIs for other plugins to use. Doing it that way also guarantees the agreement to the collection of personalizable information under GDPR in conscious, informed and voluntary."
838792522,835,RubenKelevra,2021-05-11T16:31:51Z,"> Read the backlog if you want to know why.
> Not all of us are complicit and don't care. The amount of add-ons needed to make browsing the web a proper experience clearly shows browsers are not a model to follow.

Yeah sorry, not possible with this amount of comments. :/"
838799486,835,RubenKelevra,2021-05-11T16:36:57Z,"@BenBE alright, I see your point. I expected that the description was accurate. I have read some of the comments and it felt not really substantial what people complained about.

Maybe it's worth reworking this patch and run the collection on servers of the project instead of third party ones.

I do see a large benefit of collecting crash informations for example, since audacity isn't really that stable to begin with. There's room for improvement."
838822487,835,Nex4rius,2021-05-11T16:53:31Z,"> 
> 
> I don't see why there is so much backslash. We have this on browsers, which do process much more private informations than an audio editor.
> 
> It's opt-in anyway. If you don't want to share data either don't opt-in or compile it for yourself without the module :)

A doing bad things doesn't justify when B does bad things."
838826849,835,BenBE,2021-05-11T16:56:37Z,"> @BenBE alright, I see your point. I expected that the description was accurate. I have read some of the comments and it felt not really substantial what people complained about.

There's lots of virtue signalling in the comments, unfortunately.

> Maybe it's worth reworking this patch and run the collection on servers of the project instead of third party ones.

This PR introduces a full network stack into an application that successfully managed without one for over 20 years. Thus introducing one really should have a very good reason and given the expected overall quality of the collected information the data ain't the compelling reason in this matter. There are simply too many threads attached that negatively affect the quality of the collected data, thus there's much easier and worthwhile methods to produce even better statistics to base your decisions on.

Remains the part regarding crash reports:

> I do see a large benefit of collecting crash information for example, since audacity isn't really that stable to begin with. There's room for improvement.

One of the few points that I agree. Unfortunately even here you don't really need to introduce networking into the core application. To give one example: `htop` simply gives a backtrace, some basic information required for a bug report and instruction how to help to make the backtrace more informative (basically: How you call `objdump` - or its equivalent - on your platform so you can attach that file to the bug report). This gives the option for the user to opt-in sending the bug report and still manages to respect the freedom of the user to not being tracked by the application. If you want to make it more friendly for beginners you could even use a separate application that pops up just when the main application crashed (like Firefox and several other tools do), but even then the main application does not need any linkage to any networking stack.

And FWIW: The information that `htop` asks the user to provide usually helps to pin down the exact line of the crash within about 20 minutes, even when handling the `objdump` file by hand. Could be more convenient to do, but the fact is, that the actual bug reporting can and should be fully offline."
838860677,835,Daniel34M,2021-05-11T17:20:32Z,Seriously please close this pr. I think most of the possible arguments against this have already been established and I hope all the team work in favor of the comunity
838873004,835,Amolith,2021-05-11T17:28:40Z,"@Daniel34M 

> Seriously please close this pr. I think most of the possible arguments against this have already been established and I hope all the team work in favor of the comunity

[It has already been closed.](https://github.com/audacity/audacity/pull/835#issuecomment-835880865) I do, however, think it would be a good idea to lock the PR to prevent anyone from posting yet more comments; I agree that pretty much every possible argument on all sides has been made and we probably crossed that point a day or two ago."
840611009,835,crsib,2021-05-13T14:46:19Z,"Please, see our response:

https://github.com/audacity/audacity/discussions/889"
896713904,1384,crsib,2021-08-11T10:43:00Z,"Also, it looks like we should only allow Source Separation in Win64 builds"
958149413,1384,yannickfunk,2021-11-02T20:40:02Z,"Thank you guys for this amazing work! Would it be possible to implement a local model import without the neccesity to upload the model on huggingface? The team I work in could possibly use the feature to evaluate and demo the developed models, however, our models are strictly confidential so we shouldn't share the models on a third party platform."
959639189,1384,hugofloresgarcia,2021-11-03T16:25:05Z,"> Thank you guys for this amazing work! Would it be possible to implement a local model import without the neccesity to upload the model on huggingface? The team I work in could possibly use the feature to evaluate and demo the developed models, however, our models are strictly confidential so we shouldn't share the models on a third party platform.

@yannickfunk yes! It is (kind of) already possible to use your own local models. You would just have to recreate the repo file structure where deep models are stored (for example: `~/Library/Application Support/audacity/deeplearning-models` on mac). 

Regardless, I've opened an [issue](https://github.com/hugofloresgarcia/audacity/issues/70) to add a dialog that makes this a bit less hacky. "
993437529,1384,Paul-Licameli,2021-12-14T11:16:36Z,"I have been asked to contribute my review.  First thing I notice is CI build failure on three of four platforms, but a rebasing onto commit 6af68bd761642e5937710fa0cc8ef920efa9a5df or later should fix those spurious errors.
"
993808288,1384,hugofloresgarcia,2021-12-14T17:24:40Z,"@Paul-Licameli Hi Paul! Thank you so much for taking a look. 
I just rebased on 6af68bd761642e5937710fa0cc8ef920efa9a5df, but I don't think the Linux workflow is working yet.  

Here's the relevant error trace (from the [workflow log](https://github.com/audacity/audacity/runs/4523341718?check_suite_focus=true)): 
```
Deploying dependencies for ELF file /home/runner/work/audacity/audacity/build/package/_CPack_Packages/Linux/External/audacity-linux-3.1.1-alpha-20211214+6916b57-x86_64/usr/lib/audacity/libtorch_cpu.so 
terminate called after throwing an instance of 'std::runtime_error'
  what():  Failed to run ldd: exited with code 1
linux/create_appimage.sh: line 98: 14015 Aborted                 (core dumped) linuxdeploy --appdir ""${appdir}""
CMake Error at /home/runner/work/audacity/audacity/linux/package_appimage.cmake:27 (message):
  Could not create AppImage.  See output above for details.
```

Any clues? "
993841602,1384,crsib,2021-12-14T18:05:49Z,">Here's the relevant error trace

Let's ignore Linux for now"
996654061,1384,Paul-Licameli,2021-12-17T11:34:12Z,"I pushed a suggested commit on the end.  This shows how to put the new effect and analyzer into a module that is still part of the top-level ALL_BUILD but compiled into a separate dynamically loaded library and optionally loaded at startup.  See commit comments for other details.
"
1005676661,1384,Paul-Licameli,2022-01-05T13:16:09Z,"I have pushed a few easy cycle-breaking commits onto the branch, and this is the improved dependency graph, but not yet free of cycles.
![graph dot](https://user-images.githubusercontent.com/11670369/148223625-0cf2223e-2d13-4221-8fbc-6f74314d7f9d.gif)

"
1006165116,1384,Paul-Licameli,2022-01-05T23:46:19Z,"I'm done reviewing ModelCard, the first step in my upward topological sort of that dependency graph.  Which file should I do next?
"
1007838854,1384,Paul-Licameli,2022-01-08T00:25:22Z,"Doxygen output is much improved!

The last piece I need to review is the ModelManager, and I might suggest a way to break the remaining dependency cycle among the files.
"
1008164817,1384,Paul-Licameli,2022-01-08T22:24:37Z,"@hugofloresgarcia , I would like you to review two new commits from me now, with a suggested fix for the dependency graph.  By adding one more file pair, ActiveModel, and one use of indirect function call (giving the ActiveModel object a ""listener""), I make the graph nicely acyclic.

![graph dot](https://user-images.githubusercontent.com/11670369/148661969-cf18ed83-f238-4f9e-bb00-3b115333e66b.gif)"
1008211669,1384,Paul-Licameli,2022-01-09T01:57:41Z,"At last, my review of this project is complete!
"
1011579765,1384,Paul-Licameli,2022-01-13T00:32:43Z,"@hugofloresgarcia I have not yet caught up in a second round of review of your anwsers to my suggestions -- let me know when the branch is stable and I should do it.

Meanwhile I have pushed two more suggested commits.

The first is a cherry-pick from the master, which will disappear from this branch if you rebase it onto latest master.

The second makes use of the new utility defined in the first, to simplify the sending of messages from ActiveModel, which is the class I introduced to break dependency cycles.

This is the well known ""Observer Pattern"" in action -- it is a great friend for the breaking of cycles, and I use it so often I wrote a new class template to help generate instances of it.

It often happens that something UI related, like the dialog here, needs to be at the higher level of the dependency graph, and so it is the ""subscriber"" to messages that are ""published"" by the lower level object (here ActiveModel) which ought to implement the core logic of the program and not have unnecessary dependencies on the UI code.

In well structured code, the flow of control often goes in the opposite direction to the static build-time dependency arrows, and indirect function calls through pointers make this possible.
"
2413152268,1384,LWinterberg,2024-10-15T07:53:40Z,"Hello! We just [switched master to 4.0.0](https://forum.audacityteam.org/t/master-has-been-switched-to-4-0-0-development/120444) which makes this PR incompatible and/or obsolete as we're switching UI framework and reorganizing large parts of the codebase. 
"
1470455176,4414,Paul-Licameli,2023-03-15T17:27:25Z,"That completes just an overview of the final state of the source tree.  I didn't yet study each commit.

Is this all, or will there be other pull requests for other parts of the project?
"
1474011102,4414,Paul-Licameli,2023-03-17T15:25:45Z,My first round of review is complete.  There is a lot to fix.  I do not object if you force push onto recent master and resolve all the conflicts before the next round.
1474368696,4414,crsib,2023-03-17T20:23:27Z,"I have composed a list of tasks based on your review comments and some leftovers TBD after rebasing onto the master branch. The branch is now in the following state. 

- [x] [final not override in RegistryVisitor](https://github.com/audacity/audacity/pull/4414#pullrequestreview-1341961138)
- [x] [Add comment to lib-snapping CMake](https://github.com/audacity/audacity/pull/4414#pullrequestreview-1342018838)
- [x] [Add @pre to auStaticText::ScaleFont](https://github.com/audacity/audacity/pull/4414#pullrequestreview-1342905108)
- [x] [SetProjectCommand::Apply missing the SetRate](https://github.com/audacity/audacity/pull/4414#pullrequestreview-1342921648)
- [x] [AUPImportFileHandle::Import misses SetRate](https://github.com/audacity/audacity/pull/4414#pullrequestreview-1342922711)
- [x] [Fix second commit compilation](https://github.com/audacity/audacity/pull/4414#pullrequestreview-1343688038)
- [x] [Use Pref for the `/SelectionToolbarMode`](https://github.com/audacity/audacity/pull/4414#pullrequestreview-1344519663)
- [x] [Missing SetName on pCtrl in SelectionBar.cpp](https://github.com/audacity/audacity/pull/4414#pullrequestreview-1344583092)
- [x] [Avoid repetition of `ProjectTimeSignature::Get(mProject)`](https://github.com/audacity/audacity/pull/4414#pullrequestreview-1344650397)
- [x] [Check `cassert` in SelectionBar.cpp](https://github.com/audacity/audacity/pull/4414#pullrequestreview-1344671484)
- [x] [Comment `bool snapped` in SnapUtils.h](https://github.com/audacity/audacity/pull/4414#pullrequestreview-1344701328)
- [x] [Remove the comment about AS_SetSnapTo](https://github.com/audacity/audacity/pull/4414#pullrequestreview-1344729708)
- [x] https://github.com/audacity/audacity/pull/4414#pullrequestreview-1344731218
- [x] [Break TrackPanel dependency in project selection manager](https://github.com/audacity/audacity/pull/4414#pullrequestreview-1344739123)
- [x] [Relace NumericTextCtrl to ComponentInterfaceSymbol in Snap.h](https://github.com/audacity/audacity/pull/4414#pullrequestreview-1344766859)
- [x] [Fix `XO(""%d"")` in device prefs](https://github.com/audacity/audacity/pull/4414#pullrequestreview-1344840235)
- [x] [Fix L10n in SnappingToolbar](https://github.com/audacity/audacity/pull/4414#pullrequestreview-1344927775)
- [x] [Fix the comment in TimeSignatureToolbar.h/cpp](https://github.com/audacity/audacity/pull/4414#pullrequestreview-1344929149)
- [x] [Fix L10n in TimeSignatureToolbar](https://github.com/audacity/audacity/pull/4414#pullrequestreview-1344944377)
- [x] Remove beats and measures from interface preferences
- [x] Hook beats and measures with the time signature toolbar
- [x] Missing `window.RedrawProject();`
- [x] Undo/Redo for time signature
- [x] [Complete ReadSnapToSetting](https://github.com/audacity/audacity/pull/4414#pullrequestreview-1344675455)
- [x] Correctly handle the time signature in NumericConverter
- [x] Fix ProjectRate settings (final design TBD)"
1474402015,4414,Paul-Licameli,2023-03-17T21:04:58Z,"Here's another thing I overlooked:  at the commit ""SelectionBarListener no longer controls snapping"", you delete the call to `SnapSelection()` in `AS_SetSelectionFormat()`.  I think this means that when you change selection format in the toolbar, the selection fails to update for the changed granularity of snapping."
1474406590,4414,Paul-Licameli,2023-03-17T21:11:06Z,"At ""Removes project rate from the selection toolbar"", you can remove `#include ""SelectionBar.h""` from ProjectFileManager, SetProjectCommand, ImportAUP
"
1474410637,4414,Paul-Licameli,2023-03-17T21:16:47Z,"At ""SelectionBarListener no longer controls snapping"" you can remove `#include ""ProjectSelectionManager.h""` from PluginMenus"
1474415271,4414,Paul-Licameli,2023-03-17T21:22:58Z,"I have done the work of rebasing #4379 onto your latest draft and expect that if your branch still changes, there will be much less work to rebase again.
"
1474416890,4414,crsib,2023-03-17T21:25:19Z,"> Here's another thing I overlooked: at the commit ""SelectionBarListener no longer controls snapping"", you delete the call to `SnapSelection()` in `AS_SetSelectionFormat()`. I think this means that when you change selection format in the toolbar, the selection fails to update for the changed granularity of snapping.

The point of this PR is to make snapping to be independent from the selection format, so I don't really get your point "
1474431851,4414,Paul-Licameli,2023-03-17T21:46:22Z,"> > Here's another thing I overlooked: at the commit ""SelectionBarListener no longer controls snapping"", you delete the call to `SnapSelection()` in `AS_SetSelectionFormat()`. I think this means that when you change selection format in the toolbar, the selection fails to update for the changed granularity of snapping.
> 
> The point of this PR is to make snapping to be independent from the selection format, so I don't really get your point

Rebasing my branch onto yours made me think something was missing.

You are right about the independence that we now want.

What should replace the deleted line is a subscription to `SnapChangedMessage` and re-snapping the selection in response.

And, that is indeed done.

"
1474434833,4414,Paul-Licameli,2023-03-17T21:49:07Z,"`mSnapModeChangedSubscription` is perhaps a misleading variable name -- the subscription will correctly fire either for change of mode, or change of snapping unit.
"
1474439282,4414,crsib,2023-03-17T21:55:18Z,"> And, that is indeed done.

So why this comment? 

> mSnapModeChangedSubscription is perhaps a misleading variable name

I don't quite agree, but I will change that to `mSnappingChangedSubscription` on Monday."
1474521701,4414,Paul-Licameli,2023-03-17T23:47:49Z,"> > And, that is indeed done.
> 
> So why this comment?
> 
> > mSnapModeChangedSubscription is perhaps a misleading variable name
> 
> I don't quite agree, but I will change that to `mSnappingChangedSubscription` on Monday.

Sorry I got confused.  Ignore the suggestion if you wish."
1474875828,4414,petersampsonaudacity,2023-03-18T15:15:07Z,"@crsib @Paul-Licameli 

I have been testing Dmitry's latest branch build with the updated bottom tooldock: audacity-win-3.3.0-alpha-20230317+745c285-x64

I have a couple of immediate observations:

### 1) the Selection toolbar is using **hh.mm.ss + milliseconds** as its default setting.  
This is a regression bug already reported:
 **Default time format in Selection toolbar (and Generators) changed to hh:mm:ss + hundredths** #4408 

This is fixed by a 3rd party pull request (that has not made it into master yet):
 **fix default time format and TimeAndSampleFormat index** #4413 

![image](https://user-images.githubusercontent.com/50205984/226114540-0ef47ab4-6973-4a72-941d-a0bfbefb6a5c.png)
----------------------------------------------------------
### 2)  The default time format for the Time toolbar has been changed from **hh:mm:ss** **xxx,xxx.xxx seconds**
Logged (so we can track this) as:
 **Reset Configuration does not use the proper time format for the Time toolbar** #4426 

This change results in a much smaller font display (for the same toolbar size) - and one that is probably a lot less useful to most users.

The oddity here is that if I clear the audacity settings folder then I still get the nice old **hh:mm:ss** time format for Timer toolbar.
**_BUT_** if I then use **Tools > Reset Configuration** it changes to the **xxx,xxx.xxx seconds**

**UPDATE**
Further testing shows this is a regression on 3.2.4 introduced in 3.2.5

Might this be related to the issue in 1) above?  I.e. introduced as a result of the new **seconds + milliseconds** time format.


---------------------------------------------------------------------------------
### 3) Display oddity with Snap
Logged (so we can track this) as:
 **Display oddity with Snapping toolbar when turning snapping off** #4427 

Also note if you turn **Snap** on with a chosen snap format and then turn it if you are left with a residual blue background the size of the text of the now defunct **Snap** format:

![image](https://user-images.githubusercontent.com/50205984/226114872-08cb49c5-d88a-447f-a265-2d3c60b84e79.png)



"
1474879507,4414,petersampsonaudacity,2023-03-18T15:31:42Z,"I have set a raft of P1s in the Manual for the many changes that will be needed when this revised bottom tooldock makes it to master _(presumably for the upcoming 3.3.0)_

I will not work on this until the updated lower tooldock has stabilized."
1479309080,4414,DavidBailes,2023-03-22T10:37:58Z,"Some accessibility issues:

TIME SIGNATURE TOOLBAR

Screen readers do not read the names of the two wxSpinCtrls. I don't know of a quick fix for this. Normally the fix for being able to have an accessibility name where there is no visible label is setting WindowAccessible as the control's accessible object. Alas in this case, this doesn't work as it sets the accessible name of the spinner control rather than the text box which is the focus.
On Windows, by default, wxWidgets uses a native control for a wxSpinCtrl. From include\wx\msw\spinctrl.h:

// Under Win32, wxSpinCtrl is a wxSpinButton with a buddy (as MSDN docs call
// it) text window whose contents is automatically updated when the spin
// control is clicked.

(In contrast for a wxSpinCtrlDouble, on Windows wxWidgets uses a generic control. In this case, the structure is a window containing a text box and a spinner thing. With a visible label, the accessibility name of the containing window is automatically set to this label. This is no good, since again the text box is again the focus. However one can derive a class from wxSpinCtrlDouble, where one has access to the text control, and so make it accessible by setting a WindowAccessible as the text control's accessibility object, and overriding SetName to set the name of the text box.)

SNAPPING TOOLBAR

1. Was a check box chosen in preference to a toggle button because its state is clearer to see? (A toggle button could have been pressed using Enter, a standard keystroke for a button).

In the realtime effect dialogs, a keyboard user has to use a platform dependent keystroke to interact with controls which normally accept Spacebar. (On MacOs, for buttons and check boxes, Option + Spacebar;  On Windows, using either standard or full defaults, for check boxes, Ctrl + Spacebar; On Xubuntu, for check boxes, Enter.) Users of screen readers also have another alternative, but I'm ignoring this here, as the application needs to be keyboard accessible whether of not a screen reader is in use.

For the Snapping checkbox, I see that Enter can be used, without the need for a platform dependent keystroke. Is it intended that this can also be used in the realtime effect dialogs? (This would rely on them remaining without a default button.)

2. It would be better if the snapping interval drop down list had an accessibility name such as ""snapping interval"" or whatever the best name is for this, rather than an empty name.

SELECTION TOOLBAR

It would be more convenient if the two numeric controls were adjacent in the tab order (as they are in previous versions of Audacity) - ie a tab order of: setup button, first numeric control, second numeric control."
1482568619,4414,dozzzzer,2023-03-24T10:20:30Z,"@crsib It seems that snapping logic disregards the lower time signature value.
For example, let's set snapping value equal to **1 Bar** and look how snapping works when **4/4** time signature is set:
![2023-03-24_10-41-01 (1)](https://user-images.githubusercontent.com/70063970/227493269-4624be65-a4cd-4c2d-a5d7-5092c1c350dd.gif)

Now, let's change the lower time signature value to a half of the previous one, i.e. time signature now is 4/2. Observe how selection now snaps to half the value, i.e. 1/2 Bar while visually it remains the same as in previous example:

![2023-03-24_11-19-30 (1)](https://user-images.githubusercontent.com/70063970/227495172-3d6f110c-b77a-4883-b4c2-f5b1660db49a.gif)


"
1482570909,4414,crsib,2023-03-24T10:22:20Z,What exactly is Tempo is discussed right now :-)
1482588996,4414,Paul-Licameli,2023-03-24T10:36:50Z,"I have fetched the most recent force-push, and it only affects the commits I have not yet reviewed thoroughly.

A general comment.

The BeatsFormatter ends up in lib-numeric-formats anyway, despite the effort of making a registry.  And in the commit following that one, there is intrusion in NumericConverter.h to finish whatever is happening here.

The purpose of a registration system is open-endedness, but this does not completely realize it.

I don't say this problem must be completely cured for release but the organization could be reconsidered later.
"
1482596179,4414,crsib,2023-03-24T10:42:57Z,"Why the location of the file affects open endianness? It can be moved into a different library with no effort.  The reason I have started the crusade against `NumericConverter` is it's extreme level of unreadability and heavy reliance on the global state. I could've modified the original implementation, but that would be similarly complex and likely more error prone. 

As you can observe, beats format cannot be represented within the current framework used by NumericConverter.
"
1482599124,4414,crsib,2023-03-24T10:45:30Z,"And I had impression that we are doing a step-by-step work, not all or nothing. Otherwise I am confused about the amount of the UI details NumericConverter had after being split from the control."
1483179835,4414,Paul-Licameli,2023-03-24T17:39:43Z,"> And I had impression that we are doing a step-by-step work, not all or nothing. Otherwise I am confused about the amount of the UI details NumericConverter had after being split from the control.

Indeed we do incremental work, and you leave this code better than it was, although some dependencies among the green libraries still seem less than ideal to me.

If it is too difficult now to follow every suggestion to achieve what I think is better organization, it can be done later.  It won't be the first pull request just to reorganize libraries, as you surely know.

If UI details were still in lib-numeric-formats, it's because I wasn't pursuing perfection but I was doing sufficient to make a green library and unblock the extraction of lib-effects into the green, which was a very big prize.
"
1483819059,4414,Paul-Licameli,2023-03-25T13:04:38Z,"Regarding the doubts about the loss of the translatable string, when putting only the identifier part of `NumericFormatSymbol` into a wxEvent:

Really, `NumericFormatSymbol` is an unnecessary type, and formats should be identified simply by a `TaggedIdentifier` type.

See commit 0fb02a8024a442c571ed6e6dbd53c55da9f4a093 from 2017 where I changed `XO(""seconds"")` to `{ XO(""seconds"") }` and similar in the big table of formats, changing plain strings (`XO` expanded then just to `wxT`) with identifier-translatable pairs.  The commit comment explains that translated strings were getting stored in the .cfg file, but that was wrong:  locale-independent identifiers should have been used.

But in fact the `Msgid()` function is never used for those symbols.  This isn't very easy to prove, but I have prepared a few buildable commits transforming the code to prove it to myself.

Now I don't know whether the translations were otherwise used in 2017, but maybe they weren't -- in which case, the real ancient mistake, traceable to 2010, was that these strings were just marked for i18n unnecessarily.

I no longer want to add commits to your branch, but will prepare my own pull requests to make this simplification as a code quality improvement that isn't necessary for 3.3.
"
1483821290,4414,crsib,2023-03-25T13:15:48Z,"We do use those strings for labels, so they have to be translated. We could've had 2 strings instead - one for id and the second for display purposes, but it is not how it works now."
1483831248,4414,Paul-Licameli,2023-03-25T13:55:29Z,"> We do use those strings for labels, so they have to be translated. We could've had 2 strings instead - one for id and the second for display purposes, but it is not how it works now.

Right, some of what I said was nonsense.

What's not nonsense is that NumericFormatSymbol requires much less widespread use.

The sole place where the translation does affect anything is where `NumericTextCtrl::OnContext` visits the registry.

In fact the type could be eliminated and `NumericConverterRegistryItem` could just expose an `Identifier` and a `TranslatableString` separately.

That's what I really proved to myself with the help of some code changes and the compiler.
"
1483831852,4414,Paul-Licameli,2023-03-25T13:58:17Z,"I have pushed a commit, just a small and unimportant fix for a bug that was prior to this pull request.
"
1483889471,4414,Paul-Licameli,2023-03-25T18:19:24Z,"AND I'M DONE WITH THIS ROUND.

I need to reread all my comments and decide which ones I must really insist on and which are only suggestions.  I may get to that Tuesday.  Between now and then you may force push a branch with any fixes you agree with, perhaps squashed into the history.
"
1483890550,4414,crsib,2023-03-25T18:23:39Z,Please read my replies as well 
1484782168,4414,crsib,2023-03-27T09:09:41Z,"Sorry, pressed the re-review button by accident"
1484839462,4414,DavidBailes,2023-03-27T09:49:50Z,"> Screen readers do not read the names of the two wxSpinCtrls. I don't know of a quick fix for this.

When there is a text label in front of wxSpinCtrls, screen readers read the label without any extra code - Windows automatically sets the accessibility name of the text box.

When there isn't a label, something along the lines of the following seems to work. This is part of my code that I wrote just to test the idea:
```
class MyNativeWindow : public wxNativeWindow
{
public:
    MyNativeWindow(wxWindow* parent,
        wxWindowID winid,
        wxNativeWindowHandle handle) :
        wxNativeWindow(parent, winid, handle) {}

    bool AcceptsFocus() const override { return false; }
};


class  MySpinCtrl : public wxSpinCtrl
{
public:
    MySpinCtrl(wxWindow* parent,
        wxWindowID id = wxID_ANY,
        const wxString& value = wxEmptyString,
        const wxPoint& pos = wxDefaultPosition,
        const wxSize& size = wxDefaultSize,
        long style = wxSP_ARROW_KEYS,
        int min = 0, int max = 100, int initial = 0,
        const wxString& name = wxEmptyString) :
        wxSpinCtrl(parent, id, value, pos, size, style, min, max, initial, name)
    {
        mNativeWindow = new MyNativeWindow(parent, wxID_ANY, m_hwndBuddy);
#if wxUSE_ACCESSIBILITY
        mNativeWindow->SetAccessible(new WindowAccessible(mNativeWindow));
#endif
    }

    ~MySpinCtrl()
    {
        mNativeWindow->Destroy();
    }

    void SetName(const wxString& name) override
    {
        mNativeWindow->SetName(name);
    }

private:
    MyNativeWindow* mNativeWindow{};
};
```"
1488980329,4414,Paul-Licameli,2023-03-29T17:05:37Z,"I'm working in the last big commit.  Meanwhile, of the unresolved things above, at least please add more i18n-hints for:

""Beats"" ""beats"" ""beats and 16th""

Be sure each comment has `i18n-hint` not `i18-hint`

And you can incidentally fix some other old similar errors in those comments in LibraryPrefs.cpp and UpdateNoticeDialog.cpp

And, as I look at new strings for i18n, now I wonder if we might improve appearance a bit with Unicode fractions for 1/2, etc. ?

See already in ChangeSpeed.cpp: `XO(""33\u2153"")`
"
1489301379,4414,Paul-Licameli,2023-03-29T20:53:08Z,"DONE.

Now I need to self-review my own unresolved comments and decide which ones I feel strongly about.  That would include at least the i18n-hint comments, maybe no others now.

Take or leave my minor style suggestions.  Make a commit with those, and at this point I don't insist on squashing the history.
"
1489467858,4414,Paul-Licameli,2023-03-29T23:26:19Z,"Now I’m done reviewing my own comments and resolving what I don’t care about.  Please read the rest, though some (especially recent ones) aren’t of high importance.


"
1490805515,4414,Paul-Licameli,2023-03-30T19:17:50Z,That’s all for this round 
1491070611,4414,Paul-Licameli,2023-03-30T22:56:27Z,"I see the last two commits.  Nothing to add.

Am I waiting for a change to fix the unit tests or can I formally approve now?"
1491353651,4414,crsib,2023-03-31T06:13:02Z,"Unit tests work now, so I think this one can finally be approved ☺️"
1491820483,4414,crsib,2023-03-31T12:00:14Z,">  I didn't see before.

There was commit literally named ""Use 1/4 for BPM basis in Snapping"". It was before 66a4c611380fda90d455695233e636cbfa3b5840 in the current sequence."
1491831439,4414,Paul-Licameli,2023-03-31T12:08:48Z,"Still an incorrect commit comment in the squash :-)

""Rename mSnapModeChanged to mTimeSignatureChanged""

I'm too fussy
"
1491833264,4414,DavidBailes,2023-03-31T12:10:14Z,@crsib . Thanks for the accessible spin control!
1491842767,4414,Paul-Licameli,2023-03-31T12:18:16Z,"There is ""eplicit"" misspelled also in one commit comment.

More importantly:  I see the changes of assertions in AudioIOBase.cpp, but I don't see the changes in the AudioIO mock initialization that I expected to see too.

So I think this only hides a known assertion violation in tests, but arguably tests should be compiled with assertion checking enabled and should be made to pass under those stricter conditions.

I will not block approval of the PR for this.

"
1491848967,4414,crsib,2023-03-31T12:23:45Z,">  but I don't see the changes in the AudioIO mock initialization that I expected to see too.

I've planned to try, not to implement them. In order to call HandleDeviceChange I would need a full AudioIO, I want to keep the dependencies for the tests as small as possible.

> but arguably tests should be compiled with assertion checking enabled and should be made to pass under those stricter conditions.

We do not build different set of libraries for tests, which makes a lot of sense, because we test exactly what we ship. 

The better question is why that assertion is correct. "
1491860548,4414,Paul-Licameli,2023-03-31T12:34:04Z,"> > but I don't see the changes in the AudioIO mock initialization that I expected to see too.
> 
> I've planned to try, not to implement them. In order to call HandleDeviceChange I would need a full AudioIO, I want to keep the dependencies for the tests as small as possible.

Maybe some essential part of that function could be demoted into lib-audio-devices.

> 
> > but arguably tests should be compiled with assertion checking enabled and should be made to pass under those stricter conditions.
> 
> We do not build different set of libraries for tests, which makes a lot of sense, because we test exactly what we ship.
> 
> The better question is why that assertion is correct.

"
1491862815,4414,Paul-Licameli,2023-03-31T12:36:01Z,"Actually that wasn't the end of the epic
"
999391475,2295,Paul-Licameli,2021-12-22T08:42:08Z,"In the PR comment, remember to write only one issue number in each “Resolves:” line, so that automatic updating of project boards mentioning this issue are correct."
1009436880,2295,Paul-Licameli,2022-01-10T23:11:36Z,"I pushed a small commit on the end to fix an incorrect comment in EffectInterface.h.

As you may know by now, ""Automation"" is unfortunately used in Audacity's code to mean the saving of settings for purposes of macros, but the settings are not meant to vary during the application of the effect, as with an ""automation track"".  Misleading terminology.

"
1009526601,2295,Paul-Licameli,2022-01-11T01:50:30Z,"I'm done with my first round of review of this draft PR !
"
1025055852,2295,Paul-Licameli,2022-01-30T02:50:55Z,"Second round of review, done!

Please see the comments from the first round that I did not resolve.

I expect some minor build problems rebasing this onto recent master, such as the need to add `noexcept` to some of the overrides of EffectProcessor now.

I would like to keep round three of review short.  The Linux UI difficulties, if they can be solved -- let them be in another pull request.
"
1031772623,2295,Paul-Licameli,2022-02-07T18:17:56Z,"I'm done with another round of review of new code.  I have not yet reviewed again all of my older comments and marked them resolved as appropriate.
"
1035558184,2295,Paul-Licameli,2022-02-10T21:50:24Z,"The commit ""VST3 plugin modules loading"" now fails to build because internal/ComponentHandler.h does not yet exist, but deleting just that #include is enough to fix the commit.

The next commit ""VST3 processing"" needs to put the #include back.

""VST3 UI"" fails to build because PluginSettings was not in VST3Effect.cpp, but including ConfigInterface.h is enough to fix it and all commits after.

Please make these three small changes in the commit sequence to keep all buildable.
"
1035605654,2295,vsverchinsky,2022-02-10T22:41:05Z,"> The commit ""VST3 plugin modules loading"" now fails to build because internal/ComponentHandler.h does not yet exist, but deleting just that #include is enough to fix the commit.
> 
> The next commit ""VST3 processing"" needs to put the #include back.
> 
> ""VST3 UI"" fails to build because PluginSettings was not in VST3Effect.cpp, but including ConfigInterface.h is enough to fix it and all commits after.
> 
> Please make these three small changes in the commit sequence to keep all buildable.

@Paul-Licameli Each commit compiles now"
1036387802,2295,Paul-Licameli,2022-02-11T16:27:14Z,"> Unfortunately some VST plugins may expose many thousands of parameters, which sometimes aren't present in the plugin interface, it's the safest option i see right now to remove such parameters from the list

So I withdraw the suggestion above.
"
1036389315,2295,Paul-Licameli,2022-02-11T16:28:58Z,"> You expect that list of options will stay same for both VST and VST3?

I don't know.  So let's tolerate the duplication then.

"
1036390533,2295,Paul-Licameli,2022-02-11T16:30:20Z,"> `size_t` would be a better type, unless you need -1 for invalid?

This wasn't addressed but is minor
"
1036391932,2295,Paul-Licameli,2022-02-11T16:31:57Z,"> That's how it implemented in other effects

Then I will reexamine all the GetLatency overrides later.
"
1036394668,2295,Paul-Licameli,2022-02-11T16:35:02Z,"The suggestion to re-use MessageBuffer, which is now in lib-utility, stands.  But don't try it yet.  Maybe I will do it myself in near future refactorings.  MessageBuffer or something like it SHOULD be used in all existing real-time effects to communicate changes of dials atomically, but IS NOT yet.  It wasn't thought of years ago.  It is good that you thought of it without prompting.  But a question I need to settle is how to do it in a unified way for all effects.
"
1036406487,2295,Paul-Licameli,2022-02-11T16:48:06Z,"The suggestion to rewrite BuildPlainUI taking references instead of pointers (required not to be null) was not addressed.  At least write an easy comment that pointers must be non-null, where BuildPlainUI is declared.
"
1036408962,2295,Paul-Licameli,2022-02-11T16:50:48Z,"> The non-copy constructor may leave mEditController null. It makes mComponentHandler non-null only if mEditController is. These things should be stated here in comments.
> 

My suggestion stands, to make a comment about this invariant, to help the next person who reads this code.
"
1036413463,2295,Paul-Licameli,2022-02-11T16:55:41Z,"> ""try to grab"" again

""try grab"" grammar error still in ComponentHandler.cpp
"
1036416818,2295,Paul-Licameli,2022-02-11T16:59:27Z,"> I would prefer the string literals ""ProcessorState"" and ""ControllerState"" appearing in only one place each and given a name

I still like this suggestion to avoid duplication of string literals -- a very general rule, even if VST 2 code doesn't do it this way, but it is not very important.
"
1036419840,2295,Paul-Licameli,2022-02-11T17:02:49Z,"> According to VST documentation, it's not prohibited to change parameter names. It's not difficult to append suffix if parameter has a title to a parameter key, like `0_Vol`. Then, to read it from a CommandParameters we would need to extract id number and discard suffix.

I resolved the conversation where you said this, because I see you made code changes in response to the suggestion, but I don't understand ""it's not prohibited to change parameter names"".  When might they change?  When upgrading to a new version of a plug-in?  Or do you mean something else?

Compatibility of data we write into audacity.cfg is important, in case that file migrates from one version of Audacity to the next, or a plug-in upgrades its version.

"
1036423242,2295,Paul-Licameli,2022-02-11T17:06:34Z,"> I believe so, the `RealtimeInitialize` is called before any call to `RealtimeAddProcessor`, so we cannot configure them here (but they are initialized in `RealtimeAddProcessor` instead), and there is no need to set up the ""container"" effect since it's not used for realtime processing.

In fact you are right, and removing the call to `ProcessInitialize` in `VSTEffect::RealtimeInitialize()` (old VST) is the right thing I think, which will be part of my new issue #2547 
"
1036424556,2295,Paul-Licameli,2022-02-11T17:08:03Z,"> Maybe VST2 implementation does not need to initialize the ""master effect"" too, there is no need to do so in the VST3 implementation since all the processing is done by ""processor effect"" instances, in the case of realtime processing master effect simply holds initial parameters with which other instances would be initialized

You were similarly right again here and VST 2 needs to change
"
1036433591,2295,Paul-Licameli,2022-02-11T17:16:59Z,"Please read through my most recent comments and make the small suggested changes as you wish.

RunLoop.cpp does not in fact have the bug of double-free of resources, but still I would suggest making the helper classes move-only, and eliminating the extra indirection of `unique_ptr`, would improve style.

"
1038980633,2295,DavidBailes,2022-02-14T11:36:03Z,"I've had a look at the plain gui, and have found serious problems using a couple of the free plugins from here:
https://www.voxengo.com/group/free-vst-plugin-download/

I downloaded and installed both the vst and vst3 versions of the Mastering Graphic Equalizer, and the Tube Amplifier.
For the VST versions, the existing plain gui was OK.
However for the VST3 versions the plain gui is definitely not OK:
1. Values not in the right range - for example in the Graphic equalizer, the sliders in the normal gui have ranges -12 to 12, but the equivalent spin control in the plain gui has range 0 to 1.
2. A wxSpinCtrlDouble can be used for a property which has discrete values. In the normal view of the tube amplifier, there's a mode which can be set to be mode 1 or mode 2. In the plain gui, there's a wxSpinCtrlDouble for the mode, with a range 0 to 1.0

Checked the VST3 versions in Reaper, and the plain gui version, which is just a series of sliders and values, does not have the first isssue above - the values are in the correct range.

There are also accessibility isssues, but it probably best to address them after above problems have been sorted out."
1039462772,2295,vsverchinsky,2022-02-14T19:20:59Z,"> > ""try to grab"" again
> 
> ""try grab"" grammar error still in ComponentHandler.cpp

Checked it again, it isn't there any more



> > According to VST documentation, it's not prohibited to change parameter names. It's not difficult to append suffix if parameter has a title to a parameter key, like `0_Vol`. Then, to read it from a CommandParameters we would need to extract id number and discard suffix.
> 
> I resolved the conversation where you said this, because I see you made code changes in response to the suggestion, but I don't understand ""it's not prohibited to change parameter names"". When might they change? When upgrading to a new version of a plug-in? Or do you mean something else?
> 
> Compatibility of data we write into audacity.cfg is important, in case that file migrates from one version of Audacity to the next, or a plug-in upgrades its version.

Yes, VST3 documenation says nothing about changing the parameter name, so I suppose that plugin developers are free to change them, but parameter id should stay same."
1862807370,5791,saintmatthieu,2023-12-19T13:57:42Z,"@rbdannenberg this might be of interest to you? In any case, this whole initiative would benefit from your input."
1867641036,5791,Paul-Licameli,2023-12-22T12:39:28Z,"Please note, I have pushed a few suggested commits onto the branch to simplify some algorithms.  I cherry-picked IteratorX.h from the wave-clip-refactoring branch, which you reviewed before.  I extended it with more utilities.  You can avoid temporary vectors of integers just to use iota.
"
1874784924,5791,Paul-Licameli,2024-01-03T02:44:05Z,"I figured out the reason for the crash in the unit test in macOS release builds, and I presume the Linux builds were failing for the same reason.
"
1877638700,5791,saintmatthieu,2024-01-04T19:22:05Z,"@Paul-Licameli I've addressed the 3 things we've agreed on: the `div / 8` error, filtering 4/4 time signatures rather than mistakenly just taking the first of them, and using integer arithmetic when filtering out hypotheses that don't have a round number of tatums per bar.
I've also addressed some of the easiest other comments. Sorry at this late hour I don't have sufficient brains for more.
And finally, I've rebased and put aside the benchmarking commits for now. Since these _do not_ change the behaviour of Audacity, I think they can be pushed even while QA is doing its work. But for today they're out.
I'll make time tomorrow to address more of your comments if I'm confident they don't change behaviour. My benchmarking tests can help me verifying this."
1878654502,5791,Paul-Licameli,2024-01-05T13:24:05Z,"Reminding ourselves that https://github.com/audacity/audacity/pull/5791#discussion_r1441172648 points to a pre-existing problem that should have another issue and will be easily fixed.
"
1882154302,5791,Paul-Licameli,2024-01-09T01:54:27Z,Does the last commit affect caching or the missed beats in time track?
1882600625,5791,saintmatthieu,2024-01-09T08:22:58Z,"> Does the last commit affect caching or the missed beats in time track?

It's only about caching. What missed beats do you mean?"
1883982961,5791,saintmatthieu,2024-01-10T00:02:21Z,"@Paul-Licameli I cherry-picked the benchmarking test code onto that branch (including your suggestion commits). Production code is not modified at all so that won't interfere with QA. A lot of follow-up work depends on this and I already have a benchmarking-improvement ticket, so didn't want to add to the confusion by creating yet another similarly named ticket."
1884722806,5791,dozzzzer,2024-01-10T12:04:19Z,"@saintmatthieu 
When importing a non-looped rhythmical audio file, it still tries to detect its tempo even though it shouldn't.
So, to illustrate this misbehavior let's take [this loop of 78 bpm](https://www.dropbox.com/scl/fi/jarjq2jo22365jejvzbqp/bb_drum_break_loop_brooklyn1_78.wav?rlkey=nt9g6tug4kkczr2iywfxm4bzu&dl=0) as a source and trim it by about 1/16 from the right. The resulting loop would look smth[ like this](https://www.dropbox.com/scl/fi/pkp5l5i012x1viyw1f4f4/cut-off-loop.wav?rlkey=v59ce3mada9peqziy4jthxyhw&dl=0).
Import it into Audacity with ""Ask me each time"" in Preferences, and there you have it: Audacity falsely detects the tempo.
 
<img width=""400"" alt=""image"" src=""https://github.com/audacity/audacity/assets/70063970/719e541c-89ea-4d83-8d4a-9e33c995f159"">
"
1884748398,5791,saintmatthieu,2024-01-10T12:22:19Z,"Yes: the algorithm detects it as 7 bars of 3/4. There probably is such a periodicity in the onset pattern, which is all the algorithm takes into account at the moment. If it also looked at timbre change patterns, it could probably realize that there in fact is no such periodicity. With a bit of luck I can work on that, but later."
1690104387,5043,Paul-Licameli,2023-08-23T14:48:58Z,"The first commit in this branch fails to build.
"
1690125190,5043,saintmatthieu,2023-08-23T15:00:09Z,"> The first commit in this branch fails to build.

Squashed the branch to something more sensible. Each commit builds now."
1709814980,5043,saintmatthieu,2023-09-07T09:31:59Z,I reset this PR to draft because I have to make a bigger effort at preserving the old behaviour where appropriate. Will update the QA checklist for use are reference.
1715819431,5043,Paul-Licameli,2023-09-12T14:19:10Z,"Please review and approve this new commit https://github.com/audacity/audacity/pull/5138/commits/1372b859c9c2db198da93129729d8fba0f0371a6 at #5138 

-- and then make similar fixes for this branch
"
1722477544,5043,Paul-Licameli,2023-09-17T13:28:13Z,"Added a QA checkbox about sync lock
"
1725070421,5043,saintmatthieu,2023-09-19T08:39:49Z,"@Paul-Licameli addressed your comments, with [this](https://github.com/audacity/audacity/pull/5043#discussion_r1322887539) as yet unresolved question."
1727901790,5043,Paul-Licameli,2023-09-20T14:58:39Z,"I am beginning another round of review, checking that each commit builds.

The first fails to build but it is easily fixed.
"
1730483986,5043,Paul-Licameli,2023-09-21T23:25:54Z,"> IIUC, the `+` overload works like an ""&&"", and your proposal would yield another condition: `playable && (IsSynCLockSelected || notLocked)`. I think what could work is
> 
> ```
> const auto range = tracks.Any<Track>() + [&](const auto pTrack) {
>       return SyncLock::IsSyncLockSelected(t) ||
>              (notLocked && dynamic_cast<const PlayableTrack*>(pTrack) != nullptr);
>    };
> ```
> 
> but that's not so important.

Please reconsider that, I find it more elegant to read it.
"
1731242407,5043,Paul-Licameli,2023-09-22T11:13:45Z,"My review so far.

The last things I don't fully understand are the implications of the changes in `PasteOverPreservingClips.cpp` and the changes in `WaveTrack::PasteOne`.

About the changes to remove duplication with progress indicators -- you can just remove those three commits and leave the duplication of code for now.  We can make the code nicer later.
"
1731357563,5043,Paul-Licameli,2023-09-22T12:48:13Z,"I have completed a round of review!

I was dreading `WaveTrack::PasteOne`, remembering the huge complications in earlier drafts that I had only skimmed over, but now the changes are easier to comprehend and I see nothing seriously wrong there.
"
1731503040,5043,dozzzzer,2023-09-22T14:17:32Z,"A note for myself: check if the resulting clip gets shifted a few samples rightwards after having merged the two stretched adjacent clips:

https://github.com/audacity/audacity/assets/70063970/025fe2d4-2190-4f74-9eff-8dd39cb1113f

"
1734043683,5043,saintmatthieu,2023-09-25T16:02:27Z,"There's a crash when joining clips with contrasting stretch ratios. I verified that the [More standard-conform SplitProgress](https://github.com/audacity/audacity/pull/5043/commits/3d0ba5ae52150a11564272ab476aec01bc4c937d) commit isn't responsible, but couldn't investigate any further at this time."
1737216726,5043,Paul-Licameli,2023-09-27T11:32:28Z,"The commit ""WaveClip::Paste handles stretch ratio differences"" no longer builds.  This call has too few arguments:

```
      GetClip(channel)->ApplyStretchRatio(
         [&reportProgress, channel, channelsCount](double progress)
         { reportProgress((channel + progress) / channelsCount); });
```
"
1737350171,5043,Paul-Licameli,2023-09-27T12:57:33Z,"Approved for QA testing, but I want to continue with my own open-box testing too, exploring edge cases
"
1738995316,5043,Paul-Licameli,2023-09-28T11:51:23Z,"I see the additional commit, and it mostly looks good, but one question...
"
1739614591,5043,dozzzzer,2023-09-28T16:02:17Z,"Found issues @saintmatthieu 

- when joining 3 or more clips having different stretch ratios, the resulting clip has wrong length and has gaps of silence that aren't supposed to be there:

https://github.com/audacity/audacity/assets/70063970/72dfc1c5-81c0-40eb-a59f-68ced3ea9a4a

- when having multiple clips with different stretch ratios across multiple tracks, selecting them all and trying to Join, Audacity freezes. [This project ](https://www.dropbox.com/scl/fi/0sziskbfz13g35uhjyrhl/buggy-proj.aup3?rlkey=fwls04x70ebv8dk6x8m7myat4&dl=0)can be used for reproduction.

https://github.com/audacity/audacity/assets/70063970/3679e8b2-d1aa-4d75-806e-97056a77dbef

(to be continued)


"
1740574965,5043,saintmatthieu,2023-09-29T09:19:13Z,"I realize that the commit I just pushed, [Fix potential crash when joining stereo clips](https://github.com/audacity/audacity/pull/5043/commits/fe8331d3bd3089c2c346a0f21352f59a3596bf87), while fixing the problem when joining two clips, is insufficient when joining more ..."
1743143298,5043,chinakov,2023-10-02T14:37:57Z,"Bug found by @Tantacrul is fixed, thank you! Reflected in the checklist. "
1743349307,5043,dozzzzer,2023-10-02T16:36:25Z,"@saintmatthieu In the updated branch, previously logged issues are now fixed 👍 
New issues found:

### When generating audio into a clip, the resulting clip is shifted left to zero and the waveform is incorrect:

#### Expected:

https://github.com/audacity/audacity/assets/70063970/151c7d1f-7314-48f2-abb6-28f417d5821c

#### Actual:

https://github.com/audacity/audacity/assets/70063970/732c98eb-7a7c-4f1b-a88e-93ddcdb4fbf6


### When joining two stretched clips with envelopes, the resulting clip's amplitudes don't match the pre-rendered ones:


https://github.com/audacity/audacity/assets/70063970/8dc2f2c0-b16f-4b9f-8e92-daf8647d7094

#### Before `Audio Clips > Join`:

<img width=""450"" alt=""Screenshot 2023-10-02 at 18 34 34"" src=""https://github.com/audacity/audacity/assets/70063970/0ceda231-f803-4172-8897-10293d11dfe9"">

#### After `Audio Clips > Join`:

<img width=""450"" alt=""Screenshot 2023-10-02 at 18 34 50"" src=""https://github.com/audacity/audacity/assets/70063970/1870a4c1-2afe-4bd5-b96c-79f1d578d0ef"">

"
1743670610,5043,saintmatthieu,2023-10-02T19:59:02Z,"Thanks @dozzzzer.
I noticed yet other problems: at the end of a clip,

![image](https://github.com/audacity/audacity/assets/22740106/3f6212cb-8383-4010-9c8d-38384ddd3a6b)

generate a chirp. You get this ugly result:

![image](https://github.com/audacity/audacity/assets/22740106/722a5e14-39e2-44ae-8734-2b589cdac7ba)

Unfortunately I didn't manage solving this before my day off tomorrow. @Paul-Licameli if you have the capacity to look into this. Clue: the `PasteTimeWarper` is causing problems when restoring the splits in `ClearAndPasteOne`.

"
1746893331,5043,dozzzzer,2023-10-04T13:35:25Z,"@saintmatthieu in the updated PR:

- the issue with generating audio at the end of the clip (see previous comment) is now fixed
- the issue with generating audio over a stretched clip is now fixed
- the issue with joining clips with different stretched ratios and envelopes remains **unfixed**
- there's another issue with generating audio (only in case of Nyquist generators, such as e.g. Pluck) over an interval selected on a stretched clip:

https://github.com/audacity/audacity/assets/70063970/4190430c-cb00-4057-964d-9a4b81678c87



"
1747030323,5043,saintmatthieu,2023-10-04T14:47:20Z,"> * the issue with joining clips with different stretched ratios and envelopes remains **unfixed**

Sorry I oversaw that. Commits between your comment and now address this."
1747034185,5043,saintmatthieu,2023-10-04T14:49:22Z,"> there's another issue with generating audio (only in case of Nyquist generators, such as e.g. Pluck) over an interval selected on a stretched clip

Actually I also hit some assert if the length of generated audio is greater than the selection - doesn't have to be Nyquist. (Don't know how it looks in a Release build.) Looking into this ..."
1747843470,5043,Paul-Licameli,2023-10-05T00:30:28Z,Intermediate step “WaveClip::Paste handles stretch ratio differences” now fails to build 
1747864630,5043,Paul-Licameli,2023-10-05T00:52:53Z,The build failure is fixed three commits later
1748341777,5043,saintmatthieu,2023-10-05T08:11:46Z,"> there's another issue with generating audio (only in case of Nyquist generators, such as e.g. Pluck) over an interval selected on a stretched clip:

I found the issue, which indeed didn't concern Nyquist only but also some generators (e.g. tone generator). Generating audio over a selection for a duration greater than the selection was buggy. (Haven't checked if it was also buggy for durations less than the selection.)

With the tone generator, the duration is set per default to the selection duration, but not with the Nyquist generator, and that got you to notice the bug.

For what it's worth, the fix didn't involve modifying that complicated `ClearAndPaste` method, but usages of it, so I'm optimistic that this change won't break other things."
1748577432,5043,Paul-Licameli,2023-10-05T10:13:23Z,"> Thanks @dozzzzer. I noticed yet other problems: at the end of a clip,
> 
> ![image](https://user-images.githubusercontent.com/22740106/272072568-3f6212cb-8383-4010-9c8d-38384ddd3a6b.png)
> 
> generate a chirp. You get this ugly result:
> 
> ![image](https://user-images.githubusercontent.com/22740106/272072621-722a5e14-39e2-44ae-8734-2b589cdac7ba.png)
> 
> Unfortunately I didn't manage solving this before my day off tomorrow. @Paul-Licameli if you have the capacity to look into this. Clue: the `PasteTimeWarper` is causing problems when restoring the splits in `ClearAndPasteOne`.

I attempted no debugging of this.  Have you fixed it?
"
1748653258,5043,Paul-Licameli,2023-10-05T10:55:13Z,"My review of new commits is complete
"
1748783382,5043,saintmatthieu,2023-10-05T12:19:31Z,"> > Thanks @dozzzzer. I noticed yet other problems: at the end of a clip,
> > ![image](https://user-images.githubusercontent.com/22740106/272072568-3f6212cb-8383-4010-9c8d-38384ddd3a6b.png)
> > generate a chirp. You get this ugly result:
> > ![image](https://user-images.githubusercontent.com/22740106/272072621-722a5e14-39e2-44ae-8734-2b589cdac7ba.png)
> > Unfortunately I didn't manage solving this before my day off tomorrow. @Paul-Licameli if you have the capacity to look into this. Clue: the `PasteTimeWarper` is causing problems when restoring the splits in `ClearAndPasteOne`.
> 
> I attempted no debugging of this. Have you fixed it?

Yes."
1749057244,5043,saintmatthieu,2023-10-05T14:45:47Z,@Paul-Licameli finished addressing your comments.
1749058189,5043,saintmatthieu,2023-10-05T14:46:19Z,"Now looking into the [strange, suboptimal behaviour reported by](ttps://github.com/audacity/audacity/issues/5273#issuecomment-1748816257) @petersampsonaudacity"
1750861113,5043,dozzzzer,2023-10-06T15:11:08Z,Tested. No new issues were found.
1751013169,5043,Paul-Licameli,2023-10-06T16:10:05Z,"Fini!
"
1751050691,5043,saintmatthieu,2023-10-06T16:25:27Z,Likewise :)
1751066025,5043,Paul-Licameli,2023-10-06T16:30:36Z,"> Likewise :)

Will I see this soon?

> I don't expect there to be a use case for that: an empty clip normally is something freshly created for future insertion into a track, at which stage it gets the project tempo update. But it wouldn't hurt to be extra cautious. Will add a to-be-squashed commit for that.


"
1751071861,5043,saintmatthieu,2023-10-06T16:33:25Z,"> > Likewise :)
> 
> Will I see this soon?
> 
> > I don't expect there to be a use case for that: an empty clip normally is something freshly created for future insertion into a track, at which stage it gets the project tempo update. But it wouldn't hurt to be extra cautious. Will add a to-be-squashed commit for that.

![image](https://github.com/audacity/audacity/assets/22740106/a4fa931e-6ce6-406b-9314-1c8d0bdaae90)

Wanted to be eco-friendly saving a build by waiting for rebase."
1751093400,5043,Paul-Licameli,2023-10-06T16:43:29Z,"> > > Likewise :)
> > 
> > 
> > Will I see this soon?
> > > I don't expect there to be a use case for that: an empty clip normally is something freshly created for future insertion into a track, at which stage it gets the project tempo update. But it wouldn't hurt to be extra cautious. Will add a to-be-squashed commit for that.
> 
> ![image](https://user-images.githubusercontent.com/22740106/273277254-a4fa931e-6ce6-406b-9314-1c8d0bdaae90.png)
> 
> Wanted to be eco-friendly saving a build by waiting for rebase.

Just mine some Bitcoin to pay for the environmental impact.
"
1625191606,4881,Paul-Licameli,2023-07-07T10:18:10Z,"So I made a cursory review, to check that each commit builds (but they don't).  I haven't attempted the detailed review.

I see nothing for the envelope tool.  Can I expect to see something today?
"
1625283741,4881,saintmatthieu,2023-07-07T11:38:34Z,"> I see nothing for the envelope tool. Can I expect to see something today?

Oh that one slipped from my mind. Will give it a whack. About to push commits for hopefully acceptable spectrum display."
1625322579,4881,saintmatthieu,2023-07-07T12:11:04Z,"> I see nothing for the envelope tool. Can I expect to see something today?

Ready for review."
1625897799,4881,saintmatthieu,2023-07-07T18:56:31Z,"I have to stop now. @Paul-Licameli here is what I know remains to be done:

### Remaining features (besides destructive effects and joint-stereo)
#### Drawing:
* pencil drag-drawing : some edge samples can get missed when doing fast movements over the edge of a clip, but otherwise works nicely, including interpolation
* brush: similarly, edge samples happen to be set to extreme values, looking like uninitialized floats.
* caching: samples are read and written directly from the database. I think it should be easy to adapt the APIs I've added to `WaveClip` (`SetFloatsFromTime`, `GetFloatAtTime`, etc.) to return an `AudioSegmentSampleView` and have the drawing code keep the reference count from dropping to 0.

#### Copy, change tempo, paste:
that doesn't work at all.

#### Selection
Ignores tempo changes. Haven't looked into that at all.

### What works (or should)
The rest works to my satisfaction :
* Waveform display
* Envelope
* Spectrum display (directly on clips, `CachingSampleSequence` is dismissed)
* etc.

<br/>
<br/>
I will try to communicate and maybe address minor things sporadically over the week-end, but it is probably safer to assume me gone.
<br/>
<br/>
@crsib fyi"
1625903286,4881,saintmatthieu,2023-07-07T18:59:16Z,@Paul-Licameli I haven't done a proper commit squashing as you wished. You'll also see that I have disregarded method documentation. I hope their implementation is clear enough for you to add them by yourself when you take over. Sorry about that.
1626068033,4881,saintmatthieu,2023-07-07T20:41:19Z,@vsverchinsky @Paul-Licameli  FYI I have created (yet another) branch with the stretch-handle PoC code cherry-picked : https://github.com/saintmatthieu/audacity/tree/WaveTrack_OnProjectTempoChange_implementation-with_handles
1658492505,4881,saintmatthieu,2023-07-31T14:34:29Z,Reset this PR to draft until copy-paste and other left-over non-trivial issues are fixed.
1671420968,4881,Paul-Licameli,2023-08-09T14:18:21Z,"No comments about commits 2, 3, and 4 out of 13, except that 2 has some conflict with `Last-track-iteration-rewrites` but easily resolved.
"
1671452592,4881,Paul-Licameli,2023-08-09T14:22:43Z,"Commit 5 ""Project tempo changes affect WaveClip stretch ratios"" has another conflict.

The commit comment tells me you may knowingly cause assertion violations.  That should be avoided even in an intermediate commit if it's not hard.  Can you tell me which asserts might be the problem?

"
1673036112,4881,Paul-Licameli,2023-08-10T11:23:26Z,"Catching my breath now, I'm done with the first difficult commit ""Project tempo changes affect WaveClip stretch ratios"", except that I didn't reexamine every `GetVisibleSampleCount`, `TimeToSamples`, `SamplesToTime` to convince myself of the completeness of the necessary changes.
"
1678623283,4881,saintmatthieu,2023-08-15T09:01:34Z,"> Commit 5 ""Project tempo changes affect WaveClip stretch ratios"" has another conflict.
> 
> The commit comment tells me you may knowingly cause assertion violations. That should be avoided even in an intermediate commit if it's not hard. Can you tell me which asserts might be the problem?

As far as I recall this wasn't something trivial to fix. Calculations in `fillWhere` not accounting for stretching leading to wrong sample indices I think, and then some `std::clamp` complaining about being given inconsistent limits."
1679262150,4881,saintmatthieu,2023-08-15T16:32:44Z,"As per @Paul-Licameli 's wish, I broke down this PR in smaller ones. These are #5040 to #5045. Closing this one."
1679263603,4881,saintmatthieu,2023-08-15T16:33:58Z,@Paul-Licameli I see you posted new comments. Will address them on the relevant branches.
1178858297,3176,Paul-Licameli,2022-07-08T11:05:41Z,"On MacOS:

1. Record and count to ten aloud.
2. Open sidebar and add AUDynamicsProcessor (an example with an output meter)
3. Play, then press the gear wheel to open the dialog  (Or, press the gear first and then play)
4. Observe that the output metering does not work

In master now, at step 3 you can only press the gear first before playing (the point of this PR is to overcome that limitation)

But in master, there is some updating of the output meter (not at a fast enough rate, but that's another problem to figure out).
"
1178897619,3176,crsib,2022-07-08T11:49:38Z,"I'm not sure if I follow you. This PR provides a fix for a major UX issue, I do not see how is it related to output metering. Current UX makes real-time effects pretty much useless "
1178903564,3176,crsib,2022-07-08T11:56:10Z,"BTW following you steps I observe that output metering works (very slow, yes)"
1178921310,3176,Paul-Licameli,2022-07-08T12:16:02Z,"> BTW following you steps I observe that output metering works (very slow, yes)

I said it works, but slowly, in master yet not at all in your branch.  Are you agreeing with all that?
"
1178930634,3176,crsib,2022-07-08T12:26:22Z,I understand the reason of the problem and thinking of a solution now
1178959364,3176,Paul-Licameli,2022-07-08T12:56:55Z,"> I understand the reason of the problem and thinking of a solution now

I have my own thoughts about solution but have turned attention to other reviews since identifying the problem and haven't written them down precisely.
"
1178961181,3176,Paul-Licameli,2022-07-08T12:58:49Z,"General idea:  some parts of RealtimeEffect state that are not now copied, should be put in a structure managed by a `shared_ptr` which is copied.  This includes the pointer to the instance.  The complications with ClientData and EffectSettingsAccessTee may all be unnecessary.

But I must look at it closer to make this precise and see if it all makes sense.
"
1179024497,3176,crsib,2022-07-08T14:01:30Z,">General idea: some parts of RealtimeEffect state that are not now copied

Yep, exactly the way I plan approaching it

>The complications with ClientData

I still like the idea of UI to be attached separately, but this can be moved to be a part of RealtimeEffectState itself . The UI controller will be much more simple though.

> EffectSettingsAccessTee 

Yep, that won't be needed, but I think keeping it ""public"" does not harm.

The main question is still about the Undo/Redo stacks. Right now ""copying"" instance has a side effect of preserving the effect settings in the undo stack. I'm not sure if it is a desired behavior provided that Undo/Redo for parameters is postponed  and is not implement is several other DAWs at all. Without Undo/Redo preservation I do not see much complexity required to fix the issue you brought up

"
1192428999,3176,Paul-Licameli,2022-07-22T10:30:25Z,"Not yet a complete review.  I pushed a suggested nicer looking way (to me anyway) to implement ""Do not set Effect to be a controller...""
"
1192440871,3176,crsib,2022-07-22T10:45:03Z,"Your commit introduces a new dependency for the `lib-components`, it now requires access to wxWindow. I'm still checking if it works at all."
1192447329,3176,crsib,2022-07-22T10:53:04Z,So is it really worth introducing a new dependency just to remove on `if`? I say it is up to you.
1192457464,3176,Paul-Licameli,2022-07-22T11:05:34Z,"> So is it really worth introducing a new dependency just to remove on `if`? I say it is up to you.

Oh my, how did I overlook that?  Good point: if lib-components should only use wxBase, then the DefaultEffectUIValidator subclass should also be moved somewhere else, into Audacity.

However, actually lib-components and EffectUIClientInterface is still a somewhat confused and confusing piece of the legacy code.  There used to be several other badly named interface classes with unclear purpose that I figured out how to eliminate in this release.  EffectUIClientInterface is still one of those unsatisfying ones I haven't figured out how to clean up just yet.

"
1192460093,3176,crsib,2022-07-22T11:08:48Z,"To be fair, at some point we will need to have some façade for the event handlers anyway. So probably we can allow linking to `wxwidgets::core` here for now

>EffectUIClientInterface 

I am really confused about it, yes :-)"
1192463796,3176,Paul-Licameli,2022-07-22T11:13:47Z,"You mention Nyquist effects too now, which are also never realtime capable, but I don't see special treatment of them in this branch.

Nyquist and NoiseReduction are also the only effects that override ShowHostInterface specially, and one of your commits deletes a call to ShowHostInterface.

So is this part of the explanation?
"
1192471705,3176,crsib,2022-07-22T11:23:46Z,"Looking on `int Effect::ShowClientInterface` I think the reason is that NoiseReduction behaves very differently from other effects, including Nyquist. I have no strong feelings about that change and I'm happy to remove it."
1192474898,3176,Paul-Licameli,2022-07-22T11:27:46Z,"I will make another PR about the popping of event handlers, and you can rebase onto it if it is approved and merged.

It will also move DefaultEffectUIValidator to Audacity.
"
1192479969,3176,crsib,2022-07-22T11:34:26Z,"Hope I will see it soon, this PR will require vast amount of testing."
1192487127,3176,Paul-Licameli,2022-07-22T11:43:35Z,"See #3276
"
1192496698,3176,crsib,2022-07-22T11:56:26Z,"Well, that was really quick, thank you, Paul!"
1192497890,3176,Paul-Licameli,2022-07-22T11:58:01Z,"The proper complementary pushing and popping was a detail I recall having doubts about, and I'm glad to have reviewed and settled it to my satisfaction now.
"
1192708881,3176,crsib,2022-07-22T15:47:16Z,I have rebased and force-pushed. I removed `ShowClientInterface` override as well.
1195299720,3176,Paul-Licameli,2022-07-26T10:24:54Z,"This completes a round of review of the lines of code changed, but now I need to reread the bullet points in the issue and consider whether they were all addressed.
"
1195307506,3176,crsib,2022-07-26T10:33:01Z,"Please consider the *expected* design, not the one currently implemented for the effect UI dialog."
1197934730,3176,crsib,2022-07-28T10:03:49Z,I have fixed the issues found during the previous run
1198670475,3176,Paul-Licameli,2022-07-28T21:55:43Z,"It's not true that edits that push the Undo stack make the non-modal dialog disappear, but it seems any Undo or Redo makes it disappear even if ""the same"" track with ""the same"" state still exists.  Is that acceptable to design and QA?  I don't know.  I won't block the merge for that, but I do want the dependency cycle problem addressed.
"
1198688647,3176,Paul-Licameli,2022-07-28T22:24:38Z,"Break, also, the dependency of `ProjectWindow` on `RealtimeEffectPanel` (a dependency made earlier when the panel was introduced, not by you) and that cycle shrinks, not to one, but still excluding the new file added in 3.2, which is then not in a cycle with anything else.

How to do that?  It needs some manoeuvres with `GlobalHook` probably, that I might figure out in stabilization or for patch release.

So don't you worry about that one small addition to the cycle up in the UI layer.  But please do unblock the extraction of lib-audio-io.

"
1205394521,3176,Paul-Licameli,2022-08-04T15:14:16Z,"Some thoughts:

If mMainSettings is moved into the shared state, then there is no need for NonInterfering and the related templates to avoid false sharing, which simplifies the macOS build problem.

But I think it should not be moved into the shared state.  If you keep copying it as before, then it will be possible for a state's settings to be different at different points of Undo history.

Even if there are not distinct Undo/Redo items just for changes of settings, it may be an improvement to call ModifyState whenever the non-modal dialog closes.  This is done when you change the power button states.  Observe how it works.  Make some edit, and then toggle power.  Undo and redo.  What do you expect for power button state?  What you get is how you last left the button, before the undo; not the button as it was when the Undo state was first pushed on the stack.

ModifyState is also used for things like changes of the selected times.


"
1205396615,3176,Paul-Licameli,2022-08-04T15:16:01Z,That is separate from the lifetime problems that must be addressed to avoid the crashes in idle time for lv2 effects.
1205426269,3176,Paul-Licameli,2022-08-04T15:39:57Z,"Maybe do the opposite, though:  Put worker settings into shared state.  Undo history has versions of main settings, which is copied by the copy constructor of the state, but doesn't need multiple worker settings just taking up space.  Then no need for `SharedNonInterfering` or `NonInterfering`.
"
1205432792,3176,Paul-Licameli,2022-08-04T15:45:15Z,"Should `mID` and `mPlugin` remain in shared state?  Yes.  There is no need to reassign them after a state is made.  Replacement of one effect with another is implemented as construction of a new `RealtimeEffectState` with its own different, new shared state.
"
1205433599,3176,crsib,2022-08-04T15:45:55Z,"I'm not sure if I like your idea on project history. As a user - this is not a behavior I would expect. I close a non modal dialog, press Ctrl-Z, and everything is reverted without my knowledge about that. Please, let's agree that changes to effect settings do not affect project history for now, we will return to it after 3.2."
1205436625,3176,crsib,2022-08-04T15:48:34Z,"My proposal stands - I think that all of the state should be shared. I just need your confirmation, because you have designed this system and better understand possible problems that will occur due to this change"
1205480173,3176,Paul-Licameli,2022-08-04T16:23:40Z,"> I'm not sure if I like your idea on project history. As a user - this is not a behavior I would expect. I close a non modal dialog, press Ctrl-Z, and everything is reverted without my knowledge about that. Please, let's agree that changes to effect settings do not affect project history for now, we will return to it after 3.2.

This is a question to put to design, really not for either of us to decide unless the implementation difficulties are simply too great, but I think they would not be. @jessjwilliamson @LWinterberg @Tantacrul 

I did the power buttons deliberately as they are with Leo's agreement.

However the matter can be ignored for the purpose of this pull request and revisited as a separate issue.
"
1205492886,3176,Paul-Licameli,2022-08-04T16:30:53Z,"> My proposal stands - I think that all of the state should be shared. I just need your confirmation, because you have designed this system and better understand possible problems that will occur due to this change

I missed where exactly you proposed that ALL state be shared -- but that would include worker settings, unlike in the version I reviewed.

Yes, I think that may be right -- excepting perhaps the main settings -- and could solve the assertion violation that happened  for lv2 idle.

So the undo/redo history will surely include the changes of composition of the list -- adding, removing, replacing, permuting the states.  But there would be no more weak pointer in the EffectSettingsAccess object that could expire because of ReplaceTrack.  Instead it could hold another shared_ptr to SharedState.

I'm going to review again all that exists in the present master version of RealtimeEffectState to be sure this would work.
"
1205521420,3176,Paul-Licameli,2022-08-04T16:53:45Z,"If main and worker settings remain in the same structure, whether the shared or the unshared state -- then you should use `NonInterfering`.
"
1205526757,3176,crsib,2022-08-04T16:59:11Z,"> power buttons 

Power buttons are different:

1. You revert your last action. This is not true for the rest of the settings. Effect can have 50 parameters easily and ctrl-z will revert all changes to all 50 parameters.
2. You see the result. In this case - the action is completely hidden from user. 

Consider that you change settings in you IDE and they are reverted when you press Ctrl-Z after closing the window.

The case that effect settings bypass the project history has been already discussed a lot. Please let's not spend more time on it."
1205530295,3176,Paul-Licameli,2022-08-04T17:02:46Z,"> > power buttons
> 
> Power buttons are different:
> 
> 1. You revert your last action. This is not true for the rest of the settings.
> 2. You see the result. In this case - the action is completely hidden from user.
> 
> Consider that you change settings in you IDE and they are reverted when you press Ctrl-Z after closing the window.
> 
> The case that effect settings bypass the project history has been already discussed a lot. Please let's not spend more time on it.

I'm not convinced that the issue has been settled knowingly by designers.  There was a specification for undo/redo history strings from setting changes in the original design.  I think a *different* issue card could be opened for this an reconsidered in 3.3.

However the easy thing for now is not to address the issue (even if not forgetting the issue either), and we will agree to do the easiest thing for now, so that we do get the non-modality.
"
1205531226,3176,Paul-Licameli,2022-08-04T17:03:43Z,"> > > power buttons
> > 
> > 
> > Power buttons are different:
> > 
> > 1. You revert your last action. This is not true for the rest of the settings.
> > 2. You see the result. In this case - the action is completely hidden from user.
> > 
> > Consider that you change settings in you IDE and they are reverted when you press Ctrl-Z after closing the window.
> > The case that effect settings bypass the project history has been already discussed a lot. Please let's not spend more time on it.
> 
> I'm not convinced that the issue has been settled knowingly by designers. There was a specification for undo/redo history strings from setting changes in the original design. I think a _different_ issue card could be opened for this an reconsidered in 3.3.
> 
> However the easy thing for now is not to address the issue (even if not forgetting the issue either), and we will agree to do the easiest thing for now, so that we do get the non-modality.

This is *not* the other question of the Esc key, which was knowingly settled in favor of doing nothing about it.
"
1205604540,3176,Tantacrul,2022-08-04T18:12:11Z,I would say it is likely that any reference to Undo/Redo in the design was not properly considered. Probably a throwaway line - although I can't find it myself.
1213281546,3176,crsib,2022-08-12T16:09:57Z,">I will open some other issues about possible further bug fixes.

Please don't"
1213530462,3176,Paul-Licameli,2022-08-12T21:23:09Z,"Remaining problem (at least):

- generate noise
- add an effect to the stack
- Click the gear
- Undo

Expect:  the dialog should disappear, because the effect is no longer in the track's stack, even though the track still exists.

The dialog now holds a `shared_ptr` to state, referred to elsewhere only be Redo states.  The dialog remains open and won't have a dangling pointer, but it presents dials that have no influence on the sound when you play back.
"
1214169676,3176,Paul-Licameli,2022-08-13T14:38:22Z,"Maybe this is a solution for all the  undo problems, which won't need TrackId after all:

- intercept the track deletions that happen when popping undo state, as you do now, and remember those tracks.
- Then the event comes from the Undo manager, after the current TrackList in the project is repopulated.
- Find all RealtimeEffectStateUI that are showing, and ""reachable"" from the old tracks.  Meaning, of course, you can visit the states in their RealtimeEffectLists and find them.
- Find all that are reachable from the new list of tracks.
- Close the UIs in the first set and not the second.

Then this is enough to hide UIs either in case Undo removes the track, or Undo leaves (some state of) the track in the project but the track no longer has the RealtimeEffectState any more.

"
1214382985,3176,crsib,2022-08-14T13:54:47Z,"All proposed changes are implemented, @Paul-Licameli "
1682205933,5041,Paul-Licameli,2023-08-17T12:33:44Z,"I just bisected a bug to the commit ""Make waveform display work again"", but don't fully understand it yet.

- empty project
- Make stereo track
- select some range of time later than 0
- Generate > noise

Observe:  the channels appear misaligned.
"
1682209060,5041,Paul-Licameli,2023-08-17T12:35:41Z,"That appears to be only a display problem.  Real playback is correct.
"
1682492151,5041,saintmatthieu,2023-08-17T15:31:57Z,"> I just bisected a bug to the commit ""Make waveform display work again"", but don't fully understand it yet.
> 
> * empty project
> * Make stereo track
> * select some range of time later than 0
> * Generate > noise
> 
> Observe: the channels appear misaligned.

@Paul-Licameli I cannot reproduce it. If you could figure it out that'd be great."
1689783683,5041,Paul-Licameli,2023-08-23T11:21:49Z,"> `t1` is not used outside this constructor, so it might be a local variable

You might do this still, or not
"
1689848961,5041,Paul-Licameli,2023-08-23T12:10:46Z,"Now THAT is my complete round of review!

I think the points raised will be easy to resolve and the repeat round will be fast.
"
1689878312,5041,Paul-Licameli,2023-08-23T12:31:20Z,"Approved!  Please squash all commits after 560bc7dfcb903c393e03f2580fedb33b9ea1be9b into one.
"
1689979096,5041,Paul-Licameli,2023-08-23T13:35:30Z,"I have combined the QA checklists from two PRs.
"
1690255389,5041,dozzzzer,2023-08-23T16:18:27Z,"Found issues @saintmatthieu :

- When time-stretching from the left side (the beginning) of the clip, then dragging the new, time-stretched clip back to the zero time mark and playing the clip, it freezes for a few seconds before starting the playback. The subsequent attempts to play resulted in no stuttering. It also seems that the higher the stretch ratio is, the longer it waits before actually playing the track:

https://github.com/audacity/audacity/assets/70063970/06425b5a-636f-441c-b3dd-f273a38ea948

(a non-related to this PR issue logged as #5088)

- When shrinking a 1-minute clip to the minimum length, playback also starts after a short pause a couple of seconds long. Also, when shrinking a 1-minute mono clip to the minimum length, duplicating it, making it into a stereo track, and hitting Play, the pause time seems to double in time
- Deadlock when placing two clips with different stretch ratios next to each other and then pressing Z on the keyboard (= at zero crossings):

https://github.com/audacity/audacity/assets/70063970/d6a36e11-6c00-4e8b-8379-ab2b78eb318a

- When mixing-and-rendering a time-stretched clip (to a new track) and then measuring the contrast (_Analyze > Contrast_) or the RMS value (_Analyze > Measure RMS_) on both, the mixed-and-rendered one always appears to be a few dB quieter than the original time-stretched one:

https://github.com/audacity/audacity/assets/70063970/73228ef7-162d-48d3-9ef9-8d77cef0f3df

- Also noticed that when playing from the cursor immediately after stretching a clip, playback starts with a slight delay of maybe half a second as opposed to regular playback as well as all subsequent playbacks on the stretched clip that start immediately

- When importing a stereo file (wav/mp3) and adding some envelope points, visually only the left channel seems to be affected, even though in fact both left and right channel amplitudes are affected:
![image](https://github.com/audacity/audacity/assets/70063970/01f48b94-71c0-4044-abf4-ce151abfac1b)

- When stretching a clip using some extreme stretch ratios (e.g. stretching a 30-second mono chirp up to 12 hours), attempting to play the clip causes deadlock. We perhaps should introduce upper boundaries for the stretch factor
- Stretching a clip on a track that is part of a sync lock group doesn't cause other tracks of this group to shift in time as well; this is gonna be logged as a separate issue and is yet to be discussed with the design team, so please disregard this one
- Beat Finder analyzer fails on a time-stretched clip, e.g. a shrunk rhythm track:

https://github.com/audacity/audacity/assets/70063970/bf26683a-d801-4450-a789-dc5eb7d9892d

- Beat Finder may cause deadlock when applied on a clip that is stretched by changing the Tempo to a lower value:

https://github.com/audacity/audacity/assets/70063970/5278d67d-3b85-4f8e-8981-040af13570a3

- Poor processing of synthetic tones, such as chirp. When stretched and then mixed and rendered, it has louder peaks than the original: 
<img width=300 src=""https://github.com/audacity/audacity/assets/70063970/dd74a537-6bad-469f-a0c6-f777bb0cdc85"">
<img width=300 src=""https://github.com/audacity/audacity/assets/70063970/73b1d08a-1a0e-42c6-9cc0-acf610970cbd"">

- In a sync-locked track group, time-stretching a clip doesn't cause other tracks of the group to shift in time. Logged as https://github.com/audacity/audacity/issues/5090

- Occasionally, the uploaded to audio.com version of the stretched file would have a different length than the one in the project; this happens rarely and under certain specific circumstances that I'm yet unable to figure out

- When copying a shrunk clip and pasting it alongside, then rendering the sequence of two clips, the left and the right halves of the resulting clip look differently (see the images below); the issue is fixed now in the most recent version of the branch though.

Before:
<img width=""400"" alt=""Screenshot 2023-08-29 at 11 31 22"" src=""https://github.com/audacity/audacity/assets/70063970/5c9764f0-7f9f-45a8-bca4-46552073d7b1"">
After:
<img width=""400"" alt=""Screenshot 2023-08-29 at 11 36 35"" src=""https://github.com/audacity/audacity/assets/70063970/26171ee7-9092-4968-966b-921b992f0de6"">
"
1692972178,5041,saintmatthieu,2023-08-25T08:28:20Z,"@dozzzzer Thanks a lot for your findings so far.

> When time-stretching from the left side ...

This is already in 3.3.3 😬 Please try the exact same on the current release, using trimming instead of stretching.
The reason : before trimming, you select the entire clip. During trimming, the selection stays the same. When you shift the clip left, it also shifts the selection to the left, past the zero mark. And when you press play, it plays the selecting region, i.e. starting at second -10 ...

IMO this _is_ a strange behaviour, that _could_ be acceptable if the option to see past the zero mark is checked, but probably not if it isn't, right? Hasn't anyone complained about that so far? @LWinterberg?"
1693097518,5041,saintmatthieu,2023-08-25T09:50:54Z,"@dozzzzer 
> When shrinking a 1-minute clip to the minimum length, playback also starts after a short pause a couple of seconds long. Also, when shrinking a 1-minute mono clip to the minimum length, duplicating it, making it into a stereo track, and hitting Play, the pause time seems to double in time

StaffPad's time stretcher doesn't seem to like the way we configure it and extremely low stretch ratios. It may be a simple fix. WIP."
1693121998,5041,dozzzzer,2023-08-25T10:10:39Z,"> This is already in 3.3.3

👌 Logged as #5088 "
1693291102,5041,Paul-Licameli,2023-08-25T12:36:33Z,Perhaps I should examine the problem with envelope display.  Recently I merged to master some changes in envelopes.  Are you sure nothing was wrong already in master?
1693299781,5041,dozzzzer,2023-08-25T12:43:12Z,"> Perhaps I should examine the problem with envelope display. Recently I merged to master some changes in envelopes. Are you sure nothing was wrong already in master?

Yes, current `master` isn't affected, i.e. envelopes of both channels of a stereo track can be edited simultaneously."
1695841932,5041,Paul-Licameli,2023-08-28T14:52:03Z,"I re-approve this branch with the new commits, to the extent I understand it (this excludes changes inside the StaffPad library)
"
1695856269,5041,saintmatthieu,2023-08-28T15:00:44Z,"> When mixing-and-rendering a time-stretched clip to a new track and then measuring the contrast (Analyze > Contrast) on both, the mixed-and-rendered one always appears to be a few dB quieter than the original time-stretched one

Time stretching will modify the samples, and so we cannot expect the exact same contrast before and after rendering.

Then the follow-up question is: should we display the value for the raw data (as now) or the stretching-rendered result ? I'm not sure that the former would be preferrable. Something similar happens with real-time effects: select e.g. Bass & Treble, reducing both bands by several dBs. The contrast-command result is that of the raw audio. If you mix and render, and run contrast again, you get a different result.

So I'd leave it as it is. @LWinterberg ?"
1695884463,5041,Paul-Licameli,2023-08-28T15:17:47Z,"> > When mixing-and-rendering a time-stretched clip to a new track and then measuring the contrast (Analyze > Contrast) on both, the mixed-and-rendered one always appears to be a few dB quieter than the original time-stretched one
> 
> Time stretching will modify the samples, and so we cannot expect the exact same contrast before and after rendering.
> 
> Then the follow-up question is: should we display the value for the raw data (as now) or the stretching-rendered result ? I'm not sure that the former would be preferrable. Something similar happens with real-time effects: select e.g. Bass & Treble, reducing both bands by several dBs. The contrast-command result is that of the raw audio. If you mix and render, and run contrast again, you get a different result.
> 
> So I'd leave it as it is. @LWinterberg ?

I'm not sure.  Maybe we have discovered a subtle bug for the StaffPad guys to figure out.

I think you could prove that transforming one FFT window, changing phases only, and then doing IFFT, should leave RMS unchanged.

But that does neglect the complications of windowing functions, overlap-add, etc.

Still I would hope that time stretching of a sustained tone should at least preserve RMS with some cancelling-out of these effects over many windows.


"
1696353670,5041,saintmatthieu,2023-08-28T20:17:36Z,"That's correct, modifying the phases of the components of a signal doesn't change its RMS.

Also, I shared pictures on Discord of the effect of the time stretcher on a square wave. The waveform is greatly affected, but the RMS stays the same - roughly. Looking closer you can see it oscillating. That could be one reason.

The other reason could be delay. SP's stretcher reports a delay value that should be reviewed. We discard that many samples at the beginning of the output, but I've seen, for strong stretch ratios, signs that this may be an underestimate or overestimate, depending on the stretch direction. This could lead to discarded samples, affecting the analysis result - and other more critical problems, like truncated boundaries. Seems not be noticeable at typical ratios and we may get away with it for now, though."
1696940206,5041,saintmatthieu,2023-08-29T07:46:51Z,"@dozzzzer 
> Also noticed that when playing from the cursor immediately after stretching a clip, playback starts with a slight delay of maybe half a second as opposed to regular playback as well as all subsequent playbacks on the stretched clip that start immediately

I'm not sure how to reproduce that. A quick attempt didn't succeed. The number of tracks, sample rate, length, stretch ratios, all could play a role. Maybe make a project available for me?"
1696956241,5041,saintmatthieu,2023-08-29T07:59:14Z,"@dozzzzer 
> When importing a stereo file (wav/mp3) and adding some envelope points, visually only the left channel seems to be affected, even though in fact both left and right channel amplitudes are affected:

@Paul-Licameli provided a fix with commit 1468879. Just tested it, works fine."
1697560832,5041,saintmatthieu,2023-08-29T14:29:57Z,"> When stretching a clip using some extreme stretch ratios (e.g. stretching a 30-second mono chirp up to 12 hours), attempting to play the clip causes deadlock. We perhaps should introduce upper boundaries for the stretch factor

Since
* the need for such drastic outward stretching is very, very unlikely,
* a fix in the StaffPad library isn't easy (it'd mean supporting analysis hop sizes of less than 1 sample),
* setting up limits would take some, if so not much, development time,

we agreed together with @LWinterberg eventually to let it come as a bug if it ever gets reported."
1697588192,5041,saintmatthieu,2023-08-29T14:44:54Z,"> Poor processing of synthetic tones, such as chirp. When stretched and then mixed and rendered, it has louder peaks than the original:

When a waveform's components' phases relationship change (which is inherent to pitch-preserving time stretching), the shape of the waveform changes, too. For synthetic, complex waveforms with distinctive shapes such as square, triangle or sawtooth waves, this is very noticeable. It comes with a change of peak values (but RMS should be preserved, at least roughly), which is partly what we observe here.

That said, we've identified with @dozzzzer and @LWinterberg a pattern, whereby compressing a clip lowers its RMS, and expanding it, increases its RMS. For typical, musical usage of time stretching this is probably small enough not to be noticeable, but an improvement here would be welcome, possibly as patch release.

The fact that louder peaks may cause clipping upon playback is something we decided not to do anything about. Clip indicators are there to make the user aware of it. Doing anything ourselves proactively would change characteristics of the waveform in likely unwanted ways. Like @Paul-Licameli said, it's the maths of it - let the user decide how to deal with it."
1697610897,5041,Paul-Licameli,2023-08-29T14:57:11Z,"> synth

You know that there is a checkmark item in the View menu that paints the track red wherever it clips?  This is useful and I have wished it were the default.

If the stretch algorithm calculates sample values out of the [-1, 1] bounds, still those numbers are preserved if in 32 bit float format, and even persist in the .aup3 file.  It is still possible to normalize or compress or limit the result to get back a track that does not clip.

Experienced users may just have to learn this and be aware.
"
1698226164,5041,saintmatthieu,2023-08-29T22:27:29Z,"Yes, Leo showed the clipping markers. Normalizing or even just lowering the gain, and, for display, zooming out vertically on the level ruler."
1698667637,5041,saintmatthieu,2023-08-30T07:48:59Z,"@dozzzzer Beat finder problems are effect-related, and will be fixed in 5-of-6. Please ignore for now. I tested on that other branch, and it works."
1698809880,5041,saintmatthieu,2023-08-30T09:23:21Z,"@dozzzzer all your boxes are checked. Comments to some of those:

> Stretched clips are quieter

... or louder, depending on the stretch direction (squeezing -> quieter, expanding -> louder). As we agreed together with @LWinterberg , this will probably be subject for a patch release and should not block this release.

> Beat Finder fails when analyzing a stretched (shrunk) clip
> Beat Finder may cause deadlock

Please ignore for now, will be fixed with the PR that fixes destructive effects.

> Insignificant lag when playing a stretched clip not from the zero mark

Could not reproduce this.

> Lag when playing a clip shrunk to extreme minimum

Comes with the pre-processing of clips stretched to large amounts : squeezed and a lot of input has to be analyzed to output just a few samples, expanded and the synthesis will first output lots of near-zero values that must be discarded. This takes time, nothing we can do about it without delving in the StaffPad algorithm and risk breaking things while optimizing. I expect this lag for ""normal"" ratios not to be noticeable."
1702387317,5041,saintmatthieu,2023-09-01T08:41:40Z,Thanks @Paul-Licameli for contributing and pushing this forward !
1702505088,5041,dozzzzer,2023-09-01T10:07:10Z,"Tested:

- All checklist items
- Plot Spectrum applied to an extremely stretched-out clip now doesn't cause the freeze
- The freeze when using At Zero Crossings is now fixed
- The mixer Board issue is gone
- The right channel of a stereo track ignoring the envelope points is fixed as well

Out of scope of this PR:

- Stretched clips are quieter (logged as #5123) and clipping (https://github.com/audacity/audacity/issues/5122)
- Beat Finder issues (will be addressed in ""5 of 6"" PR)
- Extremely shrunk clip causes delay and stutter when played back (the ""limitation"" of the algorithm; see @saintmatthieu 's comment above)
- https://github.com/audacity/audacity/issues/5118
- https://github.com/audacity/audacity/issues/5119
- https://github.com/audacity/audacity/issues/5112
- https://github.com/audacity/audacity/issues/5113
- https://github.com/audacity/audacity/issues/5088
- https://github.com/audacity/audacity/issues/5090
- https://github.com/audacity/audacity/issues/5124
- https://github.com/audacity/audacity/issues/5126"
881335854,1207,Paul-Licameli,2021-07-16T10:10:54Z,"I have cherry-picked and merged parts of this pull request.

I mentioned a few points that are still unresolved, I don't approve the edit cursor change yet, and I must still review all the label track changes.

Please rebase your branch onto recent master and force-push it again.
"
970204212,2121,Paul-Licameli,2021-11-16T12:03:11Z,"I pushed a suggested commit, please review that!
"
970230294,2121,crsib,2021-11-16T12:35:33Z,">I pushed a suggested commit, please review that!

I've left that out to see if I can see a measurable difference in performance and I've observed none. Still, that commit is a welcome addition, thank you!"
972513228,2121,Paul-Licameli,2021-11-18T04:07:26Z,"Something is definitly wrong with autosave now.  Do these steps:

1. Run Audacity; generate noise; force-quit Audacity (such as with the debugger)
2. Restart Audacity; recover files; you should get the noise back.
3. Force-quit again; restart again; recover again.

Expected result: the second recovery works.
What I observe:  varying crash-y symptoms suggestive of a memory overwrite.

I think you must recover twice to get the bug, and I think it happens only starting at the commit ""Use the fast stream reader (still, reading from memory)"".  Of course it may be hard to be sure, when there is a memory overwrite.
"
972672802,2121,crsib,2021-11-18T09:11:38Z,"> Something is definitly wrong with autosave now. Do these steps:

There was an issue with recovering a project, that never was saved. I do not observe the issue you described though"
972729744,2121,Paul-Licameli,2021-11-18T10:20:53Z,"> > Something is definitly wrong with autosave now. Do these steps:
> 
> There was an issue with recovering a project, that never was saved.

Which issue?   If it happens, it surely is an issue to fix.  The unsaved data might be a long recording.

> I do not observe the issue you described though

I know I saw this problem, and I find it reliably in my macOS debug build of this branch, though the exact symptoms are various.  I'm not satisfied until there is more understanding.

"
972739264,2121,Paul-Licameli,2021-11-18T10:33:22Z,"> > > Something is definitly wrong with autosave now. Do these steps:
> > 
> > 
> > There was an issue with recovering a project, that never was saved.
> 
> Which issue? If it happens, it surely is an issue to fix. The unsaved data might be a long recording.
> 
> > I do not observe the issue you described though
> 
> I know I saw this problem, and I find it reliably in my macOS debug build of this branch, though the exact symptoms are various. I'm not satisfied until there is more understanding.

Your latest change to LoadProject may have made the problem go away, so it seems with a few tries, although I don't know why.
"
972743450,2121,crsib,2021-11-18T10:38:53Z,"I do not observe any problems with the latest build on macOS, not in release or debug builds. I think there can be an issue in ShowError"
972767424,2121,Paul-Licameli,2021-11-18T11:11:10Z,"class `XMLUtf8BufferWriter` became unused at ""Decode BXML directly, without intermediate stage""

So should the class be deleted?  Sad all that hard work obsoleted so soon.
"
972769114,2121,Paul-Licameli,2021-11-18T11:13:24Z,"I just need to step through ProjectFileIO::LoadProject to be sure I understand all the changes in there, and I will approve if I think nothing is wrong, although the unexplained random problems I saw give me a bit of doubt that some problem was missed.
"
972773943,2121,crsib,2021-11-18T11:19:49Z,"> So should the class be deleted? Sad all that hard work obsoleted so soon.

To be fair, I think it's XMLStringWriter that will go away at some point, and XMLWriter interface will be adapted to match XMLUtf8BufferWriter. There is still room for performance gains in serialization, that can be achieved by removing `const wxString &name` from the writer interface :-) And I expect much easier PR for that!"
972810368,2121,crsib,2021-11-18T12:13:04Z,"Well, that was epic!"
833998049,836,falkTX,2021-05-07T01:47:05Z,"Is this going to be optional / opt-in?
Integrating an open-source tool with google services will make a lot of people quite unhappy and overall just lose trust on it."
834002118,836,Be-ing,2021-05-07T01:58:41Z,I don't think this sends data to a Google server. IIUC Breakpad requires the project using it to set up their own server.
834019696,836,Qix-,2021-05-07T02:46:27Z,Another :-1: here. Why the sudden interest in adding Google dependencies for analytics and user tracking?
834031514,836,Picoseconds,2021-05-07T03:15:04Z,"Well it's gonna be self-hosted so I'm not sure how bad this is, at least it won't be sending data directly to Google"
834077208,836,misyltoad,2021-05-07T05:25:35Z,"I don't see this being particularly useful, automatic crash handlers in OSS is a rarity and crashes in software like Audacity tend to be pretty easily reproducible as there's not much going on so the gain from getting dumps would be minimal.

Also can we talk about how this adds 800+ new files? Why? Importing the breakpad library this way is fucking stupid."
834118315,836,Be-ing,2021-05-07T06:58:55Z,"Automatic crash reporting is very useful. Most users won't go through the trouble of learning how to use GDB to make a good bug report.

But yes, please stop vendoring dependencies. That has collateral impact beyond Audacity."
834635280,836,InterVi,2021-05-07T17:20:18Z,can this be turned off?
834648847,836,falkTX,2021-05-07T17:43:58Z,"> can this be turned off?

It is not even on yet. There is no need to turn it off once it is merged though, it can actually be quite useful.

I had wrong ideas initially about this, was not sure about implications of using breakpad.
This one does not need to rely on google servers.

if you really want nothing to do with google, you might as well stop using the web.
upcoming quic/http3 is basically a google creation, so the web will be served on a protocol engineered at google."
835305585,836,petersampsonaudacity,2021-05-08T11:19:29Z,"> 
> crashes in software like Audacity tend to be pretty easily reproducible as there's not much going on so the gain from getting dumps would be minimal.

If only that were the case - a good example is P1 Bug 2700 which was not easily reproducible - and there have been many others over the years (I took over as the main QA tester following the death of Gale Andrews).

And very few users bother to (or even know how to) send crash logs to us sadly.

"
835371102,836,TOGLK,2021-05-08T13:47:58Z,"I would appreciate a toggle that is built-in to Audacity, or, that could be changed prior to compiling Audacity, so that end-users can disable this functionality if they wish to do so.

I fully understand the importance of crash reporting, and making it automatic helps to streamline the Crash Report Submission Process.
But.
That shouldn't mean that the option to disable such functionality shouldn't be included.

I value my privacy and If I decide that I don't want to share crash logs with the Audacity Development Team then that decision should be down to ME, and not the developers of Audacity.

It is my hardware, and my system, and I want to have the choice to decide whether or not my system reports crashes or not.

I hope that you will listen to my feedback and consider it quite heavily when deciding how to further proceed with these commits.

Thank you for taking the time to read what I have to say, and have a good day.

TOGLK.
"
835382634,836,petersampsonaudacity,2021-05-08T14:22:50Z,"> I would appreciate a toggle that is built-in to Audacity, or, that could be changed prior to compiling Audacity, so that end-users can disable this functionality if they wish to do so.
> 
> I fully understand the importance of crash reporting, and making it automatic helps to streamline the Crash Report Submission Process.
> But.
> That shouldn't mean that the option to disable such functionality shouldn't be included.

In due course when a build becomes available I will be QA testing this.  One thing I will be looking for is an option in the crash report for sending or not sending a crash report.  I, for example, almost never send crash reports to Microsoft - as I can opt out of that at crash-time (most of mine are deliberate QA crashes anyway to test resilience and Recovery - and bug fixes.)




"
835384905,836,IGBC,2021-05-08T14:30:26Z,"I am generally pro breakpad. If its between this and #835 I choose this. Its library shown to have a lot of benefits. Incidentally Steam uses it in their client, and I think they have had a lot of success with it."
835388245,836,snoozysoft,2021-05-08T14:41:24Z,"Yeah from what I can tell with some brief research, this one actually seems fine since it doesn't appear (on first glance?) to send anything to Google. From what I can tell, it requires the developer to have their own server for minidump files to be sent to.

...Which begs the question as to why they can't run telemetry stuff on their own servers but *can* run crash reporting stuff. Hm. Either way, I think the core concern here isn't privacy but stuff more strictly related to the development of Audacity itself (which I obviously can't as easily speak for)

Obviously anything Google coming near a FOSS project is not ideal but as IGBC said, if something *must* be added that's bearing that brand name then this is arguably the better one (outside of the ideal option of ""none"" of course)."
835389068,836,IGBC,2021-05-08T14:44:08Z,"anyone ever consider this is a bait and switch?

They got us angry at Analytics so we'd be OK with breakpad 😆 ?"
835389890,836,snoozysoft,2021-05-08T14:46:48Z,"Hah, that's a fun thought. I'd agree but this one popped up on the same day only 4 hours after the telemetry PR, which probably isn't enough time

Besides this is serving a completely different purpose anyway"
835390946,836,IGBC,2021-05-08T14:50:11Z,yea sadly its clear their plan was to install both. Clearly they want a near clickstream from this program. Its very marketing adjacent.  `</offtopic>`
835395746,836,Paul-Licameli,2021-05-08T15:05:20Z,"Please observe that a crash report is sent only if the CMake variable CRASH_REPORT_URL is defined, but it is not defined in this pull request.
"
835405081,836,crsib,2021-05-08T15:36:52Z,"Crash reporting will be enabled only for the RC builds. It is technically impossible to do it otherwise anyway. 

Sending the generated crash report will be an opt-in. The report will be sent to the self hosted Sentry instance."
835603408,836,IGBC,2021-05-09T00:55:46Z,"Why only RC builds, seems like there could be valuable reports out in the wild in release builds. Heaven knows the audio world has some wacky machine configurations."
839788875,836,missytake,2021-05-12T13:50:16Z,"> if you really want nothing to do with google, you might as well stop using the web.
> upcoming quic/http3 is basically a google creation, so the web will be served on a protocol engineered at google.

And this is exactly why this is a problem - if people can't use the web anymore without using google protocols or software, then we don't have a free and open web anymore.

The same is true for my favorite audio editing software. All of my four albums were produced with audacity. There must be a way to get proper crash reports without giving the biggest technology monopoly even more power."
849501934,836,igorkorsukov,2021-05-27T09:57:00Z,"As far as I know, the Breakpad is deprecated and will not evolve, for example, it will not support new types of OS and processors. So, is recommended to use Crashpad https://chromium.googlesource.com/crashpad/crashpad/+/refs/heads/main/doc/overview_design.md"
849537678,836,vsverchinsky,2021-05-27T10:57:33Z,"> As far as I know, the Breakpad is deprecated and will not evolve, for example, it will not support new types of OS and processors. So, is recommended to use Crashpad https://chromium.googlesource.com/crashpad/crashpad/+/refs/heads/main/doc/overview_design.md

Isn't Crashpad distributed under Apache License 2.0 (which is incompatible with GPLv2)?"
849734829,836,igorkorsukov,2021-05-27T15:36:25Z,"> > As far as I know, the Breakpad is deprecated and will not evolve, for example, it will not support new types of OS and processors. So, is recommended to use Crashpad https://chromium.googlesource.com/crashpad/crashpad/+/refs/heads/main/doc/overview_design.md
> 
> Isn't Crashpad distributed under Apache License 2.0 (which is incompatible with GPLv2)?

Got it what the problem is, thank you."
857997823,836,Paul-Licameli,2021-06-09T18:59:31Z,"I'm still asking for fixes for internationalization.

Among my many comments here, I also suggested improvements in comments, and also the source code tree reorganization (making the crashreporter folder less nested).

I would still like those changes, but I won't let them delay approval.
"
1579502074,4771,saintmatthieu,2023-06-06T21:57:14Z,"If my reviewers think this is worthwhile pursuing, the next steps would include:
* Let all clients of `WaveTrack` adopt this new API,
* Remove `SampleTrackCache` and all related code,
* Consider unit-testing"
1580992785,4771,saintmatthieu,2023-06-07T14:54:05Z,"@crsib @vsverchinsky @Paul-Licameli I rebased that branch onto Paul's `Mixer-does-not-use-Track` branch. Maybe there was a smarter way but, to keep the diff to my own changes, I opened a new PR from my branch onto Paul's. Here's the link : https://github.com/Paul-Licameli/audacity/pull/9 . @Paul-Licameli I guess you could add Dmitry and Vitaly as reviewers - I couldn't."
1586174774,4771,Paul-Licameli,2023-06-11T13:51:18Z,"> @crsib @vsverchinsky @Paul-Licameli I rebased that branch onto Paul's `Mixer-does-not-use-Track` branch. Maybe there was a smarter way but, to keep the diff to my own changes, I opened a new PR from my branch onto Paul's. Here's the link : [Paul-Licameli#9](https://github.com/Paul-Licameli/audacity/pull/9) . @Paul-Licameli I guess you could add Dmitry and Vitaly as reviewers - I couldn't.

Don't make pull requests against my fork please.  That will only make more confusion.

Make all pull requests against audacity/audacity and we can have just one Conversation page like this one in which we find all related comments all have made.

I do not object to force pushes of this evolving project.

I still need to change the foundations for you to build on correctly.
"
1586180008,4771,Paul-Licameli,2023-06-11T14:09:56Z,"General remarks about the new commit ""CachingWideSampleSequence decorator"".  I like it better now but still don't want to review it completely.  I still think I should continue preparing other foundational work for you to review, and you should rebase onto that, and only then should I do a complete review.

At first I was very displeased to see lots of change in AudioIO.* which will only conflict with the next refactoring I need to do, adding lots of changed lines of code, before I had completely understood the first commit.

But now I see the commit comment says that all the changes in MixerSource.cpp are reverted.  That may be good.  I had not yet understood all those changes but I thought it would be better to find a solution that does not change lib-mixer.

So really if I haven't understood the first commit fully, I can forget about it, but should instead look at the squash of the two commits.

There is now no need for `SampleTrackStuff` to be defined in lib-mixer.  It can instead be defined in Sequence.h.

That leaves lib-mixer almost unchanged, but not quite:  still you add `GetSampleTrack` to `WideSampleSequence`.

I don't like that -- lib-mixer mentioning a class defined in lib-sample-track, which is not one of its dependencies.  It compiles, because there is only a forward declaration of the class, but still it is questionable for lower level libraries to mention types defined in higher level libraries.

You make lib-audio-io accept the decorated `WideSampleSequence` objects constructed at higher levels without needing to know the implementation details.  That is goo.

But lib-audio-io still depends on `SampleTrack`, and therefore, this questionable workaround of `GetSampleTrack` is needed, to let it find that interface from `WideSampleSequence`.

Remember what I have said: really I want to make lib-audio-io have no dependency on lib-track at all.

Let me first complete that, so you can review it, then rebase this work onto that.  No changes to lib-audio-io should be needed after what I do.





"
1586761637,4771,saintmatthieu,2023-06-12T07:42:12Z,"> Don't make pull requests against my fork please. That will only make more confusion.

I admit that it didn't prove helpful."
1600787595,4771,saintmatthieu,2023-06-21T12:57:31Z,@crsib @vsverchinsky this PR is based on #4795. If you wish to review please only those commits with me face :D 
1600934935,4771,saintmatthieu,2023-06-21T14:23:12Z,"I compared some aspects of performance before and after this PR:
* Real-time performance : can play an Audacity project with as many as 1024 stereo, 146-second-long tracks without glitches, both before and after this PR.
* Memory usage : Audacity project with 4 stereo., 146-second-long tracks in spectrum display mode. Memory requirements decrease by 10% with this PR, from 231 to 212MB."
1604011990,4771,Paul-Licameli,2023-06-23T09:36:43Z,"I have now completed a round of review.
"
1604046283,4771,saintmatthieu,2023-06-23T10:05:57Z,"> I have now completed a round of review.

Thanks a lot!"
1604124536,4771,saintmatthieu,2023-06-23T11:08:25Z,I'm done with addressing comments to @Paul-Licameli 's first round of review. Awaiting round 2.
1604447179,4771,Paul-Licameli,2023-06-23T15:28:50Z,"> I actually found an alternative implementation, where it is obvious that `written < bufferSize`, and which does not unnecessarily iterate over segments after if `written` already `== bufferSize`.
> 
> But I'd have complied.

The proof relies on `AudioSegmentSampleView::Copy` returning not more than its `bufferSize` argument.
The comment on that function is sufficient, if you look for it.
It's enough.
"
1604450498,4771,Paul-Licameli,2023-06-23T15:31:32Z,"> Comment it at least because the class is meant for use outside the library that defines it. I don’t think you must comment every type defined in anonymous namespaces.
> 
> If many classes don’t have DOxygen, that’s not an excuse for improving practice now.

Of course I meant to say... it's not an excuse for NOT improving practice!
"
1604455688,4771,Paul-Licameli,2023-06-23T15:35:08Z,"> Good catch! But I'm fixing it in `WaveClip::GetSampleView`, accounting for `mTrimLeft` like `GetSamples` does.

A sufficient fix for a real bug; so now, please comment in the header that the origin of the argument for `WaveClip::GetFloatSampleView` is in fact the play start.
"
1604505617,4771,Paul-Licameli,2023-06-23T16:15:17Z,"I make a number of suggestions in this round, to improve documentations and (in one place) proper argument types.  I left two boxes un-resolved from the previous round.

Clean it up for final merge if you like, but I none of this is important enough to delay the movement of the card right on the board.
"
1609190455,4771,dozzzzer,2023-06-27T10:03:35Z,Tested.
1096682594,2668,dozzzzer,2022-04-12T12:46:53Z,"Some issues were observed when testing the solution.

- #2808
- #2809
- #2810"
1126109738,2668,Paul-Licameli,2022-05-13T14:16:18Z,"Linux build is failing, needs `#include <cstring>` for std::memmove 
"
1126993082,2668,Paul-Licameli,2022-05-15T18:34:25Z,"This round of review is complete.  I am satisfied with the much improved large scale structure of interactions.  There are a few must-fix errors.  Resolve them and this can be approved.
"
1129734396,2668,Paul-Licameli,2022-05-18T08:39:52Z,"> Hm, didn't think of it, thanks. It's hard to answer such questions without a complete understanding of requirement. Though we can initialize i18n on the host side too, but then there is a question of language preference change. So, I don't have a complete answer, not use i18n in messages is a possible solution I think.

Language change only happens if the user uses the Preferences dialog, which can't happen during application initialization.  I wouldn't worry.

Anyway I see you take the acceptably simple way out -- you just use `Debug`.  Still let's remember this discussion.  Lowering the initialization of locale into some other place in lib- might not be needed yet but lookds easy and like the right thing to do in principle.

More generally, many miscellaneous things happening in AudacityApp.cpp could use reexamination for movement elsewhere.

"
1129738181,2668,Paul-Licameli,2022-05-18T08:43:45Z,"> I was thinking of it too, and there is a downside - the size of application will increase, don't know how much though.

Experiment will tell!

If ever my separation of modules (not libraries) proceeds, which allows pieces of Audacity functionality to be loaded only selectively -- then it might also be easy to suppress the loading of modules at startup time when in the plugin host process,
and that would reduce the memory footprint and static initialization code.
"
1129750205,2668,Paul-Licameli,2022-05-18T08:55:49Z,"> Thanks! `this` is needed for class-member access

But my suggestion was to access members through `lck->` instead of implicitly with captured `this`

See `UndoManager::EnqueueMessage` for an example I wrote
"
1129760573,2668,Paul-Licameli,2022-05-18T09:06:04Z,"> It will cost some time because from what I see it doesn't yield each `Poll`. In my case the difference was 2-4 seconds.

In that case the other `Yield` could be kept for better performance, with a comment explaining it.  It's an easy tuning change to make later if we like.
"
1129765447,2668,Paul-Licameli,2022-05-18T09:10:48Z,"> > Still now, I wonder about this. What happens if a plug-in is upgraded to a newer version reinstalled at the same path? Should that be detected and cause another load again in the sandbox?
> 
> I'd say yes. But for this we need to track module file timestamp (if there is a file)

New issue opened.  (Not yet a necessity for 3.2.)
"
1129771117,2668,Paul-Licameli,2022-05-18T09:16:33Z,"> > Are you not comfortable enough with ShuttleGui?
> 
> I'm still not very comfortable with wxWidgets)
> 
> > Besides which: perhaps this dialog belongs in its own small source file.
> 
> Probably, you are right

ShuttleGui was invented to let us avoid worrying about many details in the use of wxWidgets.  

As I explained, it didn't go far enough for open-endedness, platform neutrality, declarativity, and recombination with generalized variables for holding control values.  But, it's a start.

Anyway @ksoze95 might take on the task of rewriting this small dialog with ShuttleGui soon.



"
1129775638,2668,Paul-Licameli,2022-05-18T09:21:01Z,"The one conversation I left un-resolved above is the detail about swapping of strings out of `std::optional` in a more efficient way.  Unimportant.

Let's merge this!  A very satisfying achievement!
"
1594580102,4797,saintmatthieu,2023-06-16T12:11:18Z,"As mentioned in the description, this PR is based on @Paul-Licameli 's current #4746; you may (should) ignore his commits.

Before going through the commits, I recommend taking a look at `./libraries/lib-stretching-sequence/readme.md`, which presents the rationale for the newly introduced methods in `WideSampleSequence` as well as the `lib-stretching-sequence` implementation."
1595728248,4797,Paul-Licameli,2023-06-17T12:12:57Z,"I don't understand all but here are some things to change.

- The internal cursor, if really necessary, should be a hidden implementation detail of `StretchingSequence`.
   - `ResetCursor` is called (outside `StretchingSequence`) only in `MixAndRender.cpp` immediately after construction.  Eliminate that.  If it isn't needed for Export, I think it is also not needed here.
   - `WaveTrack` has no need to override the new functions for the cursors.  Those overrides are unreachable.
- `lib-mixer` should not be changed at all.
   - The remaining change there after doing the previous is to add `ClipInterface`.  Instead put that in `lib-stretching-sequence`.  Let `lib-wave-track` depend on that -- in other words, inverting the dependency from what the first attempt did
- Don't deprecate the overload of `Get` taking channel number and buffers.  I think it will still be needed for painting code which will still need that pattern of ""channel-major, clip-minor"" access to the data going ""against the grain"" of the new data organization.
"
1597001838,4797,saintmatthieu,2023-06-19T11:18:24Z,"Thanks Paul for your timely review.
> The internal cursor, if really necessary, should be a hidden implementation detail of `StretchingSequence`

Although possible for this PR, I'd rather not. `MixerSource` will need to call this to change position or direction of play when looping (in `MixerSource::Reposition`) and scrubbing."
1597014552,4797,saintmatthieu,2023-06-19T11:27:39Z,"> Let lib-wave-track depend on that

Works for me. Done."
1597029740,4797,saintmatthieu,2023-06-19T11:38:51Z,">  I think it will still be needed for painting code which will still need that pattern of ""channel-major, clip-minor""

I still don't imagine that, after `SampleTrackCache` is removed, anything other than `MixerSource` will need a continuity of samples across clips. Waveform as well as spectrum painting look like they do (or at least could) access data from the clips directly. But I may be wrong, I don't mind removing the deprecation and later remove that method altogether if I turn out to be right. (If I'm right we might not need a `WaveTrack` at all anymore. Except for some `StretchingSequence` methods that only forward calls to `mWaveTrack`, `WaveTrack` isn't an interface `StretchingSequence` needs.)"
1597107953,4797,Paul-Licameli,2023-06-19T12:34:04Z,"> Thanks Paul for your timely review.
> 
> > The internal cursor, if really necessary, should be a hidden implementation detail of `StretchingSequence`
> 
> Although possible for this PR, I'd rather not. `MixerSource` will need to call this to change position or direction of play when looping (in `MixerSource::Reposition`) and scrubbing.

I dislike any disturbance of lib-mixer interfaces.  Is it possible to avoid that by letting the decorator instead deduce the need for a change of its cursor from the pattern of access in the `Get` calls?

But I also dislike the very notion of an internal cursor, unless there is a very strong reason for it.

I have not yet reviewed in enough detail to understand the reason.  Is it because the time stretching algorithm has to maintain some internal state that depends on previous samples?
"
1597186205,4797,saintmatthieu,2023-06-19T13:22:41Z,"Yes, the mere action of reading out some output of the time stretcher modifies its state. (Hence `GetNext` is a non-const method.)
I explained the need for a cursor to the best of my ability in this [readme.md](https://github.com/audacity/audacity/pull/4797/files#diff-db4c5a9d199bbfe619baa64ed0283e6f7d3f7bd94d1232ca928640ff72b3dc84). I hope this helps convincing you. (Hint: look for the ""Display the rich diff"" button for that file in Github to see the pictures :) )"
1602391119,4797,saintmatthieu,2023-06-22T10:22:22Z,"> I dislike any disturbance of lib-mixer interfaces. Is it possible to avoid that by letting the decorator instead deduce the need for a change of its cursor from the pattern of access in the Get calls?

It is possible, and this is how `StretchingSequence` implements legacy `Get`.

`GetNext` does the maintenance of the read position for the client, so this is done in one place, clients simply cannot use it wrongly and it can be tested once and for all (see call in `SECTION(""ResetCursor"", ""reconstructs segment sequence when expected"")`, StretchingSequenceTest.cpp).

For this reason, after `SampleTrackCache` is removed, I'd like `MixerSource` to use `GetNext`, even if it possibly still could use legacy `Get`, and one way or another have the possibility to indicate a change of direction.

My hope was that we could also remove legacy `Get`, but spectrum display code uses it. (I am skeptical that this is a good thing, though : that code draws spectra clip by clip, and so first asks for clip boundaries before querying the corresponding samples onto the track. I can't see why this wouldn't be possible by just asking samples from the clips themselves, but it's not the time for me to check.) Most pragmatic is, at least for now, to leave this API, too."
1608031472,4797,Paul-Licameli,2023-06-26T18:39:55Z,"Now reconsidering the long commit.
"
1609870913,4797,Paul-Licameli,2023-06-27T16:36:04Z,"Okay, I see my critiques of yesterday mostly resolved to my satisfaction; I reiterated two still unresolved; I added more comments about what was rewritten.

I am glad to see you did the work to accomodate the ""channel-major"" access pattern to caches as needed.

Intermediate commits are not all compilable and free of known bugs (the backwards scrubbing).  I won't hold you to the rule.

I see nothing yet to delay approval, with just suggestions that you can implement as you wish with a rebase.

I still must finish a complete review of the big commit, then likely will approve it.

"
1610944939,4797,saintmatthieu,2023-06-28T07:57:07Z,Comments addressed in squashed commits. Hoping for a green build and QA round ...
1621577115,4797,dozzzzer,2023-07-05T11:34:13Z,"Moving back to `To Do` @saintmatthieu for two reasons:

- **Wrong mixing-and-rendering behavior**: when duplicating a piece of a mono clip, then making these two mono tracks into a stereo track, mixing-and-rendering it, the resulting track's right channel has wrong data. Compare:

https://github.com/audacity/audacity/assets/70063970/b454a7c5-7523-4dea-83ef-e33757c77c0d

vs recent `master`:

https://github.com/audacity/audacity/assets/70063970/b6b2f59c-22cb-4961-859b-7d71f815f424

- **crash when duplicating a tiny portion of a mono track** surrounded by silence > merging two mono tracks into a stereo track > mixing-and-rendering:

https://github.com/audacity/audacity/assets/70063970/edaf37ef-d73f-4278-9d3c-552c6877e323

[Audacity_dbgrpt-20167-20230705T132231.zip](https://github.com/audacity/audacity/files/11957375/Audacity_dbgrpt-20167-20230705T132231.zip)


"
1625570166,4797,dozzzzer,2023-07-07T15:18:29Z,"Tested:

- all bullet points on the list of things to be checked;
- the fix of the previously discovered crash with mixing-and-renderinig.

@saintmatthieu 
"
1706194642,5138,saintmatthieu,2023-09-05T08:43:29Z,"I am going through the QA checklist for the original 5-of-6 PR, trying (almost) each item on both branches. I'll make separate comments for separate observations."
1706199704,5138,saintmatthieu,2023-09-05T08:46:45Z,"Paulstretch:
1. Stretch a clip,
2. set preferences to editing a clip can move other clips,
3. select some region inside the clip and apply Paulstretch to a factor of 10.

I get such result on this branch:
![image](https://github.com/audacity/audacity/assets/22740106/c50a11e2-86e9-45e1-86c4-8e1e5384e111)

There shouldn't be the gap. #5044 doesn't suffer this problem.

If the checkbox ""edit a clip can move other clips"" isn't checked, this experiment works, on condition of course that the stretch factor <= 1."
1706200372,5138,saintmatthieu,2023-09-05T08:47:13Z,Auto Duck: works for neither this or the original branch.
1706207995,5138,saintmatthieu,2023-09-05T08:51:58Z,"1. Select a region on some stretched clip:
![image](https://github.com/audacity/audacity/assets/22740106/424d6ac9-f39f-48c8-9388-90c5b4a21382)

2. generate silence. On the original branch, the program crashes. On this branch, no crash, but unexpected result :
![image](https://github.com/audacity/audacity/assets/22740106/a49b8f3b-a562-4d0f-a9ad-c716072c82f1)

This is if the ""edit a clip can move other clips"" is checked. Without it, in debug, `assert(target.GetTrimLeft() == 0);` fails in `WaveTrack::ClearAndPasteOne`."
1706219935,5138,saintmatthieu,2023-09-05T08:59:33Z,"Noise reduction:
On both branches, generating the noise profile stretch-renders the selected region and creates a clip (without creating an undo item):
![image](https://github.com/audacity/audacity/assets/22740106/dacb5ad4-9cf6-49a9-bee3-6dbbe70e953a)

Now I go back one step in the undo history (undoing whatever I did before generating the noise profile) and redo. Noise profile should still be in memory (?) but my undo/redo got rid of the unwanted rendered clip. Now I apply noise reduction. On this branch, I get the same spurious clip pattern as when generating silence: ![image](https://github.com/audacity/audacity/assets/22740106/dafef39f-1956-4ce3-b514-4a7dcd10ae5f)

On the original branch, it works."
1706226481,5138,saintmatthieu,2023-09-05T09:03:39Z,"Graphic EQ fails on this branch: 
![image](https://github.com/audacity/audacity/assets/22740106/1c98f51b-33ac-46c3-aa61-34342a7047fd)

The gap shouldn't be there. Another effect of the EQ submenu, Bass and Treble, works, though.
"
1706234401,5138,saintmatthieu,2023-09-05T09:08:40Z,"Effects that yield the spurious-clip pattern seen in the generating silence case:
* Generating silence
* Applying noise suppression
* High-pass filter
* Change tempo
* Change pitch
* Nyquist noise gate
"
1706263125,5138,saintmatthieu,2023-09-05T09:25:40Z,Mixing stretched stereo track to mono yields silence (on both branches)
1706266551,5138,saintmatthieu,2023-09-05T09:28:12Z,Truncate silence: works on this branch but not on the original branch (doesn't seem to pre-render)
1706340608,5138,saintmatthieu,2023-09-05T10:16:32Z,"Now I know the rationale of this PR : get the destructive effects working, cherry-picking only the necessary part of 4-of-6 to make this work, i.e., `WaveClip::ApplyStretchRatio`. [Generalize use of progress bar and avoid unnecessary stretching if clip ratios match](https://github.com/audacity/audacity/pull/5045/commits/1985c7f3e179ad94994ad68f7f036081045c6fb8) introduced the `targetRatio` argument to that method, not necessary for this PR, but we ought not to forget it when repairing copy-paste later on if this PR makes it to master."
1707043575,5138,Paul-Licameli,2023-09-05T17:45:22Z,"Rebased unchanged onto recent master
"
1707139479,5138,Paul-Licameli,2023-09-05T18:40:39Z,"Fixed intermediate commit that failed to build
"
1707186583,5138,Paul-Licameli,2023-09-05T19:19:08Z,"New commit fixes at least some of the problems when editing a clip can move other clips
"
1707187306,5138,Paul-Licameli,2023-09-05T19:19:51Z,"> Now I know the rationale of this PR : get the destructive effects working, cherry-picking only the necessary part of 4-of-6 to make this work, i.e., `WaveClip::ApplyStretchRatio`. [Generalize use of progress bar and avoid unnecessary stretching if clip ratios match](https://github.com/audacity/audacity/pull/5045/commits/1985c7f3e179ad94994ad68f7f036081045c6fb8) introduced the `targetRatio` argument to that method, not necessary for this PR, but we ought not to forget it when repairing copy-paste later on if this PR makes it to master.

This branch does not include all of the 6th of 6.  Right, don't forget the rest of that one.
"
1707745354,5138,saintmatthieu,2023-09-06T06:27:30Z,"> Paulstretch:
> 
> 1. Stretch a clip,
> 2. set preferences to editing a clip can move other clips,
> 3. select some region inside the clip and apply Paulstretch to a factor of 10.
> 
> I get such result on this branch: ![image](https://user-images.githubusercontent.com/22740106/265640540-c50a11e2-86e9-45e1-86c4-8e1e5384e111.png)
> 
> There shouldn't be the gap. #5044 doesn't suffer this problem.
> 
> If the checkbox ""edit a clip can move other clips"" isn't checked, this experiment works, on condition of course that the stretch factor <= 1.

This looks good now."
1707761296,5138,saintmatthieu,2023-09-06T06:42:35Z,"> Auto Duck: works for neither this or the original branch.

@Paul-Licameli more detail:
Without stretching : ![image](https://github.com/audacity/audacity/assets/22740106/6fe32fd9-30cb-41b7-9387-e7883382ad5c)

If I stretch the clip on the lower track, though, applying auto-duck to the upper track does nothing."
1707765416,5138,saintmatthieu,2023-09-06T06:46:31Z,"> 1. Select a region on some stretched clip:
>    ![image](https://user-images.githubusercontent.com/22740106/265642094-424d6ac9-f39f-48c8-9388-90c5b4a21382.png)
> 2. generate silence. On the original branch, the program crashes. On this branch, no crash, but unexpected result :
>    ![image](https://user-images.githubusercontent.com/22740106/265642207-a49b8f3b-a562-4d0f-a9ad-c716072c82f1.png)
> 
> This is if the ""edit a clip can move other clips"" is checked. Without it, in debug, `assert(target.GetTrimLeft() == 0);` fails in `WaveTrack::ClearAndPasteOne`.

Now it doesn't matter whether edit-can-move or not : the assert always fails."
1707767177,5138,saintmatthieu,2023-09-06T06:48:08Z,"> Graphic EQ fails on this branch: ![image](https://user-images.githubusercontent.com/22740106/265645965-1c98f51b-33ac-46c3-aa61-34342a7047fd.png)
> 
> The gap shouldn't be there. Another effect of the EQ submenu, Bass and Treble, works, though.

This works now."
1707773346,5138,saintmatthieu,2023-09-06T06:53:45Z,"> Effects that yield the spurious-clip pattern seen in the generating silence case:
> 
> * Generating silence
> * Applying noise suppression
> * High-pass filter
> * Change tempo
> * Change pitch
> * Nyquist noise gate

These still don't work, at least silence, NS (but you're working on this one @Paul-Licameli ), high-pass and change pitch. Haven't tried the others, but I reckon they also don't work."
1707847059,5138,Paul-Licameli,2023-09-06T07:52:12Z,"> > 1. Select a region on some stretched clip:
> >    ![image](https://user-images.githubusercontent.com/22740106/265642094-424d6ac9-f39f-48c8-9388-90c5b4a21382.png)
> > 2. generate silence. On the original branch, the program crashes. On this branch, no crash, but unexpected result :
> >    ![image](https://user-images.githubusercontent.com/22740106/265642207-a49b8f3b-a562-4d0f-a9ad-c716072c82f1.png)
> > 
> > This is if the ""edit a clip can move other clips"" is checked. Without it, in debug, `assert(target.GetTrimLeft() == 0);` fails in `WaveTrack::ClearAndPasteOne`.
> 
> Now it doesn't matter whether edit-can-move or not : the assert always fails.

Last evening I studied that complicated function ClearAndPasteOne.

There may be an explanation as with the bug that shifted clips too far right:  wrong inclusiveness or exclusiveness of the endpoints of a test for whether a point is in an interval, introduced when 2 of 6 was merged.

If so it would be good to understand just where this subtle problem is, not just hide it behind the 4 of 6 commit, which I think should be a logically independent fix of a different problem.
"
1708118857,5138,saintmatthieu,2023-09-06T10:55:18Z,"> Now it doesn't matter whether edit-can-move or not : the assert always fails.

I think we can ignore this for now. Generating a tone with the selected region over a clip means is done as follows: create an empty clip, write the generated tone into it, clear the selected region and insert the tone in it. Since this involves copy-pasting clips onto one another, it will be repaired in the 4-of-6 PR."
1708355709,5138,Paul-Licameli,2023-09-06T13:23:42Z,"> > Now it doesn't matter whether edit-can-move or not : the assert always fails.
> 
> I think we can ignore this for now. Generating a tone with the selected region over a clip means is done as follows: create an empty clip, write the generated tone into it, clear the selected region and insert the tone in it. Since this involves copy-pasting clips onto one another, it will be repaired in the 4-of-6 PR.

I disagree:  the assertion should be understood and fixed.  I have added a fix.

You might see `// precondition satisfied because... ??` in two places, recording doubts I had about some stuff, that now I have resolved after deeper study of the new complexities Vitaly added to that function.
"
1708574906,5138,Paul-Licameli,2023-09-06T15:13:25Z,"> Mixing stretched stereo track to mono yields silence (on both branches)

Fixed
"
1708582202,5138,Paul-Licameli,2023-09-06T15:16:19Z,"> > Auto Duck: works for neither this or the original branch.
> 
> @Paul-Licameli more detail: Without stretching : ![image](https://user-images.githubusercontent.com/22740106/265916267-6fe32fd9-30cb-41b7-9387-e7883382ad5c.png)
> 
> If I stretch the clip on the lower track, though, applying auto-duck to the upper track does nothing.

I wonder if this is in common with the un-corrected mixing of stereo to mono.  For reasons I didn't figure out, apparently there are zeroes read from the stretched track instead of the proper values.
"
1708583809,5138,Paul-Licameli,2023-09-06T15:17:10Z,"> > Effects that yield the spurious-clip pattern seen in the generating silence case:
> > 
> > * Generating silence
> > * Applying noise suppression
> > * High-pass filter
> > * Change tempo
> > * Change pitch
> > * Nyquist noise gate
> 
> These still don't work, at least silence, NS (but you're working on this one @Paul-Licameli ), high-pass and change pitch. Haven't tried the others, but I reckon they also don't work.

Have you tried again with the latest changes?"
1708589072,5138,Paul-Licameli,2023-09-06T15:20:02Z,"> > > Auto Duck: works for neither this or the original branch.
> > 
> > 
> > @Paul-Licameli more detail: Without stretching : ![image](https://user-images.githubusercontent.com/22740106/265916267-6fe32fd9-30cb-41b7-9387-e7883382ad5c.png)
> > If I stretch the clip on the lower track, though, applying auto-duck to the upper track does nothing.
> 
> I wonder if this is in common with the un-corrected mixing of stereo to mono. For reasons I didn't figure out, apparently there are zeroes read from the stretched track instead of the proper values.

`GetFloats` is called directly on the un-selected control track.  I changed that function, recall, to fail if there is any stretch in the specified interval.  So I think you will observe the same failure in master.

"
1708591585,5138,Paul-Licameli,2023-09-06T15:21:12Z,"I think the easy fix for AutoDuck is to make a temporary rendering of the control track during Process() and use that instead.

Can you write and push a commit to do that?

"
1708755658,5138,Paul-Licameli,2023-09-06T16:48:07Z,"> Effects that yield the spurious-clip pattern seen in the generating silence case:
> 
>     * Generating silence
> 
>     * Applying noise suppression
> 
>     * High-pass filter
> 
>     * Change tempo
> 
>     * Change pitch
> 
>     * Nyquist noise gate

I'm testing every place under src/effect where `ClearAndPaste` is used.  Project tempo is 120 and 4/4 time.

I generate 4 bars of noise in a mono track, stretch out to 6, select from 2 to 4, then apply an effect.

- Change speed
- High-pass filter (Nyquist.cpp)
- Generate silence (Generator.cpp)
- Noise reduction, step 2
- Tone generator (hits PerTrackEffect)
- Change Tempo, high quality on (SBSMSEffect)
- Change Tempo, high quality off (SoundTouchEffect)

In all of these, overlapping clips result.  That's bad.  I expect the same for other Nyquist effects, Chirp, Noise, Change Pitch, and the sliding pitch shift which visit the same functions.

But for any other effect, this PR makes an improvement over the master branch behavior.
"
1710316816,5138,Paul-Licameli,2023-09-07T15:04:35Z,"Rebased onto recent master and resolved conflicts
"
1710924878,5138,Paul-Licameli,2023-09-08T00:37:19Z,"If you understood my last criticisms of #5139, then you will understand my dislike of the proposed complications for the analysis phase of Noise Reduction.

If the selection for analysis happens to span clips of different stretch, then there may be mis-weighting of things when combining results.

Admittedly this is very unlikely for users to do, who use noise reduction intelligently (selecting only a small sufficient duration).

But on the other hand, for just that reason, I think the pursuit of this supposed efficiency isn’t worth it either.

I would keep my simple fix:  just render the stretch if needed, only on the selection, likely to be short, and simply avoid the side effect on tracks by not committing the EffectOutputTracks object.
"
1711363389,5138,saintmatthieu,2023-09-08T09:27:53Z,"Referring to my comment in the spectrum-analysis PR : https://github.com/audacity/audacity/pull/5139#discussion_r1319559253

The experiment I did there is I think more likely to happen in the noise reduction use case: the selection is likely to be at the start of a clip, where there is background noise but speech hasn't started, and unfortunately this is where the algorithm is in a transient phase.

The difference in spectrum characteristic is arguably not dramatic, but used as a profile it might not perform as well when used in the processing of other parts.

On the other hand, one could argue that the profile selection will probably be used to process the same clip, and since we know the RMS is unfortunately different before and after rendering the stretch, it's safer to take stretch-rendered data as profile for the processing of data that will also be stretch-rendered.

Now I've put all my arguments forth, and will let you decide. It's your baby after all."
1713591482,5138,saintmatthieu,2023-09-11T10:16:05Z,"Pushed another commit to fix the ""Silence Audio"" command.
Generate tone, stretch clip, select region and ""Silence Audio"" (ctrl+L)
Before fix (possible result, you may get the ""Internal error"" message too):
![image](https://github.com/audacity/audacity/assets/22740106/501cdb4e-de9a-42c4-a94e-dc8728c6e146)

After fix:
![image](https://github.com/audacity/audacity/assets/22740106/d36ed623-143d-494e-b3a2-1a72594f7589)"
1715575571,5138,dozzzzer,2023-09-12T11:49:48Z,"Tested. Found issues:

- When clicking either **Cancel** or **Stop** in the **Rendering Time-Stretched Audio** dialog, progress hangs for a while but finishes in the background anyway, so basically neither of these two buttons is functional
- When applying ""Repair"" effect on a selection of max. 128 samples, it creates a spurious unwanted clip with gaps on each side:

<img width=300 src=https://github.com/audacity/audacity/assets/70063970/304ecd98-64cb-4167-839f-bfb3f1384870>"
1715801682,5138,Paul-Licameli,2023-09-12T14:09:05Z,"Rebased onto recent master and sqaushed the fixup for Noise Reduction.
"
1715969855,5138,Paul-Licameli,2023-09-12T15:38:11Z,"Rebased again to recent master and added commits to disable the Repair effect on stretched clips.
"
1717282771,5138,dozzzzer,2023-09-13T09:33:11Z,"- The Repair effect is disabled for stretched/shrunk clips
- The issue with non-op progress dialog buttons is now fixed
in the most recent commit of this PR

@Paul-Licameli @saintmatthieu "
1720088831,5138,Paul-Licameli,2023-09-14T20:19:56Z,"> Not so alert, but through testing. Other effects behave like that, I didn't comment them all.

Like what -- you mean other effects behave correctly when there is a stretching error?

If any behave wrongly (as Loudness did) I should know it and fix it and you should withhold approval until I do.
"
1720097403,5138,saintmatthieu,2023-09-14T20:25:59Z,"Would that be a regression, though ? On master, and I suspect on 3.3.3, too, some effects may fail, modify the content partially ? and then commit the result."
1720100581,5138,Paul-Licameli,2023-09-14T20:28:10Z,"Rebased unchanged onto recent master
"
1720103881,5138,Paul-Licameli,2023-09-14T20:30:02Z,"> Would that be a regression, though ? On master, and I suspect on 3.3.3, too, some effects may fail, modify the content partially ? and then commit the result.

The failure of stretching should be propagated so that the effect fails.

Loudness was failing to do that.  Do others fail to do that?
"
1720136471,5138,saintmatthieu,2023-09-14T20:51:42Z,"Pardon me, I must have recalled wrongly: looked again at your commit where you check the return value of `WaveTrack::Set`. Loudness is now the only one I see that didn't make use of `false`. Feel free to double-check."
1721242677,5138,dozzzzer,2023-09-15T12:59:00Z,"Found issues:
- when stretching/shrinking audio and trying to silence the selection by Ctrl (Cmd) + L, it does so in a different place of the clip:

https://github.com/audacity/audacity/assets/70063970/e64505d6-fbd2-4186-9382-ebe86765ac4f

- Trim Silence effect fails:

https://github.com/audacity/audacity/assets/70063970/78ea9a9a-069b-43c9-995c-081242068925
"
1721338681,5138,saintmatthieu,2023-09-15T14:04:34Z,"@dozzzzer The ""Silence Audio"" command not working is known and fixed in that other PR, #5182."
1722475235,5138,Paul-Licameli,2023-09-17T13:16:27Z,"Rebased onto recent master with some squashing and permuting of commits.

Added two more commits.
"
1722477302,5138,Paul-Licameli,2023-09-17T13:27:05Z,"More QA checkboxes, since we discovered there are interactions with Sync Lock
"
1723125987,5138,Paul-Licameli,2023-09-18T10:20:41Z,"Force-pushed once more with one commit inserted first in the sequence to fix crashes in sync-lock

"
1725011111,5138,dozzzzer,2023-09-19T07:57:51Z,Tested
1195333596,3278,Paul-Licameli,2022-07-26T11:00:04Z,"In my fetch of your latest force-push, there is still failure to build on macOS at the second commit.
"
1196966245,3278,pietro68,2022-07-27T16:14:58Z,"Please note: ""effect inherits PerTrackEffect not StatefulPerTrackEffect"" is specified originally as part of step 4; but once I changed that inheritance, the code would not build until I implemented the most parts of step 5. - this is why it is part of step 5."
1198483080,3278,Paul-Licameli,2022-07-28T18:14:17Z,"""removed unnecessary calls to ResetModuleAndHandle"" might be squashed earlier
"
1198487610,3278,Paul-Licameli,2022-07-28T18:19:25Z,"> Please note: ""effect inherits PerTrackEffect not StatefulPerTrackEffect"" is specified originally as part of step 4; but once I changed that inheritance, the code would not build until I implemented the most parts of step 5. - this is why it is part of step 5.

The problem, as I explained before, was that I omitted before part of what needed to be done in step 4.  That is, move `ProcessFinalize` also into the Instance.

Your step 5.1 simply deletes that function from the Effect but does not restore the equivalent into the Instance.  That may be losing an important side effect.

So I can't accept this pull request yet.
"
1199678029,3278,pietro68,2022-07-29T16:27:12Z,"I redid step 4. from scratch - hopefully it is not too complicated, I could not split it into subparts."
1201026569,3278,Paul-Licameli,2022-08-01T10:39:39Z,"I wrote earlier ""Also in step 4, the PowerOn() in BuildFancy() should be changed to call it on the Instance, not on this.
Pass the Instance into BuildFancy() from PopulateUI().""

The latest push doesn't do this any more.  Please restore that change.
"
1202714855,3278,pietro68,2022-08-02T14:37:42Z,"> I wrote earlier ""Also in step 4, the PowerOn() in BuildFancy() should be changed to call it on the Instance, not on this. Pass the Instance into BuildFancy() from PopulateUI().""
> 
> The latest push doesn't do this any more. Please restore that change.

ok, restored"
1202811880,3278,pietro68,2022-08-02T15:22:42Z,"All of what we discussed yesterday is now in the last push I did, commit 4.
"
1203030225,3278,Paul-Licameli,2022-08-02T17:42:35Z,"The latest push looks good, but it awaits completion with step 5.  A few comments:

- `VSTEffectValidator::mIntance` might be private.
- I was surprised to see `AudioMaster` moved into `VSTInstanceBase`.  I thought at first, that's wrong, it should remain in the Wrapper, and the Validator may need to use it too.  But your comments suggest, we will split the `AudioMaster` function into multiple functions, and pass different functions to `pluginMain`.  I now think that's a good alternative solution too.
- `ProcessBlockB ` doesn't need to be separated from `ProcessBlock ` as a member function of `VSTInstanceBase`, now that slaves are also Instances.  (But not so, yet, for the initialize and finalize functions.)
- Where is `VSTEffectInstance::mNumChannels` used?  I can't find it.  You might just delete that, and the functions that get and set it.
- `callSetChunk` (which has two overloads) is no longer called anywhere!  (And the four-argument overload in fact became unused already at commit 2df527f6d72c92c5cf5c8cc679ac6122a03c4649). So, just delete those, and rename the `callSetChunkB` functions as `callSetChunk`.
- I think `VSTInstanceBase::Automate` is wrong... I think the `VSTInstance` needs to override it, and call `callSetParameter` (not B), and so, the Instance needs, transitionally, a reference to the array of slaves.
- Why is `mTimeInfo` still in the Effect class?  Only the Instance and the slaves, also Instances, need it.  Once you address the point about `ProcessBlockB`, this will become clearer.  Remove it from the Effect.

Please do an interactive rebase addressing all of these, force push it, and then proceed to step 5.
"
1203667942,3278,pietro68,2022-08-03T08:50:35Z,"> * Why is `mTimeInfo` still in the Effect class?  Only the Instance and the slaves, also Instances, need it.  Once you address the point about `ProcessBlockB`, this will become clearer.  Remove it from the Effect.

`mTimeInfo` is actually in the InstanceBase class, not the Effect class; it is referenced by:
- `GetTimeInfo()`  called from the vst callback
- `GetSampleRate()` called from the vst callback
- `VSTEffect::VSTEffect` 

As long as the vst callback is called for the effect too, I can not move `mTimeInfo` in the Instance only. I actually wonder if I can move it there even after I split the vst callback in two parts (one for the effect, one for the instance) because maybe the callback for the effect will still need to call `GetTimeInfo` and/or `GetSampleRate`? this because the vst GUI might want to draw something that depends on the samplerate (think of a band equalizer for instance)"
1203753452,3278,Paul-Licameli,2022-08-03T10:13:12Z,"> > * Why is `mTimeInfo` still in the Effect class?  Only the Instance and the slaves, also Instances, need it.  Once you address the point about `ProcessBlockB`, this will become clearer.  Remove it from the Effect.
> 
> `mTimeInfo` is actually in the InstanceBase class, not the Effect class; it is referenced by:
> 
> * `GetTimeInfo()`  called from the vst callback
> * `GetSampleRate()` called from the vst callback
> * `VSTEffect::VSTEffect`
> 
> As long as the vst callback is called for the effect too, I can not move `mTimeInfo` in the Instance only. I actually wonder if I can move it there even after I split the vst callback in two parts (one for the effect, one for the instance) because maybe the callback for the effect will still need to call `GetTimeInfo` and/or `GetSampleRate`? this because the vst GUI might want to draw something that depends on the samplerate (think of a band equalizer for instance)

I thought we decided it is not needed in the Effect. If for GetTimeInfo and GetSampleRate, the effect can simply inherit the trivial implementations, then mTimeInfo can belong to Instance only."
1203804466,3278,Paul-Licameli,2022-08-03T11:09:07Z,"> > > * Why is `mTimeInfo` still in the Effect class?  Only the Instance and the slaves, also Instances, need it.  Once you address the point about `ProcessBlockB`, this will become clearer.  Remove it from the Effect.
> > 
> > 
> > `mTimeInfo` is actually in the InstanceBase class, not the Effect class; it is referenced by:
> > 
> > * `GetTimeInfo()`  called from the vst callback
> > * `GetSampleRate()` called from the vst callback
> > * `VSTEffect::VSTEffect`
> > 
> > As long as the vst callback is called for the effect too, I can not move `mTimeInfo` in the Instance only. I actually wonder if I can move it there even after I split the vst callback in two parts (one for the effect, one for the instance) because maybe the callback for the effect will still need to call `GetTimeInfo` and/or `GetSampleRate`? this because the vst GUI might want to draw something that depends on the samplerate (think of a band equalizer for instance)
> 
> I thought we decided it is not needed in the Effect. If for GetTimeInfo and GetSampleRate, the effect can simply inherit the trivial implementations, then mTimeInfo can belong to Instance only.

If experiment shows that those cases in AudioMaster are not reached for the Effect object, but only for the Instance, then
the simplification of moving mTimeInfo out of Effect could be done and would be desirable.

But we might leave that until we do such experiment.
"
1203809495,3278,pietro68,2022-08-03T11:14:33Z,"> * I think `VSTInstanceBase::Automate` is wrong... I think the `VSTInstance` needs to override it, and call `callSetParameter` (not B), and so, the Instance needs, transitionally, a reference to the array of slaves.

I'd like to think out loud a bit now. Automate is called from the vst callback, sometimes on the Effect, sometimes on the Instance. I put some breakpoints and I observed this:

1) when instantiating an effect 
--> `Automate` is called on the effect, nothing happens because `mMaster` is null and `mSlaves` is empty

2) when moving a slider on the effect gui --> as above

3) when pressing play 
--> `Automate` is called on the instance

4) when clicking ""apply"" (i.e. destructive processing) 
--> `Automate` is called first on the effect (`mMaster`=null `mSlaves`={}) and then on the instance

5) when moving a slider while playing 
--> `Automate` is called on the effect, `mMaster`=null but this time `mSlaves` has one item

My conclusions (but I might be wrong): 

a) we need both overrides of `Automate `(for Effect and Instance), and when I will split the callback, both of them will need to call `Automate `when requested to. 

b) `mMaster` can be removed (it is always nullptr in my tries above)

c) I could do as you say, i.e. pass the array of slaves to the instance and have Instance::Automate call callSetParameter (not B) on them, but, is it really needed? without this, everything still works and it would be a temporary thing anyway

"
1204077864,3278,pietro68,2022-08-03T15:10:13Z,"> If experiment shows that those cases in AudioMaster are not reached for the Effect object, but only for the Instance, then the simplification of moving mTimeInfo out of Effect could be done and would be desirable.
> 
> But we might leave that until we do such experiment.

Did a little experiment: using a simple plugin like gain, `GetTimeInfo()` is never reached, neither for the effect nor for the instance. But already using an equalizer plugin, at least `GetTimeInfo()` is reached, and for the effect only. 
So I would say, at least `GetTimeInfo()` should remain for the effect and return the actual mTimeInfo, and if we want to play it safe, also` GetSampleRate()`.
"
1210864250,3278,pietro68,2022-08-10T15:23:55Z,"A note about my commits for step 5. :

I said earlier (and wrote in code comments) that I would split the vst callback function in two parts, one for the instance and one for the effect.

Since then I changed my mind and opted for a more conservative solution, which is: keep the vst callback in the wrapper and have it call virtual methods. I think doing so is cleaner and poses less risks of breaking things.
"
1215735182,3278,Paul-Licameli,2022-08-15T20:05:51Z,"> I was wrong when I said that Automate has to belong to the instance. It must indeed belong to the Effect, because changes in sliders are intercepted by the Effect vst callback.
> 
> That being said, yes it is still wrong that Automate() loses the loop over slaves. In commit 4.3 I fix that by having Automate use callSetParameter and that required that mInstances move to the instancebase class.

I'm still not satisfied.  As I explain:  Both in Automate(), and in OnSlider() (which will both ultimately go to the Validator class), callSetParameter should be invoked, but NOT in `this`, but instead on an Instance object.

That is the Instance stored in the minimal Validator class now; and, until the Validator is complete, the Effect will keep a pointer to the active Validator.
"
1216341317,3278,pietro68,2022-08-16T08:57:28Z,"> I'm still not satisfied. As I explain: Both in Automate(), and in OnSlider() (which will both ultimately go to the Validator class), callSetParameter should be invoked, but NOT in `this`, but instead on an Instance object.
> 
> That is the Instance stored in the minimal Validator class now; and, until the Validator is complete, the Effect will keep a pointer to the active Validator.

I can not do this because:

1) `::Automate` comes in two versions:

- `VSTInstanceBase::Automate`  which has no access to members of the Effect (such as the pointer to the active Validator)
- `VSTEffect::Automate` it is actually calling callsetparameterB


2) I tried doing it in `::OnSlider`, but then it breaks this functionality:  as I move sliders of the plain GUI while realtime processing, I do not hear changes in the sound anymore.

"
1222922394,3278,Paul-Licameli,2022-08-22T20:16:13Z,"I am reviewing the latest force-push and so far I am satisfied with the 4.x steps.  They can be squashed into one in your next force-push.
"
1223856907,3278,Paul-Licameli,2022-08-23T10:11:51Z,"Please rebase onto latest master, squash steps 4 into one, and squash steps 5 into another commit.  Address in step 5 the two reqeusts for change.  Then, this will be approved, and you will move on to the Validator.
"
1223887411,3278,Paul-Licameli,2022-08-23T10:42:19Z,"Less important, `mUseLatency` might also move from Wrapper to Instance
"
1112848203,2867,Paul-Licameli,2022-04-29T03:40:17Z,"THIS COMPLETES ROUND ONE OF REVIEW!
"
1112937274,2867,Paul-Licameli,2022-04-29T07:04:32Z,"I have pushed the two promised commits onto this branch.  If you rebase and force-push, perhaps they could be moved to the start of the commit sequence so you don't add and old style event handling code for the theme, only to change it again.
"
1113284121,2867,Paul-Licameli,2022-04-29T13:01:01Z,"A third suggested commit added to the branch
"
1134817786,2867,Paul-Licameli,2022-05-23T15:26:00Z,"In fact `TrackList::FindById` is the convenient thing to use on undo or redo.  Use `Track::GetId` to find the value to store in the window.

"
1135776315,2867,Paul-Licameli,2022-05-24T11:08:12Z,"If the responses to undo and redo appear to work now, without any use of `TrackId` or any subscription to undo manager changes, it is because you rely on coindicental track focus change messages -- those send from EditMenus.cpp, right?

I fell a bit uncomfortable with that.  It seems a bit fragile, and it might be preferable that this panel should express its dependency on the current undo state directly, even if it requires a little more work.

You are depending on things coded in EditMenus.cpp for this window to work correctly, but the src/menus files should be tops of the dependency graph -- they depend on other things, but nothing depends on them.  This isn't ""dependency"" in the really hard sense of link time, but dependency in a weaker sense.

I might not insist on this fix to get this merged and testable.  But I'm not wholly satisfied without it.
"
1135802233,2867,Paul-Licameli,2022-05-24T11:37:58Z,"I pushed a small commit 93b60966a10d36998a990e467cd5d115b1e9d170 onto the branch, in case my point about a pure virtual having definition was unclear.

This completes another round of review.  I hope this converges today into something we merge and let QA test.
"
1135806963,2867,Paul-Licameli,2022-05-24T11:43:07Z,"One more thing -- did you resolve the point, that a click on the ""[Add] Effects"" button should reset the track focus?  I don't see where that omission was fixed.
"
801468758,759,bitigchi,2021-03-17T21:56:33Z,"Hi, thanks for the translations. I'll continue the review later on, but so far these translations are hardly an improvement over the current ones, moreover some of the previously correct translations are broken. I'd recommend a re-pass over the translations as a whole, and make sure that the ""audio"" context is preserved."
801662932,759,serkan-maker,2021-03-18T06:20:06Z,"Hello, I corrected some incorrect translations. I did not make much change in the current translation. The majority was to add accelerators. I fixed the translation of the most parts. I would appreciate it if you report the mistake I made, I would be considered a novice in the translation business. There are also 270 missing translation lines that are not in the .pot file but are available in the interface. These missing lines are present in the .po file but cannot be used.
[audacity_tr.po.zip](https://github.com/audacity/audacity/files/6161718/audacity_tr.po.zip)
"
801782345,759,bitigchi,2021-03-18T09:49:45Z,"I will continue reviewing later on. It will take a while, since I was able to barely review a quarter of the changes."
801873229,759,serkan-maker,2021-03-18T12:04:59Z,"I corrected the wrong translations you warned
[tr.po.zip](https://github.com/audacity/audacity/files/6163845/tr.po.zip)
"
801877324,759,bitigchi,2021-03-18T12:12:32Z,"> I corrected the wrong translations you warned
> [tr.po.zip](https://github.com/audacity/audacity/files/6163845/tr.po.zip)

Thanks for the corrections, I appreciate it. Is it possible to commit your changes here for easier review?"
802638643,759,serkan-maker,2021-03-19T08:12:07Z,"incorrect translation corrections
[tr.po.zip](https://github.com/audacity/audacity/files/6169563/tr.po.zip)
"
1233188463,3432,Paul-Licameli,2022-08-31T16:56:23Z,"My review of `lib-cloud-audiocom` and earlier commits is done.
"
1234259431,3432,Paul-Licameli,2022-09-01T13:10:00Z,"Done
"
1234913086,3432,Paul-Licameli,2022-09-01T23:40:37Z,"Another omission you might fix:  make a `AttachedToolBarMenuItem` in ShareAudioToolbar.cpp analogous with other toolbars, so that there is a new View > Toolbars menu item.
"
1235329701,3432,crsib,2022-09-02T10:23:18Z,There will be additional changes added
1235333843,3432,Paul-Licameli,2022-09-02T10:28:03Z,"> There will be additional changes added

OK, I'll merge my two little PRs rather than yield to you now
"
1235621511,3432,Paul-Licameli,2022-09-02T15:15:24Z,"The hidden dependency is broken, so mod-pcm etc. might still be extracted -- good.

The configuration of preferred types is stored in lib-cloud-audiocom and not in the UI layer.  OK.

Otherwise I'm not sure I understand the other objections to my draft solution, or why there is an essential difference.

Why would it be so wrong in principle to combine the two abstract interfaces if in future the ExportPlugin interface could be demoted into a library too?  The concrete implementations of ExportPlugin and associated CloudExporterPlugin end up side-by-side anyway.

And it's not even necessary, for cycle breaking, to demote the new CloudExporterPlugin interface into a library.  lib-cloud-audiocom depends on lib-cloud-upload -- but really only for MimeTypesList which is just a few type aliases.

I don't know quite what you mean about the existing exporter framework being so difficult to rewrite. It is true that it has its own ""statefulness"" problem much like effects.  Each particular exporter has a set of global variables for preferred settings.  Is there some great need for a menu of ""Presets"" for each exporter?  Would we store those in std::anys? ...

Finally my foolish question, why can't any file format you like be uploaded to cloud, then downloaded again to another Audacity executable that can interpret the same format?  Why can't we have open-endedness here?  I don't understand the technical limitation that the server would impose againt it.
"
1235702193,3432,crsib,2022-09-02T16:34:22Z,"> Why would it be so wrong in principle to combine the two abstract interfaces

Well, this is wrong ... in principle. For example, it breaks ISP, which is I in SOLID. I do not like the implementation I proposed either, but provided the current framework it will have to stay for now. Hopefully, it would be removed one day.

 ExportPlugin should know nothing about the possibility of audio uploads. Uploading is an optional feature. Uploading depends on exporting, not vice versa. I can easily see how we need to extend those interfaces based on user testing, I do not want to change ExportPlugin interface to do that. You are correct, that implementations reside close to the plugins now, but that is not because I like it there. There is simply no other feasible options right now.

> std::anys

To be fair I had never seen usage of `any` that solved problems instead of introducing ones. Scripting language binding, commonly referred as a `good example`, are not using `any`. Scripting languages have a very well defined set of types and bindings must know how to map the specific host language type into a scripting language type. `any` has virtually no use there. Python has a stronger type system than C, so to speak.

Speaking of exporter configuration I am afraid that FFmpeg approach is the ""nessecary evil"". That is - we have a string identifier mapping a well defined variant, with values checked by a plugin for validity. Plugin, on the other hand, provides a list of supported options with the constraints on them, so the UI can be built.

Using `any` as a configuration will not allow interface clients to supply configuration to the plugin unless we link against a specific plugin. However, I like the presets idea very much.

> why can't any file format you like be uploaded to cloud

audio.com is an audio sharing service. That is - it needs to know how to play and how to transcode the uploaded audio ."
1235719425,3432,Paul-Licameli,2022-09-02T16:54:46Z,"I'm not sure I understood all of the previous.  std::any is surely a dangerous escape into typelessness, unlike std::variant, and not to be overused, but it does allow open-endedness as variant does not.  I think it is the right tool for the job in the system of effects.

There are ""producers"" of anys (Effects doing MakeSettings) and ""consumers"" that can interpret them (instances) but in between a custodian that ""warehouses"" them (RealtimeEffectState).  The middleman needs to belong to a lower level of the dependency graph, and not need to know a closed-ended variant of possibilities, which would violate ""D"".  The middleman's job is to guarantee only that it gives the right anys back to the right parties that ask to use them and know how to interpret them.
"
1235744930,3432,crsib,2022-09-02T17:24:56Z,"> but it does allow open-endedness

I do not agree, but I though we agreed to disagree here :-)

> I think it is the right tool for the job in the system of effects.

There are significant limitations that will make implementing certain features expensive or not possible. On top of that, it makes debugging hard. So we are not on the same page here as well. (Think of any feature that needs a list of parameters!)

 > which would violate ""D""

I'm not sure how D will be violated, but L is violated right now. D, as in dependency inversion, is very strict on L. Otherwise it is impossible to make the system safe.

> The middleman needs

I am not convinced yet that this middleman itself is needed and there is definitely no need for it in exporters :-) Using similar approach for exporters will not solve the issue we are discussing right now.



"
1235764887,3432,Paul-Licameli,2022-09-02T17:50:41Z,"I don’t understand what alternative you would suggest for the system of effects.

EffectSettings may have been stretched for too many purposes that should be separated — yes.  The inter-thread communication could be simpler.  I have ideas for that I would like to do next release.

Still see the need for Real-time Effect State to store some polymorphic data for the related stateless Effect object to interpret and serialize and deserialize."
1235773417,3432,crsib,2022-09-02T18:01:52Z,">  stateless Effect object to interpret and serialize and deserialize

This just means, that stateless Effect is not serializable, the statefull EffectInstance is. 

> I don’t understand what alternative you would suggest for the system of effects.

Quite a complex topic to discuss on a train using a phone. Can we discuss it sometimes later please?
"
934524358,1193,Paul-Licameli,2021-10-05T15:40:07Z,"Thank you, Edward.  The merging of this work was done, but not using the GitHub interface to do it.
"
1271882058,1193,tank-trax,2022-10-07T17:54:22Z,How does this work? I can't find any spectral data control panel
1271887991,1193,Paul-Licameli,2022-10-07T18:02:00Z,"> How does this work? I can't find any spectral data control panel

It is not yet exposed to end users.  If you build your own from source, you can modify Experimental.CMake to get it"
1272001494,1193,tank-trax,2022-10-07T19:10:22Z,"after enabling **BRUSH_TOOL** this error appears and the build fails (should I open another ticker?)


```
~/src/audacity/audacity/src/SpectralDataDialog.cpp: In constructor ‘SpectralDataDialog::SpectralDataDialog(AudacityProject&)’:
~/src/audacity/audacity/src/SpectralDataDialog.cpp:175:19: error: ‘EVT_AUDIOIO_PLAYBACK’ was not declared in this scope
  175 |    wxTheApp->Bind(EVT_AUDIOIO_PLAYBACK,
      |                   ^~~~~~~~~~~~~~~~~~~~
~/src/audacity/audacity/src/SpectralDataDialog.cpp:179:19: error: ‘EVT_AUDIOIO_CAPTURE’ was not declared in this scope
  179 |    wxTheApp->Bind(EVT_AUDIOIO_CAPTURE,
      |                   ^~~~~~~~~~~~~~~~~~~
[ 69%] Building CXX object src/CMakeFiles/Audacity.dir/SpectrumAnalyst.cpp.o
make[2]: *** [src/CMakeFiles/Audacity.dir/build.make:1339: src/CMakeFiles/Audacity.dir/SpectralDataDialog.cpp.o] Error 1
make[2]: *** Waiting for unfinished jobs....
make[1]: *** [CMakeFiles/Makefile2:2694: src/CMakeFiles/Audacity.dir/all] Error 2
make: *** [Makefile:163: all] Error 2

```"
1272054881,1193,Paul-Licameli,2022-10-07T20:18:12Z,"> after enabling **BRUSH_TOOL** this error appears and the build fails (should I open another ticker?)
> 
> ```
> ~/src/audacity/audacity/src/SpectralDataDialog.cpp: In constructor ‘SpectralDataDialog::SpectralDataDialog(AudacityProject&)’:
> ~/src/audacity/audacity/src/SpectralDataDialog.cpp:175:19: error: ‘EVT_AUDIOIO_PLAYBACK’ was not declared in this scope
>   175 |    wxTheApp->Bind(EVT_AUDIOIO_PLAYBACK,
>       |                   ^~~~~~~~~~~~~~~~~~~~
> ~/src/audacity/audacity/src/SpectralDataDialog.cpp:179:19: error: ‘EVT_AUDIOIO_CAPTURE’ was not declared in this scope
>   179 |    wxTheApp->Bind(EVT_AUDIOIO_CAPTURE,
>       |                   ^~~~~~~~~~~~~~~~~~~
> [ 69%] Building CXX object src/CMakeFiles/Audacity.dir/SpectrumAnalyst.cpp.o
> make[2]: *** [src/CMakeFiles/Audacity.dir/build.make:1339: src/CMakeFiles/Audacity.dir/SpectralDataDialog.cpp.o] Error 1
> make[2]: *** Waiting for unfinished jobs....
> make[1]: *** [CMakeFiles/Makefile2:2694: src/CMakeFiles/Audacity.dir/all] Error 2
> make: *** [Makefile:163: all] Error 2
> ```

Please do.  Sorry, I'll get that fixed in the next-release branch.
"
1611474835,4853,saintmatthieu,2023-06-28T14:03:06Z,This PR is based on currently-in-QA https://github.com/audacity/audacity/pull/4797
1611482097,4853,saintmatthieu,2023-06-28T14:07:14Z,"Message of second commit:
> lib-numeric-format implements `ProjectTempoPublisher` and offers a `ProjectTempoListenerInterface`.
Whoever implements the listener must be able to use the `TrackList` to make sure all tracks of a project get the update, AND to make sure newly added tracks also get the project tempo set.
Since lib-track and lib-numeric-format do not depend on one another, I have the source code itself implement the listener.

My first approach during the early PoC days was to have `lib-wave-track` depend on `lib-numeric-format`. It was a request from @Paul-Licameli that I avoid this dependency and we came up with this solution. I still am not convinced that it is the wisest choice, though, since it comes at the cost of rather lots of synchronization code. Also, at it stands I implement `ProjectTempoListenerInterface` in `src` itself, which means more work for the Qt migration I suppose?"
1611596798,4853,Paul-Licameli,2023-06-28T14:54:16Z,"Actually, I'm questioning the need for this PR at all.

`WaveClip` has a stub `SetProjectTempo` not doing anything yet.  What will happen in future?  You will store a `double`?

Is the intention that `WaveClip`s will default their tempo to the project tempo, unless otherwise changed by the user for the individual clip?

But why not simply store `optional<double>`?

You understand we can't have `WaveTrack` or `WaveClip` store back-pointers to the Project or any attachment of the project, because copy-paste across projects would then have dangling pointers.

But in all places where it matters to retrieve the clip ratio, arrange to supply the value from the project as context information.

For instance, the stretching sequence decorator can be constructed with that value. `StretchingSequence::Create` is now used in three places.  In two, there is a `TrackList` available that can be queried for its project.  The third is in `MixAndRender` and the two callers of that have a `TrackList` so it would not be hard to add one argument for the value.


"
1611607857,4853,Paul-Licameli,2023-06-28T15:00:55Z,"Or put this another way -- can you make a bigger PR?  Show me how `WaveClip::GetStretchRatio` becomes a real function and not just the stub returning 1.0 always.

Then I'd say, change it to take default tempo as an argument, figure out all other necessary changes in `lib-stretching-sequence` to supply that argument, and then working up the call stack, you would arrive at the uses of `StretchingSequence::Create`.

Then maybe all this effort with publishers and listeners won't be needed, and we will have one less consistency invariant in the data structures that we would need to worry about preserving.

"
1612018981,4853,saintmatthieu,2023-06-28T19:55:59Z,"The stretch ratio (not only clip-specific, but that which takes project tempo into account too) isn't only needed during playback, but also for painting. And we must care to look at up-to-date project tempo values, too.
That said, playback assumes constant project tempo (we want to disable the possibility of tempo change during playback), so your suggestion would probably work in this case.
As for the painting, it's all in `src`, so yeah, looks like an up-to-date project tempo value can be queried for each painting pass.
I'll try it out."
1612035927,4853,crsib,2023-06-28T20:09:58Z,"Constant tempo during the playback is not the design choice, we just had no time to make the tempo and time signature variable.

And even with tempo being constant for the whole project duration, I am not sure that changing the tempo during the playback is disabled now or should be disabled in the future.

I haven't looked through the PR yet, so I don't know why there is a need for another publisher."
1612057316,4853,saintmatthieu,2023-06-28T20:28:15Z,"> Constant tempo during the playback is not the design choice, we just had no time to make the tempo and time signature variable.

I can't think of anything UX-wise that should prevent tempo change during playback, but even with more time it seems to me that the implementation cost is not worth the additional convenience for the user. In any case, yes, we don't have time in this iteration. I believe this was mentioned during stand-up, there seemed to be a consensus that tempo change could be disabled during playback, and no one mentioned it should be done on the longer term. You'd be the first :)"
1612233455,4853,Paul-Licameli,2023-06-28T23:23:47Z,"Tempo change during playback might raise the problem of proper updates without race conditions when a worker thread needs to query the tempo.

Maybe `GetStrerchRatio` needs a context type that will contain a constant double in a first version but a virtual function to get the varying tempo in future and the override could use atomics."
1612331811,4853,Paul-Licameli,2023-06-29T02:11:47Z,"See also the TrackArtist structure and uses of TrackArtist::Get.  That's how other context information can be got into drawing routines.

See TrackPanel::DrawTracks where things are set up in this context.
"
1612718918,4853,saintmatthieu,2023-06-29T09:39:45Z,"Trying the project-tempo-passed-as-argument-when-needed approach ... There's a difficulty, that could be worth tackling.

`WaveClip` boundary getters and setters (`GetPlayStartTime`, `SetSequenceStartTime`, etc) use _seconds_. Now consider situations such as this one :
1. User moves clip, which updates its boundary member variables.
2. User changes tempo.
3.  Painting wants to paint, which requires clip to report its time boundaries. The correct value would be `boundaryInSeconds * tempoWhenBoundaryWasSet / currentTempo`. Where do we get `tempoWhenBoundaryWasSet` ?

Possible approaches:
* Publisher approach: Like I've been doing so far: each project tempo change is published to clip, which modifies its boundaries accordingly. This requires this PR.
* ProjectTimeSignature approach: similar to the publisher approach, except `lib-wave-track` depends on `lib-numeric-format`.
* Beat approach: Clip boundaries are expressed in beats, as well as all its public methods.

| | Pros | Cons |
|--- | ------------- | ------------- |
| **Publisher** | * Proven to work<br/>* likely fastest delivery | * need to maintain up-to-date values<br/>* rounding errors might build up (each tempo change implies a `*=` operation on those time values)  |
| **ProjectTimeSignature** | * no need for a ""new publisher"" | * need to pass correct reference when copy-pasting, c.f. `SampleBlockFactory`<br/>* maintenance of clip time boundaries is still needed |
| **Beat** | * clips don't worry about tempo changes<br/>* consistent with UI : project tempo changes modify position in time view, not B&M view -> might have unforeseen positive side-effect | * clients must know project tempo when asking these values (may not be a bad thing)<br/>* compatibility |

**Explanation about the compatibility problem of the beat approach** :
Old Audacity projects store boundary-related clip member variables in seconds. To convert them in beats, the project tempo must be known. This information, available somewhere in the project file, will have to be communicated to the clip.
Backward compatibility (opening 3.4+ projects with older versions), if deemed important, could also be achieved by saving time values, in which case project tempo at save time will also have to be communicated.

I have a goodish feeling about the beat approach. I'll give it a try, at least until new feedback arrives.
"
1613117496,4853,Paul-Licameli,2023-06-29T12:46:01Z,"> Trying the project-tempo-passed-as-argument-when-needed approach ... There's a difficulty, that could be worth tackling.
> 
> `WaveClip` boundary getters and setters (`GetPlayStartTime`, `SetSequenceStartTime`, etc) use _seconds_. Now consider situations such as this one :
> 
> 1. User moves clip, which updates its boundary member variables.
> 2. User changes tempo.
> 3. Painting wants to paint, which requires clip to report its time boundaries. The correct value would be `boundaryInSeconds * tempoWhenBoundaryWasSet / currentTempo`. Where do we get `tempoWhenBoundaryWasSet` ?
> 
> Possible approaches:
> 
> * Publisher approach: Like I've been doing so far: each project tempo change is published to clip, which modifies its boundaries accordingly. This requires this PR.
> * Beat approach: Clip boundaries are expressed in beats, as well as all its public methods.
> 
> Pros	Cons
> **Publisher**	* Proven to work
> * likely fastest delivery	* need to maintain up-to-date values
> * rounding errors might build up (each tempo change implies a `*=` operation on those time values)
> **Beat**	* clips don't worry about tempo changes
> * consistent with UI : project tempo changes modify position in time view, not B&M view -> might have unforeseen positive side-effect	* clients must know project tempo when asking these values (may not be a bad thing)
> * compatibility
> **Explanation about the compatibility problem of the beat approach** : Old Audacity projects store boundary-related clip member variables in seconds. To convert them in beats, the project tempo must be known. This information, available somewhere in the project file, will have to be communicated to the clip. Backward compatibility (opening 3.4+ projects with older versions), if deemed important, could also be achieved by saving time values, in which case project tempo at save time will also have to be communicated.
> 
> I have a goodish feeling about the beat approach. I'll give it a try, at least until new feedback arrives.

My understanding of “beats” is that you normalize out any tempo information when modifying the clip.  Then only current tempo is needed.

I think that may work better.

Maybe this PR should be closed and you will propose another that really stores new information in clips so I can better understand the whole.
"
1613313492,4853,saintmatthieu,2023-06-29T14:46:10Z,"> My understanding of “beats” is that you normalize out any tempo information when modifying the clip. Then only current tempo is needed.

Modifying the project tempo also counts as clip modification (its boundaries)."
1613361585,4853,saintmatthieu,2023-06-29T15:13:51Z,Closing this PR for now makes sense until new developments.
1613515366,4853,saintmatthieu,2023-06-29T16:43:18Z,"It's quite thrilling ... hard to formulate simply and convincingly, even to myself. I think key to understand the problem is indeed that _one tempo change is all it takes_ to invalidate clip boundaries. _Beats_ remain constant, seconds don't.

Imagine:
1. Hey clip, set start time to 60s.
2. I'm going to change project tempo now ...
3. Hey clip, what's your start time again ?

Clip cannot tell, unless it knows by how much the project tempo has changed between. It is _not_ sufficient (@Paul-Licameli) for the client to know tempo in step 3 : the answer differs if all three following examples:
A) Tempo was 60bpm in 1 and is now 120bpm in 3 => answer is 30s
B) Tempo was 120 and is now 60 => answer is 120s
C) Tempo was 120 and is now 240 => answer is 30s.

I've said this already earlier: the publisher approach makes sure that the tempo is known at any time, which enables giving the correct answer without changing the `WaveClip` boundary-related methods - and there's many of them:
* GetSequenceStartTime
* SetSequenceStartTime
* GetPlayStartTime
* SetPlayStartTime
* GetPlayEndTime
* SetPlayEndTime
* SetTrimLeft
* GetTrimLeft
* SetTrimRight
* GetTrimRight
* TrimLeft
* TrimRight
* TrimLeftTo
* TrimRightTo
* Offset
* WithinPlayRegion
* BeforePlayStartTime
* AfterPlayStartTime

I don't think I can give a better impression of what any alternative to the proposal in this PR would look like in terms of size. I, personally, would still prefer to have clips store their boundaries in beats. It might hurt now, but could bring good after."
1613532118,4853,Paul-Licameli,2023-06-29T16:57:01Z,"We must choose between the pain of redundant data stored in each clip, with the problems of invalidation.

Or the pain of changing all of those functions to accept ""Wave Clip Context"", but then, boundaries become computed.

I still feel inclined toward the second pain.  Once it is done, ""Wave clip Context"" can also be enlarged to carry other information, and we won't need other publishers and listeners.

"
1613540105,4853,Paul-Licameli,2023-06-29T17:02:48Z,"> We must choose between the pain of redundant data stored in each clip, with the problems of invalidation.
> 
> Or the pain of changing all of those functions to accept ""Wave Clip Context"", but then, boundaries become computed.
> 
> I still feel inclined toward the second pain. Once it is done, ""Wave clip Context"" can also be enlarged to carry other information, and we won't need other publishers and listeners.

Maybe the first will look like the lesser short-term pain, after all, but my intuition is that the second would be better for longer term maintainability.
"
1613541601,4853,crsib,2023-06-29T17:04:06Z,"Do we need a context other than AudacityProject, though? I don't quite understand the problem now; I will chat with @saintmatthieu tomorrow."
1613693798,4853,saintmatthieu,2023-06-29T19:37:12Z,"The context we need is `ProjectTimeSignature`, an attachment to the audacity project in `lib-numeric-format`. That dependency graph node and `lib-wave-track`, where this context need is seen for the first time, have no inter-dependency, and @Paul-Licameli is reluctant in establishing one."
1613725844,4853,DavidBailes,2023-06-29T19:52:15Z,"> I think key to understand the problem is indeed that _one tempo change is all it takes_ to invalidate clip boundaries. _Beats_ remain constant, seconds don't.

At least some DAWs seem to have options for the timebase. eg:
https://steinberg.help/cubase_pro_artist/v9/en/cubase_nuendo/topics/track_handling/track_handling_defining_the_track_time_base_t.html
https://prorec.com/change-tempo-in-reaper-without-stretching-timebase/

Is the plan for Audacity not to have such options? Or have I misunderstood what you have written?"
1613732428,4853,crsib,2023-06-29T19:57:16Z,"As I understand, the primary concern of Paul is that we cannot store any references to AudacityProject in the clips due to copy/paste implementation details. This concern is very convincing :-)

"
1613764561,4853,Paul-Licameli,2023-06-29T20:23:37Z,"> As I understand, the primary concern of Paul is that we cannot store any references to AudacityProject in the clips due to copy/paste implementation details. This concern is very convincing :-)

That was a concern in @saintmatthieu 's prototype efforts.  It's not my concern now, with this or the alternative proposals.

A context passed whenever some computed result is needed allows the clip not to store a reference to the context object.

But as @saintmatthieu said I don't like accumulating unnecessary dependencies.

A context, which is not AudacityProject& or any object within it, can itself be computed as needed upstairs in src/, where wide dependencies are acceptable, and passed by value as a struct.

A problem is getting that context into all the right places must disturb much code.  But the alternative of pushing redundant copies of project tempo information into each clip whenever there is a change -- seems questionable too, increasing the problems of keeping project data consistent.
"
1614234791,4853,saintmatthieu,2023-06-30T07:17:07Z,">  the primary concern of Paul is that we cannot store any references to AudacityProject in the clips due to copy/paste implementation details

There is the possibility of passing the correct `ProjectTimeSignature` as argument to clip copy constructors, the way it already is done with `SampleBlockFactory`.

For the sake of completeness I'll add this option to the table."
1614253818,4853,crsib,2023-06-30T07:35:11Z,"> A context, which is not AudacityProject& or any object within it, can itself be computed as needed upstairs in src/, where wide dependencies are acceptable, and passed by value as a struct.

I am strongly opposed to this solution. It will make Audacity fragile and hard to extend, it immediately makes a NEW non-UI feature in Audacity not available to Qt. 

The dependence of `WaveClip` (or rather of any `Track`) on tempo is explicitly specified in product design. It can be made implicit in code, indeed, but this sounds like an enormous source of errors more than anything else.

Previously, when the need for such context occurred, you pushed hard against it and I agreed with you. I don't honestly understand how is this case different. "
1614303424,4853,saintmatthieu,2023-06-30T08:18:58Z,"@crsib trying to understand your concern, please correct me if I'm wrong.

> It can be made implicit in code

You mean `WaveClip` storing boundaries (`mTrimLeft`, `mSequenceOffset`, etc.) as beats rather than seconds, implying tempo must be specified for these to become convertible to seconds and sample indices.

>  it immediately makes a NEW non-UI feature in Audacity not available to Qt

Could you give a concrete example? So far the identified places where `src` would have to pass the project tempo information is when the transport tracks are constructed for playback and rendering, as well as where painting (waveform and spectrum) is needed. Aren't these places where tempo will be available, whether now or in Qt?"
1614323965,4853,crsib,2023-06-30T08:36:14Z,"> You mean WaveClip storing boundaries (mTrimLeft, mSequenceOffset, etc.) as beats rather than seconds, implying tempo must be specified for these to become convertible to seconds and sample indices.

No. Why? I'm talking about introducing some external generic context with ""all we need to calculate the boundaries, drawing, and everything"". Like `TrackPanelDrawingContext`, which is so generic that it even has a `void*` ""user data"" field! Does it remove the dependency on tempo? It does not.

> Could you give a concrete example?

Playback will be lifted from the `src` tree, and drawing won't. Where should we fill this ""externalized"" context? What should we do when the context extends? And we anticipate that it will extend. Otherwise, we could just pass ""tempo"" value. But we have an example with effects already where we cannot have beats display because initially, we pass only the sample rate instead of a more general context.
"
1614343885,4853,Paul-Licameli,2023-06-30T08:52:47Z,"> > A context, which is not AudacityProject& or any object within it, can itself be computed as needed upstairs in src/, where wide dependencies are acceptable, and passed by value as a struct.
> 
> I am strongly opposed to this solution. It will make Audacity fragile and hard to extend, it immediately makes a NEW non-UI feature in Audacity not available to Qt.
> 

This objection is not strong.  It may only mean that the place where the context is built is not yet extracted into a higher level library.  The library extraction effort is paused to get all this other work done.

I would like to avoid lib-wave-track depending on more things.  What if I concede that?  Then AudacityProject& is enough context.

> The dependence of `WaveClip` (or rather of any `Track`) on tempo is explicitly specified in product design.

Design specifies desired program behavior.  It does not specify any such implementation choice.

> It can be made implicit in code, indeed, but this sounds like an enormous source of errors more than anything else.
> 
> Previously, when the need for such context occurred, you pushed hard against it and I agreed with you. I don't honestly understand how is this case different.

Remind me what you refer to.

Anyway if context is not used, and a “push” of tempo info into each clip really must be done, then a roundabout way of doing it as in the closed PR will be needed.

But I can’t approve this PR without seeing and understanding more of the whole, and whether the alternative really makes more sense.
"
1614364953,4853,crsib,2023-06-30T09:07:03Z,"> Remind me what you refer to.

I refer to #4414

> I would like to avoid lib-wave-track depending on more things

It explicitly depends on `lib-project-rate-interface` already. I understand your concern about `lib-numeric-format`, but I can easily extract ProjectTimeSignature into another library. I don't expect that it will take more than 30 minutes.

> But I can’t approve this PR without seeing

Nor do I. We are very aligned on this.

> It does not specify any such implementation choice.

Behavior specifies an explicit dependency on tempo. It can be hidden by introducing a transfer object of some kind (call it Context), but it does not remove this dependency. Failing to correctly specify the tempo will result in an error. "
1614366498,4853,saintmatthieu,2023-06-30T09:08:20Z,"> I'm talking about introducing some external generic context

Oh, ok. My concern for now is limited to tempo context. I still am not 100% sure that this is also something you see a problem with. You mention real-time effects, but I'm not too concerned that these need project tempo information."
1614369512,4853,crsib,2023-06-30T09:10:48Z,"> but I'm not too concerned that these need project tempo information.

They do, regardless of the time stretch. We cannot allow using bars/beats for the duration in generators because they cannot access the time signature and tempo. There are plans, currently on hold, to fix that."
1614397756,4853,Paul-Licameli,2023-06-30T09:34:50Z,"> > but I'm not too concerned that these need project tempo information.
> 
> They do, regardless of the time stretch. We cannot allow using bars/beats for the duration in generators because they cannot access the time signature and tempo. There are plans, currently on hold, to fix that.

Do you refer to my attempts to define EffectContext?

The recently reviewed RAII object for temporary effect output tracks was spun off from that other effort to remove state from EffectBase.


"
1614400307,4853,crsib,2023-06-30T09:36:57Z,"> Do you refer to my attempts to define EffectContext?

Exactly!"
1614406714,4853,Paul-Licameli,2023-06-30T09:42:13Z,"> > the primary concern of Paul is that we cannot store any references to AudacityProject in the clips due to copy/paste implementation details
> 
> There is the possibility of passing the correct `ProjectTimeSignature` as argument to clip copy constructors, the way it already is done with `SampleBlockFactory`.
> 
> For the sake of completeness I'll add this option to the table.

Maybe that will after all look like the least difficult thing, if more dependency from lib-wave-track is allowed.

But consider what I asked elsewhere about maybe under specified behavior of other kinds of tracks. 

"
1614412228,4853,Paul-Licameli,2023-06-30T09:47:03Z,"> not too concerned

Are you two thinking of the same thing?  I think Matthieu refers to the playback, not the ui, and for that we have the stretching decorator encapsulating the time stretch calculations."
1614412771,4853,crsib,2023-06-30T09:47:33Z,"> But consider what I asked elsewhere about maybe under specified behavior of other kinds of tracks.

Absolutely, let's raise it at the meeting today!"
1614415043,4853,Paul-Licameli,2023-06-30T09:49:27Z,"> > But consider what I asked elsewhere about maybe under specified behavior of other kinds of tracks.
> 
> Absolutely, let's raise it at the meeting today!

I will be climbing a mountain now that there’s finally some good weather here
"
1615194636,4853,saintmatthieu,2023-06-30T21:04:31Z,"Trying out the beat approach. It turns out to be a very healthy exercise, insofar as it reveals that some methods now make little sense ...
<br/>

Time values cannot index to specific positions in tracks or clips anymore without a tempo specified. It'd be like asking when a given sample must be played out without knowing the speed of the cursor.

For clips, we still can have methods like `Get(sampleCount start, size_t length)`, since the left-trimmed part is actually a fraction of the raw data. We ignore that fraction of the raw samples, and start from there, reading unstretched, raw data.

Tracks are the arrangement of clips onto a timeline with beat units. As such, they _must_ return stretched data : it wouldn't make sense for the UI to show clip A lasting 1s, and then having it produce 2s worth of samples. `Get(sampleCount start, size_t len, ...` and the likes should therefore be banned from non-stretching-capable tracks.

So, `WaveTrack::Get` : gone. (Or `assert(false)` for now if it ever gets used.) `StretchingSequence` can stretch, so that's fine. The other is `CachingPlayableSequence` : I think this whole class should be gone. Without its  `Get` method it serves little purpose. The spectrum-display code should query the raw data on the clips directly (and stretch the display), using the `GetSampleView` method the way `CachingPlayableSequence` has been doing to ensure caching works.

And then come destructive effects...

On the one end, there's a `WideSampleSource`, calling `WaveTrack::Get`, and on the other, a `WideSampleSink`, calling `WaveTrack::Set`, with a per-track effect instance in between. I've argued already that `Get` should go. `Set` should go for the same reasons. What I think makes most sense instead is to have those source and sink classes handle clips directly too, in their order of appearance on the timeline, read _all_ samples (including those trim-hidden), process them, and write them back. Silence is ignored in between, leading to clip A possibly ringing into clip B, but ringing already happens in a not very convincing way UX-wise.

<br/>
I'm not finished yet with that experiment. Let's hope there are no more hurdles for it to reveal. Paul pointed out the label-track case today, which also are arrangement of objects on a timeline now with beat units, though..."
1615338747,4853,Paul-Licameli,2023-07-01T01:26:23Z,"> Trying out the beat approach. It turns out to be a very healthy exercise, insofar as it reveals that some methods now make little sense ...
> 
> Time values cannot index to specific positions in tracks or clips anymore without a tempo specified. It'd be like asking when a given sample must be played out without knowing the speed of the cursor.
> 
> For clips, we still can have methods like `Get(sampleCount start, size_t length)`, since the left-trimmed part is actually a fraction of the raw data. We ignore that fraction of the raw samples, and start from there, reading unstretched, raw data.
> 
> Tracks are the arrangement of clips onto a timeline with beat units. As such, they _must_ return stretched data : it wouldn't make sense for the UI to show clip A lasting 1s, and then having it produce 2s worth of samples. `Get(sampleCount start, size_t len, ...` and the likes should therefore be banned from non-stretching-capable tracks.
> 
> So, `WaveTrack::Get` : gone. (Or `assert(false)` for now if it ever gets used.) `StretchingSequence` can stretch, so that's fine. The other is `CachingPlayableSequence` : I think this whole class should be gone. Without its `Get` method it serves little purpose. The spectrum-display code should query the raw data on the clips directly (and stretch the display), using the `GetSampleView` method the way `CachingPlayableSequence` has been doing to ensure caching works.
> 
> And then come destructive effects...
> 
> On the one end, there's a `WideSampleSource`, calling `WaveTrack::Get`, and on the other, a `WideSampleSink`, calling `WaveTrack::Set`, with a per-track effect instance in between. I've argued already that `Get` should go. `Set` should go for the same reasons. What I think makes most sense instead is to have those source and sink classes handle clips directly too, in their order of appearance on the timeline, read _all_ samples (including those trim-hidden), process them, and write them back. Silence is ignored in between, leading to clip A possibly ringing into clip B, but ringing already happens in a not very convincing way UX-wise.
> 
> 
> I'm not finished yet with that experiment. Let's hope there are no more hurdles for it to reveal. Paul pointed out the label-track case today, which also are arrangement of objects on a timeline now with beat units, though...

Eliminating WaveTrack::Get and WaveTrack::Set, and making Mixer aware of clip boundaries, are radical ideas that I dont like.  I need persuading.
"
1615589796,4853,Paul-Licameli,2023-07-01T07:23:12Z,"What are you assuming about conservation of clip structure when rendering or applying a destructive effect?  What was specified by the design team?

Mix and render has never preserved it.  Existing destructive effects do not do it consistently.

If that change is not your idea alone but the design teams, I am very unhappy to learn about it now.

I am thinking of implications and I don’t like them.

But WaveTrackSink is not even used for all destructive effects, only those that inherit PerTrackEffect.  Whatever you think you will accomplish by these changes will not apply to all destructive effects.

I oppose changes for rendering too.  Rendering for export should be oblivious to clips, but just take streams of samples to mix into an audio file, which doesn’t have clips, and that means keeping the simple abstraction of sources.

Mixing and rendering to a track should not behave differently. It should give you the as-if-exported sound but still in a track.  Clip boundaries are lost.

"
1615593186,4853,Paul-Licameli,2023-07-01T07:29:02Z,"I have a growing suspicion that we have fundamentally erred in assuming all time stretch should apply upstream of stacked effects.  It seems to be creating too many problems.  Doing tempo stretch downstream, for drawing and playback and rendering, might cut through some problems.  The stretch determined by clip handles could be a separate upstream stretch.

Yes, drawing of clips may need to avoid WaveTrack::Get, fetching straight from clips and taking the handle drag into account.

But now I think tempo should be a separate thing, also in drawing context, available in drawing routines of all track types.

Mixing for export should also apply the tempo stretch as the last processing stage.  Mixing and rendering would omit that, so that the rendered track as played is exactly what would result from exporting the tracks instead.  But I don’t see how to get this property if tempo stretch is upstream instead.

Time stretch for tempo would need to be done in AudioIO.  That’s a lot of work messing with what is fed into those ring buffers.  Maybe multiple levels of ring buffers are needed!  I’ll think of something.

(Do we also want dynamic variation of tempo during playback?  More headache.)

The problems of Get and Set in PerTrackEffect may be unimportant because the sources and sinks are really sequential, not random access.

WaveTrack::Set needs to exist still to implement the pencil tool, or maybe a direct WaveClip::Set. You zoom in until you see samples (though now some stretch is applied in drawing them), and you edit them directly.

Where WaveTrack::Set is still used in destructive effects, leave it alone.  I don’t want universal preservation of clip structure suddenly imposed as a new surprise requirement.

Tempo stretch seems to me to want to be a high level project wide thing that is applied in the right contexts, and can be kept out of WaveClip or any other track subtype.
"
1615689796,4853,saintmatthieu,2023-07-01T08:30:21Z,"> What are you assuming about conservation of clip structure when rendering or applying a destructive effect? What was specified by the design team?

Behavior relating to clip preservation would change in neither mix-and-rendering, export nor destructive effects. `WideSequenceSource` and `WideSequenceSink` would now deal with clips directly (or `ClipInterface`, or whichever few methods they need from clips) and not with a `WideSampleSequence`. Their implementation wouldn't need to know where clips are on the UI representation, but could just process them one after the other, ignoring silence in between. This process would change the _contents_ of the clips, but not affect their _boundaries_ on tracks."
1615691102,4853,saintmatthieu,2023-07-01T08:31:46Z,"> I have a growing suspicion that we have fundamentally erred in assuming all time stretch should apply upstream of stacked effects.

In the case of destructive effects, no stretching comes in to play."
1615705262,4853,crsib,2023-07-01T08:39:26Z,"> This process would change the contents of the clips, but not affect their boundaries on tracks.

mix-and-render changes the clip boundaries by design (effectively by creating a single clip, dropping attached effects etc), I don't think that it is wise to change this behavior. Probably I don't understand you correctly. FWTIW playback, rendering, and export could be viewed as the same process, but with different sinks, and for mix&render the sink is just a track. 

> In the case of destructive effects, no stretching comes in to play.

I am a bit confused. I don't think that there are commutative properties in effect application. Wouldn't it make a destructive application result to be very different in some cases? "
1615720170,4853,saintmatthieu,2023-07-01T08:45:14Z,"> mix-and-render changes the clip boundaries by design

By destructive effects I've been meaning selecting a track, choosing an effect and applying it. This preserves clip boundaries now, and it still would with my suggestion."
1615741826,4853,saintmatthieu,2023-07-01T08:59:27Z,"> I am a bit confused. I don't think that there are commutative properties in effect application. Wouldn't it make a destructive application result to be very different in some cases?

Say you have a clip and stretch it by a ratio of 2. Now apply an effect. There are two possibilities:
1. Render an un-stretched clip : apply the effect a it is now, on the raw data. The result is still a clip with stretch ratio metadata 2.
2. Render a stretched clip : apply the effect and stretch (or the other way round). The result is a clip with stretch ratio metadata 1.

I have been suggesting 1. It is more conservative : stretch a clip by 2, apply gain, unstretch : it's as though you had never stretched. Also, the sources and sinks used wouldn't need to have time-stretchers injected.

Does that un-confuse you?"
1615762061,4853,Paul-Licameli,2023-07-01T09:12:55Z,"> > What are you assuming about conservation of clip structure when rendering or applying a destructive effect? What was specified by the design team?
> 
> Behavior relating to clip preservation would change in neither mix-and-rendering, export nor destructive effects. `WideSequenceSource` and `WideSequenceSink` would now deal with clips directly (or `ClipInterface`, or whichever few methods they need from clips) and not with a `WideSampleSequence`. Their implementation wouldn't need to know where clips are on the UI representation, but could just process them one after the other, ignoring silence in between. This process would change the _contents_ of the clips, but not affect their _boundaries_ on tracks.

Design team’s requirements or your ideas?

I suspect a lot of surprising consequences are not well thought out, such as the overlapping of clips, and restructuring every destructive effect to work this way is a bad surprise implying a lot of work no one budgeted."
1615771981,4853,Paul-Licameli,2023-07-01T09:19:48Z,"I think we need to separate clip stretching from project tempo, and do one, only one, of them well in this release.

I have a growing alarm about overreach.

I think tempo is the more valued thing, but my efforts have all been to support clip stretching.

I think downstream application of tempo stretch is the right thing for various reasons, but the alternative was not given proper early consideration.
"
1615773210,4853,Paul-Licameli,2023-07-01T09:21:40Z,"And doing it downstream means messing with the data communicated between threads in AudioIO, and that is the large problem I should be figuring out.  (And fixing the outstanding latency problems with it.)"
1615803665,4853,saintmatthieu,2023-07-01T09:49:36Z,"> Design team’s requirements or your ideas?

I don't see how this could be Design's idea. The behavior doesn't change, whether with stretched clips or not."
1615842180,4853,Paul-Licameli,2023-07-01T10:41:26Z,"So it’s not a requirement, it’s your own idea, but you are incorrect that separately applied effects on each clip would give equivalent results for all effects.

What does Reverb do it you select a clip and some empty space after it?"
1615854396,4853,saintmatthieu,2023-07-01T11:14:24Z,"This:
![image](https://github.com/audacity/audacity/assets/22740106/6659f9bb-bf34-406b-a8e2-21f96824a920)

"
1615861652,4853,saintmatthieu,2023-07-01T11:35:33Z,"... but that with delay:
![image](https://github.com/audacity/audacity/assets/22740106/c7dd8a0e-6ef3-48d7-a99b-31b12704a745)
That's new to me. I'm not too concerned that the source now has to know how much silence there is between each clip, but it also makes me realize that the parameters of timing-based effects (such as this one, a delay) must account for the stretch ratio. That'd need to be done on each timing-related effect one by one, would only (?) be a parameter change, but it may have other consequences. The alternative, indeed, is to do have the source apply time stretching - not the sink! Or the effect's timing is messed up just as much. Couldn't that work with a `StretchingSequence` ?"
1615865653,4853,Paul-Licameli,2023-07-01T11:42:34Z,"> This:
> ![image](https://user-images.githubusercontent.com/22740106/250270709-6659f9bb-bf34-406b-a8e2-21f96824a920.png)

Try it again, with a silent clip touching the other clip on the right."
1615867694,4853,Paul-Licameli,2023-07-01T11:47:22Z,"But I don’t like the ideas I’m hearing.

Im increasingly thinking the entire project needs a rethink.

My refactorings for wide wave clips and tracks are not wasted work, and the new caching was not either, but I have doubts now whether the stretching decorator is right.

Downstream application of time stretch seems better to me.  Why wasn’t it considered?  Maybe because doing it upstream was easier to figure out for a convincing prototype.  Doing it down may need other less obvious work but the alternative should be considered."
1615880783,4853,saintmatthieu,2023-07-01T12:15:58Z,"> Try it again, with a silent clip touching the other clip on the right.

The reverb of A leaks into B. So would it with the clip-by-clip approach I propose, as well as with a `StretchingSequence` used by the source."
1615881093,4853,crsib,2023-07-01T12:17:00Z,"I'm not sure that a follow the terminology, but I think that the stretching should happen before any other effect. Probably I'm wrong, @Tantacrul @LWinterberg can you please help with this?"
1615883998,4853,saintmatthieu,2023-07-01T12:22:10Z,"> I think that the stretching should happen before any other effect

I'd say so too. Timing-related effects would need to anticipate stretching to produce the wanted result. Take slap-back echo, for example. Apply it first, and stretch after, and you've stretched the slap-back time. Or the effect would have to compensate for stretching upstream, which sounds ugly."
1615885540,4853,saintmatthieu,2023-07-01T12:28:33Z,"> I am a bit confused. I don't think that there are commutative properties in effect application. Wouldn't it make a destructive application result to be very different in some cases?

@crsib you were one step ahead of me. Later in this conversation I was writing
> The alternative, indeed, is to do have the source apply time stretching - not the sink! Or the effect's timing is messed up just as much.

Sounds like a rule of thumb."
1615885627,4853,Tantacrul,2023-07-01T12:28:55Z,"I can't imagine applying time stretching after effects. As @crsib and @saintmatthieu say, it seems sensible for it to be first in the chain."
1615887337,4853,saintmatthieu,2023-07-01T12:34:35Z,"To be complete, possible would also be to time-stretch downstream of `WaveTrack`, with a time-stretcher which changes its ratio on the fly. The effects would still come after, and we wouldn't have had the joint-stereo problem.
I still feel better on a clip-based stretching instance, though, and have the guarantee that timing at the start of a clip doesn't depend on the stretcher's output until then. @Paul-Licameli this was the main reason driving me to suggest this approach from the start."
1615909162,4853,Paul-Licameli,2023-07-01T13:26:11Z,"> I can't imagine applying time stretching after effects. As @crsib and @saintmatthieu say, it seems sensible for it to be first in the chain.

One argument for applying tempo stretch last:

If you export, time stretch is applied in the resulting audio file.

If you mix and render, you should get a track that plays back exactly as the exported audio.  That means:  we should precompute everything except the tempo stretch, because playback will apply it.

This may not be possible if the stretch applies first in export."
1615915006,4853,Paul-Licameli,2023-07-01T13:30:46Z,"> > Try it again, with a silent clip touching the other clip on the right.
> 
> The reverb of A leaks into B. So would it with the clip-by-clip approach I propose, as well as with a `StretchingSequence` used by the source.

Then I do not understand the proposal. "
1615917673,4853,crsib,2023-07-01T13:33:59Z,"> If you export, time stretch is applied in the resulting audio file.

Is it what happens now? Then I would call it bug and fix it."
1615923336,4853,Paul-Licameli,2023-07-01T13:48:30Z,"> > If you export, time stretch is applied in the resulting audio file.
> 
> Is it what happens now? Then I would call it bug and fix it.

I mean I assume it would happen and be a feature.  Whatever you play in Audacity should be what
goes into the export.  We do that for the stacked effects, and would do it too for stretch.

Now honestly let me counter argue myself:  If tempo stretch applies before other stacked effects, then a solution is that mix-and-render also applies the inverse of project tempo stretch as the last stage of transformation before re-storing the samples.

Then playback inserts tempo stretching upstream, which cancels this.
"
1615926710,4853,Paul-Licameli,2023-07-01T13:53:16Z,"> > > If you export, time stretch is applied in the resulting audio file.
> > 
> > 
> > Is it what happens now? Then I would call it bug and fix it.
> 
> I mean I assume it would happen and be a feature. Whatever you play in Audacity should be what goes into the export. We do that for the stacked effects, and would do it too for stretch.
> 
> Now honestly let me counter argue myself: If tempo stretch applies before other stacked effects, then a solution is that mix-and-render also applies the inverse of project tempo stretch as the last stage of transformation before re-storing the samples.
> 
> Then playback inserts tempo stretching upstream, which cancels this.

But the counter counter is this:  Are we really sure that applying stretch by ratio r, then again by 1/r, is really an identity transformation in this implementation?"
1615928055,4853,crsib,2023-07-01T13:55:41Z,"I'm not sure I follow. Mix-and-render, similar to playback, similar to export, applies time stretch first. However the resulting track (and it's single clip) is not time stretched. Why do we need to do the reverse transform?

Yes, it will become very complicated when we allow to set the tempo curve, but right now this is not the case."
1615937957,4853,Paul-Licameli,2023-07-01T14:19:51Z,"> I'm not sure I follow. Mix-and-render, similar to playback, similar to export, applies time stretch first. However the resulting track (and it's single clip) is not time stretched. Why do we need to do the reverse transform?
> 
> Yes, it will become very complicated when we allow to set the tempo curve, but right now this is not the case.

Isn’t the project tempo stretch applied to all tracks?  Then if rendered tracks, being in the same project, have had the tempo stretched baked into the data, the playback will insert the tempo stretch again unless somehow the rendered track cancels it."
1615942630,4853,Paul-Licameli,2023-07-01T14:36:22Z,"On the other other hand… A solution can be that every clip stores what the project tempo was at the time it was created.  The stretch ratio depends on that and the current project tempo.

Or was that the idea all along?  I was foolish then."
1615949531,4853,Paul-Licameli,2023-07-01T14:54:59Z,"Whatever we do decide, stretching before or after effects — I want to know that designers considered the alternatives and really have a strong preference, or are decidedly neutral about it and will leave it to development to choose an implementation.

It seems it is not so:  that Martin is only now answering the question, and Matthieu did not consider alternatives or is acting on assumptions about which is better, that I’m not persuaded of.

If design is neutral, then I dislike Matthieu’s proposals as introducing unnecessary complexities we might avoid.

If design is not neutral, and at least some of these complexities are unavoidable, very well, we must accept them and make things work."
1615965992,4853,crsib,2023-07-01T15:41:10Z,"I think Martin has strongly asserted that time stretching should be applied first. I don't think that it makes sense to do it other way around. I feel that this oversight is similar to one with effect settings window modality. It was assumed to be obvious so it never was explicitly stated. 

For sample tracks, the amount of stretch is a property of a clip. Within a track clips
can have different stretching coefficients."
1615975218,4853,Paul-Licameli,2023-07-01T16:02:49Z,"> I think Martin has strongly asserted that time stretching should be applied first. I don't think that it makes sense to do it other way around. I feel that this oversight is similar to one with effect settings window modality. It was assumed to be obvious so it never was explicitly stated.
> 
> For sample tracks, the amount of stretch is a property of a clip. Within a track clips can have different stretching coefficients.

Maybe it’s obvious to others.  But I’d like Martin to speak for himself.  I may not understand the use cases.

What I do know is that if project tempo can be applied after all else, then it can cut through a lot of implementation difficulty.  (Ignore what I said about render and export: I now think  that can work with either choice.)

This is not the same problem as stretching each clip by a different adjusted ratio.

And I want to ask again, whether we should commit to doing only one of these in this release — either tempo adjustment (which was the purpose stated in this PR title) or clip adjustment (which is not) — in case we can’t solve all the difficulties of both on time."
1615977581,4853,Tantacrul,2023-07-01T16:12:29Z,"To avoid the risk of committing to a course of action without fully agreeing (because I, for one might miss something), I'd suggest we have a little chat early next week.

When talking about real-time effects, it's not very valuable to apply TS at the end of the effects chain. This is a production thing.

If someone here is discussing destructive effects, then I worry there's some use case (or technical weirdness in Audacity) I've failed to consider."
1616015844,4853,Paul-Licameli,2023-07-01T17:39:00Z,"> To avoid the risk of committing to a course of action without fully agreeing (because I, for one might miss something), I'd suggest we have a little chat early next week.
> 
> When talking about real-time effects, it's not very valuable to apply TS at the end of the effects chain. This is a production thing.
> 
> If someone here is discussing destructive effects, then I worry there's some use case (or technical weirdness in Audacity) I've failed to consider.

So, destructive effects were not a topic in those design meetings yet that I skipped?

I want so say:  identify known problems with timing dependent destructive effects, to fix in next release.

There is worrying scope creep getting discussed here, here dissipating our limited efforts.  Get all the other fundamentals done.  Leave destructives alone to behave however they will for this release.
"
1616034162,4853,Tantacrul,2023-07-01T18:17:30Z,"Let's chat. The last thing I want to do is accidentally give the impression that some large chunk of work now needs to be done. 


"
1616051900,4853,saintmatthieu,2023-07-01T19:00:10Z,"Time-stretching a clip by a factor of 2 and then again by a factor of 2 yields a result different from time-stretching that clip once by a factor of 4. Likewise, @Paul-Licameli, since you asked: stretching by 2 and then by 0.5 doesn't restore the original. Quality suffers from each pass. Our time-stretcher may be excellent, it's not perfect : there still is some amount of widening and smearing.

Therefore, the approach we're undertaking is the best from a quality point of view. Each clip's stretch ratio is the product of its individual stretch ratio (modifiable with the handles) and of the ratio `originalTempo / projectTempo`, allowing only just one time-stretching pass.

@Paul-Licameli this PR is only just about bringing the project tempo information to the clips. Their own, ""handle"" stretch ratio is easy to get - that's the ticket we planned for Vitaly.
"
1616052669,4853,saintmatthieu,2023-07-01T19:03:02Z,What is `originalTempo`? @Paul-Licameli you guessed right : it's the project tempo when the clip is dropped. It is on the roadmap (at least informally) to improve this by reading tempo metadata or detecting is by analyzing the signal.
1616053994,4853,Paul-Licameli,2023-07-01T19:08:23Z,"> Time-stretching a clip by a factor of 2 and then again by a factor of 2 yields a result different from time-stretching that clip once by a factor of 4. Likewise, @Paul-Licameli, since you asked: stretching by 2 and then by 0.5 doesn't restore the original. Quality suffers from each pass. Our time-stretcher may be excellent, it's not perfect : there still is some amount of widening and smearing.
> 
> Therefore, the approach we're undertaking is the best from a quality point of view. Each clip's stretch ratio is the product of its individual stretch ratio (modifiable with the handles) and of the ratio `originalTempo / projectTempo`, allowing only just one time-stretching pass.
> 
> @Paul-Licameli this PR is only just about bringing the project tempo information to the clips. Their own, ""handle"" stretch ratio is easy to get - that's the ticket we planned for Vitaly.

Yes, I didn’t raise the question of repeated stretching causing degraded quality but I thought of it.

Stretching for project tempo and for handles should be adjacent in the stack of processing, whether upstream or down, and combined into one.

I was thinking about how to implement it all downstream, very differently from the stretching decorator.

But if that really is a non-starter from a design standpoint , okay forget it.

Reopen this pull request, under a new number so we can restart the conversation thread.  Put more in it if you can — enough that I see what new data a WaveClip really stores and updates."
1616599710,4853,Paul-Licameli,2023-07-02T10:59:11Z,"About the problems of destructive effects:

I emphasize again, do not attempt a solution as you outlined it.  I think too many individual built in effects will need too much rewriting.  It will distract from more fundamental problems of this feature that are still not moving through review and test.  It will likely conflict with many of the other rewrites I’m trying to do to support joint stereo.

But I did have an idea for an alternative solution that I want to explain…"
1616600761,4853,Paul-Licameli,2023-07-02T11:04:15Z,"Whenever an effect or other editing operation must paste into a WaveTrack, map the given time to the correct clip.  Then first transform that clip with time stretch, and reset its stored stretch information to unit stretch ratio.  Then proceed as in old code.

I think this way would be more local in code modifications of class WaveTrack, will not disturb its interface, and will leave much other code undisturbed.

Do similar with Set() except for the pencil tool.
"
1002200367,2224,LWinterberg,2021-12-28T17:06:40Z,"Hello @Subhra264, are you planning to continue work on this?"
1002220837,2224,Subhra264,2021-12-28T18:00:43Z,"Hello, sorry, I know that I am late( I had no idea about audio channels, samples, sample rate etc. so had to study it first), but I am still working on it..

The `ImportWavPack.cpp` file is almost ready, except the `ImportWavPackFileHandle::Import` function which is partly complete. For example I pushed all the `channels` to `outTracks`. But it's taking time because ~I am not sure what to do with the `samplesRead` decoded with `WavpackUnpackSamples` as  in  the `ImportFLAC.cpp` file, I saw that channels were directly pushed to `outTracks`,  but in `ImportOgg.cpp` file, the read samples were appended to channels.
Also in `Import.cpp` and `ProjectFileManager.cpp`(I forgot the exact name but it was something similar), it looked like only those `tracks` were used.
Basically, I am confused that if only channels created with `WaveTrackFactory` and `sampleRate` are enough or I need to somehow append the decoded samples to the channels.~ (Edit : Sorry I misunderstood it, now seems to be clear)

Hopefully I will be able complete in 1 or 2 days.
Thanks..."
1099136838,2224,crsib,2022-04-14T12:32:09Z,"Hi @Subhra264 

Sorry for the delay! Can you please rebase onto the latest master, squash you changes into a single commit and force push?"
1099148552,2224,Paul-Licameli,2022-04-14T12:45:41Z,"> Hi @Subhra264
> 
> Sorry for the delay! Can you please rebase onto the latest master, squash you changes into a single commit and force push?

I would like to see a rebase too, but not necessarily a squash to one commit, if the intermediate steps are really useful for review of the new feature in sensible incremental steps, and not just corrections of mistakes.
"
1099384618,2224,Subhra264,2022-04-14T16:35:57Z,"> Sorry for the delay!

No Issues! :)
>  but not necessarily a squash to one commit, if the intermediate steps are really useful for review of the new feature in sensible incremental steps, and not just corrections of mistakes.

yeah, actually, I added new commits after the previous commit is bug-free ( I mean, after resolving the bugs I encountered related to that particular feature/implementation, so may not be ""bug-free"" ). So, each commit mostly represents a new feature/file. For example, the first commit is about integrating wavpack and creating a file containing all the necessary class details, the second commit implements all the `ImportPlugin` and `ImportFileHandle` class methods, and the third commit is to read tags, etc. "
1157452320,2224,crsib,2022-06-16T09:41:18Z,"Hi @Subhra264!

Sorry for this long delay. I have crafted a commit, that should resolve your CI issues https://github.com/crsib/audacity/commit/2a353fd357f6cebb1a9cda61be33a9afe3edfb36

Can you please cherry pick it in your branch and rebase everything onto the latest master?"
1157955712,2224,Subhra264,2022-06-16T17:39:33Z,"> I have crafted a commit, that should resolve your CI issues https://github.com/crsib/audacity/commit/2a353fd357f6cebb1a9cda61be33a9afe3edfb36

All checks passed! Thank you!"
1160445181,2224,Subhra264,2022-06-20T13:23:30Z,"> When I export from Audacity - the resulting file seems to be missing some metadata: VLC does not show the file length and does not allow seeking. Everything works fine, if I generate wv file using the official CLI.
> 
> Looks like you miss `WavpackUpdateNumSamples` call in the end.

I have replaced `FileIO` with `wxFile` as seeking to the first block of the file was required. I have tested the wavpack files generated from audacity with VLC media player. Now, it seems to work correctly as it is now allowing seeking and the audio length is also shown. Also, I have addressed the changes you asked me to make. The latest commit is now ready for another review.

"
1161636658,2224,Subhra264,2022-06-21T11:44:59Z,"> Export looks fine now, I will review import now!

Ok then, I will commit and push the remaining ExportWavPack changes along with ImportWavPack changes."
1165629234,2224,crsib,2022-06-24T14:26:05Z,@LWinterberg can you please add Subhradeep Chakraborty to the AboutDialog?
1568304039,4746,saintmatthieu,2023-05-30T11:55:49Z,"Some questions :
* `MixerSource` already used to be a collection of tracks, one per channel,
* Iteration over the channels used to be done in `::Acquire`, now it is one stack level below, in `MixSameRate` or `MixVariableRates`,
* In the future, `SampleFrameSequence` will provide multi-channel audio data, and the channel iteration in `MixerSource` can be removed."
1582392493,4746,Paul-Licameli,2023-06-08T11:14:09Z,"> Some questions :
> 
> * `MixerSource` already used to be a collection of tracks, one per channel,
> * Iteration over the channels used to be done in `::Acquire`, now it is one stack level below, in `MixSameRate` or `MixVariableRates`,
> * In the future, `SampleFrameSequence` will provide multi-channel audio data, and the channel iteration in `MixerSource` can be removed.

Names changed since you wrote this, otherwise its a correct summary.
"
1585873620,4746,Paul-Licameli,2023-06-11T00:30:21Z,"In anticipation of the merge of #4742 soon, I have rebased this branch onto that one, and made only the changes needed for conflict resolution.

The commit ""Segregate WideSampleSequence from the SampleTrack interface..."" is still the first one proper to this new branch, and only that one and later ones should be reviewed.
"
1586260170,4746,Paul-Licameli,2023-06-11T17:44:56Z,"Force pushed again, with some NEW and FIXUP commits inserted to address your comments.
"
1587378053,4746,Paul-Licameli,2023-06-12T13:46:55Z,"The latest force-push only squashes the fixup commits and edits some commit comments.
"
1588685537,4746,saintmatthieu,2023-06-13T07:15:07Z,"Pushed back to ""In Progress"" because export is broken : 
![image](https://github.com/audacity/audacity/assets/22740106/d1b65f06-ccc2-49d0-87a3-9152172da3dc)

The mono track was exported to stereo, and a 4-second chunk is clipped to -1."
1590073259,4746,saintmatthieu,2023-06-13T21:54:29Z,"Here is the problem I see during mix-and-render: 
![image](https://github.com/audacity/audacity/assets/22740106/3644dadb-ffc0-41e1-95e5-9094842a01a4)
The lower track is the rendering of the upper track.
I was debugging this because I have a branch based on this one (for the stretching decorator) and thought I was doing a mistake, but by reverting I could verify that the problem came from elsewhere. I suspect the `SampleTrackCache` to be passing incorrect pointers to the WaveTrack.
I also verified that it is not on current master (0ec7ab2908f2acb5759323e1f5b5f345698e3d1b)"
1590871576,4746,Paul-Licameli,2023-06-14T09:52:55Z,"https://github.com/audacity/audacity/pull/4746/commits/0101fcfcc7f10f411a8c62b428399d3cbd0e2cf3

Was it this commit that you built?

Describe exact steps to reproduce.

Probably the bug is in SampleTrackCacke.

i confirmed that I could reproduce the bug in export and that it was fixed."
1591155393,4746,Paul-Licameli,2023-06-14T12:56:52Z,"Rebased once more after #4792 was merged, so now only 23 commits
"
1591354770,4746,Paul-Licameli,2023-06-14T14:38:00Z,"A second fixup corrects the error in rendering
"
1591525537,4746,Paul-Licameli,2023-06-14T15:51:44Z,"Rebased onto more recent master, and squashed
"
1594452969,4746,dozzzzer,2023-06-16T10:16:39Z,"Moving back to In Progress.
When mixing-and-rendering a stereo track with any built-in or third-party effect in the sidebar, Audacity freezes (macOS) or crashes (Windows). No issues with exporting.
@Paul-Licameli "
1594482974,4746,Paul-Licameli,2023-06-16T10:45:05Z,"> Moving back to In Progress.
> When mixing-and-rendering a stereo track with any built-in or third-party effect in the sidebar, Audacity freezes (macOS) or crashes (Windows). No issues with exporting.
> @Paul-Licameli

I observe that mixing and rendering crashes even with no effect stack.  Was that bug introduced by this branch or by an earlier merged PR?
"
1594489308,4746,dozzzzer,2023-06-16T10:51:13Z,"> Was that bug introduced by this branch or by an earlier merged PR?

If you refer to the wide wave clip PR #4742 – no, it shows no issues with mixing-and-rendering both with and without effect stack. So it seems that the problem was introduced by this branch."
1594490642,4746,Paul-Licameli,2023-06-16T10:52:30Z,"> > Was that bug introduced by this branch or by an earlier merged PR?
> 
> If you refer to the wide wave clip PR #4742 – no, it shows no issues with mixing-and-rendering both with and without effect stack. So it seems that the problem was introduced by this branch.

I observe not only a crash, but the recovery file is also somehow corrupted to cause a crash if you restart and try to recover.
"
1594498819,4746,dozzzzer,2023-06-16T10:59:58Z,"> The recovery file is also somehow corrupted to cause a crash if you restart and try to recover.

I don't see the crash when trying to recover, but weirdly enough in addition to the stereo track I also have a mono track in the recovered project which isn't supposed to be there.

<img src=""https://github.com/audacity/audacity/assets/70063970/c6c3b034-1f64-456f-9d13-3b06619fad9c"" width=500>
"
1594804951,4746,Paul-Licameli,2023-06-16T14:38:57Z,"@saintmatthieu  Rebased onto recent master, with a new FIXUP that removes a mistaken assertion from an earlier PR, which was violated when you Mix Stereo to Mono.

I am still investigating the bug in rendering.

"
1601138896,4746,dozzzzer,2023-06-21T16:14:40Z,"Tested on macOS 13.0, Windows 11 VM and Ubuntu 22.04 VM.
What was tested:
- all bullet points on the list of things to be checked
- cases with mismatched left and right channel lengths, such as mixing-and-rendering, export, playback
- made sure that all previously found bugs introduced by this PR were fixed"
1971587834,6068,Paul-Licameli,2024-02-29T17:09:20Z,"You need a Windows build fix
"
1971624404,6068,saintmatthieu,2024-02-29T17:31:10Z,"> You need a Windows build fix

I have a segmentation fault on the StaffPadTimeAndPitch unit-test, which I can't reproduce locally :/"
1972839913,6068,saintmatthieu,2024-03-01T09:35:49Z,Found what the problem was - memory alignment. Pushed a fix commit with an explanation. Thanks unit tests 🙏 
1991209076,6068,saintmatthieu,2024-03-12T09:49:10Z,"@patrickvi2 thanks a lot for your comments ❤️ I just pushed commits to address them, feel free to re-review."
1991218459,6068,saintmatthieu,2024-03-12T09:53:11Z,Just force-pushed after rebase without other changes.
1991221534,6068,saintmatthieu,2024-03-12T09:54:47Z,@vsverchinsky: @patrickvi2 has reviewed the DSP part of this PR. Would you be so kind to review the rest?
1992294160,6068,saintmatthieu,2024-03-12T18:26:48Z,">   * You define it using and interface too, and I don't see why. The only place it is used - it is used directly.

Not strictly speaking: `FormantShifter` only sees the abstract API.
I stopped my experimentational wandering when I reached this solution, despite it mixing up both logging and configuration responsibilities. I admit that it's not perfect, but I thought it could be tolerated and further clean-up work be spared. I don't really mind addressing this, if you still see it as a must.

I provided an answer to your question around optimization earlier in this conversation."
1999394523,6068,crsib,2024-03-15T10:47:02Z,"Please note, that tests have failed, @saintmatthieu "
2003612120,6068,dozzzzer,2024-03-18T11:02:39Z,"@saintmatthieu 

The discovered bugs are macOS only:
1. While playing, an attempt to change the clip's pitch by entering any non-zero semitones/cents value causes Audacity to freeze;
2. While playing, if semitones/cents value is other than zero and formant preservation is ON, an attempt to disable formant preservation causes a freeze as well;
3. While playing, if the Pitch and Speed dialog is opened, an attempt to close the dialog causes a freeze."
2004509624,6068,saintmatthieu,2024-03-18T17:20:37Z,"@dozzzzer thank you, I didn't get thread safety right and for some reason it still worked on Windows.
@crsib the last commit addresses this."
1607879419,4668,vsverchinsky,2023-06-26T17:05:14Z,"Rebase on recent master, no other changes"
1623595387,4668,vsverchinsky,2023-07-06T12:28:22Z,"@petersampsonaudacity all issues from the [list](https://github.com/audacity/audacity/issues?q=is%3Aissue+is%3Aopen+%22New+Export%22+label%3Aimport-export) were addressed
@crsib I added constraints to ffmpeg and mp2 exporters, no other encoder seem to specify them
@LWinterberg if I didn't miss anything: options lineup, multiple metadata editing, new timer record dialog export"
1623608700,4668,DavidBailes,2023-07-06T12:38:21Z,"> @petersampsonaudacity all issues from the [list](https://github.com/audacity/audacity/issues?q=is%3Aissue+is%3Aopen+%22New+Export%22+label%3Aimport-export) were addressed
> @crsib I added constraints to ffmpeg and mp2 exporters, no other encoder seem to specify them
> @LWinterberg if I didn't miss anything: options lineup, multiple metadata editing, new timer record dialog export

@vsverchinsky Have you had a look at: https://github.com/audacity/audacity/issues/4317#issuecomment-1571712895 ?

One possible solution to issue 1, would be to make the current selection radio button the last of the three buttons, though I guess that probably isn't the most logical order. (This is assuming the the current selection radio button is the only one that may be disabled.)

Issue 3 has been fixed."
1624200531,4668,vsverchinsky,2023-07-06T19:25:30Z,"> Have you had a look at: https://github.com/audacity/audacity/issues/4317#issuecomment-1571712895 ?

Not yet, will try to fix issues you mentioned, thanks! @LWinterberg could you please also take a look at issue 6?

"
1634351976,4668,vsverchinsky,2023-07-13T14:31:02Z,"@petersampsonaudacity #4819 fixed
@DavidBailes regarding https://github.com/audacity/audacity/issues/4317#issuecomment-1571712895 - I removed ""force export to mono"" as it now duplicates ""mono"" checkbox. Keys are assigned to major controls"
1634431330,4668,DavidBailes,2023-07-13T15:16:21Z,"> @DavidBailes regarding [#4317 (comment)](https://github.com/audacity/audacity/issues/4317#issuecomment-1571712895) - I removed ""force export to mono"" as it now duplicates ""mono"" checkbox. Keys are assigned to major controls

@vsverchinsky 
Two of the access keys are difficult to see:
1. Folder: using d would be better than l.
2. Custom mapping: using a would be better than g.

In addition I'm still very concerned about the keyboard navigation of the radio buttons for the export range - see: https://github.com/audacity/audacity/issues/4317#issuecomment-1625363019
See also: https://github.com/audacity/audacity/pull/4668#issuecomment-1623608700
"
1634618281,4668,petersampsonaudacity,2023-07-13T17:18:02Z,"> @petersampsonaudacity #4819 fixed

@vsverchinsky 

Testing on W10 with Vitaly's latest branch build:  audacity-win-3.4.0-alpha-20230713+e7f58dd-x64

#4819 is properly fixed:
a) the new dialog appears
b) there is NO crash when accessing the Export dialog(s) for the automated export
c) The Timer record works and exports properly"
1635737221,4668,DavidBailes,2023-07-14T11:39:01Z,"> In addition I'm still very concerned about the keyboard navigation of the radio buttons for the export range - see: [#4317 (comment)](https://github.com/audacity/audacity/issues/4317#issuecomment-1625363019)
> See also: [#4668 (comment)](https://github.com/audacity/audacity/pull/4668#issuecomment-1623608700)

@vsverchinsky See also https://github.com/audacity/audacity/issues/4317#issuecomment-1635677467 - @LWinterberg is happy with changing the order of the export range radio buttons to get round this bug."
1636742744,4668,DavidBailes,2023-07-15T11:36:05Z,"> @vsverchinsky See also [#4317 (comment)](https://github.com/audacity/audacity/issues/4317#issuecomment-1635677467) - @LWinterberg is happy with changing the order of the export range radio buttons to get round this bug.

@vsverchinsky . Thanks for changing the order. Noticed that the accessibility name of the multiple files radio button is still ""Export split in parts"", and so needs changing to ""Export multiple files""."
1636802897,4668,petersampsonaudacity,2023-07-15T15:36:34Z,"@DavidBailes 

Actually in @vsverchinsky 's latest branch build:  audacity-win-3.4.0-alpha-20230713+e7f58dd-x64

it is already **Multiple Files**
![image](https://github.com/audacity/audacity/assets/50205984/79730a9c-8ef0-4a36-b8ca-328e47b7914c)
"
1637583026,4668,DavidBailes,2023-07-17T08:20:04Z,"> @DavidBailes
> 
> Actually in @vsverchinsky 's latest branch build: audacity-win-3.4.0-alpha-20230713+e7f58dd-x64
> 
> it is already **Multiple Files**

@petersampsonaudacity 
By ""accessibility name"" of the radio button I was referring to the name of the radio button read by screen readers. Sometimes it's helpful if this name is different from the visible name. In this case the text ""export range"" is not automatically read by screen readers, so it's helpful to add the word export to the accessibility name. Just use narrator to see what's going on in this case (windows + ctrl + enter to start or stop)."
1637669282,4668,vsverchinsky,2023-07-17T09:19:36Z,"> Noticed that the accessibility name of the multiple files radio button is still ""Export split in parts"", and so needs changing to ""Export multiple files"".

@DavidBailes Thanks! fixed
"
1641990489,4668,DavidBailes,2023-07-19T12:25:40Z,"@vsverchinsky . Only just noticed that there are a couple of other accessibility names that need setting. When the format is set to Custom FFmpeg Export, there are two text controls: Current format and Current Codec. These currently have empty accessible names. WindowAccessible is automatically set as the accessible object for text controls in ShuttleGui, so all that is needed is to set the accessible name for these text controls (like you did for sliders)."
1645462140,4668,petersampsonaudacity,2023-07-21T11:52:43Z,"> I finished this round, I am quite concerned about loosing STEREO in MP3 export

Testing on W1- with @vsverchinsky 's latest branch build:  audacity-win-3.4.0-alpha-20230713+e7f58dd-x64

Using my clearly obvious wide-panned stereo track - tack 1 from Sgt. Pepper's Lonely Hearts club band.

I looks, and sounds, as though the stereo output from MP3 export is **true stereo** .
S0 it looks like we have lost the option for **Joint Stereo** that we da in the <P3 export dialog we had in earlier Audacity versions:
![image](https://github.com/audacity/audacity/assets/50205984/4cc337cb-cbd8-488a-a66b-0ae3caa6b550)
"
1645474690,4668,petersampsonaudacity,2023-07-21T12:04:24Z,"In an earlier version of Vita;'s new export we has a field for **Channel Mode** which has now disappeared in the later versions:
![image](https://github.com/audacity/audacity/assets/50205984/5c89e8b5-d167-4626-b3db-255a68e46759)
"
1645487984,4668,vsverchinsky,2023-07-21T12:13:44Z,"> S0 it looks like we have lost the option for Joint Stereo that we da in the <P3 export dialog we had in earlier Audacity versions:

It actually set to `JOINT_STEREO` now, there is a discussion on that topic above. It seems like lame can switch between M/S and stereo when it's set to `JOINT_STEREO` mode"
1645491166,4668,petersampsonaudacity,2023-07-21T12:16:40Z,"> > S0 it looks like we have lost the option for Joint Stereo that we da in the <P3 export dialog we had in earlier Audacity versions:
> 
> It actually set to `JOINT_STEREO` now, there is a discussion on that topic above.

In which case I am **_very_** concerned at the loss of proper stereo where the two channels are encoded separately and independently.

That is certainly the way I have always configured my many MP3 exports over the years."
1645526314,4668,LWinterberg,2023-07-21T12:44:31Z,@petersampsonaudacity I've put up an explanation in #4940
1645624498,4668,petersampsonaudacity,2023-07-21T13:51:13Z,"@LWinterberg   ACK

I've updated the draft manual page for this."
1645652380,4668,petersampsonaudacity,2023-07-21T14:09:34Z,Discussion transferred to #4940
1645703888,4668,LWinterberg,2023-07-21T14:43:09Z,let's please continue this discussion in https://github.com/audacity/audacity/discussions/4940 and leave this thread for the code reviewy bits
1649308047,4668,vsverchinsky,2023-07-25T07:49:02Z,"@dozzzzer @chinakov 
Few notes for testing:
1) Exporting via macro and cloud upload use same export routines
2) Transport->Record->Timer Record uses simplified export audio dialog (it's not mentioned in figma)"
1660792892,4668,vsverchinsky,2023-08-01T17:34:25Z,New commit added that fixes #4959 
1660841379,4668,crsib,2023-08-01T18:10:00Z,Last commit approved.
1551547514,4701,saintmatthieu,2023-05-17T14:52:10Z,"Windows builds are failing, don't know why, it compiles locally and there is no apparent error message. Hopefully someone will recognize the error ?"
1551858352,4701,saintmatthieu,2023-05-17T18:19:36Z,- [x] test in stereo
1563480412,4701,Paul-Licameli,2023-05-25T20:39:16Z,"GitHub says there is a conflicting file, but it's easily fixed.
"
1563493479,4701,Paul-Licameli,2023-05-25T20:53:06Z,"The commits in this branch are not all buildable.  I'm doing my own rebase onto master locally, and squashing the build fixes for myself, so each builds, then I will examine more closely.
"
1569830809,4701,crsib,2023-05-31T09:28:53Z,I wonder why no jobs were run for the PR
1569890511,4701,saintmatthieu,2023-05-31T10:04:42Z,"I guess because of this, sent to me over email : ""[GitHub] You've used 100% of included services for the saintmatthieu account"""
1569919121,4701,crsib,2023-05-31T10:21:03Z,"That is odd, I can see that your fork is public, and Audacity itself is public. GitHub has no limits for open-source projects."
1569958155,4701,saintmatthieu,2023-05-31T10:48:12Z,"Ah, I think I know. I made a private fork of something public that had jobs. Maybe now it's disabling it for all my repos, public ones included. I don't need that private repo, will delete it and see what happens."
1569968626,4701,saintmatthieu,2023-05-31T10:55:00Z,@crsib Just rebased and jobs are running now.
1571722796,4701,saintmatthieu,2023-06-01T09:51:25Z,@crsib just rebased my time-stretching PoC branch onto the head of this one. Still integrates and works fine. Just awaiting your green light now.
1681910850,5042,saintmatthieu,2023-08-17T09:05:26Z,"This morning I came to remember maybe my very first experience of Audacity. It was at the National University of Ireland, Maynooth, in the computer music introductory module. I remember the lecturer saying ""and you can even draw the samples with the pencil"". I must have been impressed to still remember it - it was in 2005-2006. Great educational tool. @rbdannenberg @Paul-Licameli "
1696572603,5042,Paul-Licameli,2023-08-28T23:48:52Z,"> This morning I came to remember maybe my very first experience of Audacity. It was at the National University of Ireland, Maynooth, in the computer music introductory module. I remember the lecturer saying ""and you can even draw the samples with the pencil"". I must have been impressed to still remember it - it was in 2005-2006. Great educational tool. @rbdannenberg @Paul-Licameli

Would you believe I hadn’t heard of, less used it, before December 2012?"
1702884882,5042,saintmatthieu,2023-09-01T14:53:38Z,"@Paul-Licameli just pushed [05c4f37](https://github.com/audacity/audacity/pull/5042/commits/05c4f37a53ec2ebe42ddfbfd2b478d4cd1e6eb01), addressing all your comments."
1719194855,5042,Paul-Licameli,2023-09-14T10:31:48Z,"`GetSamples` (not a new function) should also comment that `start` is relative to play start
`GetFloatAtTime` should comment that `t` is relative to play start
"
1719310058,5042,Paul-Licameli,2023-09-14T11:57:10Z,"Done with this round of review!

I await a rebase onto #5138 and conflict resolution.
"
1723343594,5042,saintmatthieu,2023-09-18T12:50:48Z,@Paul-Licameli finished addressing your comments.
1725340986,5042,Paul-Licameli,2023-09-19T11:43:44Z,"Finished this review round
"
1727266419,5042,saintmatthieu,2023-09-20T08:51:26Z,"I was wrong about the first use: if `t` is past the end boundary of the clip, `effectiveEnd` can indeed be greater than `effectiveStart`. I couldn't reproduce this situation by trying even drag-drawing across several minuscule clips, but changing the value of `t` in the debugger showed it was possible. Thank you. Will push a safety check."
1727268225,5042,saintmatthieu,2023-09-20T08:52:24Z,Unit-testing would have been useful to find out I was wrong earlier.
1727563896,5042,Paul-Licameli,2023-09-20T11:45:39Z,"I see and approve the latest three commits.  Correct spelling of ""rectangle"" in the last commit comment.

But there are conflicts with master.
"
1727593553,5042,saintmatthieu,2023-09-20T12:06:36Z,Thanks for the speedy review.
1731573096,5042,dozzzzer,2023-09-22T15:01:54Z,"Tested.
Found issues: #5231 
Also, I've discovered that when using the Pencil tool on adjacent clips, then stretching them and mixing and rendering the track, it produces a waveform that looks different from the pre-mixed-and-rendered state:


https://github.com/audacity/audacity/assets/70063970/ef7b7985-c065-4685-aefb-114d07f5c879


https://github.com/audacity/audacity/assets/70063970/5bea899e-e5bd-4690-aa6f-540e658fea20


https://github.com/audacity/audacity/assets/70063970/b7988d7e-1cc1-494a-9439-919869604cb0


In some cases, it looks like it simply gets inverted, while the other examples don't quite look like it. Despite this mismatch doesn't look particularly good to me, this might be insignificant and I reckon should not delay the merge.

"
1731601545,5042,saintmatthieu,2023-09-22T15:20:06Z,"I agree that the rendering doesn't look great. There are two upcoming fixes that could improve this: a more accurate delay estimation #5206, and solving the indeterministic behaviour you found #5210.
But I'm confident that this limitation isn't related to drawing. Drawing modifies the samples as expected. Only the rendering of the result isn't necessarily as expected :D"
852656377,830,Paul-Licameli,2021-06-02T02:08:57Z,"We're still interested in this proposal.

Please see more discussion at the Audacity Forum.
"
853029046,830,dofuuz,2021-06-02T13:29:50Z,"@Paul-Licameli
Rebased commit at recent upstream master branch.

TBH, I'm not fully satisfied with CLA.
But I belive that commercial profit and support can boost imporvement on OSS.
So I signed at the CLA anyway.

I just wish Audacity would remain free, open and be **much greater** than now. 😀"
853302878,830,Paul-Licameli,2021-06-02T18:51:42Z,"> @Paul-Licameli
> Rebased commit at recent upstream master branch.
> 
> TBH, I'm not fully satisfied with CLA.
> But I belive that commercial profit and support can boost imporvement on OSS.
> So I signed at the CLA anyway.
> 
> I just wish Audacity would remain free, open and be **much greater** than now. 😀

As for that, I share those hopes.

I not only hope so, I expect so, from what I know.

Though that is on the understanding that code of the Audacity audio editor ""remaining free"" is consistent with the possibility of a dual sub-licensing of parts of it that the CLA leaves open.
"
856336759,830,dofuuz,2021-06-07T23:59:08Z,@Paul-Licameli Ping
856609924,830,Paul-Licameli,2021-06-08T09:23:18Z,"I have not forgotten this!  I will write more today.
"
859609792,830,petersampsonaudacity,2021-06-11T14:10:36Z,"I just tested on W10 with dofuuz's latest build and I see that we now have the changed color descriptions in Spectrogram Preferences as we discussed.  Thanks for sorting that.
![image](https://user-images.githubusercontent.com/50205984/121699753-7f6fb380-cacf-11eb-9826-6d0af883401c.png)
"
859610327,830,petersampsonaudacity,2021-06-11T14:11:26Z,I tested with pure Spectrogram and with Multi-view dor the new and alternative colorways
859611926,830,Paul-Licameli,2021-06-11T14:13:43Z,"Thanks, Peter.  Did you also observe the changes in Set Track Visuals?  A choice replaces what was only a checkbox for grayscale.
"
859617200,830,petersampsonaudacity,2021-06-11T14:22:02Z,"Paul, I assume you mean from the TCp - in which case yes, I have been playing with that too and all looks fine.
"
859620339,830,Paul-Licameli,2021-06-11T14:26:40Z,"> Paul, I assume you mean from the TCp - in which case yes, I have been playing with that too and all looks fine.

No, I refer to one of the Macro commands.  See #969 
"
861164424,830,Paul-Licameli,2021-06-15T04:42:30Z,"I'm pleased with these changes to address my points.  Each commit builds.

I am satisfied too now with changes in AColor.cpp.  (I might suggest that the names in AColorResources.h could be made static, to have no linkage and spare a little space in symbol tables.)

But I do not want the change in Experimental.h.  It leaves no visual indication of sync lock in a spectrogram.  If you think this change is very important, than I think some alternative solution should be sought.  The sync lock tiles might be painted more than once (as they are in Waveform view).  They might be repainted last, with transparency.  Perhaps you fill follow up this implementation suggestion.

So to summarize:   please rebase onto most master, and omit the change to Experimental.cmake.  Then I will approve it and merge it!

"
861173140,830,dofuuz,2021-06-15T05:07:18Z,"Removing transparency from spectrogram is important fix! Without the change, new colormap gonna lose its power.
I'll find if there are easy and nice fix for this situation..."
861203172,830,petersampsonaudacity,2021-06-15T06:11:01Z,"> But I do not want the change in Experimental.h. It leaves no visual indication of sync lock in a spectrogram. If you think this change is very important, than I think some alternative solution should be sought. The sync lock tiles might be painted more than once (as they are in Waveform view). They might be repainted last, with transparency. Perhaps you fill follow up this implementation suggestion.


But even in current Audacity there is very poor visual indication of sync-lock in a spectrogram ...

The example image below was made with 3.0.2
![image](https://user-images.githubusercontent.com/50205984/122001420-9c96d180-cdb0-11eb-9025-2538e946b4c3.png)

This image flatters the real-life situation
a) It is (at least) double real-life size - much harder to see in Audacity on-screen
b) I deliberately greatly reduced the amplitude of the left half of the selction, note that in the right half of the selection in the spectrogarm track the clocks are barely visible at all.

I thought we had a Bugzilla entry for this, but I can't find it.  Maybe we should be logging one ...
"
861274917,830,petersampsonaudacity,2021-06-15T07:56:20Z,">I thought we had a Bugzilla entry for this, but I can't find it. Maybe we should be logging one ...

I logged this as P3 Bug #2806
https://bugzilla.audacityteam.org/show_bug.cgi?id=2806
Spectrogram view has poor/inadequate visual cues to show Sync-lock selection

And remember that this is not a result of the new Spectrogram colorway - it's always been like this."
861446617,830,Paul-Licameli,2021-06-15T12:13:04Z,"> Removing transparency from spectrogram is important fix! Without the change, new colormap gonna lose its power.
> I'll find if there are easy and nice fix for this situation...

As your branch is now, there is no indication at all of sync lock, rather than the existing one, poor though that might be.

Why do you think removing transparency of the spectrogram is very important?  In my own trials building your branch,  I did not think it looked bad either with or without it.

Would you consider merging the branch with transparency, but opening an issue to correct the problems?

I see your example in ""Obstacles."" https://forum.audacityteam.org/viewtopic.php?f=20&t=117875#p424607

"
861456344,830,SteveDaulton,2021-06-15T12:28:49Z,"I don't think that losing the Sync-Lock ""clocks"" in spectrogram view is a problem. Even with ""classic"" spectrogram view they are barely visible with real world audio, and imo they are little more than visual clutter when they are. Waveform view, or multi-view are far better suited to temporal editing. I'd rather have a clearer view of the spectrogram in track spectrogram view than overlaid information that is irrelevant to ""spectral"" editing."
861466558,830,dofuuz,2021-06-15T12:44:22Z,"![synclock](https://user-images.githubusercontent.com/8174871/122051527-a99ed980-ce1f-11eb-8d73-1d8415d95ac8.jpg)
↑ New color with `SPECTROGRAM_OVERLAY` transparency. Clock background on 4th track is almost not visible.

Transparency makes the visual totally different from what I intended(accurate and pretty).
Background becomes brighter than some of foreground. There are some grain around black which should not appear. It means loss of accuracy.
Overall color becomes desaturated. Not pretty.

Bringing clock overlay on top of spectrogram [like this](https://user-images.githubusercontent.com/8174871/122054382-96d9d400-ce22-11eb-9890-a7db4d253904.jpg) might be the fix. 
But basically I have same opinion with @SteveDaulton."
861466852,830,Paul-Licameli,2021-06-15T12:44:50Z,"If we want to keep the clocks but also make spectrogram non-transparent, then I think a solution is to draw the clocks with transparency, not the track, and paint the clocks later.

If we lose all of the clocks in spectral view, arguably that's a regression.  But maybe Steve and Peter would agree not to treat it as such.

Are there examples of clocks on the spectrogram in the manual?  If so they would be one more thing to change in manual images.

I think the objection that clocks are clutter for spectral editing is irrelevant.  The track that you do interact with, for spectral editing, never shows the clocks.  The clocks indicate what part of another track will be affected, if the track you do interact with changes its length with insertion or deletion.  Spectral editing doesn't do that, but other edits do.



"
861468919,830,Paul-Licameli,2021-06-15T12:48:07Z,"> Bringing clock overlay on top of spectrogram [like this](https://user-images.githubusercontent.com/8174871/122054382-96d9d400-ce22-11eb-9890-a7db4d253904.jpg) might be the fix.
> But basically I have same opinion with @SteveDaulton.

How did you do that ""like this"" picture?  Did you change Audacity source code to do it?
"
861469589,830,dofuuz,2021-06-15T12:49:07Z,"> How did you do that ""like this"" picture? Did you change Audacity source code to do it?

No. I used image editor."
861494911,830,petersampsonaudacity,2021-06-15T13:24:21Z,"> If we lose all of the clocks in spectral view, arguably that's a regression. But maybe Steve and Peter would agree not to treat it as such.

It's not really our call any more - But I would certainly be happy with the way it si now with the closcks invisible on the spectrogram (I agree with Steve's views above that  
a) they've been largely unvisible on Soectrograms anyway and 
b) other views are better for temporal editing)

So if MUSE QA and RM agree (Dmitry, Martin, Jouni) I would vote for this - and this would then let me close P3 Bug 2806.

As far as I can recall no user has ever complained about the clocks on Spectrograms - porr visibiliy of or lack thereof.
"
861549576,830,Paul-Licameli,2021-06-15T14:30:32Z,"I would leave bug 2806 open.  But we need to get a release out very soon, and these new colors will be a banner feature, and I don't want this detail to block it.

Maybe Myungchul will even write the fix easily.  I outlined how we might to do it.  Repaint the clocks, after the spectrum, making the clocks the transparency.

"
861609491,830,dofuuz,2021-06-15T15:41:45Z,"![image](https://user-images.githubusercontent.com/8174871/122081263-ed9ed800-ce39-11eb-99a4-09727c22429f.png)
↑ In development screenshot, Left: Light theme, Right: Dark theme

Fortunately, It seems like the fix is not hard to implement.
I'll push commit after some cleanup in couple of days. For now, I have to sleep😴

To adjust color and transparency of clock overlay, we need to edit theme image. I won't do this.
I think the clock should be gray, 50% transparent."
861618111,830,SteveDaulton,2021-06-15T15:52:39Z,"Thanks for trying the clocks dofuuz, but from a user perspective I would much prefer to NOT have the clocks.

When using track spectrogram view and Sync-Lock, I would have to temporarily turn off Sync-Lock to remove the distraction of the clocks. That's more work for the user, and a needless distraction from their workflow. The user can already see if Sync-Lock is on by looking for the clock in the control panel on the left hand end of the track - which is how users have had to work (with zero complaints) when using the ""classic"" spectrogram color scheme.

With QA hat on, usability trumps consistency. Now that I can see what it looks like with the new color scheme + clocks (thank you), I would say that it is significantly worse than not having the clocks showing in spectrograms.

Steve"
861648200,830,Paul-Licameli,2021-06-15T16:28:08Z,"Thank you, Steve.

You have a strong opinion about the clocks.  I do NOT have a strong opinion about them -- which is why I brought the matter up:  in the absence of strong opinions, the presumption should be conservatism about the application's behavior, changing only what one needs to change for the really new feature.

In this case, hiding the clocks was not the intention of the feature, but a side-effect of trying to achieve something else, the non-transparency that improved spectrogram appearance.

However, given your remarks now,  I find no reason left to delay the merger of this pull request.  If someone really wants to overrule the elimination of the clocks, let them raise an issue.


"
861659708,830,Paul-Licameli,2021-06-15T16:44:29Z,"Merged!

The residual issue about the clocks -- if anyone insists on keeping them -- is already at: https://bugzilla.audacityteam.org/show_bug.cgi?id=2806
"
861912635,830,dofuuz,2021-06-16T00:06:49Z,"Great😆
We can implement sync-lock overlay later, if there are anyone complain about it."
863368442,830,Paul-Licameli,2021-06-17T16:06:12Z,"dofuuz, do you wish to be listed in the Credits dialog of the next version?  If so, how exactly should we spell your name?  (In Hangul too if you like.)
"
863634816,830,dofuuz,2021-06-18T00:01:21Z,"@Paul-Licameli 
Yes. List me as
Myungchul Keum
Thanks😆"
863921860,830,petersampsonaudacity,2021-06-18T10:05:26Z,"I have updated the Website Credits page adding Keum to the ""Contributors""
https://www.audacityteam.org/about/credits/

I cannot update the in-app credits.

Thanks for your work on this Keum/dofuuz   😆"
864428089,830,Paul-Licameli,2021-06-19T16:32:42Z,"Please help, we want to be sure that it is correct to alphabetize that under K and not M!
"
864639369,830,dofuuz,2021-06-21T00:30:01Z,Keum is my family name.
864945672,830,petersampsonaudacity,2021-06-21T11:07:58Z,"Thanks for that clarification dofuuz ( Myungchul)  - I have adjusted that ordering in the Website credits:
https://www.audacityteam.org/about/credits/

Th latest 3/.0.3 alpha already has the correct alphabetic ordering.

Peter.

"
857973805,966,Paul-Licameli,2021-06-09T18:46:11Z,"I will await resolution of points I raised before continuing review.
"
862870490,966,Paul-Licameli,2021-06-17T02:37:00Z,"Before anything else:  again, please simplify the commit history.  Make one simple, straight branch.  Do not include merge commits.  Rebase or cherry-pick one of the branches onto the other.  You could do
```
git checkout tracking-version
git reset --hard 1426e5f2c021116ae61dd6e350db724a07e8529c
git cherry-pick 944edbcc0f3180d6aaf93ab9ef1247404eec64e5
git cherry-pick 14922cfc738df1bca1401f0a75a178dd35f7c40d
```

And then, rebase onto more recent master and force-push.  You might also do git rebase -i and make some of these commits fixups so the history is shorter.
"
1127854928,2941,petersampsonaudacity,2022-05-16T16:03:12Z,"Tested on macOS 12.3.1 Monterey with @ksoze95 branch build:  audacity-macOS-3.2.0-alpha-20220516+4592471-x86_64 
I can't test on Windows as those are not building Artifacts.

I see the new cogwheel ""Audacity Audio Setup Toolbar"" - can't test the options on Mac as there are no options to switch to.
![image](https://user-images.githubusercontent.com/50205984/168636747-41bae302-caef-4336-937c-dfd1b0b17c43.png)

AFAICT (limited on Mac) the **Cogwheel>Audio Settings** dialog  and the **Cogwheel>Input Settings** both seem to interact correctly with the Devices Preferences.  

**This begs a question:** do we really need Devices preferences now that we have the cogwheel since there seems to be total overlap between the new ""**Audio Settings - Devices**"" dialog and the **Devices prefs** dialog?
Flagging @Tantacrul  and @LWinterberg  as a UX/design issue.


I note that the Device Toolbar has been removed entirely (_replaced by the new toolbar in the View>Toolbars menu_).  I assume that this is intentional?

--------------------------------------

**My initial feedback** is that I think the cogwheel is a good replacement for the Device Toolbar especially as it appears to be ""enabled"" by default.  I like the fact that it is a lot more economical in terms of screen real-estate occupied.Of note is that in the early versions of Audacity Dominic Mazzoni did not have a Device Toolbar, just Devices prefs."
1127883848,2941,LWinterberg,2022-05-16T16:28:45Z,"> I note that the Device Toolbar has been removed entirely (replaced by the new toolbar in the View>Toolbars menu). I assume that this is intentional?

No, this was a miscommunication. the device toolbar is supposed to be just hidden, not completely removed.

"
1127889972,2941,petersampsonaudacity,2022-05-16T16:34:58Z,"> > I note that the Device Toolbar has been removed entirely (replaced by the new toolbar in the View>Toolbars menu). I assume that this is intentional?
> 
> No, this was a miscommunication. the device toolbar is supposed to be just hidden, not completely removed.

So that would give the user **_three_** ways to make the same settings - that seems a little OTT.  

I can see that you might want to keep it hidden by default just so that users used to having a Device Toolbar can still have one - but it is somewhat redundant.  The only advantage that it has is that (when enabled) it always shows the user what the basic devices settings are."
1127908172,2941,Tantacrul,2022-05-16T16:54:17Z,"Perhaps we're being overly cautious. I'm worried about all those tutorials that show people how to record from their laptop, etc. I'll need to **really call this out** in our release video.
"
1127921430,2941,petersampsonaudacity,2022-05-16T17:08:18Z,"> Perhaps we're being overly cautious. I'm worried about all those tutorials that show people how to record from their laptop, etc. I'll need to **really call this out** in our release video.

But since you'll be hiding the Device Toolbar by default a lot of those users will still be fretting ...

So yes a ""good call out"" in the Release video will be a good idea.


"
1127979237,2941,SteveDaulton,2022-05-16T18:08:46Z,"I see that this is still listed as ""work in progress"", but in case it's helpful, it's not working correctly for me.
If the ""Output Device"" and/or ""Input Device"" are set to non-default settings in the main ""Cog wheel"" menu, then setting the devices in either of ""Cog > Audio Settings"" or ""Preferences > devices"" have no effect.

Testing with the Ubuntu 20.04 AppImage on Xubuntu 20.04."
1128849250,2941,petersampsonaudacity,2022-05-17T13:09:30Z,"Testing on W10 with @ksoze95 latest branch build

I) the interaction between the Cogwheel Audio setup and the Devices Preferences is not working for the input and output devices

2) that interaction seems to work OK for the Host - and for Buffer Length and Latency Compensation

3) a nomenclature **_inconsistency_** has been introduced
The first entry on the Cogwheel menu is called **Driver Type** - this has always been **Host** in the App and documentation
![image](https://user-images.githubusercontent.com/50205984/168819226-68e07d44-ecbe-44da-a5a7-997a305b7b6f.png)

In Preferences it is **Host**
![image](https://user-images.githubusercontent.com/50205984/168818742-99898433-e210-49f9-b508-8fa3b5501693.png)


And even in Cogwheel>Audio Settings...   it is **Host** too
![image](https://user-images.githubusercontent.com/50205984/168819509-98c37f69-09bc-412e-80b0-d0d7a5ece025.png)


So the inconsistency exists even within the new Cogwheel setup



4) Note too that there is a nomenclature difference/inconsistency between
a) Preferences & Audio settings dialogs which use **Playback Device** and **Recording Device**
b) whereas the Cogwheel menu uses **Output Device** and **Input Device** for the same  things
"
1128901495,2941,petersampsonaudacity,2022-05-17T13:53:56Z,"5) Making a device setting in the Cogwheel does not stick - it reverts to default:

1. purge Audacity settings folder (for OOTB default factory settings)
2. Launch latest Cogwheel branch audacity-win-3.2.0-alpha-20220516+465d3ee-x64-msvc2022
3. Observe in both Cogwheel and Pref s the default playback an recording devices match and are the default
4. In Cogwheel change the recording device to be the non-default **Stereo Mix**  YMMV
5. Exit the Cogwheel
6. Click again the Cogwheel
7. Note that the Stereo Mix has not stuck and the input device has reverted to the default

The same happens if I set either the input device or output device to be the non-deafults:  Microsoft Sound Mapper... 

And I note that the same is now true if I use Prefs rather than the Cogwheel (this is a **_regression_** on 3.1.3 and earlier)

_It basically looks like Cogwheel-Audacity is basically ignoring any settings the user makes in Prefs or Cogwheel for the input and output devices and always reverts to the defaults._
"
1128952578,2941,Tantacrul,2022-05-17T14:36:34Z,"@ksoze95

- Can you make all the changes to strings that @petersampsonaudacity has raised (basically returning to what Audacity already uses)?"
1128956996,2941,Tantacrul,2022-05-17T14:40:20Z,"@petersampsonaudacity - nice spot about those settings being ignored.

@ksoze95 - I think we'll need to fix this too and make sure that whatever place you do it, the setting is reflected everywhere else.

I've recorded a little video to demonstrate. Basically, the preferences are just being ignored.

https://user-images.githubusercontent.com/21022311/168838185-3b2eecad-29e6-4094-adc3-ed24f5f667dd.mp4

It almost seems like the 'Device' toolbar is the 'king' here and the options in preferences are subordinate. "
1128975333,2941,SteveDaulton,2022-05-17T14:55:48Z,"> Basically, the preferences are just being ignored.

Yes. https://github.com/audacity/audacity/pull/2941#issuecomment-1127979237
If you compare with deaa3f you will see that in the older 3.2.0 alpha version, changing the Recording / Playback devices in Preferences updates the Device Toolbar settings, and vice versa."
1128989429,2941,petersampsonaudacity,2022-05-17T15:08:08Z,"@Tantacrul  if the Device Toolbar is to be retained (as you said earlier) then perhaps you can add a menu item to the Cogwheel menu for showing/hiding Device Toolbar ?

That would be  less cumbersome than going to View>Toolbars - and should be more ""discoverable""."
1129028286,2941,petersampsonaudacity,2022-05-17T15:42:46Z,"Testing on W10 with the latest branch build:  audacity-win-3.2.0-alpha-20220517+5d5623f-x64-msvc2022 

1) I find that if I make a change to a non-default device using Cogwheel>Audio settings dialog then the change does not stick and stays at default device.

2) But If I use Cogwheel > Input Device then to make then change than it douse stick - AND it shows as changed in Prefs

3) I still find that changes I make in Devices for the I/O devices still do not stick and revert/stay defaults

4) The strings have not been changed as @Tantacrul requested"
1129047693,2941,Tantacrul,2022-05-17T15:59:56Z,"> @Tantacrul  if the Device Toolbar is to be retained (as you said earlier) then perhaps you can add a menu item to the Cogwheel menu for showing/hiding Device Toolbar ?
> 
> 
> 
> That would be  less cumbersome than going to View>Toolbars - and should be more ""discoverable"".

I would say we should get it functioning properly first and then test it a bit before doing that. I have no idea how much of an impact this change may make."
1129858055,2941,Paul-Licameli,2022-05-18T10:48:31Z,"Done with my first round of review of this draft
"
1129865709,2941,ksoze95,2022-05-18T10:57:47Z,"> The same happens if I set either the input device or output device to be the non-deafults: Mic

It is not specific to this PR.  It appears to be broken on master as well."
1129870334,2941,Tantacrul,2022-05-18T11:03:19Z,"> It is not specific to this PR. It appears to be broken on master as well.

OK, understood. Well, we should fix it before release separately then. Thanks!"
1129872087,2941,petersampsonaudacity,2022-05-18T11:05:23Z,"> > It is not specific to this PR. It appears to be broken on master as well.
> 
> OK, understood. Well, we should fix it before release separately then. Thanks!

Confirmed on W10 with latest alpha 3.2.0 master:  audacity-win-3.2.0-alpha-20220516+465d3ee-x64-msvc2022

I will log a new GitHub issue for this.

"
1129874377,2941,petersampsonaudacity,2022-05-18T11:08:17Z,"@Tantacrul - might it not have been simpler if **Cogwheel>Audio Settings...**  had just invoked **Devices Preferences** rather than creating a whole new dialog for it, since that new dialog duplicates everything that Devices Prefs does?  

Or is the plan to remove Devices Preferences from the Prefs settings in favor of the new cogwheel dialog?"
1129895812,2941,Tantacrul,2022-05-18T11:32:22Z,"> @Tantacrul - might it not have been simpler if **Cogwheel>Audio Settings...** had just invoked **Devices Preferences** rather than creating a whole new dialog for it, since that new dialog duplicates everything that Devices Prefs does?
> 
> Or is the plan to remove Devices Preferences from the Prefs settings in favor of the new cogwheel dialog?

Let's discuss all that later. And probably best discussed in Discord too to avoid making poor Kit and Paul's head spin :)"
1129910078,2941,petersampsonaudacity,2022-05-18T11:48:58Z,"> I will log a new GitHub issue for this.

Done:  **Devices Prefs ignores user settings for changes of I/O devices** #2948 "
1130246504,2941,petersampsonaudacity,2022-05-18T16:44:14Z,"Can I please suggest that the Cogwheel Toolbar is moved across leftwards so that it is adjacent to the Transport Toolbar (as it relates to what goes on in the Transport Toolbar:
![image](https://user-images.githubusercontent.com/50205984/169097110-a2ff7f17-eee6-4019-ba67-e672be0fc3cf.png)
"
1130270627,2941,Tantacrul,2022-05-18T17:10:22Z,"This cog button is actually unfinished. It is meant to have the words 'Audio setup' under it and look like this:

<img width=""817"" alt=""image"" src=""https://user-images.githubusercontent.com/21022311/169101824-de3f4164-d40f-412b-b21f-0fb5106c87b5.png"">

The point being that users can easily identify its function - especially those who are used to the device toolbar.

Otherwise, I'd agree!

"
1130271861,2941,Tantacrul,2022-05-18T17:11:43Z,"We're ultimately planning for a layout that looks a bit like this (WIP)
<img width=""1469"" alt=""image"" src=""https://user-images.githubusercontent.com/21022311/169102156-fb894567-f80d-4d82-a09b-6551feaf4f5c.png"">

This would be after we've found a way to eliminate all the modes, apart from the Envelope tool, which would still need to be there."
1130387031,2941,petersampsonaudacity,2022-05-18T18:50:35Z,"Oh that's a shame I've already gotten to like Mr, Coggy ...
Folk are very used to seeing cogwheels for setup stuff.

And yes I like that new layout look"
1130402409,2941,Tantacrul,2022-05-18T19:08:56Z,Giving him a name like '**Mr Coggy**' is a wonderful tactic to make me feel guilty about changing him.
1130481358,2941,Paul-Licameli,2022-05-18T20:02:34Z,"> Giving him a name like '**Mr Coggy**' is a wonderful tactic to make me feel guilty about changing him.

Would you rather have Mr Clippy?"
1130535705,2941,petersampsonaudacity,2022-05-18T20:52:39Z,"> Giving him a name like '**Mr Coggy**' is a wonderful tactic to make me feel guilty about changing him.

I'm lovin' Mr Coggy - my Mystery-Shopper does too

We both feel that he gives an immediate modern idiom twist to Audacity's old-fashioned GUI.

It's a knowing twist that says ""yeah we know the GUI looks ancient - but we can fix it!"" - a pointer to the future the GUI/GUIs yet to come ,,,
"
1130575409,2941,SteveDaulton,2022-05-18T21:37:40Z,"Martin's ""Audio Setup"" button is much less ambiguous than a cog icon.

While the gear / cog icon has become familiar to most in relation to ""settings"", there's no indication that it has anything to do with _audio_ settings until you actually use it. In terms of visual  language, the gear / cog icon is vague."
1131366462,2941,petersampsonaudacity,2022-05-19T07:57:53Z,"> While the gear / cog icon has become familiar to most in relation to ""settings"", there's no indication that it has anything to do with _audio_ settings until you actually use it. In terms of visual language, the gear / cog icon is vague.

Perhaps then we could consider retaining Mr Coggy but re-purposing it as a more ""discoverable"" way of invoking Preferences.

In that role it could perhaps become a single height button."
1131391683,2941,Tantacrul,2022-05-19T08:23:08Z,"> > Giving him a name like '**Mr Coggy**' is a wonderful tactic to make me feel guilty about changing him.
> 
> Would you rather have Mr Clippy?

""It looks like you're trying to record a podcast! Want help with that?"""
1135940753,2941,petersampsonaudacity,2022-05-24T13:42:31Z,"As per the testing for Issue:
**Devices Prefs ignores user settings for changes of I/O devices** #2948 

Testing on W10 with @ksoze95 's branch build:  Audio setup rework Build Audacity #1369

Changes there seem to have had an impact on this issue too _(the three ways of setting devices should be all linked in step)_

a)  Original steps 1-7 and new steps 1-12 now appear to work correctly with the user's settings properly persisting
b) changes made in Devices prefs ripple through to the Device Toolbar and the Cogwheel settings
c) changes made in the Cogwheel settings ripple through to the Device Toolbar and Devices prefs
d) changes made in the Device Toolbar ripple through to the Cogwheel settings and Devices Prefs

I note too that the nomenclature in Cogwheel>Audio Settings has now changed to the standard, long-standing, Audacity terms.

**_BUT_** we still have a regression residual where the default channels is now **1 (mono)** and not **2 (stereo)**"
1137484116,2941,petersampsonaudacity,2022-05-25T16:09:26Z,"Testing on macOS 12.3.1 Monterey with @ksoze95 Kit's latest branch build:  audacity-macOS-3.2.0-alpha-20220525+4bdb8f8-x86_64 
https://github.com/audacity/audacity/actions/runs/2383883708
Note that I can't test on W10 as the Windows builds failed

I cannot test non-default changes on Mac as I only have a single option for the I/O devices and Host.

**_BUT_** I note that we still have the regression residual where the default channels is now **1 (mono)** and not **2 (stereo)**
And now with the Device toolbar hidden/disabled by default it is not immediately obvious that this is the case.

_And RIP Mr Coggy - I'm missing him already_  ..."
1138778501,2941,petersampsonaudacity,2022-05-26T16:50:32Z,"Testing on W10 with @ksoze95 Kit's latest branch build:  audacity-win-3.2.0-alpha-20220526+15d701b-x64

We still have the regression residual where the default channels is now **1 (mono)** and not **2 (stereo)**.

1. purge the Audacity settings folder
2. launch audacity-win-3.2.0-alpha-20220526+15d701b-x64
3. Click on Audio Setup
4. Click on Recording Channels
5. Observe: default is **1 (mono)**

And now with the Device toolbar hidden/disabled by default it is not immediately obvious that this is the case."
1138840659,2941,Tantacrul,2022-05-26T17:38:44Z,"@petersampsonaudacity - since this is a separate issue that was not introduced in this PR, @ksoze95 won't be fixing it here. Just so you know!"
1138853088,2941,petersampsonaudacity,2022-05-26T17:53:11Z,"> @Tantacrul since this is a separate issue that was not introduced in this PR, @ksoze95 won't be fixing it here. Just so you know!

But testing with that latest master alpha this is not the case - with that the default is **still 2 (stereo)**  


"
1143517453,2941,DavidBailes,2022-06-01T12:02:18Z,"The items on the main audio setup menu (host, playback device, etc) should have access keys."
1143547615,2941,petersampsonaudacity,2022-06-01T12:30:28Z,"Testing on my Zurich W11 laptop with @ksoze95  Kit's latest branch build:  audacity-win-3.2.0-alpha-20220601+f8b50f1-x64

a) the default settinf for channels is now reverted to ""2 (stereo)""
b) the Adio settings and Devices Pefs abnd Device toolbar all stay in lock-step together when a user makes changes in any one of the three.

So looking good to me on W11"
1143549281,2941,petersampsonaudacity,2022-06-01T12:31:56Z,"> The items on the main audio setup menu (host, playback device, etc) should have access keys.

@DavidBailes they appear to have these when I test @ksoze95 's latest brabch build on W11:  audacity-win-3.2.0-alpha-20220601+f8b50f1-x64"
1143558986,2941,DavidBailes,2022-06-01T12:40:34Z,"Lack of access keys:
![image](https://user-images.githubusercontent.com/11887021/171406612-d9cfadf8-84f0-417f-8871-9d1991c0fb40.png)
"
1143722455,2941,petersampsonaudacity,2022-06-01T15:00:54Z,"
@DavidBailes Oh I see what you mean now - I was looking at the dialog not the menu:
![image](https://user-images.githubusercontent.com/50205984/171436013-640c7011-cea0-4198-bdc8-7781a26b7a3b.png)


"
1143979444,2941,Paul-Licameli,2022-06-01T18:15:35Z,"Another anomaly with settings, in master and also in this branch:  Be sure it's fixed in the final version!

- delete audacity.cfg, start, exit.
- Start again, go to Quality settings, choose 48000 for rate, press OK.
- Don't exit, but Ctrl+N to open a new project.

Observe:  44100 in the Project Rate drop-down in the Selection bar at bottom of screen; but Expect: 48000.  And if your record, you get a 44.1 kHz track, not 48.


### Update by @petersampsonaudacity 
I confirm this is the case in the latest 3.2.0 master audacity-win-3.2.0-alpha-20220601+e71f24b-x64-msvc2022

a) The Manual clearly states:
> **Default Sample Rate:** This sets the [Sample Rate](https://alphamanual.audacityteam.org/man/Sample_Rates) which will be used each time Audacity is launched and also when a new project window is opened.

So Audacity should change the Project rate and the rate of newly recorded tracks in the new project window


b) It is less clear to me what one should expect in the original project window - the Manual states:
>Changing this Preference setting will not change your project's Project Rate], so if you wish your current project to use the new sample rate you will need to reset that in the Selection Toolbar.

So it is clear that the Project rate is unchanged by the preferences change in the original projct - what is unclear (undefined) is that any newly recorded track in the original project will be recorded at the unchanged Project rate and not the rate set in Quality preferences.

Since this is an issue in master I will log this as a new issue.

**Logged:   New Project does not take its Project Rate from Qualty Preferences #3017** 

### Further update
Further testing shows that in a project (in this case the original project) any newly recorded track is recorded at whatever the user sets or changes their Project rate to be in the Selection Toolbar.  

So whatever is in the Selection Toolbar for Project Rate at any time is independent of what the setting is in the Quality preferences.  The Quality Preferences is _**only**_ ever used at launch time to set the Project Rate (but should be used for a Ctrl+N new project, according to the Manual anyway).  

I'm not convinced that this loose linkage is readily ""discoverable"" - it takes a  careful RTFM to grasp this.

"
1143996149,2941,Paul-Licameli,2022-06-01T18:32:27Z,"Another anomaly, not in master but in this branch:

- delete audacity.cfg, start.
- Open Interface preferences, and change the dB range to 120.  OK.
- Genearate noise, right-click in the vertical ruler, and choose dB.

Observe:  -60 at the mid-line but Expect: -120.

My study of the source tells me there are no other anomalies.

### Update from @petersampsonaudacity 
Confirmed on W11
a) latest 3.2.0 alpha master works correctly - unlike this branch
b) note that this also affects the displayed range in the meters too and not just the Vertical Scale

"
1453551031,4384,Paul-Licameli,2023-03-03T13:42:24Z,"Excellent!  But still a draft.  What is missing?
"
1453557953,4384,vsverchinsky,2023-03-03T13:48:05Z,"> Excellent! But still a draft. What is missing?

Export parameters should replace global prefs and break dependency on ShuttleGUI, direct invocations of message dialogs still happening during export process, import and export process is still happening in the main thread ... I'll update parent ticket so it would be easier to understand the progress.

And I think it make sense to keep it draft, so that QA team could avoid testing it multiple times"
1453580630,4384,Paul-Licameli,2023-03-03T14:05:00Z,"Failing builds
"
1464091922,4384,Paul-Licameli,2023-03-10T16:54:40Z,"This round of review is complete!
"
1469929815,4384,Paul-Licameli,2023-03-15T12:38:30Z,That's all for the first new commit
1578387706,4384,saintmatthieu,2023-06-06T10:29:04Z,"I just tried to open a wav file through the File>Recent menu, which yielded 
![image](https://github.com/audacity/audacity/assets/22740106/e7a97918-6b44-4d1b-8204-481eedd8471d) ; Maybe I'll find out that it's intended, but I'm skeptical.
"
1578820454,4384,saintmatthieu,2023-06-06T13:57:55Z,"Problem clarified (thanks @vsverchinsky) : I was only building the Audacity target, the modules were never built. Using ""Build All"" solved it.
Should we leave it at that or to make the DLL builds a pre-condition to building the Audacity target in CMake?"
1676938321,4384,vsverchinsky,2023-08-14T08:52:44Z,Closed in favor of https://github.com/audacity/audacity/pull/4668
1221592329,3396,Paul-Licameli,2022-08-21T17:52:22Z,"> The new `ProcessInitialize` no longer calls `ConsumeChanges`. Does destructive processing correctly apply the changes to settings made in the dialog? How is that communicated? I must see the tenth commit I suppose.

I did stepping through in the debugger and now I understand that `FlushSettings` and then `StoreSettings` in `ValidateUI` puts complete state into `EffectSettings`, then `ProcessInitialize` causes `FetchSettings` to complete the copy of state correctly into another instance object.

"
1221593936,3396,Paul-Licameli,2022-08-21T18:03:47Z,"I just noticed one `TODO` can be easily fixed:  `VST3Effect::LoadPreset` can now be `const` and the ugly `const_cast` at line 232 can be removed.
"
1221598834,3396,Paul-Licameli,2022-08-21T18:34:41Z,"I'm almost approving this commit.  Please see all the comments above that I did not yet mark resolved.

I would like to have some explanation of why Base64 conversion was not working as expected.

Also see the points about UpdateUI.  I did some experiments, exporting a custom preset, then trying to switch between defaults and importing my preset, using the sidebar dialog, during play and while not playing.

This does not yet work properly.

We might decide it's good enough for alpha release without this, but you are right that we must ""send changes via IComponentHandler"".
"
1221600405,3396,Paul-Licameli,2022-08-21T18:46:27Z,"Besides those two important points, there is the suggestion that a map to optionals might be better.

I can demonstrate a problem that I think would be fixed by this.

With Valhalla Supermassive, I use default settings, click ""Mix"" and then, during play, click and drag that dial, then release.

I can get the dial to fluctuate between two different values, sometimes very different values, and hear the playback switching between them.
"
1221600449,3396,Paul-Licameli,2022-08-21T18:46:48Z,"Really then, that is three important points.  There are other recent points I made that are only suggestions.
"
1222393071,3396,Paul-Licameli,2022-08-22T13:51:18Z,"Second commit comment has a spelling error in ""redundant""
Third commit ""Moving some of components into VST3Wrapper"" now fails to build!
"
1222404807,3396,Paul-Licameli,2022-08-22T14:00:47Z,"Another commit comment misspells ""actual""
"
1222409453,3396,Paul-Licameli,2022-08-22T14:04:22Z,"Your new last commit makes a much simpler fix for the problem of fluctuating settings.  Now I feel silly that I didn't think of it!
"
2082135837,6359,LWinterberg,2024-04-29T08:21:00Z,"> No micro fades

As in, it doesn't honor the micro-fades preference? "
2082414381,6359,dozzzzer,2024-04-29T10:52:31Z,"@vsverchinsky when playing a mono clip, only the left channel is playing audio:

<img width=""500"" alt=""image"" src=""https://github.com/audacity/audacity/assets/70063970/0916ce8c-5cb3-4d0b-9142-cbb579838084"">
"
2104747376,6359,Paul-Licameli,2024-05-10T14:50:09Z,"I have completed a review of changes in AudioIO.cpp.

If my contribution of per track meters is also wanted, there is a lot of needed work to make these compatible.

I may volunteer my own very different rewrite of AudioIO.cpp to support a master channel in the right way.

I understand that:
- The sequence of transformations on individual tracks includes time warping (for time track), muting (of individual tracks), effects (stacked on single tracks), panning, in that order.
- Then you mix tracks and apply the master stack, on the PRODUCER side of the RingBuffer.  (As for individual stacks.  We must avoid who knows what computations in opaque code, on the low-latency consumer side.)
- Micro-fading is still applied on the consumer side.
- There are only one or two RingBuffers corresponding to the device output channels.

The old version, without a master stack, differed in these ways:
- There was a RingBuffer for each WaveChannel.
- Applying mute and pan, and mixing of the RingBuffer outputs, was done on the consumer side.

Questions might arise about subtle differences of results, moving the muting before the effect processing.  (Is it better with your change?  Have you tried muting a track with a reverb, during play -- which before, would just mute it at once, but after, might instead produce the decaying tail of what was unmuted?)

Also, whether pan should apply before a per-track effect or after:  It might make a difference for certain effects like reverbs that are not simple LTIs but might work in terms of mid and side channels.  (@saintmatthieu, opinion?)

More later...
"
2107765303,6359,Paul-Licameli,2024-05-13T14:31:55Z,"More:

The existing ring buffers should not be removed.  Ring buffers for the master mix should be added.  The consumer thread should take equal samples out of all of them.  Only the samples from the master mix are stored in the output buffer of the audio io callback.

This allows future development to send the buffers of pre-mixed per-track data inter-thread, back to the master thread for drawing.

 See `SendVuInputMeterData` and `SendVuOutputMeterData` which now do such inter-thread communication:  but I would need to send other buffers too.

 My thinking is this:  the consumer thread needs to have access to intermediate states of calculation of the mix samples, corresponding in time to the ultimate output.  Those intermediates should be sent to other code that performs graphical display, keeping as closely synchronized as possible with the real-time playback.  That synchronization will not be perfect, given the reality of frame refresh rates.

Still, the latency of the RingBuffer itself should be accounted for in that drawing update.  Sending the per-track information to the main thread more directly from the producer thread would make less perfect synchronization of the display.

Therefore, more data should be travelling through ring buffers from the high-throughput but variable-latency producer thread, to the more regularly updating consumer thread.
"
2111587483,6359,saintmatthieu,2024-05-15T04:59:15Z,"@Paul-Licameli good point about reverb.
I confirm that muting a track may not instantly mute the sound but any effect with a tail will continue ringing.
It may sound better but I don't think this is the wanted behaviour: muting is muting. What if the effect is a long echo ?
@LWinterberg ?"
2111592889,6359,saintmatthieu,2024-05-15T05:04:16Z,"About panning before or after, yes, if the effect is non LTI, this would make a difference. If there is one place for panning and gain, I think it should be where it is a the moment, after the effect stack. I guess other DAWs do it that way, too (or may have also a ""pre-gain""), and if a non LTI effect such as a compressor comes in, it will come with its own pre-processing gain parameter.
A mid/side encoding/decoding operation is a linear operation, though, so in that particular case it should not make a difference."
2114951687,6359,Paul-Licameli,2024-05-16T11:16:09Z,"I disapprove.

please wait to see my alternative that will be compatible with oerctrack meters.

expext it today.
"
2115329003,6359,saintmatthieu,2024-05-16T13:58:27Z,"Approving for now. My purpose is not to override @Paul-Licameli's disapproval, because maybe his alternative makes this very complex logic easier ? I'll leave up to @vsverchinsky to decide but I don't want to block QA anymore."
2115341961,6359,Paul-Licameli,2024-05-16T14:03:54Z,"Let it merge then:  but my PR will begin with reversion of all the changes in AudioIO.cpp (not of other UI changes) and then a more careful stepwise rewrite.

QA will likely need to re-test everything involving sound quality, but not the UI changes.
"
2117510228,6359,chinakov,2024-05-17T12:38:01Z,"Found issues:
1. When a User adds [MT-A Plugin by Mercurial](https://mercuriall.com/cms/details_freestuff) to the Master Effects, and uses the built-in bypass feature, the audio played back is panned 100% to left, instead of stereo playback. 
2. When a User adds Kilohearts Distortion plugin to the Master Effects, and playbacks some audio, full scale noise can be heard for a second after playback has been initialized.
3. If a User has added any Master Effects, and enabled them, the effects are not applied to files on file export (I am not sure what to expect here, should Master Effects render when they are enabled?) "
2117558304,6359,LWinterberg,2024-05-17T13:03:13Z,">  (I am not sure what to expect here, should Master Effects render when they are enabled?)

Yes!"
2117561488,6359,Paul-Licameli,2024-05-17T13:04:57Z,"> Let it merge then: but my PR will begin with reversion of all the changes in AudioIO.cpp (not of other UI changes) and then a more careful stepwise rewrite.
> 
> QA will likely need to re-test everything involving sound quality, but not the UI changes.

My changes are more complicated than expected.

However, I might be fixing long standing problems with effect latencies.  Search for issues with “latency”"
2117614528,6359,saintmatthieu,2024-05-17T13:30:22Z,Looking into the export/render problem.
2119869587,6359,DavidBailes,2024-05-20T07:46:28Z,"@vsverchinsky .  Serious accessibility issue, logged here: https://github.com/audacity/audacity/issues/6456"
2119903740,6359,DavidBailes,2024-05-20T08:07:17Z,"@vsverchinsky . Another accessibility issue, logged here: https://github.com/audacity/audacity/issues/6457"
2125362139,6359,vsverchinsky,2024-05-22T17:15:20Z,Completed review of @saintmatthieu commits :+1:
915730636,1614,Paul-Licameli,2021-09-09T03:21:22Z,"This round of review is now COMPLETE!  The overall approach is sound, but I flagged many details that need attention.  None of these is difficult by itself.
"
929092855,1679,Paul-Licameli,2021-09-28T11:15:54Z,"I see this is rebased onto more recent master now.

I like the more detailed explanation in commit comments.

In commit comments, if you write more than one line, then always make the second line blank, and after it, use line breaks at about 80 columns.
"
933436337,1679,Paul-Licameli,2021-10-04T12:29:31Z,"At last, I consider this review complete!
"
1869629697,5818,crsib,2023-12-26T15:53:24Z,Have you addressed the issue with zoom levels where min and max have the same sign?
1870094918,5818,vsverchinsky,2023-12-27T09:02:32Z,"> Have you addressed the issue with zoom levels where min and max have the same sign?

I've attempted to fix that but not sure that it was correct:
![изображение](https://github.com/audacity/audacity/assets/20165230/46d8d9e4-d125-4a51-9ce0-92ecc68b777f)
![изображение](https://github.com/audacity/audacity/assets/20165230/14bdb514-6f4b-4ad6-9c86-ac513503c10f)
"
1870103599,5818,Paul-Licameli,2023-12-27T09:12:53Z,"Linux build is failing.

Is this only about waveform painting? If so, rename it all as Lin-waveform-paint.

Or maybe lib-waveform-geometry if the library will also handle any hit testing.  The painting and hit testing for anything painted on the screen should be kept together.  Painting maps some thing to pixel x and y coordinates, while hit testing must know the inverse of the same mapping.
"
1870107894,5818,crsib,2023-12-27T09:17:51Z,"> The painting and hit testing for anything painted on the screen should be kept together

I strongly disagree. These topics are irrelevant most of the time, and definitely irrelevant here."
1870112880,5818,crsib,2023-12-27T09:23:59Z,"> If so, rename it all as Lin-waveform-paint.

`lib-wave-track-paint` is a green library providing a way to build visuals for wave tracks. Right now, only waveform painting has been migrated to this library. Neither Vitaly nor I ever migrated the ""green"" part of the spectrogram painting. This can be done, however."
1870129237,5818,vsverchinsky,2023-12-27T09:43:59Z,"> Linux build is failing.

Trying to fix that...

> Is this only about waveform painting? If so, rename it all as Lin-waveform-paint.

Right now it has only waveform image generation part. As you mentioned it could provide geomentry data that will be useful for hit testing and in that case `lib-waveform-geometry` could be an option too.

> Or maybe lib-waveform-geometry if the library will also handle any hit testing

It could indeed provide geometry information for hit testing purpose, as hit testing itself usually refers to platform or framework specific code, I think. But there is nothing to hit test right now. This library does not provide any means to draw ""lollipops"" or envelopes that can be manipulated.

"
1870135083,5818,crsib,2023-12-27T09:51:19Z,"> It could indeed provide geometry information for hit testing purpose, as hit testing itself usually refers to platform or framework specific code, I think.

I strongly disagree. This is a lower-level library, that is only responsible for helping the WaveformView to **paint** given the ZoomInfo, selection, and screen bounds. It is not responsible for interactions and it should be kept that way."
1870208788,5818,Paul-Licameli,2023-12-27T11:20:42Z,"> > It could indeed provide geometry information for hit testing purpose, as hit testing itself usually refers to platform or framework specific code, I think.
> 
> I strongly disagree. This is a lower-level library, that is only responsible for helping the WaveformView to **paint** given the ZoomInfo, selection, and screen bounds. It is not responsible for interactions and it should be kept that way.

No, don't make it responsible completely for interactions.  However the association between pixel coordinates and things in the data model ought to be defined in one place.  A mapping of things to pixels required for painting, and its inverse mapping, should be defined together and kept consistent.

So maybe what I want to argue is that lib-waveform-geometry would be separated from a painting library and do only such coordinate transformations.  lib-waveform-painting could depend on it, and hit testing would also depend on it, but neither of those two would depend on the other.

My opinion about spectrogram is that it is a completely different association of things with pixels, at least in the y coordinate, and would have its own separate libraries.

"
1870213113,5818,crsib,2023-12-27T11:26:41Z,"> No, don't make it responsible completely for interactions. However the association between pixel coordinates and things in the data model ought to be defined in one place

ZoomInfo is still used to achieve this purpose.

> My opinion about spectrogram is that it is a completely different association of things with pixels, at least in the y coordinate, and would have its own separate libraries.

This library provides the way to cache imagery, required to draw WaveTrack. Spectrograms are no different in this aspect. The way how the specific bitmap is generated can be lifted away from the library, resulting in 3 libraries: caching, waveform bitmap generation, and spectrogram image generation. "
1870226702,5818,Paul-Licameli,2023-12-27T11:38:28Z,"> > No, don't make it responsible completely for interactions. However the association between pixel coordinates and things in the data model ought to be defined in one place
> 
> ZoomInfo is still used to achieve this purpose.

Yes, the association x-coordinate with time is common to spectrum and waveform views, and is already in lib-screen-geometry which does not even depend  on wxBase.

The two kinds of views define very different meanings for y-coordinates however and would have completely different paint procedures, in the detailed use of that caching and blitting layer.

Really I must go beyond my simple reaction to the pull request title and really review it to see what's really there.  I'm still waking up.
"
1871121357,5818,crsib,2023-12-28T12:28:41Z,"I would like the review to pause, for now, @Paul-Licameli 

1. It was not agreed yet that we need it for 3.5 or for Audacity 3 at all.
2. Most of the comments are related to disliking names. This brings an enormous cognitive load when reading the comments.
3. Likely the part you are looking at now can be omitted.
4. The next commit is enourmous.  Unless we agree first on some basic ideas I expect the review to span hundreds of comments again. I would like to avoid that. 
5. I don't remember the details of the code, so I can't respond to the comments.

If Martin and Yana would approve moving this PR forward, we will clean it up with Vitaly first and discuss the ideas on the dev call first."
1871130220,5818,Paul-Licameli,2023-12-28T12:40:52Z,"> I would like the review to pause, for now, @Paul-Licameli
> 
>     1. It was not agreed yet that we need it for 3.5 or for Audacity 3 at all.
> 
>     2. Most of the comments are related to disliking names. This brings an enormous cognitive load when reading the comments.
> 
>     3. Likely the part you are looking at now can be omitted.
> 
>     4. The next commit is enourmous.  Unless we agree first on some basic ideas I expect the review to span hundreds of comments again. I would like to avoid that.
> 
>     5. I don't remember the details of the code, so I can't respond to the comments.
> 
> 
> If Martin and Yana would approve moving this PR forward, we will clean it up with Vitaly first and discuss the ideas on the dev call first.

All right, I will stop.  But please note:  there is more than just naming to object to.  I think there are real off-by-one errors in the bounding box class.

"
1871147681,5818,crsib,2023-12-28T12:58:18Z,">  I think there are real off-by-one errors in the bounding box class.

I agree, there are errors for sure."
1871447058,5818,Paul-Licameli,2023-12-28T19:46:30Z,"> > I think there are real off-by-one errors in the bounding box class.
> 
> I agree, there are errors for sure.

I'm NOT reviewing, just noting other thoughts while compiling something else.

There IS a need to distinguish point and vector.  Surely Rectangle stores a point for top left, and BoundingBox for top left and bottom right.

I didn't review Size completely, but it too has some strangeness (like multiplication of two sizes, why?).  Maybe Size should become the vector class and a Rectangle can be defined by a point and a diagonal vector.

But should rectangles be ""oriented"" (with possibly negative area) or just have non-negative area always? -- Then maybe Rectangle should instead always canonicalize itself to have a diagonal with non-negative components, and the corner as the real top-left.
"
1871508549,5818,crsib,2023-12-28T21:44:59Z,"There is a common terminology in UI toolkits, where Point has some vector-like properties. You can observe similar properties with QPoint and wxPoint. There is absolutely no need to distinguish points and vectors unless the ultimate goal is to teach students about doing dimensions in C++. I don't recall the concept of ""point"" in math though. They are pretty much the synonyms, used interchangeably.

Usually rendering engines call such structures ""vectors"" and UI toolkit ""points"". I think that ""Point"" is used in UI for the last 40 years or so. We can rename it to vector, just to save time on this code review, but I'd rather not. 

I am hard against having both points and vectors. It will create lots of mess in the code for very little and strictly academic (?) reason. We are writing software, not a research paper. It must be fast, readable, and maintainble.

Both vector and points may have component by component division, even if it makes little sense from the mathematical perspective. They are not multiplicative inverses, but from the programming point of view they can be useful. For example , when you need to represent a different scale on different axises. In fact, this operation is implemented in hardware both for CPUs and GPUs.

Defining a rectangle is quite complex topic indeed. That is why there are two different definitions in this library alone. However, the way how rectangle is defined is never about defining the most correct one from the math point of view. It's about convince and performance.

I don't think that we need AABB for the sake of this PR. They were used in code that was further 10x faster than this. That's it, 100x faster than Audacity is now.

However, I think that Point (with vector properties, sorry), Size, and Rect as (Point, Size) could be useful overall. I agree, that there is a better place for them now than lib-graphics. They surely need better unit test coverage. I would love to have adequate Color class too. wxColour is quite heavy and not too useful.

To summarize, I don't like renaming points to vectors, but I don't care much. I will stand hard against adding vectors on top of the points or defining rectangles using diagonals."
1871677505,5818,Paul-Licameli,2023-12-29T02:11:05Z,"The standard library distinguishes time points from durations in chrono.  It does not affect the performance of compiled code but it makes distinctions between variables that allow programming errors to be caught at compile time and increases confidence in correctness of code that does compile.

What I suggest is simply analogous to that.
"
1871692389,5818,Paul-Licameli,2023-12-29T02:58:20Z,Affine space is a different mathematical notion from vector space.  One has points with no distinguished origin.  The other describes displacements in an affine space.  https://en.m.wikipedia.org/wiki/Affine_space
1871885925,5818,crsib,2023-12-29T09:46:47Z,"To be able to describe a point in affine space you need to have a basis. When you have a basis vectors and points are pretty much the synonyms.

I don't see how std::chrono and Points as defined in UI are related. Chrono attaches units to the durations and time_points have implementation defined basis, unknown to the user in principle. Both concerns are critical to chrono. At the same time chrono is very verbose and rarely used in extensive computations.

In graphics, we always have a well defined basis for the screen space. We don't need to attach units to the points (this is not true for typography or for physics, but we are not doing a physics library). The vectors and points are the synonyms in this case. There is absolutely no need to separate between them except making the point (no pun intended). I won't change my opinion. In case the discussion about this topic will take too much time, this PR will be dropped and QPoint (with vector properties!) will be used for the needs of the Qt version of the Audacity.

"
1871893801,5818,Paul-Licameli,2023-12-29T09:58:08Z,"You asked my opinion in review and I gave it.  I would design these classes differently.

Points and vectors may have a common representation but they do not have the same algebra.  A static type distinction between them can catch errors at compile time and also make the signatures of functions more informative.

Just as we distinguish different types of Identifier rather than pass naked strings around, or use enumerations — similarly there are number pairs used for different purposes and I would distinguish them.

A point is a position in a geometric space.  A vector is not, but is a displacement from point to point.  Scaling a vector is meaningful.  Scaling a point is not.
"
1871929568,5818,crsib,2023-12-29T10:27:17Z,"And I have strong reasons to disagree with you.

> they do not have the same algebra

I'm unsure how to read this, but I will stress again: we are not doing academic papers, and we are not implementing an abstract concept.

> Just as we distinguish different types of Identifier 

We don't. There are 2 cases in the code where TaggedIdentifier is used, and URLString is a clearly a bad example of one. It is not used in the code anymore; I have forgotten to remove it. Otherwise, we just use Identifier. It gives no better type-safety over the raw strings. We have exactly one type-safe identifier: NormalizedKeyString. Is it an Identifier at all? I don't know, but that feels a bit wrong.

>  or use enumerations

We rarely use them, preferring Identifiers, which are essentially strings and are not type-safe.

Gosh, we have places where `any` is used. We are constantly dependent on a global state. We have so many places that need attention right now, so why waste time and mental resources on discussing points vs vectors, irrelevant to the use case they are designed for?

> Scaling a point is not.

This statement is wrong when we are talking about GUI of any kind. At least, since the first release of Android :-)

---

I honestly feel that we are in the ""snapping"" PR space again. However, that PR was critical because it was fixing the functionality required for release, which was implemented wrong. This one is not. I have no time, or energy, or will to discuss this topic. "
925471307,1623,Paul-Licameli,2021-09-23T02:58:22Z,"One more push of commits, and some in-line comments and questions, and this completes my review!

Act on my suggestions as you wish, force push once more, and I will make one quick check of what you did and likely approve this and move on!
"
926220674,1623,Paul-Licameli,2021-09-23T22:57:24Z,"I missed the infinite loops with GetNextCodec() and GetNextOutputFormat()!  I see how you corrected them.  Was it testing that discovered it?
"
926659004,1623,Paul-Licameli,2021-09-24T14:13:12Z,"I re-approve the latest force-push!

Only small suggestions:

ExportFFmpeg::InitCodecs should be a private member function, to prove the safety of the new pointer dereference in it just from examining the class in isolation.

The copy and move assignments of AVDictionary now have assertions at the top -- which ought to be stated, at least informally, in the header files of the class as preconditions.

And that's all!

"
926832583,1623,Paul-Licameli,2021-09-24T18:19:04Z,🥳 🎉 ⚡ 🔥 🚀 🍻 
932045372,1623,petersampsonaudacity,2021-10-01T08:52:19Z,Might this also resolve #1794 ?
932083511,1623,JamesCrook,2021-10-01T09:48:08Z,Awesome!
856305704,952,Paul-Licameli,2021-06-07T22:32:44Z,"Summary of my re-review:  besides minor matters, I think the important things are (1) fix the CMake function not to depend on environment and (2) consider whether we might get overreporting of irrelevant information in case of writing FileExceptions.
"
856812665,952,Paul-Licameli,2021-06-08T14:22:33Z,"Fix ""too"" and ""imitate"" in comments, add doc comments for AnonymizedMessage, and it's good to merge.

I see all ""Error_opening_sound_device"" are done.
"
1178479328,3183,Paul-Licameli,2022-07-08T02:44:16Z,"That's enough for this round of review!
"
1182998830,3183,Paul-Licameli,2022-07-13T09:37:47Z,"I am examining the latest force-push.  The commit ""added MakeSettings"" does not build because it uses `GetSettings` which is not defined.  The next commit repairs that.
"
1183011873,3183,Paul-Licameli,2022-07-13T09:50:15Z,Still incomplete in the commit that defines `TransferDataToWindow`: remove `RefreshParameters` from `LoadUserPreset` `DoLoadFactoryPreset` and `ImportPresets`
1183283099,3183,Paul-Licameli,2022-07-13T14:16:21Z,"> Let's try to see it from this angle: what `LoadParameters` has to do, is to read some stuff from the config, set it to a plugin handle (done in the call to `callSetChunkB`) and fetch the settings from the plugin handle. This handle is `mAEffect`, a member of the wrapper. Methods of `VSTEffect` do not operate on `mAEffect` directly, but through methods of `VSTEffectWrapper`. Is this wrong?

Not wrong, but not necessary,  just to hide mention of the member mAEffect inside the function VSTEffect::LoadParameters.

Right, and necessary, to use mAEffect somewhere if a ""chunk"" must be reinterpreted as a settings object.  It's then a scratch handle.

But, I think that if LoadParameters takes the other path that does not use the chunks, then it is not necessary to use a scratch handle, not necessary to define `StoreCommandParameters` or then to use `FetchSettings`.  On that path, a direct conversion can be done from strings stored in the config file into values in the map in EffectSettings.

"
1183309842,3183,Paul-Licameli,2022-07-13T14:39:02Z,"> I interpret your comment like so: in `LoadParameters`, instead of calling `StoreCommandParameters` and then `FetchSettings`, just call `LoadSettings`. Then there would be no need for `StoreCommandParameters` to exist.
> 
> But the thing is: the new `LoadSettings` only translates to settings the `CommandParameters` that it is given, without writing them to the handle. I thought this was the semantics of `LoadSettings` we agreed on - is it not? it should be only a translator, not a translator + a setter.
> 

It should be a translator, but sometimes needs a scratch handle, as with the paht that uses chunks.  But not the rest.

You wrote `StoreCommandParameters` which uses a handle but unnecessarily.  Don't add the function, but just adapt LoadSettings to interpret `parms` and update a map.

> Because I found the existing `LoadSettings` not to conform to these agreed semantics (it was also writing to the handle), I renamed it to `StoreCommandParameters` and wrote a new `LoadSettings` which does the translation only.
> 

There is no need to retain `StoreCommandParameters`.  Change `LoadSettings` to avoid use of a handle and iterate over the config file.  Well you did that already.  But also, do not change the convention previously used to name the keys associated with the values.

> But I could also revert it all, i.e. just have the original `LoadSettings` which translates and sets to the handle, and then I could use it as you suggest. No problem for me, the code would also be simpler. I would only have the concern that the semantics of `LoadSettings` would then vary across effect families.

Maybe what you misunderstand is that `LoadParameters`, which is used by `LoadUserPreset`, is also intended as a translator only.  Side effect on a scratch handle for the interpretation of chunks is unavoidable as part of interpretation.  But on other paths, it is not important to keep whatever side effects used to happen.

"
1184132246,3183,pietro68,2022-07-14T08:07:17Z,"



> I am examining the latest force-push. The commit ""added MakeSettings"" does not build because it uses `GetSettings` which is not defined. The next commit repairs that.

ok, now fixed"
1184514734,3183,pietro68,2022-07-14T14:26:18Z,"> Still incomplete in the commit that defines `TransferDataToWindow`: remove `RefreshParameters` from `LoadUserPreset` `DoLoadFactoryPreset` and `ImportPresets`

right, done"
1184518466,3183,pietro68,2022-07-14T14:29:27Z,"> Maybe what you misunderstand is that `LoadParameters`, which is used by `LoadUserPreset`, is also intended as a translator only. 

I surely misunderstood that! I have now fixed things in this way."
1184547512,3183,pietro68,2022-07-14T14:54:12Z,"Regarding the incompatibility with keys like ""parm_%d"": 
that kind of key is used when for some reason the handle will not be able to return proper parameter names (e.g. ""gain"").
I now fixed this by having this code 

```
wxString name = GetString(effGetParamName, i);
if (name.empty())
{
   name.Printf(wxT(""parm_%d""), i);
}
```
both in ::ForEachParameter and in ::LoadSettings."
1184738785,3183,Paul-Licameli,2022-07-14T17:55:51Z,"Commit 7c469cdd604c3b44a6b8252ce8562da7d9689519 had almost acceptable versions of `SaveSettings` and `LoadSettings` -- except for the problem of preserving the formatting of the keys.  `SaveSettings` from that commit can now be used verbatim, because the change in `ForEachParameter` corrected the keys.
"
1185460836,3183,pietro68,2022-07-15T11:38:58Z,"> Commit [7c469cd](https://github.com/audacity/audacity/commit/7c469cdd604c3b44a6b8252ce8562da7d9689519) had almost acceptable versions of `SaveSettings` and `LoadSettings` -- except for the problem of preserving the formatting of the keys. `SaveSettings` from that commit can now be used verbatim, because the change in `ForEachParameter` corrected the keys.

I modified commit 6.2 in the way I think you specified - basically `SaveSettings` and `LoadSettings` are the same as in the commit you pointed out, belonging to the previous iteration. The switching of the key to the parm_%d in case the handle can not provide alphabetic names for keys is now done exclusively in `ForEachParameter` - I guess this is right?

btw, you said:
> don't do the side effects of `constCallDispatcher` or `callSetParameter`

But in that commit, neither LoadSettings or SaveSettings were calling them? or maybe I am missing something
"
1185478435,3183,Paul-Licameli,2022-07-15T12:04:28Z,"> > Commit [7c469cd](https://github.com/audacity/audacity/commit/7c469cdd604c3b44a6b8252ce8562da7d9689519) had almost acceptable versions of `SaveSettings` and `LoadSettings` -- except for the problem of preserving the formatting of the keys. `SaveSettings` from that commit can now be used verbatim, because the change in `ForEachParameter` corrected the keys.
> 
> I modified commit 6.2 in the way I think you specified - basically `SaveSettings` and `LoadSettings` are the same as in the commit you pointed out, belonging to the previous iteration. The switching of the key to the parm_%d in case the handle can not provide alphabetic names for keys is now done exclusively in `ForEachParameter` - I guess this is right?
> 
> btw, you said:
> 
> > don't do the side effects of `constCallDispatcher` or `callSetParameter`
> 
> But in that commit, neither LoadSettings or SaveSettings were calling them? or maybe I am missing something

True, the previous version did not do that.
"
2110637912,6395,dozzzzer,2024-05-14T16:20:05Z,"@saintmatthieu 

When changing parameters during playback, abrupt volume changes of high amplitude occur:

(Warning: it may get loud)

https://github.com/audacity/audacity/assets/70063970/b324f64f-d924-4954-b0ca-c006d4a86c55

"
2110810298,6395,saintmatthieu,2024-05-14T17:58:03Z,"@petersampsonaudacity was reporting this [here](https://github.com/audacity/audacity/issues/6339#issuecomment-2109972046) for a chirp and with other parameters, too.
I expect this to happen. We do not have any kind of parameter change smoothing in place, so it does so in steps. In this particular case, you are changine the threshold for the limiter, which is like changing the input gain."
2112085388,6395,petersampsonaudacity,2024-05-15T10:00:21Z,"Testing on W11 with @saintmatthieu 's latest branch build:  audacity-win-3.6.0-alpha-20240514+2d767ac-x64

This shows that with both the new effects the **Presets and Settings**  fail to work:
a) the **Factory Presets/Default** fails to restore the default settings,
b) whilst the user can set and recall a user preset, these also fail to apply when invoked.

_This is technically a regression on 3.5.1 behavior with the old, replaced, effects._"
2114334140,6395,saintmatthieu,2024-05-16T07:57:15Z,"> Testing on W11 with @saintmatthieu 's latest branch build: audacity-win-3.6.0-alpha-20240514+2d767ac-x64
> 
> This shows that with both the new effects the **Presets and Settings** fail to work: a) the **Factory Presets/Default** fails to restore the default settings, b) whilst the user can set and recall a user preset, these also fail to apply when invoked.
> 
> _This is technically a regression on 3.5.1 behavior with the old, replaced, effects._

@petersampsonaudacity thanks for your report!
On my side it's also buggy, but less so: changing an effect parameter by applying a preset does not update the slider positions. Everything else works, though.
Could you double-check if this is consistent with your experience?
Fix commit pushed."
2115138409,6395,petersampsonaudacity,2024-05-16T12:37:01Z,"> On my side it's also buggy, but less so: changing an effect parameter by applying a preset does not update the slider positions. 

@saintmatthieu testing on W11 with your two latest branch builds;
audacity-win-3.6.0-alpha-20240516+b7b392b-x64 and 
audacity-win-3.6.0-alpha-20240516+13bcfb5-x64

I confirm that
a) the default slider settings get restored (slider positions)  with the use of the Factory >default
b) the user can set a user preset and when recalled it restores the users slider positions

So looks like this works properly now.

>Everything else works, though.
> Could you double-check if this is consistent with your experience?

I can't really vouch for the actual accuracy in use of compressor or limirter as I have no real experience of using such effects - you might want to approach @SteveDaulton  for that.

-------------------------------------------------------------------------------------------------------------------

One thing I do note is that the dialogs for the new replacement effects are narrower than the ones they replace - the upshot being that the sliders are narrower than previously.

This can be mitigated by expanded the dialog rightwards with click&drag on its right edge 
**_BUT_** I am un-convinced that this will be readily ""discoverable"" by many users.

"
2115555579,6395,SteveDaulton,2024-05-16T15:29:47Z,Am I testing the correct version? I am using Audacity 3.6.0-alpha commit ID: 4e4fdb but the new Limiter does not behave like any other limiter I've ever used.
2115571797,6395,saintmatthieu,2024-05-16T15:35:06Z,That's the correct version. I'm listening :)
2115642737,6395,SteveDaulton,2024-05-16T16:06:59Z,"An ""ideal"" (but impossible) limiter prevents the audio from going above a specified threshold level, without affecting audio below that level (other than optional makeup gain), and without introducing distortion.

Easiest to demonstrate with a generated test tone, though it  also applies to real-world audio.
Here is a 10 second 2kHz sine tone, which fades up to a peak level of 0dB over 5 seconds, then fades back down to silence:


![sine](https://github.com/audacity/audacity/assets/11681097/d2f63df0-c61d-4ee6-95a1-496aba9e3f15)


After limiting to -5dB (chosen to match the  new limiter default), I would expect the waveform to look similar to this:


![hard-limit-5](https://github.com/audacity/audacity/assets/11681097/eadab87f-1027-464a-8d93-a709b94bf967)


Using the new Limiter with default settings, the result looks like this:


![new-limiter](https://github.com/audacity/audacity/assets/11681097/a022efd4-4d5b-42ba-a01e-1ab2d09fe076)


which, after normalizing to 0dB looks like this:



![new-limiter-normalized](https://github.com/audacity/audacity/assets/11681097/69d915b2-0fa9-43c4-97de-5e4cab24bfe2)

"
2115677889,6395,saintmatthieu,2024-05-16T16:23:52Z,"Strange. I get this: 
![image](https://github.com/audacity/audacity/assets/22740106/0ca886c5-56d4-4d9b-ba4c-0ba98ca2ebb2)
That was, like you, with default settings: 
![image](https://github.com/audacity/audacity/assets/22740106/b9e46b4e-6fcb-4231-864c-4925f35e8e54)
That looks correct to me."
2115697355,6395,SteveDaulton,2024-05-16T16:34:03Z,"> Strange. I get this:

That does not look like a sine wave. I'm guessing it is a square wave, but even so I don't get that result.
(I am using the Ubuntu 22.04 AppImage on Ubuntu 22.04)
"
2115698951,6395,LWinterberg,2024-05-16T16:34:48Z,"I cannot reproduce your post-normalization case either. 

The way this thing works is somewhat similar to the Waves L2, the Avid Pro Limiter and various other mastering limiters. The idea of these is that you have a ceiling (which we call ""make-up target"") which already would be a normalized output to whatever you set as your target - assuming material actually hits the threshold. For the case where you don't want any make-up, the target and threshold need to be identical. "
2115770713,6395,SteveDaulton,2024-05-16T16:59:35Z,Also tested the same AppImage in a clean install of Debian in VirtualBox and I get the same result.
2115825329,6395,saintmatthieu,2024-05-16T17:29:26Z,"Right, it was with a square wave. Now with a sine: ![image](https://github.com/audacity/audacity/assets/22740106/70b26313-8e8a-4e2d-9071-21435c9e6308)
@SteveDaulton any way you could try the exact same on another OS ? Looks like we have a problem on Linux."
2116385500,6395,SteveDaulton,2024-05-16T23:45:42Z,"Curiously, on one attempt the effect did change the dynamics, but much more than it should have. I have not been able to repeat this.

When I try now, if I set the Threshold and Make-up Target to the same value, the effect does nothing (effectively a no-op)."
2117046421,6395,saintmatthieu,2024-05-17T08:42:05Z,"Thanks for your early report, @SteveDaulton , @dozzzzer has confirmed [this](https://github.com/audacity/audacity/pull/6395#issuecomment-2115642737). Looking into this."
2117048716,6395,dozzzzer,2024-05-17T08:42:54Z,"(Ubuntu 22.04) I also see a wrong result after applying Limiter with the default parameters to a sine tone with fade in & fade out, although different from @SteveDaulton's one:

![image](https://github.com/audacity/audacity/assets/70063970/57dfb1a8-7aa0-4966-8c01-fdeafb0321c2)
"
2117140450,6395,saintmatthieu,2024-05-17T09:31:09Z,"I was using `abs` instead of `std::abs`, which on Linux takes an `int` argument ...
Fix pushed, please @SteveDaulton @dozzzzer would you give it another shot once the build is ready ?"
2117160364,6395,dozzzzer,2024-05-17T09:42:50Z,"When resizing the window during playback, the graph drawing stops until the LMB is released:

https://github.com/audacity/audacity/assets/70063970/07293dc4-c44f-4af6-a97f-295a72c3a68f

"
2117163304,6395,saintmatthieu,2024-05-17T09:44:36Z,"Yeah, I haven't found how to solve this. I don't get updates when resizing is under way (wxWidgets stuff). At best I could get the straight line to disappear. Then it'd look like when you bypass and un-bypass."
2117285689,6395,saintmatthieu,2024-05-17T10:42:31Z,@dozzzzer actually that was an easy fix. Please re-test when latest build is ready.
2117402022,6395,SteveDaulton,2024-05-17T11:35:21Z,Testing with Commit Id: d40c0e  I am still seeing the same bug.
2117459263,6395,saintmatthieu,2024-05-17T12:11:08Z,I beg your pardon: I messed up force-pushing from different machines. [0d0f371](https://github.com/audacity/audacity/pull/6395/commits/0d0f371275f451122b5e4ac09ddd3699793fe331) is the fix commit.
2117506846,6395,petersampsonaudacity,2024-05-17T12:36:07Z,"Testing on W11 with:  audacity-win-3.6.0-alpha-20240517+d40c0e6-x64

Like @dozzzzer I get a break when the dilaog is resized until the LMB is released.

But unlike @dozzzzer  my break is blank withou the joing line that he has:

![image](https://github.com/audacity/audacity/assets/50205984/8a5454c7-f2db-4aed-a34d-ca5e6b3e525d)
"
2117523667,6395,saintmatthieu,2024-05-17T12:45:30Z,"@petersampsonaudacity yes. The fact that you don't see a line is the improvement brought by 8c2b772cd3aa0e554c9186e2de15a0a6deca1227. I don't think I can possibly get the data updates during resizing, as this seems to block the main thread, where the updates otherwise happen."
2117697169,6395,petersampsonaudacity,2024-05-17T14:10:13Z,"> The fact that you don't see a line is the improvement ...

Yes, I think it's better with the blank rather than the line.

>I don't think I can possibly get the data updates during resizing, as this seems to block the main thread, where the updates otherwise happen.

I'm pretty sure folk can live with that, resizing the dialog is not something most users will be doing a lot of.

"
2117907095,6395,SteveDaulton,2024-05-17T15:57:52Z,"> I beg your pardon: I messed up force-pushing from different machines. [0d0f371](https://github.com/audacity/audacity/pull/6395/commits/0d0f371275f451122b5e4ac09ddd3699793fe331) is the fix commit.

OK, that one works, though it introduces a lot  more distortion than the Nyquist limiter, even with the ""Hard Limit"" algorithm. The distortion is particularly noticeable on the 3rd  harmonic."
2118097592,6395,dozzzzer,2024-05-17T17:37:12Z,"During playback, when moving one of the following: **Threshold**, **Attack** or **Release** in the Compressor effect, it produces abrupt volume changes. The Limiter effect doesn't have such a problem anymore. Check this out:

https://github.com/audacity/audacity/assets/70063970/118973d7-8abc-4e31-aea7-148878d59dcd

I think this is pretty serious, so I'd like this to be fixed within this PR. However, given the circumstances, I'd want to know what you guys think about it and whether we would want to address this in the next patch release @Tantacrul @LWinterberg 

Also, @saintmatthieu I understand this isn't going to be an easy fix, is it?"
2118120038,6395,LWinterberg,2024-05-17T17:52:47Z,Oof. Yeah that's pretty bad.
2118240186,6395,saintmatthieu,2024-05-17T19:22:17Z,"Thanks @dozzzzer, it is a bug you caught indeed.
Note that each time you change the release time, the graph shows the actual attenuation goes back to zero before it converges back towards the target, in a time lapse that I suspect equals your look-ahead (120ms).
The mistake I did was to reset the look-ahead state when any parameter gets changed. Fix was easy and is pushed. I hope it does the job."
2120085600,6395,dozzzzer,2024-05-20T09:46:31Z,"@saintmatthieu I've discovered that the graph isn't being painted as long as the ""Presets & Settings"" menu is opened. And then when the menu is closed, a straight line is painted all over the gap. Could you fix that?

<img width=""450"" alt=""image"" src=""https://github.com/audacity/audacity/assets/70063970/41f8558d-105a-4fff-b591-8ff0491c3738"">
"
2120124390,6395,DavidBailes,2024-05-20T10:08:55Z,"@saintmatthieu . In the compressor dialog, the panel containing the transfer function doesn't need to be in the tab order.
cf Autoduck effect, where in Autoduck.h, the class definition for the panel it uses includes the following lines:
```
bool AcceptsFocus() const override { return false; }
// So that wxPanel is not included in Tab traversal - see wxWidgets bug 15581
bool AcceptsFocusFromKeyboard() const override { return false; }
```"
2122084950,6395,saintmatthieu,2024-05-21T08:39:54Z,"> @saintmatthieu I've discovered that the graph isn't being painted as long as the ""Presets & Settings"" menu is opened. And then when the menu is closed, a straight line is painted all over the gap. Could you fix that?
> 
> <img alt=""image"" width=""450"" src=""https://private-user-images.githubusercontent.com/70063970/332019447-41f8558d-105a-4fff-b591-8ff0491c3738.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTYyODA0NDQsIm5iZiI6MTcxNjI4MDE0NCwicGF0aCI6Ii83MDA2Mzk3MC8zMzIwMTk0NDctNDFmODU1OGQtMTA1YS00ZmZmLWI1OTEtOGZmMDQ5MWMzNzM4LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA1MjElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNTIxVDA4MjkwNFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWE1ZTk1MmYxZjE4Y2U3ZjY4ODFlNmE5ZTMzMjExM2I4NWIxYTQyNWNhZjBjNTRjY2VkNTg2YTFlYjhhODNmMDMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.LxL9b2otUrrR-dMDzA280HaMKvh_7sbKzL_X0Uy5E7s"">

@dozzzzer thanks. It appears that it's not only when opening that particular menu, but any menu. Also, it doesn't occur on Mac.
Looking into this ..."
2122272667,6395,saintmatthieu,2024-05-21T10:12:55Z,"@dozzzzer just pushed a few commits that alleviate but don't eliminate the problem. What you should now see when closing the menu is a gap, like you do after resizing the graph.
It seems to me that the main thread gets blocked rather easily on Windows. Opening a menu, moving the window, resizing it ... and the data transfer from audio to main thread relies on the main thread being fast, or there is data loss. This explains why the graph isn't deterministic. Maybe there is a more reliable way of transmitting the data, I will have to look into this, but not in this PR anymore."
2122286350,6395,saintmatthieu,2024-05-21T10:19:18Z,"> @saintmatthieu . In the compressor dialog, the panel containing the transfer function doesn't need to be in the tab order. cf Autoduck effect, where in Autoduck.h, the class definition for the panel it uses includes the following lines:
> 
> ```
> bool AcceptsFocus() const override { return false; }
> // So that wxPanel is not included in Tab traversal - see wxWidgets bug 15581
> bool AcceptsFocusFromKeyboard() const override { return false; }
> ```

@DavidBailes beautiful, thank you!"
2133701522,6395,petersampsonaudacity,2024-05-27T15:30:20Z,"Testing on W10 with @saintmatthieu 's latest master alpha build for 3.6.0:   audacity-win-3.6.0-alpha-20240527+5f8ee46-x64-msvc2022

The graph now looks continuous:
a) when the ""Presets and Settings"" menu is opened
b) when parameter sliders are moved and the LMB is later released"
1159991935,3088,ruro,2022-06-20T05:32:38Z,"@LWinterberg @crsib is there anything left on my side, that is blocking this PR or are we just waiting for someone to review this?"
1160044428,3088,LWinterberg,2022-06-20T06:52:05Z,"I think the main blocker for this was the weekend :) 

The review is already inside our kanban board, so crsib will look at it soon "
1160455295,3088,ruro,2022-06-20T13:32:46Z,"@crsib PTAL. I've implemented the 4 XDG Base Directories. Currently, all 4 directories default back to `~/.audacity-data` if it already exists and to `GetUserDataDir` on Windows. (for backwards compatibility)

Also, I completely removed the `FileLayout_XDG` logic since it would only affect `Config` and we would still need to implement the XDG logic manually for `Cache`, `Data` and `State`, at which point there is no reason to use `GetUserConfigDir` only for `Config`.

For now, `Cache` and `State` aren't used anywhere. If you have any suggestions regarding which other old `DataDir()` calls should be replaced with `Cache`, `Config` or `State`, feel free to point them out. I am not too familiar with the various audacity `xml` files, so I don't know, which of them should go to `Config` or `Data` or `State` etc."
1160462868,3088,ruro,2022-06-20T13:39:29Z,"Here are some files/directories that currently still use `DataDir()`:
- lastlog.txt
- genres.txt
- journal.txt
- journallog.txt
- EQCurves.xml
- EQDefaultCurves.xml
- EQBackup.xml
- ffmpeg_presets.xml
- Chains
- Macros
- NRP
- Plug-Ins
- Theme

I might have missed some."
1160482524,3088,ruro,2022-06-20T13:57:45Z,"Oops. I don't have a Windows/Mac machine, so I missed a typo. @crsib sorry, can you approve the CI/CD again."
1160513869,3088,crsib,2022-06-20T14:25:34Z,"Hmm, usually only one approval is needed. Anyway, the job is running now"
1160557296,3088,imciner2,2022-06-20T15:02:26Z,"Instead of having to do all the path manipulation and environment variable checks manually, I think it would be better to just use the GLib functions to retrieve the appropriate directories:
* `XDG_STATE_HOME` -> `get_user_state_dir()`
* `XDG_CONFIG_HOME` -> `get_user_config_dir()`
* `XDG_CACHE_HOME` -> `get_user_cache_dir()`
* `XDG_DATA_HOME` -> `get_user_data_dir()`

These will then handle testing the environment variable for existence and forming the default path if it doesn't exist.

Also, having it keep using the old directory if it exists doesn't seem very user-friendly to me. If it does that, then documentation becomes more complicated because it has to deal with 2 possible directories, and downstream bug reports could become more complex with having to explain this. It would be better in my opinion to just do a single transition to the new directory and remove the old one."
1160589952,3088,ruro,2022-06-20T15:31:17Z,"@imciner2 
> It would be better in my opinion to just do a single transition to the new directory and remove the old one.

Can you clarify, what do you mean by ""transition""? Do you suggest, that we

1) detect, if `~/.audacity-data` exists, and automatically move the files to their new locations

or

2) just ignore `~/.audacity-data` and the user must manually migrate it after updating Audacity

Option (1) would be very hard to get right, because the single `~/.audacity-data` directory must be split between the 4 XDG directories. Also, this is a (potentially) destructive and non-reversible operation (if something goes wrong, the user can't just downgrade their audacity version to get back to a working condition).

P.S. Sure, using GLib sounds reasonable, I'll try refactoring it to use GLib in a bit. Btw, these functions return `gchar`. It seems to be just a typedef of `char`, but do you know, if we can rely on that being true for all platforms/versions?"
1160725924,3088,ruro,2022-06-20T18:14:28Z,"@imciner2 I've refactored the code to use `glib` and `get_user_*_dir()`, but it seems that `glib` is normally not used for building `libraries/` so I had to manually add `glib` to `libraries/lib-files/CMakeLists.txt`. I am not sure, if I did that right (I just copy-pasted that line from `src/CMakeLists.txt`)."
1161456037,3088,crsib,2022-06-21T08:51:30Z,"Linux build has failed as well!

"
1161488617,3088,ruro,2022-06-21T09:21:19Z,"> Linux build has failed as well!

Yeah. It seems that CI uses an older GLib version, that doesn't have `g_get_user_state_dir`. It seems to be only available since 2.71.1. What do you think we should do:

1) Update required GLib version
2) Remove `FileNames::StateDir` and `State` from `DirTarget`
3) Don't use GLib at all and revert to manually checking the environment variables"
1161494177,3088,crsib,2022-06-21T09:26:18Z,"We will not upgrade GLib version on CI any time soon, as it will break AppImage for users on older GNU/Linux versions.

Otherwise it's your call"
1161500506,3088,ruro,2022-06-21T09:31:49Z,"@imciner2 requested to use GLib
@crsib requested to add `State`

Please decide, which request should be reverted. :sweat_smile:
I would generally prefer to just remove the GLib dependency and revert to manual env lookup, but this is a weak preference."
1161509243,3088,crsib,2022-06-21T09:39:33Z,">I would generally prefer to just remove the GLib dependency and revert to manual env lookup,

Me too, to be fair. "
1161524684,3088,imciner2,2022-06-21T09:53:41Z,"If you really want to use the state directory, then more work would be needed probably. The XDG state directory was only added to the spec last year, so there may be issues with the base directories not existing on older systems, so you need to ensure the entire directory path exists, not just the Audacity subdirectory.

> We will not upgrade GLib version on CI any time soon, as it will break AppImage for users on older GNU/Linux versions.

Doesn't appimage bundle its dependencies into the image?"
1161530471,3088,ruro,2022-06-21T09:59:18Z,"> ... there may be issues with the base directories not existing on older systems, so you need to ensure the entire directory path exists, not just the Audacity subdirectory. ...

Currently, the code calls `FileNames::MkDir` that uses `wxFileName::Mkdir` with `wxPATH_MKDIR_FULL`
```
If the flags contain wxPATH_MKDIR_FULL flag, try to create each directory in the path and also don't return an error if the target directory already exists.
```

So that shouldn't be an issue."
1164031430,3088,ruro,2022-06-23T07:03:30Z,"So, @crsib @imciner2 what's the conclusion here? Is there anything else I can do to get this PR accepted?"
1164130962,3088,crsib,2022-06-23T08:47:35Z,I'll do a hopefully final round today
1164416336,3088,ruro,2022-06-23T13:34:37Z,"@crsib can you approve the CI again, please."
1165624833,3088,crsib,2022-06-24T14:21:23Z,@LWinterberg can you please add RuRo to the AboutDialog?
1900617422,5874,saintmatthieu,2024-01-19T15:22:58Z,"Sorry for the single large commit. There was a lot of trials before I came to that solution, and with the many API changes I'd have to rewrite integration with the older interfaces to break this down."
1908155495,5874,saintmatthieu,2024-01-24T13:46:17Z,Rebased after merging speed improvement PR.
1919196982,5874,saintmatthieu,2024-01-31T14:18:47Z,"@vsverchinsky addressed the most critical of your comments, you may do another review iteration."
1927050487,5874,dozzzzer,2024-02-05T13:47:14Z,"@saintmatthieu 

When importing multiple loops at once, I'm getting wrong results basically in two different ways: 

1. In some cases (when importing [these three](https://drive.google.com/drive/folders/1GyNRPVB8EqiJH_ByffmjFpck6XXy9tA3?usp=drive_link), for example), one of the loops is stretched by the wrong amount. However, when importing this exact loop all by itself, it gets auto-stretched correctly, following the project's tempo.
2. In some other cases (e.g. when importing [these three loops](https://drive.google.com/drive/folders/1K9VPWYCR_AS-jKx7HhamQv0iEOE9cQtL?usp=drive_link)), it not only detects the tempo incorrectly but also fails to stretch the remaining parts to match that tempo."
1927201760,5874,saintmatthieu,2024-02-05T15:01:39Z,"@dozzzzer I don't know how much of the problems you've found this covered, but at least some of it: there already is a bug on master.
1. Import 100_VintageDrums_03_TL.wavv, it gets correctly auto-detected.
2. Import JBK_170_Brk_Full_Drums_Stig_V1.wav, this one too.
3. Import again 100_VintageDrums_03_TL.wav: it gets detected as 170.

If the  2nd file hadn't metadata, there wouldn't be a problem. It's my fault, I have to fix this, but it should provide a separate fix.
Would you mind re-testing these two problems with files that have no metadata, just their BPM in the title? To be 100% sure that they don't have metadata, you may re-export your loops from Audacity."
1927224675,5874,saintmatthieu,2024-02-05T15:12:46Z,Dedicated ticket for that issue: https://github.com/audacity/audacity/issues/5914
1928701816,5874,Paul-Licameli,2024-02-06T03:07:48Z,"I haven't followed this discussion, but I'm reminded of your attempts to use `std::for_each` with an execution policy.  Did you make that work, at least for Windows, and did it really save time?
"
1928917199,5874,saintmatthieu,2024-02-06T07:20:14Z,"No I haven't. Behaviour of the progress bar was strange, and I haven't looked further into that."
1102656440,2831,Paul-Licameli,2022-04-19T13:28:26Z,"> > Polarity
> 
> > rename the `Invert` effect to `Invert Polarity`, please.
> 
> As Paul wrote: ""why?"". What other kinds of waveform inversion are there? Yes there is such a thing as ""spectral inversion"" (which Audacity does not have), but if that's the distinction that you want to make then I don't think that ""invert polarity"" does it as well as ""invert waveform"".
> 
> Regardless of which wording is decided, please avoid changing the command name unless absolutely necessary as doing so will break custom macros that use the command. As Paul wrote: ""Only the localized name of the effect"" should be changed.

Steve agrees with me about not breaking macros, so changing localized names independently from internal names.

I reviewed how Nyquist parses names, and it does not make this similarly easy to do -- to update a localized name while not changing the identifier that macros might be using.

I intend to change Nyquist.cpp and I can push that commit onto Vitaly's branch.  Then the .ny files can update certain localized Nyquist effect names as Leo prefers them, but without the compatibility problem.

Meanwhile, exploring the source for Steve Harris' Ladspa plug-ins, I found this bit about the terminology of its simple inversion effect:

```
    <name>Inverter</name>
    <p>A utility plugin that inverts the signal, also (wrongly) known as a 180 degree phase shift.</p>

```
"
1102666167,2831,Paul-Licameli,2022-04-19T13:36:18Z,"Vitaly and I are disagreeing about the proposed implementation.  In this first attempt, the tree that Leo specified is essentially replicated in one place in the source code.

I don't find that acceptable.  Instead, I say category information should be associated with each individual effect in the code that defines that effect.

The code that builds the effect menu should iterate all effects and gather their category information in a generalized way according to some new extension of the effect interface, then sort them without special hardcoded information about any one effect.

I have pointed out that certainly in the case of Nyquist effects, some other Nyquist programmer wanting to extend Audacity should have means to specify in the .ny file how to categorize that effect, without rebuilding Audacity.  I say build into Audacity now the code that interprets a new kind of special Nyquist comment, then use that comment in .ny files.
"
1102717441,2831,Paul-Licameli,2022-04-19T14:21:20Z,"I think extra effort is needed for open-endedness.  If you really do want to go beyond my incomplete suggestion, I would encourage it.  The value returned by the new virtual function of Effect would not be of an enumeration type.  It would be a ComponentInterfaceSymbol pairing an Identifier and a TranslatableString.  Effect.h could have extern declaration of some ComponentInterfaceSymbol constants commonly used, including the ones specified in the issue.

But PluginMenus.cpp would not require the returned values to be from this limited set of choices.

What I described would not provide a way to order the categories extrinsically.  But if @LWinterberg agrees that a rule like major sort by the localization of the category name is acceptable, then that's enough.

"
1149685124,2831,Paul-Licameli,2022-06-08T09:31:24Z,"I'm done with this round of review.  There are some things to fix but the basic design is good.
"
1151013946,2831,vsverchinsky,2022-06-09T11:38:44Z,"@petersampsonaudacity In the recent PR update I've also attemted to fix the issue metioned in the discrord channel about bundled effects being grouped by publisher, as well as other issues metioned by @Paul-Licameli in this thread earlier "
1151061722,2831,petersampsonaudacity,2022-06-09T12:31:40Z,"> @petersampsonaudacity In the recent PR update I've also attemted to fix the issue metioned in the discrord channel about bundled effects being grouped by publisher,

@vsverchinsky  testing on W10 with you latest branch audacity-win-3.2.0-alpha-20220609+fa94517-x64

a) If I purge the audacity settings folder (for OOTB factory settings - new install)  then I no longer see ""Steve Daulton"" menu entries.

b) If I upgrade to your latest branch from 3.1.3 or latest 3.2.0 master then I **_do_** see the ""Steve Daulton"" entries in the Analyze and Tools menus.

c) if after b) I do a Reset Configuration then I _**still**_ see the ""Steve Daulton"" entries in the Analyze and Tools menus.

Given that **many** of the installers/users of 3.2.0 will be upgraders, it is probably important to fix b)"
1152105091,2831,petersampsonaudacity,2022-06-10T08:21:30Z,"Testing on W10 with @vsverchinsky 's latest branch build audacity-win-3.2.0-alpha-20220609+831286a-x64

### 1) Analyze Menu
Following an upgrade from 3.1.3 to this branch build there is no longer a ""Steve Daulton"" menu entry in the Analyze menu - but note that the two Steve Daulton plug-ins are duplicated in the Analyze menu:
![image](https://user-images.githubusercontent.com/50205984/173022515-ec307ddd-dd5a-4bf5-8b97-46c6b1186bfd.png)

### 2) Tools menu
Following an upgrade from 3.1.3 to this branch build the Tools menu still has a ""Steve Daulton"" menu entry - and here too the sub-menu items are duplicated:
![image](https://user-images.githubusercontent.com/50205984/173023263-86d98a1c-a504-411d-8a5a-2c18b840fefa.png)

"
1152108779,2831,petersampsonaudacity,2022-06-10T08:25:35Z,"> I suggest @petersampsonaudacity should open another issue for what he observed in the case that multiple versions of Audacity are installed.

@Paul-Licameli  -  I could do that but at the moment this is only a developer branch build it is not in master yet.   Normally we only log bugs that are in the master builds.  

But if you really want I can break with _""tradition""_ and log this issue against @vsverchinsky 's branch build, please advise.


_BTW this may be an issue if multiple versions of Audacity are installed - but primarily it's an issue for anyone with a single version of Audacity upgrading from an earlier Audacity version to 3.2.0_"
1152717224,2831,vsverchinsky,2022-06-10T20:31:04Z,">primarily it's an issue for anyone with a single version of Audacity upgrading from an earlier Audacity version to 3.2.0

@petersampsonaudacity it happens even if there is only a single instance of Audacity installed at the same location as the older version?"
1152902698,2831,petersampsonaudacity,2022-06-11T11:24:29Z,"> > primarily it's an issue for anyone with a single version of Audacity upgrading from an earlier Audacity version to 3.2.0
> 
> @petersampsonaudacity it happens even if there is only a single instance of Audacity installed at the same location as the older version?

@vsverchinsky  - so I tested on my wife's PC simulating an upgrade from 3.1.3 to your 3.2.0 branch and all looks good when I do that. For the ""normal"" upgrading user with a single Audacity version all seems fine.

1. The existing and only version of Audacity on that PC was 3/1/3 installed in the default location C:\Program Files\Audacity
2. I upgraded to 3.1.3 - using the EXE
3. then installed your branch build (ZIP not EXE) 
4. Observe: the EGAT menus:

### Effect menu
![image](https://user-images.githubusercontent.com/50205984/173186226-08314b4d-3655-4594-a877-6088497df2a1.png)

### Analyze menu
![image](https://user-images.githubusercontent.com/50205984/173185771-82de39ee-928b-4ad5-8b5f-0af2a01a6c0a.png)

### Generate menu
![image](https://user-images.githubusercontent.com/50205984/173185802-94595251-fecc-4425-ab02-d32333a69d52.png)

### Tools Menu
![image](https://user-images.githubusercontent.com/50205984/173185826-40e90cb1-5595-4d77-a6d6-63ec0ee1d86f.png)


So no sign of ""Steve Daulton"" menu entries and no duplicate entries.

### Reversion
I also simulated a user who upgrades to 3.2.0, doesn't like it for whatever reason, and downgrades back to 3.1.3 (or earlier).  All is fine with the older menu structure for the EGATs
"
1152912171,2831,Paul-Licameli,2022-06-11T12:05:42Z,"Peter removed our last doubts.  I merged the branch, although I broke my usual rule that branches should be rebased first onto latest master.  Vitaly is taking time off for two weeks and I didn't want this to wait."
1710432398,5139,saintmatthieu,2023-09-07T16:13:27Z,"> Reversion of my changes to AudioSegmentSampleView is questionable

I missed that commit on 2-of-6.
I looked at it again, but couldn't figure out the reason behind it ?
For the spectrum analyzer it seems simpler to me to be returned a `sampleCount` and then check whether this exceeded the maximum allowed number of samples."
1710542180,5139,Paul-Licameli,2023-09-07T17:37:43Z,"> > Reversion of my changes to AudioSegmentSampleView is questionable
> 
> I missed that commit on 2-of-6. I looked at it again, but couldn't figure out the reason behind it ? For the spectrum analyzer it seems simpler to me to be returned a `sampleCount` and then check whether this exceeded the maximum allowed number of samples.

I wrote a longer comment but the GitHub page ate it"
1710545259,5139,Paul-Licameli,2023-09-07T17:40:29Z,"That's really annoying.  I wrote a careful long line comment and chose ""Request Changes"" from the top right but it lost my long comment.
"
1710557316,5139,Paul-Licameli,2023-09-07T17:50:56Z,"> > Reversion of my changes to AudioSegmentSampleView is questionable
> 
> I missed that commit on 2-of-6. I looked at it again, but couldn't figure out the reason behind it ? For the spectrum analyzer it seems simpler to me to be returned a `sampleCount` and then check whether this exceeded the maximum allowed number of samples.

Who said things should be as simple as possible, but not simpler?

This is a case of ""not simpler.""
"
1710896715,5139,Paul-Licameli,2023-09-07T23:50:04Z,"Here is a test case:  Make neighboring clips of equal duration.  Generate a tone in one and a tone of another frequency and the same amplitude in the other.  No stretches yet.  Select all and plot spectrum.  See two peaks equally high.  (Not two spikes, because of the realities of spectral leakage, unless you use rectangular windows and choose frequencies as exact multiples of the inverse of the sample window duration.  You might also like to choose linear, not log frequency scale.) …"
1710900560,5139,Paul-Licameli,2023-09-07T23:56:34Z,"… if that is the control, the experimental would be two clips that sound the same as the control as played, but have unequal stretches.  For instance make the first clip half as long as in the control but stretch it to 2x duration, with the second clip as before.

Then plot spectrum.  What would you see?

I think you should see nearly the same plot, but I predict you will see unequal heights.  A clip stretched more will be under-weighted and another stretched less or compressed, over-."
1710902686,5139,Paul-Licameli,2023-09-08T00:00:32Z,"So maybe this bug fix allows some data to be plotted instead of nothing, but it’s bogus.  What should be done?

- ignore this as an unlikely use case?
- Detect clip stretch mismatch and display an error rather than bogus data?
- Do the hard work of more proper weighting of values?

If the last, maybe the way to do it is make a spectrum analyst for each clip separately, then write something that makes the correct weighted sums of several analyst results as one analyst object to be used later in plotting.
"
1710919949,5139,Paul-Licameli,2023-09-08T00:28:13Z,"Yet another possibility:  downgrade the priority of this bug, if in fact, present master doesn’t freeze but only fails to plot anything.  Then kick the can down to a later release.

Or just detect failure of `GetFloats` and give the user an error dialog explaining the problem, instead of the quiet failure to show any data, or showing bogus data."
1711251202,5139,dozzzzer,2023-09-08T08:04:25Z,">  downgrade the priority of this bug

I believe P4 is already a pretty fair priority for it, but I definitely agree that it can be kicked down to the later release"
1711313926,5139,saintmatthieu,2023-09-08T08:52:16Z,"> … if that is the control, the experimental would be two clips that sound the same as the control as played, but have unequal stretches. For instance make the first clip half as long as in the control but stretch it to 2x duration, with the second clip as before.
> 
> Then plot spectrum. What would you see?
> 
> I think you should see nearly the same plot, but I predict you will see unequal heights. A clip stretched more will be under-weighted and another stretched less or compressed, over-.

Yes, in that case, the result would be obviously unexpected."
1711317303,5139,saintmatthieu,2023-09-08T08:54:50Z,"Now I read all your comments till the last.

I say we merge this. It's imperfect, but at least it will work if you change project tempo and analyse over several clips. Then let's see if complains come our way."
1711326388,5139,Paul-Licameli,2023-09-08T08:59:45Z,"> Now I read all your comments till the last.
> 
> I say we merge this. It's imperfect, but at least it will work if you change project tempo and analyse over several clips. Then let's see if complains come our way.

I do not approve this for merge.
"
1711338150,5139,Paul-Licameli,2023-09-08T09:08:24Z,"This bug has low priority.  It is not a crash or freeze bug.

Rebasing 4th of 6 into the effect changes or refactoring tasks are far more important.
"
1711352248,5139,saintmatthieu,2023-09-08T09:18:52Z,I regret that. The work is now done and it does bring an improvement. Splitting hairs was more time consuming - although leading to interesting discussions.
1711388259,5139,Paul-Licameli,2023-09-08T09:45:43Z,"> I regret that. The work is now done and it does bring an improvement. Splitting hairs was more time consuming - although leading to interesting discussions.

Reasoning about the correctness of the changes you propose is my duty.  I did it.  I'm not satisfied.
"
1712473388,5139,petersampsonaudacity,2023-09-09T10:00:54Z,"Testing on W10 with @saintmatthieu 's branch build for this:  audacity-win-3.4.0-alpha-20230908+519eafe-x64

When I now try to run Plot Spectrum on a stretched clip I get this error message.
![image](https://github.com/audacity/audacity/assets/50205984/18720a47-7305-4bc4-bd5f-192ff8277689)

I find that message very opaque and unhelpful to the user.  Now I figured out that if I rendered the stretched track then I would be able to plot the spectrum - but that's _**only**_ as a result of the discussions I had with Matthieu on Thursday.  

Maybe the error message could suggest that the user renders the track and then retries.
"
1717304106,5139,saintmatthieu,2023-09-13T09:46:54Z,Note that this PR would benefit from the [Move a function to new file WaveTrackUtilities](https://github.com/audacity/audacity/pull/5138/commits/b066650f6effa6fedd195564f32417fccdb72191) commit in #5138 : then we'd know for sure whether it's because of stretched data or not.
1719145924,5139,dozzzzer,2023-09-14T09:58:23Z,"Tested. On macOS, after a proper error message is displayed, a blank **Frequency Analysis** dialog is displayed that cannot be dismissed:

<img width=450 src=https://github.com/audacity/audacity/assets/70063970/9d475ea8-5142-4c0e-9653-80a4bfa17713>
"
1723427681,5139,chinakov,2023-09-18T13:37:06Z,Tested
1825727707,5570,saintmatthieu,2023-11-24T14:08:32Z,"Of course, I'll do a proper squash before merging. Thank you!"
1828353489,5570,dozzzzer,2023-11-27T18:03:40Z,"#### 1) When importing a loop after another loop with a different tempo, stretching is applied

1. In a clean project, import a loop of 136 bpm
2. Click ""Yes"" in the appeared dialog
3. Observe: the project tempo is set to 136 bpm
4. Close the Track
5. Import a loop of 89 bpm
6. Click ""Yes"" in the appeared dialog
7. Observe: the project tempo is set to 89 bpm (which is correct), but the 50% stretching is applied to the clip

#### 2) When auto-stretching an imported loop, the algorithm doesn't seem to take into account its stretch ratio 

1. Set the project tempo to 90 bpm
2. Import a [4-bar loop of 128 bpm](https://www.dropbox.com/scl/fi/gksbt344qv8a5bkch6xc1/DK_Break_128_PL.wav?rlkey=1w0gj7ski886piotia8pgx28p&dl=0)
3. Click ""No"" in the Music Import dialog
4. Observe: the loop's speed is 70% (70.3125% to be precise)
5. With snapping enabled, shrink the loop to fit exactly 2 bars
6. Observe: the loop's speed is now 140.625%
7. Compare stretch ratios – 1.422 vs 1.406

Thus, it was supposed to go with the lesser one – 1.406 – which in this particular case would mean it should've **shrunk** the clip to 2 bars @ 90 bpm, not expanded it up to 4 bars @ 90 bpm.

#### 3) Undo resets the stretch ratio when Undo-ing

1. Set the project tempo to 120 bpm
2. Import a clip of 90 bpm
3. In the Music Import dialog, click No
4. Observe: the clip is shrunk (133% speed)
5. By holding Alt (Option), drag the edge of the clip and release to shrink or stretch the clip even more
6. Ctrl (Cmd) + Z

Actual result: back to 100% speed
Exp. result: 133% speed

#### 4) When importing a clip and auto-stretching it, the imported clip retains its original length and speed until you hover the mouse over the clip's title bar

1. Import a clip that has a tempo different from the project's one
2. Click No in the Music Import dialog in order to perform auto-stretching
3. Observe: no speed value at the top right corner of the clip's title bar
4. Hover over the clip's title bar
5. Observe: now the speed value pops up and the clip shrinks (expands) instantaneously


https://github.com/audacity/audacity/assets/70063970/f704a66a-f52d-47f6-a6a2-92251dc5d002

@saintmatthieu 


"
1831475562,5570,saintmatthieu,2023-11-29T08:55:02Z,"@dozzzzer the problems you reported should be fixed now.
I also simplified the regex and made it more conservative, too. Essentially, ""BPM"" (case-insensitive) must be found after the BPM value (will add something to the QA list). If this is not the case, I'm working on a DSP-based plan B anyway, which would give a second chance for these files to be tempo-detected.

Thanks, those were all good catches."
1831904650,5570,dozzzzer,2023-11-29T13:32:37Z,"@saintmatthieu **Music Import** preference isn't working now in the updated branch.
Regardless of the selected option in the Music Imports section, a musical file is imported as a regular audio file."
1831927208,5570,saintmatthieu,2023-11-29T13:46:27Z,"> @saintmatthieu **Music Import** preference isn't working now in the updated branch. Regardless of the selected option in the Music Imports section, a musical file is imported as a regular audio file.

@dozzzzer I just tried it again, and it works for me. Could it be because the file you import doesn't have ""BPM"" in its title? https://github.com/audacity/audacity/pull/5570#issuecomment-1831475562"
1833350761,5570,saintmatthieu,2023-11-30T08:59:16Z,"@LWinterberg just realizing that I've only been doing tempo detection when only one file is imported at a time.
I'd keep the multiple-file import in a follow-up ticket, because the desired behaviour isn't so simple.
If the user has set her preference to either auto-configure or do-nothing, then I suppose the behaviour would be almost as it is now, i.e., either do nothing or switch to B&M and auto-stretch, not touching the project tempo.
If the preference is on ask-me-each-time, though, the dialog might need be changed. Also, the preference's wording might need be generalized."
1833366100,5570,saintmatthieu,2023-11-30T09:09:59Z,Follow-up ticket regarding multiple-file import: https://github.com/audacity/audacity/issues/5726
1838986898,5570,dozzzzer,2023-12-04T16:18:46Z,"@saintmatthieu 
- in Beats and Measures mode, when selecting ""No"" in the Music Import dialog, the imported clip gets auto-stretched. Ctrl-Z should then undo the import, rather than undoing the auto-stretching of the clip:

https://github.com/audacity/audacity/assets/70063970/a77bd0f9-8cb7-4e17-b00d-426d5176822b

- in Minutes and Seconds mode, when selecting ""No"" in the Music Import dialog, the imported clip isn't auto-stretched. Ctrl-Z should then undo the import right off. Currently, the first attempt to Ctrl-Z doesn't do anything (the menu entry is ""undo Automatic Music Configuration""), and only the second one undoes the import:


https://github.com/audacity/audacity/assets/70063970/1c3c6a4c-8ce5-4edc-993c-9338d78eafe4

> The prompt can be tab-traversed

This doesn't work on macOS. Cmd + Fn + F6 should enter tabulation mode, but it doesn't.



"
1840307532,5570,saintmatthieu,2023-12-05T09:02:55Z,"@dozzzzer Just pushed a fix for both bullet points 1 and 2. As discussed and clarified, the tab-traversing item is actually only relevant to Windows ; I wasn't aware such functionality wasn't available on Mac.
Cheers!"
1840546250,5570,dozzzzer,2023-12-05T11:17:08Z,Tested
1867479241,5570,saintmatthieu,2023-12-22T09:55:07Z,@Paul-Licameli I'm addressing your comments on #5791.
1978874461,6094,Paul-Licameli,2024-03-05T14:16:29Z,"Rebased unchanged onto updated dependency
"
1980980352,6094,Paul-Licameli,2024-03-06T14:21:34Z,"Rebased unchanged onto updated dependency
"
1981029250,6094,saintmatthieu,2024-03-06T14:45:01Z,Is destination master already ?
1981083237,6094,Paul-Licameli,2024-03-06T15:09:09Z,"I corrected the base branch
"
1981323169,6094,Paul-Licameli,2024-03-06T16:47:30Z,"The known crash bisects to 3fa777844e0bdee147d5d6f8a8b7dfff109eef85

I hoped I could remove those complications, and I verified that generating stereo pluck words.  But mono pluck crashes, as does tone or noise either mono or stereo.
"
1981658454,6094,Paul-Licameli,2024-03-06T19:43:17Z,"Please re-commence review of the commit sequence from the beginning and dismiss your first review if satisfied that there are no crashes.

But it’s not done yet.  Expect more steps in this transformation.

Yet I think that at last, this will be the last PR of this big fix of the foundations.
"
1983152161,6094,saintmatthieu,2024-03-07T09:59:23Z,"Reviewed up to ""WaveChannel no longer contains WaveClipHolders..."" inclusively."
1983893089,6094,Paul-Licameli,2024-03-07T16:20:57Z,"Rebased onto updated base branch.

Some minor changes removing extraneous semicolons and improving commit comments.

The commit adding SwapChannels and MakeNarrow was removed.

One commit adding some assertions was added.
"
1987286133,6094,Paul-Licameli,2024-03-10T16:28:03Z,"Apologies for all the force-pushes.  Please review at least from ""The width of a WideChannelGroupInterval is not immutable"" onward.
"
1988910087,6094,Paul-Licameli,2024-03-11T16:41:45Z,"Sorry, more commits to review.  I decided there is something still unsatisfactory in Transactions.  It's not strictly part of the clip restructuring but it's not correctly exception-safe.  Also @vsverchinsky's debugging of import performance calls to our attention, the need to avoid unnecessary transactions.
"
1989013561,6094,Paul-Licameli,2024-03-11T17:21:57Z,"> I haven't commented on this in the wide-wave-track PR, but is there something that justifies `WaveChannel` inheriting `WideSampleSequence` conceptually?

Let's leave that alone.

At least one place where compilation will fail is where `WideSampleSource` is constructed in `PerTrackEffect.cpp`.

`WideSampleSource` lives in `lib-mixer` which doesn't know `lib-wave-track` but uses the `WideSampleSequence` abstraction.
"
1989037200,6094,Paul-Licameli,2024-03-11T17:33:42Z,"I found this in your `StretchingSequenceIntegrationTest.cpp`

```
   const auto numChannels =
      GENERATE(1 /*, 2*/); // When wide WaveTrack is implemented this test
                           // should also run in stereo.
```

You can decide what to do about it later
"
1991546851,6094,Paul-Licameli,2024-03-12T12:32:21Z,"I have fixed the infinite recursion.
"
1991606728,6094,Paul-Licameli,2024-03-12T13:04:21Z,"Force pushed onto updated base branch
"
1992243484,6094,Paul-Licameli,2024-03-12T17:56:40Z,"force-push with some squashing
"
1205109984,3229,Paul-Licameli,2022-08-04T11:09:03Z,Will you soon fix build failures?
1225587075,3229,Paul-Licameli,2022-08-24T11:24:05Z,"I'm done!
"
1227393112,3229,Paul-Licameli,2022-08-25T15:11:07Z,"I see you have force-pushed some changes, but this is not yet rebased onto recent master, and I understand there will be conflicts to resolve.
"
1952546660,5980,petersampsonaudacity,2024-02-19T14:18:36Z,"@vsverchinsky 

You have a small typo Vitaly - it should say Di**s**abled

![image](https://github.com/audacity/audacity/assets/50205984/f0bba5de-0682-42d6-8913-8d479d8c5ac8)

Plus the Consistency>Spelling page in the Manual (and on Manual pages) has long had

""**built-in**"", not ""builtin"" or ""built in""

![image](https://github.com/audacity/audacity/assets/50205984/535fe73a-4fab-4466-962f-305f5863b5a7)


-------------------------------------------------------------------------------------------------------

But otherwise all seems to work fine

"
1966391672,5980,vsverchinsky,2024-02-27T12:00:00Z,Last branch update aims to fix compilation and keyboard navigation issues on platforms other than win. Remaining accessibility problems are yet to be fixed
1966626215,5980,petersampsonaudacity,2024-02-27T14:06:02Z,"Testing on W10 with @vsverchinsky 's latest branch build:   audacity-win-3.5.0-alpha-20240227+067c5e1-x64

The list of EGATS is still NOT in strict alphabetical order - rather it has alphabetically ordered subsections.

a) This makes it harder to use.

b) It is not really necessary as the user can filter by Type to see the subsections."
1966806406,5980,petersampsonaudacity,2024-02-27T15:23:14Z,"Testing on W10 with @vsverchinsky 's latest branch build: audacity-win-3.5.0-alpha-20240227+95f0559-x64

That looks better to me now with proper alphabetic ordering.

![image](https://github.com/audacity/audacity/assets/50205984/88a7061a-f69e-4196-9105-3f20108f6211)
"
1971224746,5980,petersampsonaudacity,2024-02-29T14:10:00Z,"Testing on W10 with @vsverchinsky 's latest branch build for this:  audacity-win-3.5.0-alpha-20240229+0df2b93-x64

I see we now have an additional filter for Category (type of EGAT)

The cute thing is that the default setting you get for Category depends on the way you get to the Plugin Manager, so coming from **Effect>Plugin Manager** will default to Category **Effect** and similar for the other EGAT categories.

_I just hope that users are curious enough to explore the Category filter and realize that there is still an **All** category choice._
"
1983190805,5980,petersampsonaudacity,2024-03-07T10:18:07Z,"Testing on W10 with @vsverchinsky 's latest branch:  audacity-win-3.5.0-alpha-20240306+c6c5a1c-x64

a) The cycling based on initial letter now seems good

b) if you are lower in the list that the first letter you type it will go back and find the EGATs starting with that letter

-------------------------------------------------------------------------------------------------

But I observe a small oddity with the alphabetic ordering of the list.

A couple of my VST/VST3 plugins are out of order at the bottom of the list.  This does not appear to be a VST/VST3 problem per se  as I have other VST/VST3 plugins further up the list which are in the correct alphabetic order.

![image](https://github.com/audacity/audacity/assets/50205984/1f523594-a499-45a2-951f-4875fb860680)

Interestingly though if I use ""i"" or ""m"" as my first letter it cycles through the correctly ordered ones and then these out of order ones at the bottom and then cycles back up.
"
1985475978,5980,DavidBailes,2024-03-08T10:51:11Z,"@vsverchinsky . Having C as the access key for Category has created a duplicate, as Cancel also uses C. Suggest you change the access key of Category to a.
Also as noted above by @petersampsonaudacity , the alphabetic ordering should not be case sensitive."
1985649918,5980,petersampsonaudacity,2024-03-08T12:56:21Z,"> Also as noted above by @petersampsonaudacity , the alphabetic ordering should not be case sensitive.

Ahhhh, so that was the problem - thanks @DavidBailes "
1985778620,5980,LWinterberg,2024-03-08T14:19:50Z,this dialog is going to be the closest thing to perfection we have in this app
1985784330,5980,petersampsonaudacity,2024-03-08T14:23:25Z,"> this dialog is going to be the closest thing to perfection we have in this app

I'm certainly liking it a lot :-)"
1988877315,5980,petersampsonaudacity,2024-03-11T16:34:51Z,"Testing on W10 with @vsverchinsky 's latest branch for this:  audacity-win-3.5.0-alpha-20240311+dcc70d2-x64

The alphabetic ordering now properly ignores case:
![image](https://github.com/audacity/audacity/assets/50205984/7d7a5ce7-43a4-432a-a832-9ca9b3701de0)
"
1991694746,5980,dozzzzer,2024-03-12T13:47:57Z,"@vsverchinsky 

These two issues can be reliably reproduced:

#### 1. On Windows, when clicking into a checkbox to enable a plugin/effect, it wrongly clicks in a different row:

https://github.com/audacity/audacity/assets/70063970/cee9135a-2053-4c66-a497-aa5e50696537

#### 2. On macOS, when double-clicking on an empty row in the Plugin Manager, Audacity crashes.

___

> [!NOTE]
> The following issues occur seemingly at random and only on macOS, but still, it isn't too hard to come across them since they exhibit themselves frequently although not in 100% of the cases. These issues are:

#### 3. Audacity crashes after having disabled some built-in effect(s), then switching the Category to Generator and trying to rescan.

##### Example 1:

https://github.com/audacity/audacity/assets/70063970/8413ff05-79c4-4d7d-840e-cde3d54232f2

##### Example 2:

https://github.com/audacity/audacity/assets/70063970/11e90f59-580b-420d-8b5d-35f187e24c1c

#### 4. Audacity may also freeze sometimes with or without the ""Audacity Support Data"" dialog popping up when performing pretty much the same set of actions, i.e.:

1. Effect > Plugin Manager
2. Disable one-two effects
3. Click Rescan
4. Click Cancel to abort scanning
5. Click OK to dismiss the dialog
6. Select Category: Generator
7. Click Rescan

##### Example 1

https://github.com/audacity/audacity/assets/70063970/432aecc0-c6b5-41d9-8635-36aabab21467

##### Example 2

https://github.com/audacity/audacity/assets/70063970/b34d122f-68bb-4bb1-9f21-ac3c3a37f31c

#### 5. And lastly, much more rarely Audacity may freeze when canceling scanning. For this one, I don't have a screen recording."
1991995813,5980,petersampsonaudacity,2024-03-12T15:56:17Z,"@dozzzzer @vsverchinsky 

> 1. On Windows, when clicking into a checkbox to enable a plugin/effect, it wrongly clicks in a different row:

I cannot reproduce this on W10

_Well, I can if I have run older versions and get multiple copies of the same EGAT - buut not if I clear the Audacity settings folder before launching the latest branch build for this._"
1991999148,5980,petersampsonaudacity,2024-03-12T15:57:53Z,">3. Audacity crashes after having disabled some built-in effect(s), then switching the Category to Generator and trying to rescan.

@dozzzzer @vsverchinsky 

I cannot reproduce this on W10"
1992010377,5980,petersampsonaudacity,2024-03-12T16:03:02Z,"@dozzzzer @vsverchinsky 

>4. Audacity may also freeze sometimes with or without the ""Audacity Support Data"" dialog popping up when performing pretty much the same set of actions

>5. And lastly, much more rarely Audacity may freeze when canceling scanning. For this one, I don't have a screen recording.

I can never get to the **Cancel** button on the **Rescan** dialog anything like quickly enough - so I find myself unable to test this.

"
1998064354,5980,vsverchinsky,2024-03-14T18:20:33Z,"@dozzzzer 
> 1. On Windows, when clicking into a checkbox to enable a plugin/effect, it wrongly clicks in a different row:

Nice catch! When I was debugging this issue I've found out that to reproduce this you'll need to have multiple rows with equal values in the column and enable sorting for this column. ""Type"" is a best option."
1998384156,5980,vsverchinsky,2024-03-14T20:21:53Z,@dozzzzer It seem that all 2-5 crashes/freezes may have same origin. At least I could reproduce any of 3-5 after I caught and fixed second issue.
1999263060,5980,petersampsonaudacity,2024-03-15T09:30:38Z,"Testing on W10 with @vsverchinsky 's latest branch build for this:  audacity-win-3.5.0-alpha-20240314+cfb3b3a-x64

The list of **Types** has had ""effects"" trimmed from them as per @LWinterberg 's request
And ""Native Audacity"" is there for Audacity supplied EGATS (thanks for that)

![image](https://github.com/audacity/audacity/assets/50205984/aa631c58-f281-4553-b4da-1d47e8dece96)
"
1999735245,5980,petersampsonaudacity,2024-03-15T14:01:51Z,"Testing on W10 with @vsverchinsky 's latest branch build for this:  audacity-win-3.5.0-alpha-20240314+cfb3b3a-x64

A few posts ago in this thread @LWinterberg requested that in the Type field we should lose the term ""effect"" from the type listings as not all EGATs are effects.  And this is now done as reported above.

**BUT** in the EGAT lists the non-effect EGATs show as ""**Built-in Effects**"" in their path listing:

![image](https://github.com/audacity/audacity/assets/50205984/d451ca4e-29cc-4d3c-92ef-fedb5a67ca26)
"
2011886707,5980,petersampsonaudacity,2024-03-21T10:37:03Z,"Testing on W10 with @vsverchinsky 's latest branch build for this:  audacity-win-3.5.0-alpha-20240320+4f4b2e0-x64

@LWinterberg @dozzzzer @Tantacrul 

From a user and usability perspective all seems fine but with one small oddity/niggle - and that is the behavior of the space-bar shortcut with multiple selections (basically it acts as a toggle).

a) If you select a single EGAT in the displayed list and press the space-bar it toggles the enabled/disabled status of that selected EGAT.  All well and good and as expected.

b) BUT if you make a selection of multiple EGATs in the displayed list (with Shift or Ctrl modified selection) and press the space-bar it toggles the entire selection based on the status of the **last** EGAT that you select- rather than toggling the status of each individual EGAT in the list based on its current status (and it is topmost not the first one you select).

**Is this intended and desired behavior ?**   
Is it what a user would expect ?  I would have thought that most users would expect a toggle of existing status for all selected EGATs _(my ""Mystery-Shopper"" thought so too when I ran this past her)_.

@DavidBailes  - what would VI users expect in this case ?

BTW if you make a multiple EGAT selection with a Shift modified click to select a contiguous range of EGATS, then the toggle is based on the status of the whichever EGAT you clicked on second to make the contiguous selection.

-----------------------------------------------------------------------

STR
1. Effect > Plugin Manager
2. set Type filter to native Audacity
3. Observe:  Classic Filters is the only disabled entry
4. Click on Classic Filters to select it
5. Ctrl+Click on Auto Duck and Bass&Treble to select those too
6. Press the space-bar: 
7. Observe all three become un-selected i.e. Classic Filters does _**not**_ toggle

----------------------------------------------------------------------------------

I partly ask this question as the editor of the manual as this existing behavior is somewhat tricksy to explain.
"
1563331212,4723,Paul-Licameli,2023-05-25T18:28:41Z,"And that almost completes a round of review...

... Just one thought I have now is that anticipatory pre-fetching of the next block by a background thread could be a further enhancement.  Just entertain that thought for now as a bonus project, that might speed up rendering for instance, but it may not be essential to get tolerable performance in realtime.
"
1563531345,4723,Paul-Licameli,2023-05-25T21:33:23Z,"I've been thinking more about this.  I'm not convinced this will work.

In the old caching, the caches were external to the track, and spectrogram drawing or MixerSource controlled their lifetimes.  The invalidation problem did not exist, because in those contexts it could be assumed that the contents of the track would not be changing in the lifetime of the caches.

Furthermore, it was possible for different code to access the same wavetrack in different places, but different caches would exist to take advantage of the different patterns of locality.  For instance, a track might be playing or looping, while a changing display (such as, spectrogram with pinned play head, or a change of zoom during play) might require a different loop over the blocks concurrently.  And yes, concurrently -- there really were multiple threads involved.

But putting an internal cursor into the Sequence object has all the disadvantage of non-thread-safety; even if synchronized, different fetches from different threads would repeatedly miss the cache; and without a way to destroy the caches early, extra problem of invalidation exists.

So we need a very different solution that still allows the caches to be external to the Sequence, and yet, lets MixerSource control cache lifetimes although it is in lib-sample-track and can't depend on lib-wave-track where Sequence lives.

But how?  I can explain.

"
1563545023,4723,Paul-Licameli,2023-05-25T21:48:59Z,"1. Sequence exposes a function that returns a cache object, and the caller determines its lifetime.
2. (If ever longer lifetimes are needed, such that invalidation becomes a problem, then Sequence can be a Publisher and the caches can subscribe.  But don't do that until it's really necessary, and then be sure there aren't multithreading problems.)
3. `Sequence::Get` (the overload not taking a first int argument) takes an optional pointer to cache defaulting to nullptr, and uses it if it isn't null.
4. This extra argument propagates up the stack in changes of arguments of WaveClip::GetSamples().
5. WaveTrack can construct multiple Sequence caches (one for each of its clips, storing them in a hash map from clip addresses) and call that single object a cache, and return it to the caller.  WaveTrack::Get(), if given a pointer to a cache from outside, can pass the correct sub-cache to the correct clip as needed.
6. SampleTrack can have a new pure virtual function, `MakeCache`, returning `X` , and its virtual function `Get` can take an optional pointer to `X`, defaulting to nullptr.  I just explained in 5 how these pure virtuals are overridden.
7. What type is `X`?  I think it's a good job for `std::any` -- that's just a polymorphic holder of anything that can be copied and destroyed.  `WaveTrack::GetSamples` packs the box, somebody else (even in lib-sample-track) can hold onto the box, or destroy it, without needing to know what's in it, and then `WaveTrack::Get` uses `std::any_cast` to look inside the box again.
8. Then construct the caches exactly where `SampleTrackCache` was constructed before, destroy them exactly where the old caches were destroyed, and wherever the old caches were used, pass the new caches to `SampleTrack::Get()`.
"
1563564074,4723,Paul-Licameli,2023-05-25T22:08:51Z,"Also some afterthought about `WaveTrack::GetIdealBlockSize()`:  the side effect it might have had as a non-const function was unimportant, and is possible quite wrong in case the non-const function shadows the const one and becomes more widely used.  It could have a side effect of making a new, empty clip.

Don't do it.  Just delete that function.

And then, what purpose is still served by the old, and const, `GetMaxBlockSize` ?

It is, to hint a a good size for fetching some WaveTrack data for a sequential march through a long stretch of track duration, for instance in many of the effects.

Maybe it's just not important to have this function.  Those places could just allocate something fixed, like a megabyte.  If they later add caches for efficiency or pre-fetching (they aren't cached now, and would not be if you followed my suggestions above strictly), it wouldn't really bring any advantage to tune the effect's buffer size to match the internal buffers of the cache.

But there is no harm in keeping the function either, so let it remain and all the existing calls to it.
"
1563886244,4723,crsib,2023-05-26T06:46:20Z,"> What type is X? I think it's a good job for std::any -- that's just a polymorphic holder of anything that can be copied and destroyed.

I will veto that and you know it well."
1563921957,4723,Paul-Licameli,2023-05-26T07:20:00Z,"> > What type is X? I think it's a good job for std::any -- that's just a polymorphic holder of anything that can be copied and destroyed.
> 
> I will veto that and you know it well.

Explain your alternative."
1563943746,4723,Paul-Licameli,2023-05-26T07:36:48Z,"std::any was used without objections here https://github.com/audacity/audacity/commit/3eb6f9861266ca8f75579c7862ae22b35bd5c719
"
1563958332,4723,crsib,2023-05-26T07:49:48Z,"> the caches were external to the track, and spectrogram drawing or MixerSource controlled their lifetimes

But we are solving different problems here, aren't we?

> Sequence::Get (the overload not taking a first int argument) takes an optional pointer to cache, defaulting to nullptr, and uses it if it isn't null.

I see this as ""excessive complication for the problem."" Especially because it needs propagation `up the stack in changes of arguments of *`. I see it as a much more invasive approach.

> What type is X?

This is a huge red flag in your proposal. So it cannot be even expressed in type? The user needs to know what is safe to use to manipulate it or where to pass it? It cannot be verified by a compiler? A big, strong no. I had more trouble with `EffectSetting` than I asked already. I know that I was not alone. We've been talking through it for a very long time, and I have been largely ignored. So now I will be pushing hard against any such code, which is something I told you before too. JS gets type, Python gets type, and Audacity written in C++ erases types randomly because it's fun and because the committee decides to take `std::any` into the standard. (Still not the worst thing that slipped into the std lib, just look at `std::async`)   

If there are cases where you find per clip/per track caches to be required make an appropriate cache and READ using it, do not pass it to the track or clip. This is irrelevant to this problem anyway; we must efficiently satisfy around-the-border reads, which is only the problem with SQLite-based sample blocks. 

>  Reclaiming the memory resources of the cache when it's not good to occupy them.

Dropping the cache because the caller decided it no longer needs it is a very weird pattern. But again, it still can be done. You can have more than one cache. Your CPU has **three** just to satisfy reads.

> Explain your alternative.

Easy. Do not use `std::any`. I am really frustrated that I have to cover this again, but while I have never seen a good excuse to use `std::any` (that includes ""what if you need a cache that can store anything by a key""), there are numerous problems it causes:

1. Compiler is no longer your friend. It is now the responsibility of the developer to validate types.
2. It violates LSP, and I have a very strong opinion that L is the single most important letter in SOLID. Without L it just makes no sense.
3. It makes debugging intrusive and hard.
4. It breaks all kinds of features that use the knowledge of the code model: code completion, refactoring, static analysis, etc.

> std::any was used without objections here [3eb6f98]

I was not happy, and I told you that during the review. However, that specific case was nothing more than a scope guard, the returned object was never meant to be used, so I allowed it. It could've been done differently and if I knew that it would be used as an argument for yet another `EffectSetting` I would've pushed to do it differently.
"
1564121330,4723,crsib,2023-05-26T09:48:50Z,"On top of that - `std::any` is not polymorphic. It won't be possible to use different caching policies unless they are implemented within the same cache, so the proposed approach is closed for extension, forcing you to **modify** existing implementation if one needs to extend the behavior.
"
1564175124,4723,saintmatthieu,2023-05-26T10:26:50Z,"@Paul-Licameli thanks for your constructive review.

I did think of multithreading, and yes, I wouldn't leave this code as-is given this possibility.

About the cache lifetime issue, I admit the scenario of a project with many small clips (which would happen if a user concatenates several clip instances of the same underlying data to make a looping track) would require far more memory than necessary.

I'm open to alternative approaches and am looking at yours with interest. Comments/questions coming up."
1564179127,4723,Paul-Licameli,2023-05-26T10:30:19Z,"> On top of that - `std::any` is not polymorphic. It won't be possible to use different caching policies unless they are implemented within the same cache, so the proposed approach is closed for extension, forcing you to **modify** existing implementation if one needs to extend the behavior.

Two things only are required.  The cache can be destroyed when no longer needed.  The cache can be passed back to the object that produced it which then interprets it.  I foresee no further requirements.  No example of a third was given.

 std::any is sufficient.  Unique pointer to an ad hoc abstract base class with a virtual destructor could do it too, avoiding std::any but just needing more keystrokes.

It addresses the present problems compatibly with library dependencies.

I still don’t know what alternative is offered.
"
1564222335,4723,crsib,2023-05-26T11:04:09Z,"> std::any is sufficient.

std::any is wrong. 

> The cache can be passed back to the object that produced it which then interprets it.

Why this complexity with passing random objects back and forth? There is a need for a cache with a specific lifetime? Create a cache, point it to the data source, and **read from the cache**. That's how caching works. Not by passing the cache back to the data source.

>  I foresee no further requirements.

If it was possible to foresee all the possibilities and requirements - software won't be needed. But this is not the case. ""I do not see now"" does not mean such a case won't occur tomorrow. Introducing rigid and overcomplicated code ""just because"" is not something that we need to continue to do.

> It addresses the present problems compatibly with library dependencies.

Please focus not only on breaking library dependencies. The code should be maintainable and readable first. `std::any` hides dependencies and result in bad code.

> I still don’t know what alternative is offered.

There is a cache already that suits your needs. It is orthogonal to what was needed for the abandoned graphics PR and to what stretching needs. So leave it this way. Do not try to invent a single cache to rule them all, this won't work.

In the end, you almost give the answer yourself. If you need a cache that returns you the samples for the given range - **explicitly** define the contract. Not with ""comments"", not with `std::any`. Explicitly.


"
1564305241,4723,Paul-Licameli,2023-05-26T12:16:41Z,"I am not the one who first said we should remove the existing cache from spectrogram drawing code.  Matthieu proposed doing that, and for a good reason.  A cache needs to be upstream of the time-stretching processing for performance reasons, and time stretching may need to be calcuated even by drawing code too if we want to remap the display to account for it.

I'm not convinced that `std::any` is a tool in the kit that should never to be considered, with proper knowledge of its tradeoffs -- but in this case it was admittedly a reluctant compromise.  I thought there was a need to change the SampleTrack abstract interface to introduce caches as context arguments.

If that can be avoided, while also getting the thread safety, and correctness, and avoidance of excessive allocation -- then that's all to the better, and after more sleep and a chat with Matthieu, we are forming some outline of how to do that.

So please no more debate about `any`.  I'll talk about the next ideas.
"
1564313688,4723,Paul-Licameli,2023-05-26T12:24:16Z,"I'm preparing a long comment, please wait.
"
1564557526,4723,Paul-Licameli,2023-05-26T15:25:11Z,"Sorry for unintentional close.

Some study now convinces me that the really acceptable solution must first wait on some other restructuring I need to do (even without cache restructuring) in AudioIO.cpp.  So expect a PR from me instead, on which to rebase all of this.
"
1564581155,4723,saintmatthieu,2023-05-26T15:39:37Z,"@Paul-Licameli following up on our conversation today, here's pseudo code of the weak_ptr approach :

```cpp
class SQLiteSampleBlock {
public:
  using BytePtr = shared_ptr<char[]>
  using ByteWPtr = weak_ptr<char[]>
  BytePtr Get();
}

class Sequence {
public:
  struct Cache {
    std::vector<BytePtr> sqliteCaches; // Contiguous audio samples
    const sampleCount start;
    const size_t len;
  }
  using CachePtr = shared_ptr<Cache>
  using CacheWPtr = weak_ptr<Cache>

  CachePtr Get(sampleCount start, size_t len) {
    // Here do not release mCacheHolder until newCache is constructed with the BytePtrs it needs,
    // else that'd drop the ref count to 0 and SQLiteSampleBlock would need SQL-querying again.

    CachePtr newCache;
    // Put together newCache from sample blocks ...
    // ...
    // ... now newCache is ready.
    return mCacheHolder = newCache;
  }

private:
  CachePtr mCacheHolder;
}

class WaveClip {
public:
  Sequence::Cache Get(sampleCount start, size_t len) {
    return mSequence->Get(start, len);
  }
}

class WaveTrack {
public:
  Sequence::Cache Get(sampleCount start, size_t len) {
    // Could make up a Sequence::Cache just by assembling caches returned by `WaveClip::Get` as well as ones filled with silence if needed.
    return assembledCache;
  }
}

class StretchingSampleTrack {
public:
  Sequence::Cache Get(sampleCount start, size_t len) {
    // The stretcher would use `WaveClip::Get` to feed the algorithm. The stretched output can be placed in another `Sequence::Cache`.
    // `sqliteCaches` would have size 1 and match the requested start and len.

    return stretcherOutput;
  }
}
```"
1564604341,4723,Paul-Licameli,2023-05-26T15:59:39Z,"> @Paul-Licameli following up on our conversation today, here's pseudo code of the weak_ptr approach :
> 
> ```c++
> class SQLiteSampleBlock {
> public:
>   using BytePtr = shared_ptr<char[]>
>   using ByteWPtr = weak_ptr<char[]>
>   BytePtr Get();
> }
> 
> class Sequence {
> public:
>   struct Cache {
>     std::vector<BytePtr> sqliteCaches; // Contiguous audio samples
>     const sampleCount start;
>     const size_t len;
>   }
>   using CachePtr = shared_ptr<Cache>
>   using CacheWPtr = weak_ptr<Cache>
> 
>   CachePtr Get(sampleCount start, size_t len) {
>     // Here do not release mCacheHolder until newCache is constructed with the BytePtrs it needs,
>     // else that'd drop the ref count to 0 and SQLiteSampleBlock would need SQL-querying again.
> 
>     CachePtr newCache;
>     // Put together newCache from sample blocks ...
>     // ...
>     // ... now newCache is ready.
>     return mCacheHolder = newCache;
>   }
> 
> private:
>   CachePtr mCacheHolder;
> }
> 
> class WaveClip {
> public:
>   Sequence::Cache Get(sampleCount start, size_t len) {
>     return mSequence->Get(start, len);
>   }
> }
> 
> class WaveTrack {
> public:
>   Sequence::Cache Get(sampleCount start, size_t len) {
>     // Could make up a Sequence::Cache just by assembling caches returned by `WaveClip::Get` as well as ones filled with silence if needed.
>     return assembledCache;
>   }
> }
> 
> class StretchingSampleTrack {
> public:
>   Sequence::Cache Get(sampleCount start, size_t len) {
>     // The stretcher would use `WaveClip::Get` to feed the algorithm. The stretched output can be placed in another `Sequence::Cache`.
>     // `sqliteCaches` would have size 1 and match the requested start and len.
> 
>     return stretcherOutput;
>   }
> }
> ```

I don't see where you use the weak pointer types in the pseudocode, but I get the general idea.

There is more to think about, to manage type safety, efficiency, and putting a bound on the memory the cache may occupy at one time.

There is also still the problem of lifting the construction and lifetime management of these caches to an appropriate place, so that lib-sample-track and lib-audio-graph don't need any mention of the caches in their interfaces -- as in the my last proposal.  Which I find a not wholly satisfying compromise just because of this intrusion in the SampleTrack interface.

And that problem is what makes me want to pause this while I figure out some other restructuring.  I need also to do things in AudioIO.cpp so that it doesn't use TrackList.

"
1564657214,4723,saintmatthieu,2023-05-26T16:45:39Z,"I realize that, in my draft above, each `WaveClip` holds on to one or more `SQLiteSampleBlock::BytePtr`, meaning many clips would mean lots of memory.

Trying again, this time moving the holders to `SampleTrack` implementation level. If the `SampleTrack` clients query small audio chunks at a time, which is typical and convenient, then there'd be typically one, sometimes two, strong references to `SQLiteSampleBlock::BytePtr` per track at all time, which would be totally acceptable memory wise. I think that'd address your concern, @Paul-Licameli, of
> putting a bound on the memory the cache may occupy at one time

```cpp
class SQLiteSampleBlock {
public:
  using BytePtr = shared_ptr<char[]>
  using ByteWPtr = weak_ptr<char[]>
  BytePtr Get();
}

class Sequence {
public:
  struct Cache {
    std::vector<BytePtr> sqliteCaches; // Contiguous audio samples
    const sampleCount start;
    const size_t len;
  }
  using CachePtr = shared_ptr<Cache>
  using CacheWPtr = weak_ptr<Cache>

  CachePtr Get(sampleCount start, size_t len) {
    CachePtr newCache;
    // !!!!!!!!!!!! change from previous draft !!!!!!!!!!!!
    // Put together newCache from sample blocks ...
    return newCache;
  }
}

class WaveClip {
public:
  Sequence::Cache Get(sampleCount start, size_t len) {
    return mSequence->Get(start, len);
  }
}

class WaveTrack {
public:
  Sequence::Cache Get(sampleCount start, size_t len) {
    // !!!!!!!!!!!! change from previous draft !!!!!!!!!!!!
    // Here do not release mCacheHolder until assembledCache is constructed with the BytePtrs it needs,
    // else that'd drop the ref count to 0 and SQLiteSampleBlock would need SQL-querying again.
    return mCacheHolder = assembledCache;
  }

private:
  Sequence::Cache mCacheHolder;
}

class StretchingSampleTrack {
public:
  Sequence::Cache Get(sampleCount start, size_t len) {
    // !!!!!!!!!!!! change from previous draft !!!!!!!!!!!!
    // Simiilarly to WaveTrack: do not let go of the strong reference before the one to be returned is created.
    return mCacheHolder = stretcherOutput;
  }

private:
  Sequence::Cache mCacheHolder;
}
```

It's not perfect that the clients of `Sequence` need knowledge of the caching mechanism to use it properly, there may be room for improvement there."
1564659403,4723,saintmatthieu,2023-05-26T16:47:47Z,"> There is also still the problem of lifting the construction and lifetime management of these caches to an appropriate place, so that lib-sample-track and lib-audio-graph don't need any mention of the caches in their interfaces

Mention of the caches in their interface doesn't bother me so much. It would still be an improvement from what we currently have API wise because much easier to use, I expect."
1564662626,4723,saintmatthieu,2023-05-26T16:51:15Z,"... we probably don't even have to mention ""cache"" in the returned audio containers. I'm more bothered (although not that much) by the clients having to make sure they do not drop a shared pointer before acquiring a new one. But maybe we can return a more intelligent object that takes care of this."
1564854669,4723,crsib,2023-05-26T19:49:21Z,I don't understand why we need a per-block sample cache.
1565156786,4723,Paul-Licameli,2023-05-27T02:08:34Z,"> I don't understand why we need a per-block sample cache.

I doubted the idea too at first, but now I see advantages:  the cache aligns perfectly to block boundaries, and immutability means no need for invalidation logic.

Maybe the cache data are held by SeqBlock and not the SampleBlock itself.  If the mutable Sequence changes, a SeqBlock can be destroyed and free its cache.

Maybe Sequence can implement an LRU policy with a bound on total cache size (or block count) to evict some cache from memory and avoid too much memory usage.

Doing that MRU cache update with thread safety would present some difficulty but I think it could be overcome.

These ideas aren’t firmed up yet.  We are exploring alternatives and need various ideas.
"
1567799633,4723,saintmatthieu,2023-05-30T06:02:49Z,"@Paul-Licameli pointed out that this wasn't thread-safe. Looks like we need yet some rather different solution. We are evaluating ideas, but this one looks unlikely to be carried through. Declining."
1916746723,5900,Paul-Licameli,2024-01-30T12:32:51Z,"I see messages crossed about Observer.

You made simplifications, not exactly as I suggested, and I hope you agree it's all more understandable now.

Can you answer my questions about thread safety?  The subscriptions may be created and destroyed only in the main thread, and that includes destruction of either the publisher or the subscriber before the other.

Publication on another thread is safe if that is so.

"
1916769669,5900,Paul-Licameli,2024-01-30T12:45:40Z,"I would move `CentShiftChange` into `ClipSegment.h` and then `WaveClip` could publish that type and simply pass a function to `Subscribe` without the extra lambda adaptor.

It's minor though.
"
1916781291,5900,Paul-Licameli,2024-01-30T12:52:34Z,"All right, I see no real blocker.

I dislike the now increasing involvement of pitch and stretch notions in lib-wave-track, where they should be extraneous, but that restructuring is for later.

Assuming too that the thread safety of Observer is correct, and that you will squash it into fewer commits -- I can approve it
"
1917706142,5900,dozzzzer,2024-01-30T19:05:21Z,"@saintmatthieu 

1. When opening up the Pitch & Speed dialog and entering a new value, a strange ""-24"" pops up in the text box at random. Furthermore, after the text box is cleared and the new value is entered, it gets increased by 1:

https://github.com/audacity/audacity/assets/70063970/eb05ca0d-ba3d-4ae0-8d1e-3765b852582d

Also, I've observed that every time I put the cursor in the ""cents"" text box and press Backspace, the semitones value decreases by 1:

https://github.com/audacity/audacity/assets/70063970/013bcdcd-f4f0-4cd9-9f51-daefad08b2ad



2. Not sure if anything at all should be done about it, but during testing, I've observed somewhat deteriorating quality at higher values. It becomes more obvious from around 20+ semitones up. At this point, the sound becomes quite unusable while the competitor's algorithm yields a much cleaner result. Tested on one-shots, drum loops, bass loops and vocals. Here's an example of such deterioration: https://www.dropbox.com/scl/fo/71moh408cvrlz34pmrafr/h?rlkey=kq1xllldkag4e71hswmk5t4zg&dl=0 This isn't too critical since it manifests itself at higher (although not extreme) values but still smth worth to be aware of.

(TBC)

"
1918723223,5900,saintmatthieu,2024-01-31T09:33:19Z,"> 1. When opening up the Pitch & Speed dialog and entering a new value, a strange ""-24"" pops up in the text box at random. Furthermore, after the text box is cleared and the new value is entered, it gets increased by 1

Tweaks pushed, hope they improve UX.

About 2., I allowed pitch shifting to such extreme ratios because the weird resulting sounds might be interesting to the users at an educational and experimental level, and maybe useful in the creation of weird atmospheres. When we have tempo curves, I can imagine that one might want to slowly drop or raise the pitch to something increasingly unrecognizable.

Ideally of course, it'd pitch up and down more realistically, but the amount of work involved in improving this is completely unknown.

I'm confident that the technology will be very useful as it is. One potential area of improvement is formant preservation: when shifting voice, one quickly gets into a Chipmunk effect. I just created an issue for this: https://github.com/audacity/audacity/issues/5902. Maybe this will address some of the limitations you've noticed ? (Could you please share your examples using Google Drive instead?)"
1921064330,5900,dozzzzer,2024-02-01T11:02:31Z,"@saintmatthieu 

1. It seems that the upper/lower boundaries aren't in place when pitch-shifting using Alt (Option) + ↑/↓. After reaching a value of a couple of hundred, an attempt to play back causes Audacity to freeze.
2. On macOS, quitting the Pitch & Speed dialog by ESC doesn't restore the previous pitch value and submits the entered value instead; clicking Cancel, though, doesn't work as it should either: it resets the current pitch value to zero."
1921207660,5900,saintmatthieu,2024-02-01T12:24:01Z,"> I'm confident that the technology will be very useful as it is. One potential area of improvement is formant preservation: when shifting voice, one quickly gets into a Chipmunk effect. I just created an issue for this: https://github.com/audacity/audacity/issues/5902. Maybe this will address some of the limitations you've noticed ? (Could you please share your examples using Google Drive instead?)

@dozzzzer I omitted the problem of aliasing and imaging. This may also explain the lower quality you noticed. I created another ticket for that: https://github.com/audacity/audacity/issues/5904"
1925322835,5900,petersampsonaudacity,2024-02-03T13:31:38Z,"Testing on W10 with @saintmatthieu 's latest branch for this:  audacity-win-3.5.0-alpha-20240202+81dc5f9-x64-msvc2022

Pitch and Speed  changing appears to work while Audacity is playing - but there are some issues of note:

1) when Audacity is playing and you hover the cursor over the Clip-handle drag bar the cursor icon that you get is a **white no-entry**  icon - to me this implies that no action is available but clicking on it still brings up the drag-bar context menu, including the **Pitch and Speed** command.
This is **_not_** introduced as part of this change - the same occurs in 3.4.2

2) when Audacity is playing the **Clip Speed %** in the **Pitch and Speed** dialog is grayed-out and unavailable.  
This is _**not**_ the case when the command is invoked while Audacity is not playing.
![image](https://github.com/audacity/audacity/assets/50205984/8383c245-1445-45e4-b5cf-474e9d6cbb54)

3) The **Pitch and Speed** context menu :command has a much reduced UI compared to the **Effect > Pitch and Tempo > Change Speed and Pitch** menu command:
![image](https://github.com/audacity/audacity/assets/50205984/b633326e-093c-4d2e-865e-81a65800f672)

4) I was really expecting the **Change Speed and Pitch** effect to be a further Audacity command that would now be available in the Real-time effects stack - and not just a clip-handle context menu.

5) In the clip-handle context menu command dialog for **Pitch and Speed** - you appear to be able to change pitch and speed independently.  
This appears to contrast with what happens with the **Effect > Pitch and Tempo > Change Speed and Pitch** menu command."
1925325732,5900,petersampsonaudacity,2024-02-03T13:44:34Z,"@saintmatthieu  @LWinterberg 

Perhaps most importantly:

6) this PR states that the dynamic pitch change in the  clip being played is ""non-destructive"".

BUT testing shows that the pitch change is actually applied destructively (the change goes on the Undo/History stack).
![image](https://github.com/audacity/audacity/assets/50205984/1a172236-e9e5-46f1-8030-70e587dbae83)
And Undo/Redo can be applied."
1925343793,5900,petersampsonaudacity,2024-02-03T14:30:57Z,"@saintmatthieu @LWinterberg 

7)  the dialog seems un- necessarily wide

![image](https://github.com/audacity/audacity/assets/50205984/c2664111-7532-4c7e-a281-2c9cd6f5cce6)
"
1925350442,5900,petersampsonaudacity,2024-02-03T14:57:39Z,"8) in the old clip-handle context menu the command was **Change Speed** - in the new menu it is just **Pitch and Speed**.

Surely it would be better to add back the ""**Change**"" and make the new command be **Change Pitch and Speed**
a) for clarity of purpose  (""does what it says on the tin"")
b) to differentiate from the **Render Pitch and Speed** just beneath it

![image](https://github.com/audacity/audacity/assets/50205984/bf3f75df-1ddb-4084-ae3d-15bc3386719f)
"
1925351772,5900,petersampsonaudacity,2024-02-03T15:02:47Z,I have updated the Manual for the changes as they currently are - but retained P1s just in case further changes are effected.
888245568,1377,Paul-Licameli,2021-07-28T11:49:25Z,"Your approach is founded on a memory of the origin of a channel as ""aligned"" or not, rather than computing it as needed.

I would prefer that you compute alignment as needed.

Defining the condition will take some work.  You must sort clips of each channel, becauase they are not necessarily in sorted order, and they you must iterate corresponding clips comparing start and end times.  (Probably with a tolerance: let times differ by 1/(2*rate))

This is extra work, and extra calculation, but I believe the calculation will be small in practice because clips will be few.

The advantage is greater confidence that there are not surprising corner cases where things will not work as expected.

For instance:  I just made a mono track, duplicated it, then made a stereo track from them.  The affordance of the right channel did not disappear as expected in your branch.  It would under this other approach.

There are also other commands like ""Swap stereo tracks.""  This did not produce the expected result.  It would if aligned-ness is computed instead of stored.


"
888279855,1377,vsverchinsky,2021-07-28T12:46:55Z,"> Your approach is founded on a memory of the origin of a channel as ""aligned"" or not, rather than computing it as needed.
> 
> I would prefer that you compute alignment as needed.
> 
> Defining the condition will take some work. You must sort clips of each channel, becauase they are not necessarily in sorted order, and they you must iterate corresponding clips comparing start and end times. (Probably with a tolerance: let times differ by 1/(2*rate))
> 
> This is extra work, and extra calculation, but I believe the calculation will be small in practice because clips will be few.
> 
> The advantage is greater confidence that there are not surprising corner cases where things will not work as expected.
> 
> For instance: I just made a mono track, duplicated it, then made a stereo track from them. The affordance of the right channel did not disappear as expected in your branch. It would under this other approach.
> 
> There are also other commands like ""Swap stereo tracks."" This did not produce the expected result. It would if aligned-ness is computed instead of stored.

I don't agree with that. I've considered that possibility, but the problem is that matching clips isn't enough, the result should be cached anyway. Moreover the first case isn't valid, this behaviour was requested. The second case should be fixed. Also I see a problem with definition of matching clips: it will probably  change in the nearest feature."
888307713,1377,Paul-Licameli,2021-07-28T13:25:40Z,"
> I don't agree with that. I've considered that possibility, but the problem is that matching clips isn't enough, the result should be cached anyway. Moreover the first case isn't valid, this behaviour was requested. The second case should be fixed. Also I see a problem with definition of matching clips: it will probably change in the nearest feature.

If ""matching clips is not enough,"" what is your more precise description of the criterion?  You are guessing it will ""probably"" change, but that is speculation.  Even if it does change, defining it in one place in a test seems to me to be the less fragile approach.  More lines of code to implement the complicated test, but fewer places in the code will need changes to guarantee the consistency of the cache with changes of the track.

Caches are useful but problematic when there are many things that could happen to invalidate them.

"
888333440,1377,vsverchinsky,2021-07-28T14:00:44Z,"> If ""matching clips is not enough,"" what is your more precise description of the criterion?

It is described here https://github.com/audacity/audacity/issues/1348. The check you propose is actually answers the question we don't need to answer (are clips aligned or not?). From the description of the task i understand that the sequence of track transformation determines whether the track should be considered ""aligned"" or not. Consider case when user have stereo track with misalligned clips, then user makes them aligned by dragging. Should we consider track aligned now? If yes, then affordance should disappear, if no then user can split stereo track and merge it back to get completely another appearance (this was my question for designers). And as i understand the currently implemented behaviour is exactly what was requested (except second scenario you've provided)."
888344119,1377,Paul-Licameli,2021-07-28T14:13:55Z,"> > If ""matching clips is not enough,"" what is your more precise description of the criterion?
> 
> It is described here #1348. The check you propose is actually answers the question we don't need to answer (are clips aligned or not?). From the description of the task i understand that the sequence of track transformation determines whether the track should be considered ""aligned"" or not. Consider case when user have stereo track with misalligned clips, then user makes them aligned by dragging. Should we consider track aligned now? If yes, then affordance should disappear, if no then user can split stereo track and merge it back to get completely another appearance (this was my question for designers). And as i understand the currently implemented behaviour is exactly what was requested (except second scenario you've provided).

You are right that you tried to implement literally what is now in the text box in the first picture at that issue.

Really I think that specification should be disputed and corrected.  So, let's raise this at the next design review.

I believe that if mono tracks have aligned clips according to the numerical criteria, then they should merge into a stereo track without the second affordance area.


"
902602775,1377,Paul-Licameli,2021-08-20T10:39:30Z,"The branch needs a rebase and force-push and conflict resolution.
"
1679063067,5027,Paul-Licameli,2023-08-15T14:46:18Z,Rebased unchanged onto updated #5008 
1683861171,5027,dozzzzer,2023-08-18T12:39:45Z,"@Paul-Licameli an issue when using the Noise Reduction effect:

- have a stereo/mono track
- select a short region of ~100ms
- Effect > Noise Reduction
- click ""Get Noise Profile""
- observe

Act. result:
![image](https://github.com/audacity/audacity/assets/70063970/e45f88c3-c096-4394-898b-b71c4888aa29)
"
1683935406,5027,Paul-Licameli,2023-08-18T13:38:04Z,"@dozzzzer @chinakov See this comment in the other PR that this one depends on: https://github.com/audacity/audacity/pull/5008#issuecomment-1680511643
"
1683936710,5027,Paul-Licameli,2023-08-18T13:39:04Z,"So I already fixed this in #5008 which is under test still.

But this branch was not rebased onto that updated branch.

When I do that and rebuild, the problem should disappear.
"
1686163232,5027,dozzzzer,2023-08-21T11:36:09Z,"@Paul-Licameli Moving back to In Progress:

- when swapping stereo channels, the clip name disappears

**before:**
<img width=""220"" alt=""Screenshot 2023-08-21 at 12 58 25"" src=""https://github.com/audacity/audacity/assets/70063970/87add0ac-4b73-482b-916a-a2ec3487ebd5"">

**after:**
<img width=""220"" alt=""Screenshot 2023-08-21 at 12 58 33"" src=""https://github.com/audacity/audacity/assets/70063970/91f001f3-4cc4-47e2-91f4-87622f04517f"">

- when copying a region of the clip with some envelope points and pasting it into the same clip, envelop points get messed up

**before:**
<img width=""500"" alt=""Screenshot 2023-08-21 at 13 28 23"" src=""https://github.com/audacity/audacity/assets/70063970/96d99149-87b7-49d3-8a30-c63df316f5e9"">

<img width=""300"" alt=""Screenshot 2023-08-21 at 13 30 58"" src=""https://github.com/audacity/audacity/assets/70063970/16c83915-7120-45fd-9e60-0957216c9680"">


**after:**
<img width=""500"" alt=""Screenshot 2023-08-21 at 13 28 33"" src=""https://github.com/audacity/audacity/assets/70063970/6f5ac347-7062-4a65-9121-97c886d60783"">

<img width=""300"" alt=""Screenshot 2023-08-21 at 13 31 05"" src=""https://github.com/audacity/audacity/assets/70063970/b046d8a3-ceb6-43fc-bfc2-114baa4fd173"">

"
1686178815,5027,Paul-Licameli,2023-08-21T11:46:35Z,"> @Paul-Licameli Moving back to In Progress:
> 
>     * when swapping stereo channels, the clip name disappears
> 
> 
> **before:** <img alt=""Screenshot 2023-08-21 at 12 58 25"" width=""220"" src=""https://user-images.githubusercontent.com/70063970/262009261-87add0ac-4b73-482b-916a-a2ec3487ebd5.png"">
> 
> **after:** <img alt=""Screenshot 2023-08-21 at 12 58 33"" width=""220"" src=""https://user-images.githubusercontent.com/70063970/262009280-91f001f3-4cc4-47e2-91f4-87622f04517f.png"">
> 
>     * when copying a region of the clip with some envelope points and pasting it into the same clip, envelop points get messed up
> 
> 
> **before:** <img alt=""Screenshot 2023-08-21 at 13 28 23"" width=""500"" src=""https://user-images.githubusercontent.com/70063970/262009705-96d99149-87b7-49d3-8a30-c63df316f5e9.png"">
> <img alt=""Screenshot 2023-08-21 at 13 30 58"" width=""300"" src=""https://user-images.githubusercontent.com/70063970/262010267-16c83915-7120-45fd-9e60-0957216c9680.png"">
> 
> **after:** <img alt=""Screenshot 2023-08-21 at 13 28 33"" width=""500"" src=""https://user-images.githubusercontent.com/70063970/262009740-6f5ac347-7062-4a65-9121-97c886d60783.png"">
> <img alt=""Screenshot 2023-08-21 at 13 31 05"" width=""300"" src=""https://user-images.githubusercontent.com/70063970/262010312-b046d8a3-ceb6-43fc-bfc2-114baa4fd173.png"">

Please make your own checklist of problems at the top.  Anton and I have found this practice useful.

I think you fill find the problem with clip names should be mentioned at PR #5008 but is not the fault of new commits proper to this branch.
"
1686571724,5027,Paul-Licameli,2023-08-21T15:41:54Z,"Rebased onto updated #5008.  The problem with track names should be fixed.
"
1686743009,5027,Paul-Licameli,2023-08-21T17:28:22Z,"> @Paul-Licameli Moving back to In Progress:
> 
>     * when swapping stereo channels, the clip name disappears
> 
> 
> **before:** <img alt=""Screenshot 2023-08-21 at 12 58 25"" width=""220"" src=""https://user-images.githubusercontent.com/70063970/262009261-87add0ac-4b73-482b-916a-a2ec3487ebd5.png"">
> 
> **after:** <img alt=""Screenshot 2023-08-21 at 12 58 33"" width=""220"" src=""https://user-images.githubusercontent.com/70063970/262009280-91f001f3-4cc4-47e2-91f4-87622f04517f.png"">
> 
>     * when copying a region of the clip with some envelope points and pasting it into the same clip, envelop points get messed up
> 
> 
> **before:** <img alt=""Screenshot 2023-08-21 at 13 28 23"" width=""500"" src=""https://user-images.githubusercontent.com/70063970/262009705-96d99149-87b7-49d3-8a30-c63df316f5e9.png"">
> <img alt=""Screenshot 2023-08-21 at 13 30 58"" width=""300"" src=""https://user-images.githubusercontent.com/70063970/262010267-16c83915-7120-45fd-9e60-0957216c9680.png"">
> 
> **after:** <img alt=""Screenshot 2023-08-21 at 13 28 33"" width=""500"" src=""https://user-images.githubusercontent.com/70063970/262009740-6f5ac347-7062-4a65-9121-97c886d60783.png"">
> <img alt=""Screenshot 2023-08-21 at 13 31 05"" width=""300"" src=""https://user-images.githubusercontent.com/70063970/262010312-b046d8a3-ceb6-43fc-bfc2-114baa4fd173.png"">

So the channel names are explained.  To reproduce other misbehavior of pasting envelopes may require certain precise time selections.  I determined that with a careful example, I can reproduce the problem in versions back to 3.2.0 but not in 3.1.3.

"
1686762535,5027,Paul-Licameli,2023-08-21T17:42:51Z,"I suspect commit 33318a421544fcadbf753271500d3bb5b238ba99 introduced the bug.
"
1687944883,5027,Paul-Licameli,2023-08-22T10:42:55Z,"Rebase unchanged onto recent master
"
1688176380,5027,dozzzzer,2023-08-22T13:20:06Z,Tested
1950242762,5965,Paul-Licameli,2024-02-17T15:58:42Z,"Rebased unchanged
"
1951328325,5965,Paul-Licameli,2024-02-18T13:36:02Z,"Another rebase, with no change except one easy conflict resolution with 6110c4f5e73d90c367ba606c7a47bd8352c0f7c3
"
1952955192,5965,Paul-Licameli,2024-02-19T17:54:21Z,"Rebased to updated dependency branch

"
1956447363,5965,Paul-Licameli,2024-02-21T11:27:52Z,"Rebased, squashed some fix-ups, added a new first commit in the sequence
"
1961053912,5965,saintmatthieu,2024-02-23T10:11:54Z,"Looking at `class WideChannelGroupInterval : public ChannelGroupInterval`, I'm wondering what need there is to distinguish the two. A channel _group_ is necessarily wide, isn't it?"
1961348402,5965,Paul-Licameli,2024-02-23T13:41:13Z,"Rebased onto updated wave-clip-refactoring.  Made the newly merged in handle classes compile.  Removed the extraneous file.
"
1961753972,5965,Paul-Licameli,2024-02-23T17:52:29Z,"Two new commits which may resolve some of the problems you found.
"
1963889476,5965,Paul-Licameli,2024-02-26T11:14:36Z,"Rebased unchaged to updated base branch
"
1972349672,5965,Paul-Licameli,2024-03-01T02:33:42Z,"Merged master to wave-clip-refactoring, then rebased this with some squashing, and added to the QA checklist
"
1976759900,5965,Paul-Licameli,2024-03-04T14:51:52Z,"I discovered a problem, maybe noticeable only in debug builds.  Generate or record some sound, then use Reverse effect.  An assertion is violated.

I also observe that tracks can have duplicate shared pointers to a clip.
"
1976774239,5965,saintmatthieu,2024-03-04T14:58:05Z,"> I discovered a problem, maybe noticeable only in debug builds. Generate or record some sound, then use Reverse effect. An assertion is violated.
> 
> I also observe that tracks can have duplicate shared pointers to a clip.

@chinakov should be aware - he currently is actively testing this card."
1976846284,5965,Paul-Licameli,2024-03-04T15:29:17Z,"@saintmatthieu please look at the two newest commits
@chinakov I'm afraid you might need to retest it all to be very sure
"
1096508598,2801,pietro68,2022-04-12T10:16:02Z,"I pushed some of the requested changes. I still have to fully understand why settings are not saved and recalled in commits 1, 2 & 3. 

So far I understood this: 
in those commits, the base class of Echo is temporarily set to `EffectWithSettings<EffectEchoSettings, StatefulPerTrackEffect>`

I put a breakpoint in void `ShuttleGetAutomation::Define`; before and after those 3 commits, I see there that the values coming in, are the actual values set in the gui; with either of those 3 commits, I do not (they'd be the last saved ones)

Maybe this has to do with FetchParameters returning something wrong when the base class is `EffectWithSettings<EffectEchoSettings, StatefulPerTrackEffect>`?
"
1096608448,2801,Paul-Licameli,2022-04-12T11:34:14Z,"> I pushed some of the requested changes. I still have to fully understand why settings are not saved and recalled in commits 1, 2 & 3.
> 
> So far I understood this: in those commits, the base class of Echo is temporarily set to `EffectWithSettings<EffectEchoSettings, StatefulPerTrackEffect>`
> 
> I put a breakpoint in void `ShuttleGetAutomation::Define`; before and after those 3 commits, I see there that the values coming in, are the actual values set in the gui; with either of those 3 commits, I do not (they'd be the last saved ones)
> 
> Maybe this has to do with FetchParameters returning something wrong when the base class is `EffectWithSettings<EffectEchoSettings, StatefulPerTrackEffect>`?

Let's be satisfied with persistency of settings in the final commit, even if it fails in the intermediate commits.

I think the reason for failure is that MakeSettings() is redefined when you use the base class EffectWithSettings, so EffectManager is storing a real settings object instead of an empty `any`.  Then there are calls to SaveSettings and LoadSettings which really use that object.  But while EffectEcho is not yet really stateless, it is still using its own internal copy of the settings instead of the one stored in EffectManager.

"
1096618504,2801,pietro68,2022-04-12T11:44:30Z,"I see now, thanks for the explanation. 
What do you think is left to do here? would you like me to reduce the number of steps from 4 to 3, like you hinted before?"
1097752082,2801,pietro68,2022-04-13T09:04:23Z,"The last push you see is after I rebased on branch `More-stateless-effect-utilities`, in order to try using `EffectWithSettingsBase` to preserve settings in intermediate transformation steps (i.e. 1-2-3)

But what I found out is that to preserve settings, I do not need that class. I just needed to correct FetchParameters to return the right address of the settings, and leave it there for all 3 intermediate steps. I verified it works for all 3 intermediate steps, and the 4th step works too.


"
1097964846,2801,Paul-Licameli,2022-04-13T11:56:54Z,"I'm not persuaded that the transitional steps are really all correct.  They may run the effect without crashing, but I think that at step 3, the effect does not apply the correct values.

I could approve the PR anyway if the final result is correct, but I would prefer that you understand the intermediate steps well enough to know why bugs do or don't exist in them.
"
1098054294,2801,Paul-Licameli,2022-04-13T13:31:02Z,"The third step does not apply settings correctly.

It might also be useful to use the Manage button to save a named preset.  Then verify that it is correctly retrieved when you load it, in each intermediate step.

To make the intermediate steps strictly correct, you should not use EffectSettings arguments of the Instance, and should store a reference not a copy of settings in the Validator, until the last commit changes that.  You should not use EffectWithSettings until the last commit, where you remove the mSettings member of the effect."
1098055811,2801,Paul-Licameli,2022-04-13T13:32:26Z,"My transformation of Ladspa to statelessness does as I described, with other work too so there are more commits.  I also don’t need EffectWithSettingsBase at any point.
"
1098060872,2801,Paul-Licameli,2022-04-13T13:36:42Z,"This also means the places where the Validator uses GetSettings are not added until the last commit.
"
1098152914,2801,pietro68,2022-04-13T14:54:47Z,"I confirm that step 3 does not apply the chosen settings. I will edit each commit now, following these directives:

a) for steps 1-3, inherit from StatefulPerTrackEffect
b) for step 4, inherit from EffectWithSettings<EffectEchoSettings, PerTrackEffect>
c) in steps 1-3, have a mSettings as a member of Echo, and use exclusively that one
d) in steps 1-3 in the Validator, use a reference to the the settings, not a copy, but then in step 4 turn it to a copy

Is the above what you meant?

It is not really clear to me how in step 3 I can access the Effect's mSettings member from within the instance - with a downcast to EffectEcho of the instance's mProcessor member?
"
1098161008,2801,Paul-Licameli,2022-04-13T15:01:47Z,"> I confirm that step 3 does not apply the chosen settings. I will edit each commit now, following these directives:
> 
> a) for steps 1-3, inherit from StatefulPerTrackEffect b) for step 4, inherit from EffectWithSettings<EffectEchoSettings, PerTrackEffect> c) in steps 1-3, have a mSettings as a member of Echo, and use exclusively that one d) in steps 1-3 in the Validator, use a reference to the the settings, not a copy, but then in step 4 turn it to a copy
> 
> Is the above what you meant?
> 
> It is not really clear to me how in step 3 I can access the Effect's mSettings member from within the instance - with a downcast to EffectEcho of the instance's mProcessor member?

You understand correctly.  static_cast of mProcessor is what I do too in the Stateless-ladspa-effects branch.

Be sure mSettings is deleted from the effect in the last commit, which will force you to make the other needed changes so that it continues to compile.


"
1098335889,2801,pietro68,2022-04-13T18:03:37Z,"Some changes to the last agreed plan:

step 2 could not inherit `StatefulPerTrackEffect` but had to inherit `EffectWithSettings<EffectEchoSettings, StatefulPerTrackEffect>` - otherwise Validator implementations have no access to `GetSettings()`

step 3 could not inherit `StatefulPerTrackEffect` but had to inherit `EffectWithSettings<EffectEchoSettings, StatefulPerTrackEffect>` - otherwise there are no calls to the instance's Process*** methods

TESTS
- preservation of last used settings: all steps pass

- switching between user presets: 
  steps 1-2-3 pass, 
  step 4 shows a **bug**: when having two user presets A and B in the list, clicking once on one of them is not enough to change the values, the preset must be clicked twice.

Is this bug due to an error in assembling final step 4, or is the bug in the framework? I will have to inspect this tomorrow but if you have a hint, it is welcome!



"
1098954808,2801,pietro68,2022-04-14T09:51:52Z,"I could reproduce the bug I noticed with the two user presets with DTMFgen too, so I conclude the cause is in the framework. I opened issue https://github.com/audacity/audacity/issues/2822 for that."
1098981984,2801,Paul-Licameli,2022-04-14T10:06:28Z,"> Some changes to the last agreed plan:
> 
> step 2 could not inherit `StatefulPerTrackEffect` but had to inherit `EffectWithSettings<EffectEchoSettings, StatefulPerTrackEffect>` - otherwise Validator implementations have no access to `GetSettings()`

No.

GetSettings() should not be used until the last step.  I think I said that already.  The parts of the Validator code that use GetSettings should wait until step 4 to be added.


> 
> step 3 could not inherit `StatefulPerTrackEffect` but had to inherit `EffectWithSettings<EffectEchoSettings, StatefulPerTrackEffect>` - otherwise there are no calls to the instance's Process*** methods
> 

No.  Inheritance of the class changes only in the last step.


> TESTS
> 
> * preservation of last used settings: all steps pass
> * switching between user presets:
>   steps 1-2-3 pass,
>   step 4 shows a **bug**: when having two user presets A and B in the list, clicking once on one of them is not enough to change the values, the preset must be clicked twice.
> 
> Is this bug due to an error in assembling final step 4, or is the bug in the framework? I will have to inspect this tomorrow but if you have a hint, it is welcome!

"
1099022405,2801,pietro68,2022-04-14T10:23:20Z,"Alright, I can make step 2 still inherit `StatefulPerTrackEffect` if I comment out the calls to GetSettings, not a big problem there.

But... to make step3 inherit StatefulPerTrackEffect - I would have to leave ProcessInitialize, ProcessFinalize and ProcessBlock still belong to the effect and not to the instance. That's ok actually, it is just a little more work postponed to step 4.

I found the preset switching bug also in DTMFGen, I opened this issue for it: https://github.com/audacity/audacity/issues/2822"
1099056351,2801,Paul-Licameli,2022-04-14T10:42:38Z,"> I could reproduce the bug I noticed with the two user presets with DTMFgen too, so I conclude the cause is in the framework. I opened issue #2822 for that.

Are you sure the problem is in the framework?  Could it be a bug that already existed in 3.1?"
1099072368,2801,DavidBailes,2022-04-14T11:05:51Z,"> Are you sure the problem is in the framework? Could it be a bug that already existed in 3.1?

The bug isn't present in 3.1.3"
1099081110,2801,pietro68,2022-04-14T11:16:56Z,"Oops I was wrong when I said step 3 can not inherit StatefulPerTrackEffect - it can!
I will now read your other comments and act on them."
1099145845,2801,Paul-Licameli,2022-04-14T12:42:23Z,"> > Are you sure the problem is in the framework? Could it be a bug that already existed in 3.1?
> 
> The bug isn't present in 3.1.3

Can you @pietro68  or @DavidBailes write up an issue with exact steps please?
"
1099258942,2801,pietro68,2022-04-14T14:42:17Z,"> > > Are you sure the problem is in the framework? Could it be a bug that already existed in 3.1?
> > 
> > 
> > The bug isn't present in 3.1.3
> 
> Can you @pietro68 or @DavidBailes write up an issue with exact steps please?

Yes, it is at https://github.com/audacity/audacity/issues/2822
"
1099260896,2801,pietro68,2022-04-14T14:44:19Z,"I think I addressed the last round of requests; all 4 steps tested ok, with the exception of the bug happening at step 4, also happening in the DTMFgenerator - see issue at https://github.com/audacity/audacity/issues/2822

Updated 4-steps guide:
[4 steps to effect statelessness.txt](https://github.com/audacity/audacity/files/8490739/4.steps.to.effect.statelessness.txt)
 "
1099560419,2801,Paul-Licameli,2022-04-14T19:38:36Z,"At last this sequence looks like a transformation that is correct at every step.  I will merge it because you will be away for a few days.  I hope you can write a revised outline describing the procedure for transforming an effect, which you can repeat with other effects.
"
1102261043,2801,pietro68,2022-04-19T08:12:51Z,"Thanks for the merge! I already attached the revised outline in my previous comment here, but I think I will add it to the repository - a simple PR will follow for that."
1723741379,5193,Paul-Licameli,2023-09-18T15:40:27Z,"Windows build errors:
`D:\a\audacity\audacity\src\import\ImportRaw.cpp(224,1): error C2440: 'initializing': cannot convert from 'int' to 'size_t &' [D:\a\audacity\audacity\.build.x32\src\Audacity.vcxproj]`
`D:\a\audacity\audacity\src\import\ImportRaw.cpp(229,1): error C2440: 'initializing': cannot convert from 'int' to 'size_t &' [D:\a\audacity\audacity\.build.x32\src\Audacity.vcxproj]`
`D:\a\audacity\audacity\src\import\ImportRaw.cpp(221,26): error C2664: 'void ImportUtils::ForEachChannel(TrackList &,const std::function<void (WaveChannel &)> &)': cannot convert argument 2 from 'ImportRaw::<lambda_cd67ecb3f9410bfd47f9bd99446097e3>' to 'const std::function<void (WaveChannel &)> &' [D:\a\audacity\audacity\.build.x32\src\Audacity.vcxproj]`
"
1725313351,5193,Paul-Licameli,2023-09-19T11:23:55Z,"Finished a round of review
"
1725745277,5193,Paul-Licameli,2023-09-19T14:27:26Z,"I would also like to see a rebase that squashes my last two commits as fixups on earlier ones.

""Fix Windows Build"" fixes ""Eliminate `ImportUtils::MakeTracks`""

""Fix recording into stereo"" fixes ""Don't assume correspondence of channels and RecordableSequences""
"
1726413126,5193,Paul-Licameli,2023-09-19T20:20:11Z,All the builds are failing
1727435081,5193,vsverchinsky,2023-09-20T10:27:01Z,Rebased onto fixed master
1727544822,5193,Paul-Licameli,2023-09-20T11:32:50Z,"Please rebase and reword one of my commit comments
""RecordableSequences are really wide and correspond with channels""
Should say channel groups, not channels
"
1731892395,5193,vsverchinsky,2023-09-22T18:44:26Z,OGG Import crash fix & rebase 
1731925927,5193,vsverchinsky,2023-09-22T19:16:30Z,Attempted to fix recording to stereo fix
1733732512,5193,vsverchinsky,2023-09-25T13:38:35Z,Rebased
1191323742,3258,Paul-Licameli,2022-07-21T10:34:38Z,"Some updates in early commits in the force-push onto latest master, in case they were reviewed already:

- Corrected too-strong assertion in Buffers::Discard
- Source::Produce is not `const` but adds postcondition that it does not change `Remaining()`
- Where I introduce `EffectStage`, constructor takes additional `Buffers&`, no `Connect` function after
- Fix erors in SampleTrackSource::Produce where I strengthen the postcondition

And there are changes of commit comments.

Last commit still isn't all right.
"
1196582976,3258,Paul-Licameli,2022-07-27T11:02:17Z,"Un-drafted at last!
"
1197981693,3258,Paul-Licameli,2022-07-28T10:49:14Z,"> Should VST3 work? I can observe ` assert(bound == 0 || Remaining() == 0 || result > 0);` violation when applying VST3 effect

Tell me more about how you made that happen.  Was that the assertion in SampleTrackSource or EffectStage?
"
1197995876,3258,crsib,2022-07-28T11:04:51Z,"I generate *stereo* (is it relevant? I don't really know) chirp, select a part of it and try to apply Berzerk.

The first assertions is in  `PerTrackEffect::ProcessTrack`: `assert(curBlockSize <= blockSize);`
If you skip it - assertion in EffectStage::Produce is triggered."
1198013826,3258,Paul-Licameli,2022-07-28T11:24:47Z,"> I generate _stereo_ (is it relevant? I don't really know) chirp, select a part of it and try to apply Berzerk.
> 
> The first assertions is in `PerTrackEffect::ProcessTrack`: `assert(curBlockSize <= blockSize);` If you skip it - assertion in EffectStage::Produce is triggered.

The plug-in is itself a generator, or you generated first and applied an effect?
"
1198020027,3258,Paul-Licameli,2022-07-28T11:31:38Z,"I just pushed more assertions of postconditions, which should cause the first assertion sooner.
"
1198027290,3258,crsib,2022-07-28T11:39:33Z,">The plug-in is itself a generator, or you generated first and applied an effect?

I generated first "
1198037336,3258,Paul-Licameli,2022-07-28T11:50:51Z,"Yes actually I think I broke the case of generator plug-ins, but fixed it with another commit
"
1198048101,3258,Paul-Licameli,2022-07-28T12:00:25Z,"Commit 744f696e7120aa0db0c79b2f04d16dcef5ca7da8 may fix the reported symptoms now.

I have accumulated a few small commits since your tests, which you should review, then I will rebase and squash them onto previous commits.
"
1198389378,3258,Paul-Licameli,2022-07-28T16:43:56Z,"Some general comments about the Source and Sink interfaces.

See the looping task in ProcessTrack.  The task is between a source and a sink.  To make progress, it must, in very general terms:
- acquire an empty buffer from its sink (the loop begins in that state) -- ""sink.Reserve""
- acquire a full buffer from its source -- ""source.Produce""
- transform from source to sink (no-op because it's just in-place production into outBuffer)
- release the buffer acquired from source -- ""source.Advance"" or some better name (""source.Recycle""?)
- release the buffer acquired from sink -- ""sink.Consume""

When we implement a concurrent pipeline in the future, there will be multiple concurrent tasks like this, each with an upstream ""source"" and downstream ""sink"".

Each buffer between tasks would have two blocks.  Each buffer has two associated semaphores, one signaled by the upstream task, one by the down. All the semaphores can count up to two.

So each middle task will see two upstream semaphores and two down.

EffectStage::Produce would instead become another task, and instead of returning, it would ""release"" a filled buffer of ready data back to its downstream.  That's the sink.Consume operation.  (Don't like the name?...) The downstream task would be unblocked from acquiring a full buffer, which is source.Produce.  (... But see how the names complement.)

Meanwhile the stage may be able to do work on the other block of the downstream buffer if it is free, concurrently with its downstream doing the transformation before releasing the buffer again.

Before the effect stage can do any of that, it must first ""sink.Reserve"" an empy buffer from downstream.  (All the semaphores that count free space begin with value 2, so initial progress can happen).  It must also aquire data from upstream (that is already called ""source.Produce""; there is an initial pipeline filling from ultimate source, in which not all cores are active yet).  When all done, the stage must also ""source.Advance"" to ""recycle"" the buffer space to its upstream again so its upstream is unblocked again from ""sink.Reserve"" and can make more progress.

Maybe Produce/Consume can then be understood as complementary operations of cooperating tasks.  The other two operations need some nice complementary names too, and maybe Reserve/Recycle isn't clear, so suggest better please.

As for WaveTrackSink -- the conservative transformation I did here doesn't change its behavior of accumulating blocks until the buffer is full and only then writing them out, and so the function names seem strange.  But maybe this isn't really achieving significant economies, and instead a rewrite for concurrency would really make Consume act eagerly rather than have Reserve make space lazily.  The implementation can be changed under the interface.




"
1198397365,3258,Paul-Licameli,2022-07-28T16:52:11Z,"Do you know anything about the four-stoke piston engine?  I was wondering if there is a sort of analogy...

- Exhaust = Reserve
- Intake = Produce
- Compress = Recycle ?
(✨ -plug)
- Power!  (Consume)

And we want all the cylinders to keep firing all the time.

But if I used the names in the first column, you would doubtless find it all even stranger.

"
1198402092,3258,Paul-Licameli,2022-07-28T16:57:24Z,"Anyway.. maybe just Acquire and Release in each of the interfaces would be simplest.
"
1198436213,3258,crsib,2022-07-28T17:29:26Z,Probably the comment on Source/Sink should go somewhere in code
1198825936,3258,Paul-Licameli,2022-07-29T02:50:12Z,"Pushed again, with some name changes of functions and squashes of fixes; also last commit introduces AudioGraph::Task

"
846471056,918,Be-ing,2021-05-22T22:26:40Z,">  Will Artifactory be configured to allow anonymous access?

I am wondering this as well. Will developers be able to build with the same builds of libraries locally that the official builds use?"
846471614,918,Be-ing,2021-05-22T22:34:03Z,"> In the future, we plan to use custom recipes for mad and id3tag. The reason is that they use very outdated build scripts, which do not work on AppleSillicon machines even when cross-compiling.

These libraries seem to be abandoned for many years. @Holzhaus wrote a [CMakeLists.txt for libid3tag](https://github.com/mixxxdj/vcpkg/blob/2.3/overlay/ports/libid3tag/CMakeLists.txt) which may come in handy for you. Maybe you could fork these old libraries and host them under the Audacity GitHub organization?"
846528508,918,crsib,2021-05-23T08:55:47Z,"> > Will Artifactory be configured to allow anonymous access?
> 
> I am wondering this as well. Will developers be able to build with the same builds of libraries locally that the official builds use?

@Be-ing @JamesCrook 

It is already available :) The packages list is empty, because of some Artifactory limitations I wasn't able to overcome - it simply doesn't list packages with anonymous access. You can browse the list here: https://artifactory.audacityteam.org/ui/repos/tree/General/conan-local

Or you can run 

```
conan remote add audacity https://artifactory.audacityteam.org/artifactory/api/conan/conan-local
```

and play with wxwidgets build using:

```
conan install wxwidgets/3.1.3-audacity@
```

>Maybe you could fork these old libraries and host them under the Audacity GitHub organization?

We will have to :-) We have important patches in the build tree. Likely I will do that early on Monday

"
846591839,918,Be-ing,2021-05-23T16:45:03Z,"So does this branch make CMake automatically download the library binaries from Artifactory? If so, please document that and how to disable it."
846626816,918,crsib,2021-05-23T21:27:08Z,"> So does this branch make CMake automatically download the library binaries from Artifactory? If so, please document that and how to disable it.

@Be-ing you mean you always want to build libraries from source? Ok, that's not a problem.

For package-maintainer-like cases, it is possible to share Conan cache, but given that they will be forcing everything to system libraries, I don't think that it is much of an issue really."
846635214,918,Be-ing,2021-05-23T22:40:38Z,"I don't want to build the entire dependency graph from source. The default behavior I expect from a build system is to first search the system for dependencies. I think this should be the same whether building Audacity locally or packaging it. I also want to be able to use the exact dependencies locally that are used for the official builds, which should be opt in.

The documentation distinguishes between ""local"" and ""system"" libraries. I understand what ""system"" libraries mean, but how does Conan fit into this? Does Conan automatically download builds of ""local"" libraries?"
846920048,918,crsib,2021-05-24T09:40:57Z,"> I don't want to build the entire dependency graph from source. The default behavior I expect from a build system is to first search the system for dependencies. I think this should be the same whether building Audacity locally or packaging it. I also want to be able to use the exact dependencies locally that are used for the official builds, which should be opt in.

This behavior can be activated using `-Daudacity_lib_preference=system`. However, as I've mentioned earlier, this can be dangerous because there could be libraries with _official_ recipes from `conan.io` that will link to the Conan provided ZLib (or any other library), and you will have issues with the build. This is why this behavior is opt-in, not opt-out. 

If you turn library preference to **system** and you have the matching library installed and properly configured by the system maintainers the Conan won't be used for the library at all. However, this will generally require you to install all the libraries and patched pkg-config files (if you are running Ubuntu)

> The documentation distinguishes between ""local"" and ""system"" libraries. I understand what ""system"" libraries mean, but how does Conan fit into this? Does Conan automatically download builds of ""local"" libraries?

For the dependencies, that are using Conan - **local** will use Conan provided library. That means that the recipe for the library will be downloaded from `conan.io` or our Artifactory. If there are cached binaries for your system settings - the cached binaries will be downloaded. Otherwise, the dependency will be built locally on your machine. In both cases, your local cache will be checked first.
"
846927351,918,Be-ing,2021-05-24T09:53:38Z,"I'm still confused. Does `system` use Conan as a fallback if the library is not found on the system?

> For the dependencies, that are using Conan - local will use Conan provided library. That means that the recipe for the library will be downloaded from conan.io or our Artifactory. If there are cached binaries for your system settings - the cached binaries will be downloaded. Otherwise, the dependency will be built locally on your machine. In both cases, your local cache will be checked first.

I suggest renaming `local` to `conan`. To me, `local` implies that no network connections will be made."
846930598,918,crsib,2021-05-24T09:59:27Z,"> I'm still confused. Does `system` use Conan as a fallback if the library is not found on the system?

This is documented in this pull request, but I will further clarify it in the next commit. There is an option, that will force only using the system libraries. By default, if there is no system library - some fallback will be used.

> I suggest renaming `local` to `conan`. To me, `local` implies that no network connections will be made.

This PR does not replace all of the dependencies. This option can be renamed to **vendored**, but this will be confusing as well.

The option will be renamed to Conan when the work on dependencies is complete"
1044285779,2565,Paul-Licameli,2022-02-18T10:25:37Z,"I'm done with a round of review.  I await your answers.
"
1044313664,2565,Paul-Licameli,2022-02-18T10:42:36Z,"See this, about difference between `SetBackgroundColour` and `SetOwnBackgroundColour` https://docs.wxwidgets.org/trunk/classwx_window.html#a37219df52734626e23401fd83b25d8a0

I build with modification to show the effecs panel, and I can confirm that the background color updates correctly with theme change.

The separator is draggable.  There is a limiting left position, but it can be dragged right as far as the edge of the window, crowding out the track panel.
"
1044381506,2565,vsverchinsky,2022-02-18T11:38:09Z,"> See this, about difference between `SetBackgroundColour` and `SetOwnBackgroundColour` https://docs.wxwidgets.org/trunk/classwx_window.html#a37219df52734626e23401fd83b25d8a0
> 
> I build with modification to show the effecs panel, and I can confirm that the background color updates correctly with theme change.
> 
> The separator is draggable. There is a limiting left position, but it can be dragged right as far as the edge of the window, crowding out the track panel.

The documentation seems to be a bit outdated, because in the source code you'll find this:
```
    // in addition, there is a possibility to explicitly forbid inheriting
    // colours at each class level by overriding ShouldInheritColours()
    if ( ShouldInheritColours() )
    {
        if ( parent->m_inheritFgCol && !m_hasFgCol )
            SetForegroundColour(parent->GetForegroundColour());

        // inheriting (solid) background colour is wrong as it totally breaks
        // any kind of themed backgrounds
        //
        // instead, the controls should use the same background as their parent
        // (ideally by not drawing it at all)
#if 0
        if ( parent->m_inheritBgCol && !m_hasBgCol )
            SetBackgroundColour(parent->GetBackgroundColour());
#endif // 0
``` "
1044477463,2565,Paul-Licameli,2022-02-18T12:51:23Z,"I informally approve the changes.  Do you wish to merge this PR now (I would recommend it) or wait to complete it with a button for showing and hiding the sidebar?  If you wait, then change the top comment to un-link it from the issue, which it does not completely resolve.
"
1045138717,2565,vsverchinsky,2022-02-18T20:29:37Z,"@Paul-Licameli I've added 3 new commits with ""Effects"" track panel button."
1049893838,2565,Paul-Licameli,2022-02-24T14:05:41Z,"The issues is, nominally, to enable a showing and hiding of the side panel.  I tried it, and the new button does show the side bar, but I expected it might hide it if I pressed it again, but not so.  There is no way to hide it again, it appears.

But I expect is so easily fixed as not to be a reason to withhold approval.
"
1772243225,5398,saintmatthieu,2023-10-20T07:43:09Z,"Some comments about this PR that may help the understanding:
* `WaveClip` still being mono, it cannot be stretch-rendered independently from it's other channel. `WaveTrack::Interval` is now the place where this is done.
* The `StaffPadTimeAndPitch` processor needs a source and a sink. The sink sample size being different than the source, we cannot have the same `Interval` being at once source and sink. Hence the approach consisting of creating an empty copy, using it as sink, and afterwards copying over the envelope."
1772246603,5398,saintmatthieu,2023-10-20T07:45:52Z,"Cutlines are not preserved. At the moment we have a (tiny?) bug on 3.4: enable cutlines, stretch a clip, cut a portion of it, render stretching: the red line is still visible, and clicking it still makes it disappear, but does not expand anything.
With this PR at least the red line isn't present anymore. I suppose it's okay to postpone the implementation of this to after this PR if Product think they're worthwhile preserving. If yes, the cutlines would probably have to be stretch-rendered, too ..."
1772294355,5398,saintmatthieu,2023-10-20T08:21:42Z,About cutlines: @dozzzzer just logged an issue: #5401
1777093438,5398,Paul-Licameli,2023-10-24T12:16:28Z,"This completes a round of review.  I think the sample formats must surely be fixed, and also preserving the project tempo in the clip may be desirable.
"
1777674238,5398,Paul-Licameli,2023-10-24T17:11:53Z,"Envelopes:  is it correct just to copy the envelope into the replacement clips, or do they have to be stretched too, as is done in WaveClip::OnProjectTempoChange?
"
1777753626,5398,saintmatthieu,2023-10-24T18:02:33Z,"> Envelopes: is it correct just to copy the envelope into the replacement clips, or do they have to be stretched too, as is done in WaveClip::OnProjectTempoChange?

Stretch-rendering should not affect the timing of envelopes, and envelope points, like `mTrimLeft` and the likes, are updated on each shrink or expand operation. So we're good 👍 "
1777767143,5398,Paul-Licameli,2023-10-24T18:10:33Z,"> > Envelopes: is it correct just to copy the envelope into the replacement clips, or do they have to be stretched too, as is done in WaveClip::OnProjectTempoChange?
> 
> Stretch-rendering should not affect the timing of envelopes, and envelope points, like `mTrimLeft` and the likes, are updated on each shrink or expand operation. So we're good 👍

Well I'm adding a QA checkbox anyway
"
1777767257,5398,saintmatthieu,2023-10-24T18:10:36Z,"> Tracks with non-float samples should be a test case

I see you added a QA item, thanks."
1780629099,5398,saintmatthieu,2023-10-26T08:14:38Z,"> One remaining thing I wanted to see was an assertion of a postcondition. I added it during your day off, in the interests of keeping this card moving through QA.

I forgot to do that, thank you."
1782688221,5398,saintmatthieu,2023-10-27T10:36:42Z,"Just pushed a fix for [this issue](https://github.com/audacity/audacity/assets/22740106/6ac6c650-3f0c-4cab-9f67-7e6e5a350c21) found by @dozzzzer (thank you!)

"
1782721628,5398,dozzzzer,2023-10-27T11:03:59Z,"@saintmatthieu @Paul-Licameli 

- when rendering the clip that has trimmed envelope points and then dragging that clip, the trimmed envelope points re-appear:

https://github.com/audacity/audacity/assets/70063970/5e61ed5e-ba0c-45df-88c3-74e45dd55a19

"
1782722745,5398,saintmatthieu,2023-10-27T11:04:56Z,"> @saintmatthieu @Paul-Licameli
> 
> * when rendering the clip that has trimmed envelope points and then dragging that clip, the trimmed envelope points re-appear:
> 
>  Screen.Recording.2023-10-27.at.11.58.55.video-converter.com.mp4

This video is linked in my previous comment."
1782851468,5398,dozzzzer,2023-10-27T12:41:42Z,"@saintmatthieu @Paul-Licameli 

1. add some envelope points at the beginning of the clip
2. shrink/stretch the clip
3. trim away the envelope points
4. right-click and select ""render clip stretching""
5. try to add more envelope points on the resulting clip

Actual result: only one envelope point can be added, at the very beginning of the clip


https://github.com/audacity/audacity/assets/70063970/dc9edbac-7241-47ec-b275-6c8c2a8a6c95

"
1783027097,5398,Paul-Licameli,2023-10-27T14:36:43Z,"Reapproved
"
1783027098,5398,Paul-Licameli,2023-10-27T14:36:43Z,"Reapproved
"
1784691451,5398,dozzzzer,2023-10-30T08:19:19Z,Tested
1033288574,2536,Paul-Licameli,2022-02-09T02:48:23Z,"Wow!  This is wonderful.  Thanks for figuring all of this out.

I have not approved all yet -- I want to read and understand all of AudacityTesting.cmake.

Very likely those CMake functions will need enhancement with more options.  Journal tests may need to run with a certain prior environment setup, such as having a particular audacity.cfg file already in place at startup, and then the environment would need cleanup after the test.  CTest gives you the means to do such things by defining setup and teardown commands as ""test"" too in a certain dependency graph.  We may also want to associate labels with test so we can filter them and run subsets.

But all that can be future work and no reason to delay this.
"
1044375973,2536,Paul-Licameli,2022-02-18T11:32:28Z,"I'm trying it in the Xcode build but I don't yet see how to build the tests.
"
1044377629,2536,Paul-Licameli,2022-02-18T11:34:13Z,"I couldn't build the tests because reconfiguring at the command line failed:

```
CMake Error at cmake-proxies/cmake-modules/AudacityFunctions.cmake:524 (add_subdirectory):
  The source directory

    /Users/paullicameli/Github/audacity/libraries/lib-strings/tests

  does not contain a CMakeLists.txt file.
Call Stack (most recent call first):
  cmake-proxies/cmake-modules/AudacityFunctions.cmake:563 (audacity_module_fn)
  libraries/lib-strings/CMakeLists.txt:33 (audacity_library)
```"
1044380487,2536,Paul-Licameli,2022-02-18T11:37:08Z,"> 

Oh forget that!  The directory tests was a bit of junk just on my own file system, from my own experiements with tests.
"
1044380862,2536,crsib,2022-02-18T11:37:31Z,"This looks to be your local issue, lib-strings doesn't have tests directory. 

I think this is a leftover from the time you explored CTest"
1044381896,2536,Paul-Licameli,2022-02-18T11:38:32Z,"OK now I see tests in the Xcode browser.  Waiting to build and run them.
"
1044382648,2536,Paul-Licameli,2022-02-18T11:39:16Z,"There are all those CI build failures however
"
1044383368,2536,crsib,2022-02-18T11:39:58Z,"Gosh Python world is sad :-( 

https://github.com/aws/aws-sam-cli/issues/3661"
1044384122,2536,Paul-Licameli,2022-02-18T11:40:39Z,"""Error: The process '/Users/runner/hostedtoolcache/Python/3.10.2/x64/bin/conan' failed with exit code 1""

I was glancing quickly at that, and misread the word ""headache"" in there
"
1044385626,2536,crsib,2022-02-18T11:41:54Z,"Some third-party library broke half of the world again...
And I had issues with it when I was doing offline Linux builds as well. It is simply improperly packaged."
1044390745,2536,Paul-Licameli,2022-02-18T11:46:03Z,"I have built the tests in XCode, and confirmed that build fails if I edit the test program to have a syntax error.

Now I added `REQUIRE(false)` and I want to observe the consequences of a test failure.  How?
"
1044395301,2536,Paul-Licameli,2022-02-18T11:48:59Z,"Aha, I see RUN_TESTS

Great, I see test outputs.  Now we might consider what other CTest options or stderr messages from Audacity might make this display more understandable.
"
1044396256,2536,crsib,2022-02-18T11:49:39Z,"There are different ways:

1. You can select a specific test as a run target on XCode (if you want to debug the failure)
2. You can build RUN_TESTS"
1044399155,2536,Paul-Licameli,2022-02-18T11:51:43Z,"The journal sanity test makes a lot of spam, and so will every journal test:
```
2: 06:47:42: Debug: Warning: command doesn't exist: 'Cut'
2: 06:47:42: Debug: Warning: command doesn't exist: 'Copy'
2: 06:47:42: Debug: Warning: command doesn't exist: 'Paste'
2: 06:47:42: Debug: Warning: command doesn't exist: 'Trim'
2: 06:47:42: Debug: Warning: command doesn't exist: 'Silence'
2: 06:47:42: Debug: Warning: command doesn't exist: 'Undo'
2: 06:47:42: Debug: Warning: command doesn't exist: 'Redo'
2: 06:47:42: Debug: Warning: command doesn't exist: 'ZoomIn'
2: 06:47:42: Debug: Warning: command doesn't exist: 'ZoomOut'
2: 06:47:42: Debug: Warning: command doesn't exist: 'ZoomToggle'
2: 06:47:42: Debug: Warning: command doesn't exist: 'ZoomSel'
2: 06:47:42: Debug: Warning: command doesn't exist: 'FitInWindow'
2: 06:47:42: Debug: Unrecognized accel key 'NUMPAD_ENTER', accel string ignored.
```

Let's have an issue to clean that up
"
1044407625,2536,Paul-Licameli,2022-02-18T11:57:16Z,"> And still, I have very that if you need to it for unit tests you have serious design issues and should reconsider them. `add_unit_test` is expected to be used only to create unit tests.

For unit tests, avoid fixtures for sure, but for the high level journal tests, fixtures could make sense.
"
1044413072,2536,Paul-Licameli,2022-02-18T12:00:44Z,"> I have a very strong opinion that unit test should return 0 on success

But again, consider journal tests.  Maybe we will want those to write stuff to stderr to be filtered, and we will want to define success and failure some other way based on outputs.  @Penikov might use capabilities like that.

"
1044417551,2536,crsib,2022-02-18T12:03:46Z,"Well, `add_journal_test` will be modified accordingly then :)

Like we can say `add_journal_test( fail.txt EXPECT_FAIL )` or similar. "
1044419973,2536,Paul-Licameli,2022-02-18T12:05:28Z,"> There are different ways:
> 
> 1. You can select a specific test as a run target on XCode (if you want to debug the failure)
> 2. You can build RUN_TESTS

1. Good, I have confirmed that I can put a break in a test executable and hit it in the debugger.
"
1044458649,2536,Paul-Licameli,2022-02-18T12:38:36Z,🥳 
1944557583,5952,Paul-Licameli,2024-02-14T20:41:26Z,"The build fails, in both commits.

Remember `-Daudacity_use_pch=NO` in your Cmake variables.
"
1944725317,5952,Paul-Licameli,2024-02-14T21:52:24Z,"I fix the build, try to run it, generate noise -- and there is a crash.
"
1944743607,5952,Paul-Licameli,2024-02-14T21:58:38Z,"So it was at least in a debug build.
"
1945622915,5952,saintmatthieu,2024-02-15T08:47:05Z,"@Paul-Licameli thanks for your comments and help, I just pushed fixes.
I moved back this ticket to the progress column because of https://github.com/audacity/audacity/pull/5952#discussion_r1489495326."
1945760811,5952,Paul-Licameli,2024-02-15T10:13:02Z,"The CI builds still fail
"
1946055941,5952,Paul-Licameli,2024-02-15T13:02:19Z,"The build is still failing
"
1946058814,5952,Paul-Licameli,2024-02-15T13:04:06Z,"You still need `<wx/frame.h>` in WaveClipUtilities
"
1946062386,5952,Paul-Licameli,2024-02-15T13:06:18Z,"And the last commit causes new compilation errors
"
1959566668,5952,chinakov,2024-02-22T14:28:32Z,"![image](https://github.com/audacity/audacity/assets/139755141/7329b223-7b60-479c-b6a3-b1d99b00c488)

https://github.com/audacity/audacity/issues/5959 this has not been fixed by this PR. The issue is still present on Linux."
1147756897,3030,Paul-Licameli,2022-06-06T18:32:21Z,"Still unchecked in the issue is the box ""(like https://github.com/audacity/audacity/commit/519989483c227c1ae5a2ce13f225a4d790616b5f) Rewrite export and saving of presets, using StoreSettings on the ""scratch"" handles in the Effect object""

Will you add a commit for that, or is it unclear how to proceed?
"
1147768194,3030,Paul-Licameli,2022-06-06T18:43:33Z,"This completes a round of review
"
1148749404,3030,Paul-Licameli,2022-06-07T14:26:11Z,"`SaveSettings` and `LoadSettings` should not use `ForEachParameter` after all, but iterate over the map (when saving) or, as in Vitaly's original, iterate over the config file (when loading).

I'm reversing what I said before, but in fact approving a point you raised a few weeks ago.

This is what I ended up doing in #3034 which fixes bugs recently introduced into AudioUnits.
"
1151351470,3030,pietro68,2022-06-09T16:31:23Z,"> `SaveSettings` and `LoadSettings` should not use `ForEachParameter` after all, but iterate over the map (when saving) or, as in Vitaly's original, iterate over the config file (when loading).

To do this job, I need to know what are the user steps to perform which would trigger `SaveSettings` and `LoadSettings`. I still have no idea how to do it. I remember vaguely that they'd be called when using Audacity's macro system, which I could not reproduce, or that they could be triggered after some PR from Vitaly would be merged, but I have no idea how.

Another thing that would help me, is to know the name and location of the file that `SaveSettings` writes to and `LoadSettings` reads from.

Finally, Vitaly's original code (and my changes too, up until now) would save/load the settings using `MakeAutomationParameterKey`, which uses not only the parameter's numeric ID but also its ""shortTitle"" or its ""title"" - which I guess is a descriptive text.

If I we want/need to keep doing things this way, then I also must extend the VST3Settings map definition to accomodate this descriptive string, kind of what was done for the AudioUnits wrapper in a recent approved PR. Should I do this? or are numeric IDs enough, to build the key for the key-values pairs in the file?


"
1151720590,3030,Paul-Licameli,2022-06-09T23:50:21Z,"To exercise `SaveSettings` and `LoadSettings`, I think you can use the button that says ""Manage"" (for plain UI) or shows the ""hamburger"" icon (for fancy UI) and save a user preset, then load the same again.

Or you can modify your build so that `SupportsRealtime` is true for VST3 -- not expecting all else to work, but it will allow you to make an Audacity project with an effect stack in a track, save it, then reopen it.
"
1155281569,3030,pietro68,2022-06-14T14:36:01Z,closing this PR and moving to #3070 
1259285145,3696,DavidBailes,2022-09-27T10:11:43Z,"I'm not sure what the current design spec is for this, but what is read by screen readers is different from my initial suggestion: https://github.com/audacity/audacity/issues/2779#issuecomment-1093835971
What I was expecting was that when you tabbed to the button containing the playback/recording icon and the slider, screen readers would read something like
""record meter peak -30db button"", and 
""recording volume slider -4db"",
respectively.

However, what gets read by nvda when tabbing to the button and slider is:
""Record  button"", and
""Record Meter  Peak -60 dB  slider  46""
respectively.
I think the current implementation is less clear and more confusing compared to what I was expecting.

There are also some issues to do which how the slider is read when its value is changed, but these are secondary to the above issue.


"
1260620044,3696,DavidBailes,2022-09-28T09:14:05Z,"@LWinterberg . Given that the scale for the recording volume slider presented visually is wrong (https://github.com/audacity/audacity/issues/3690),
I think it would be better if the values of the volume slider read by screen readers were in the range 0 to 100, rather than incorrect ones in the range -60db to 0db. I think that would be far less confusing. What do you think?"
1263581171,3696,Tantacrul,2022-09-30T13:31:58Z,"EDIT: ignore my previous comment. Actually, I think we should still display the meter the way it is for recording. However, we should display a % value while dragging the slider - and I think this should be passed to the screen reader too."
1266697471,3696,vsverchinsky,2022-10-04T09:55:50Z,"@DavidBailes @Tantacrul I've updated a PR, can you please tell if it's alright now?"
1267275190,3696,Tantacrul,2022-10-04T16:40:15Z,"My days! I am really struggling to figure out how to tab to the record volume slider (using MacOS) in order to change it and hear a screenreader 😦.

Is it mainly a Windows thing? Need tutorial!

Apart from that two quick points:

When changing the slider I can see a colon before the %. So it says **:77%**. I suppose it should say **Recording volume: 77%**. The same with the play volume too.
<img width=""880"" alt=""image"" src=""https://user-images.githubusercontent.com/21022311/193874500-88738b99-6944-44ed-b3b0-124980fa977a.png"">

When I hover over the 'Add effect' button, Voice Over (MacOS) calls it a 'Taste'. (!) Are we aware of this strangeness? I guess This should be raised as a separate issue. I was just curious if anyone had any thoughts.
<img width=""632"" alt=""image"" src=""https://user-images.githubusercontent.com/21022311/193875281-05ee5bce-f58d-458e-83f4-96d603caad6f.png"">


"
1268397874,3696,DavidBailes,2022-10-05T12:54:34Z,"> @DavidBailes @Tantacrul I've updated a PR, can you please tell if it's alright now?

Just to let you know that I've started to have a look at this. It clearly isn't complete, and I'll add detailed comments soon."
1271649248,3696,DavidBailes,2022-10-07T14:10:37Z,"Some comments on the volume sliders:
1. The names of the sliders are currently ""record meter"" and ""play meter"". They are not meters! In 3.1.3 the names of the sliders in the mixer bar were ""recording volume"" and ""playback volume"". The current names should be changed to something similar to those in 3.1.3.
2. The step sizes for the arrow keys and page up/down keys are too big. They should be the same as in 3.1.3: step size of 1 percent for arrow keys, 20% for page up/down.
3. When as slider is the focus, the value of the slider is read by the screen reader periodically, for no good reason. This is caused by the value change event created in MeterPanel::UpdateSliderControl(). The creation of this event should be removed from this function.
4. When the sliders are changed using the keyboard, the new value is not read by screen readers. I presume that adding the creation of a value change event at some suitable point in MeterPanel::SetMixer() would fix that.

Comments on the class MeterAx:
1. This looks like it's only been partly changed to be appropriate to the sliders - for example, MeterAx::GetName() is still the code from when this was a meter, not a slider. (Code along these lines will be needed for the accessibility of the meter buttons ).
2. ASliderAx provides a good template for what MeterAx should be like. Note that ASliderAx::GetName() isn't actually needed, as WindowAccessible::GetName() does the same thing.
3. Currently the behaviour of some of the member functions of MeterAx depends on the value of MeterPanel::mAccSilent, however this no longer needs to be the case, now that MeterAx represents a slider. MeterPanel::mAccSilent  was introduced at commit 3d420e01, and  may well be needed for the accessibility of the Meter buttons.

I'll add some comments on the meter buttons shortly."
1272119855,3696,Paul-Licameli,2022-10-07T22:04:03Z,"I'm done with this round of review.
"
1274649115,3696,DavidBailes,2022-10-11T12:58:09Z,"Some comments on the meter buttons. The names of these buttons read by screen readers does not get updated to reflect the updated peak, whether their is monitoring, and whether there has been clipping.
One way of fixing this would be as follows:
- derive a class from Abutton, say called MeterButton, and use it instead of AButton in this toolbar.
- In the MeterButton class override the function wxString GetName() const, and in this function return a string with the same contents as the string produced by MeterAx::GetName(). (MeterAx now represents a slider, so MeterAx::GetName() should be removed).

With respect to fully transferring the fix in commit https://github.com/audacity/audacity/commit/3d420e019ceb7aa0d0d86b51fb44a17680eb34c4,  once the accessibility names of the buttons are correct, I can check whether anything further needs doing about this. There may need to be a minor modification to AButtonAx to give it a silent mode."
1274804383,3696,DavidBailes,2022-10-11T14:39:10Z,"> My days! I am really struggling to figure out how to tab to the record volume slider (using MacOS) in order to change it and hear a screenreader 😦.

Testing with commit 700256 on MacOS
- I can tab to the sliders
- After pressing VO+Shift+Down arrow to interact with one, I can use the arrow keys to change the value of the slider
- VoiceOver does not automatically read the new value of the slider when it is changed - don't think it's ever done this for sliders in Audacity.

> 
> When I hover over the 'Add effect' button, Voice Over (MacOS) calls it a 'Taste'. (!) Are we aware of this strangeness? I guess This should be raised as a separate issue. I was just curious if anyone had any thoughts. <img alt=""image"" width=""632"" src=""https://user-images.githubusercontent.com/21022311/193875281-05ee5bce-f58d-458e-83f4-96d603caad6f.png"">

Fortunately, I can't reproduce this.

"
1275761496,3696,DavidBailes,2022-10-12T08:08:30Z,"> Some comments on the meter buttons. The names of these buttons read by screen readers does not get updated to reflect the updated peak, whether their is monitoring, and whether there has been clipping.
> One way of fixing this would be as follows:

Another way of fixing it would be:
- Derive a class from AButtonAx, say MeterButtonAx, and set this as the accessible for the AButton in this toolbar.
- In the MeterButtonAx class override the function wxAccStatus AButtonAx::GetName, and in this function create a string with the same contents as the string created by MeterAx::GetName(). (MeterAx now represents a slider, so MeterAx::GetName() should be removed).

Again, there may need to be some minor fixes to fully transfer the fix in commit https://github.com/audacity/audacity/commit/3d420e019ceb7aa0d0d86b51fb44a17680eb34c4.

"
1285384025,3696,petersampsonaudacity,2022-10-20T11:43:34Z,"@dozzzzer @LWinterberg 

Testing on W19 with @vsverchinsky Vitaly's branch:  audacity-win-3.2.2-alpha-20221018+915aba6-x64

In this branch build:

a) the sliders on the Meter Toolbars now have the value of the current position

b) the tool-tip nicely updates when the slider is moved

![image](https://user-images.githubusercontent.com/50205984/196938888-86539936-5718-4bd5-a1d9-d55668bb69c7.png)

@DavidBailes  David, are these readable by screen readers?  My tests with NVDA seems to indicate that this is OK, but I am no accessibility expert.
"
1286768246,3696,DavidBailes,2022-10-21T10:31:28Z,"Comments on the meter buttons in the latest commit:
- if the meter is clipped, this is not read by a screen reader. In bool MeterPanel::IsClipping() const, it should be mBar[c].clipping, not mBar[c].isclipping, as in the old MeterAx::GetName().
- when appropriate, the screen reader should read ""monitoring"" or ""active"", but not both, as in the old MeterAx::GetName().
- the accessibility name does not include the current peak level, as in the old MeterAx::GetName(). In MeterToolBar::Populate(), the accessibility names of the buttons should just be set to ""record meter"" and ""playback meter"", as the peak level should be included in MeterButtonAx::GetName().
- When the button is pressed by pressing Enter, there is an unwanted ""beep"" indicating an invalid action. See also https://github.com/audacity/audacity/issues/3484"
1287012872,3696,petersampsonaudacity,2022-10-21T14:03:30Z,"@vsverchinsky  and @crsib 

since Vitaly's branch build audacity-win-3.2.2-alpha-20221018+915aba6-x64
https://github.com/audacity/audacity/actions/runs/3272357779

at least fixes:    #3810  Hovertext tooltips for recording and playback sliders no longer show the values
and this is a **_very_** useful improvement for users,

is there any chance that we could pull this fix right now (for 3.2.2) while the further important accessibility issues that @DavidBailes raises can be dealt with separately - leaving this PR thread and #3230 still open - while closing off #3810.

Bearing in mind that #3810 is a recent regression issue introduced in 3.2.0 with the new combined Meter/Mixer toolbars. ?"
1288661398,3696,DavidBailes,2022-10-24T08:43:17Z,"> * When the button is pressed by pressing Enter, there is an unwanted ""beep"" indicating an invalid action.

You may well be aware of this already, but there's a comment in void MeterPanel::OnKeyDown(wxKeyEvent &evt) about avoiding a beep."
1291925036,3696,vsverchinsky,2022-10-26T11:59:46Z,">the accessibility name does not include the current peak level, as in the old MeterAx::GetName(). In MeterToolBar::Populate(), the accessibility names of the buttons should just be set to ""record meter"" and ""playback meter"", as the peak level should be included in MeterButtonAx::GetName().

@DavidBailes Do I understand correctly that button name should include **peak hold** value and the slider should include **peak** value (`DecibelScaleCutoff`)?"
1291983393,3696,DavidBailes,2022-10-26T12:48:50Z,"> @DavidBailes Do I understand correctly that button name should include **peak hold** value and the slider should include **peak** value (`DecibelScaleCutoff`)?

- The slider should NOT include the peak value.

- The button name should include the peak hold value, as it did in the old MeterAx::GetName().  (And the order of phases that make up the name should remain the same.) Snippet of old code:

      float peak = 0.;
      bool clipped = false;
      for (unsigned int i = 0; i < m->mNumBars; i++)
      {
         peak = wxMax(peak, m->mBar[i].peakPeakHold);
         if (m->mBar[i].clipping)
            clipped = true;
      }

      if (m->mDB)
         *name += wxT("" "") + wxString::Format(_("" Peak %2.f dB""), (peak * m->mDBRange) - m->mDBRange);
      else
         *name += wxT("" "") + wxString::Format(_("" Peak %.2f ""), peak);

      if (clipped)
         *name += wxT("" "") + _("" Clipped "");
   }"
1305388209,3696,DavidBailes,2022-11-07T10:16:54Z,"@Paul-Licameli . I know you're busy, but could you review this. I may want to submit a fix for another bug, and want to avoid conflicts when it's merged."
1305470245,3696,Paul-Licameli,2022-11-07T11:28:49Z,"> @Paul-Licameli . I know you're busy, but could you review this. I may want to submit a fix for another bug, and want to avoid conflicts when it's merged.

Very nearly done
"
1306989752,3696,petersampsonaudacity,2022-11-08T10:33:29Z,"@crsib @vsverchinsky 

So now this has been approved by @Paul-Licameli  and @DavidBailes  - how does this get pulled so it can be tested in a 2.3.3 alpha or beta?"
1307106922,3696,vsverchinsky,2022-11-08T12:08:52Z,"@dozzzzer did yet complete testing it, right?"
1307216751,3696,dozzzzer,2022-11-08T13:22:55Z,"> @dozzzzer did yet complete testing it, right?

Not yet."
1308611679,3696,petersampsonaudacity,2022-11-09T11:29:27Z,"Note that latest 3.3.0 alpha:  audacity-win-3.3.0-alpha-20221109+fe50013-x64-msvc2022

does **_not_** yet have thus merged in.

Looks good on latest 3.2.2.beta:  audacity-win-3.2.2-beta-20221109+f0bb347-x64-msvc2022
"
1619005357,4867,Paul-Licameli,2023-07-03T18:51:33Z,First round of review is done.  Not approved yet.
1619432976,4867,saintmatthieu,2023-07-04T03:52:32Z,"I've noticed a problem.

1. I create a label track, add a label at time t=1.
2. I half the project tempo, the label goes to t=2, as expected.
3. I undo with ctrl+Z : now the label is at time t=0.5.

Haven't verified this, but I guess this is because the label track is copied for undo purposes. When undoing, it replaces the track modified in the last step. That would fit:

1. I create a label track, ...
2. I half the project tempo, ... => and ""undo-list"" label track is created beforehand, with label at t=1.
3. I undo ... => the track in the undo list replaces the project's track, with label at t=1, but then the time-signature restorer calls OnProjectTempoChange. So the original label position is restored, but then time-stretched.

Don't know the solution yet.

"
1619449318,4867,saintmatthieu,2023-07-04T04:12:34Z,"Looks like I solved it, but it'll be worthwhile reviewing with care."
1619924346,4867,saintmatthieu,2023-07-04T09:51:02Z,"> Looks like I solved it, but it'll be worthwhile reviewing with care.

I am more confident now."
1620015314,4867,Paul-Licameli,2023-07-04T10:48:49Z,"Is there now only one commit?
"
1620031385,4867,saintmatthieu,2023-07-04T11:00:05Z,"> Is there now only one commit?

Yes."
1620065505,4867,Paul-Licameli,2023-07-04T11:23:31Z,"Now that ProjectTempoListener.h is gone, you might also put all of that class inside the anonymous namespace, making the symbol tables a tiny bit smaller and link time a tiny bit less.

Remembering this in similar cases might have some cumulative effect.  Don't ask me to quantify.
"
1620081562,4867,Paul-Licameli,2023-07-04T11:35:26Z,"It's good enough to merge now.  Compilation is fixed.

Suggestions only to use the anonymous namespace, and skip the needless construction step.

Update the PR or issue description with what QA should test.

The expectation is that three of the four track types update themselves correctly for changes of project tempo, and also that undo and redo work -- and also, cut-copy-paste, even between projects.

"
1620083156,4867,Paul-Licameli,2023-07-04T11:36:40Z,"Persistency too should be on the QA checklist
"
1628843008,4867,dozzzzer,2023-07-10T12:15:59Z,@Paul-Licameli could you please rebase this PR on the more recent `master` (containing the fix for that error of having mismatched sample rates when opening a project) so that I could make sure that persistency works?
1628858186,4867,Paul-Licameli,2023-07-10T12:26:51Z,"> @Paul-Licameli could you please rebase this PR on the more recent `master` (containing the fix for that error of having mismatched sample rates when opening a project) so that I could make sure that persistency works?

I did that, and resolved its conflicts with my recently merged work.

Persistency of project tempo in the clips is not yet implemented in this pull request.
"
1628862219,4867,Paul-Licameli,2023-07-10T12:29:45Z,"What is expected to work, is that note, label, and time tracks correctly adjust how they are drawn as project tempo changes.

The work for wave tracks isn't yet here.
"
1826759930,5685,SteveDaulton,2023-11-26T11:38:06Z,"Here we can see that there is  slight clipping of the negative going waveform in the right channel:

![First Track000](https://github.com/audacity/audacity/assets/11681097/2cb6cc02-5aaf-48c8-9db6-443c4ec02730)
"
1826761382,5685,SteveDaulton,2023-11-26T11:45:54Z,"What's an appropriate level to set the Limiter threshold?

![First Track001](https://github.com/audacity/audacity/assets/11681097/a33212a4-cacb-4b67-9a46-9ec7f80585a9)


Looking more closely at the peaks, I think I may need a bit of compression before applying the limiter.

![First Track002](https://github.com/audacity/audacity/assets/11681097/eef9319f-3422-434d-b618-81bd4c4ce3d1)

"
1826762142,5685,SteveDaulton,2023-11-26T11:49:56Z,"Fixing the vertical scale might be useful.

![First Track003](https://github.com/audacity/audacity/assets/11681097/a189dde0-d909-4d4e-ac5d-337d2b121ae1)

![First Track004](https://github.com/audacity/audacity/assets/11681097/78dbcab1-8b5c-4296-8bdb-fb179535719e)
"
1827898147,5685,petersampsonaudacity,2023-11-27T14:05:41Z,"I think the big plus-sign cursor for advanced vertical zooming in Spectrogram view looks most odd, cheap-and-tatty rather than carefully crafted.  Maybe it's just too big?

But basically I don't see what was wrong withe the old cursor, the magnifying glass.

-----------------------------------------------------------------------

> Fixing the vertical scale might be useful.

In Spectrogram view it can shrink to a very thin bar with no reticules or numbers at high V-Zoom levels:
![image](https://github.com/audacity/audacity/assets/50205984/7ccb3765-1da3-461a-9cce-4f58250d3785)
"
1828177292,5685,petersampsonaudacity,2023-11-27T16:27:40Z,"I did some testing on old versions - and it appears that Advanced Vertical zooming was present from at least 1.2.6 onwards, so Dominic implemented that very early on.  And in those days it was only waveforms, no Spectrogram views back then.

a) The cursor back then was the little magnifying glass with the plus sign in it (which changed to a magnifying glass with a minus sign when you you used Shift modified left click to reverse the vertical zoom.

b) you could specify the vertical range to be zoomed with the click and drag in the Vertical Scale 

c) There was no right-click context menu

d) But the vertical zooming with a left mouse button click in the vertical scale could be used many times - and it centred on where the cursor was in the Vertical Scale.  In contrast the simple non-advanced context menu zoom in on the waveform seems to be limited to just one zoom in in this branch _(this limitation is not new it is in 3.4.2 and 2.4.2, so we have lost functionality there c.f. 1.2.6)_


e) in 1.2.6 the vertical scale was handled well even with a lot of zooming in

And I think that @DavidBailes is absolutely right in that it was only ""Advanced"" vertical zooming for many years and many versions of Audacity.  And is was only later when James introduced the new ""Simple"" vertical zooming accessed from the Vertical Scale context menu that the old logstanding vertical zoom acquired the label ""Advanced""

### TL;DR
**I would would _strongly_ like to see Advanced vertical zooming retained for Waveforms as well as Spectrograms.**"
1828500689,5685,LWinterberg,2023-11-27T19:54:00Z,"Having a separate normal zoom and advanced zoom is an extremely poor allocation of functionality. Another example of this are cut lines, which, despite having been introduced in 2006 IIRC, have a mere 23 mentions in the forum. Having these features and having them off by default adds a *lot* of complication for no real benefit for the *vast* majority of users.

For spectrograms, Steve was able to [demonstrate](https://youtu.be/x8Tk734GbjE) how the drag-to-zoom plays well into our other tools, namely the drag-to-make-box selection. Hence why this PR enables it for that use by default. 

For waveforms, I do not see this this level of usefulness for the drag-to-zoom feature. What I do see however is a lack of functionality: If you have a recording or a stem at -10 or -20dB or so, it currently is very hard to quickly zoom in while keeping the 0-line centered. This PR makes this much more used feature a lot faster. Note that ctrl+scroll and shift+scroll are still possible and may be used to create all of the situations shown in this thread. 

For neither view I see a good argument to keep click-to-zoom-in, shift-click-to zoom-out or shift-right-click-to-reset. The former is *way* too easy to trigger accidentally and the latter two are stupidly hard to discover. Just imagine, you just recorded something, accidentally clicked the vertical ruler and now it *looks* like your waveform is hopelessly off-center and clipping hard, and ctrl+z deletes the recording you just made. That's extremely panic-inducing, and we will not keep it, and certainly not by default. 

> I think the big plus-sign cursor for advanced vertical zooming in Spectrogram view looks most odd, cheap-and-tatty rather than carefully crafted. Maybe it's just too big?

Magnifying cursor implies click-to-zoom (compare to how browsers behave when viewing an image in a new tab). I use the default crosshair cursor here (which, aside, would be the correct one for the box selection in the spectrogram as well). But what i really need is a rotated I-beam-looking thing, or something else which is pretty clearly a horizontal line.

> In contrast the simple non-advanced context menu zoom in on the waveform seems to be limited to just one zoom in in this branch

That's a bug in my branch, I'll fix it. use ctrl+scroll in the meantime."
1828584467,5685,LWinterberg,2023-11-27T20:51:22Z,">>  In contrast the simple non-advanced context menu zoom in on the waveform seems to be limited to just one zoom in in this branch

> That's a bug in my branch, I'll fix it. use ctrl+scroll in the meantime.

actually, I can't reproduce it. right-click > zoom in happily zooms in again and again for me. "
1829721008,5685,SteveDaulton,2023-11-28T12:12:59Z,"Rather that removing functionality that close to a quarter of responders to your own survey say that they use, maybe it would be better to redesign it in a way that is more discoverable and less prone to accidental clicking. For example, some audio apps use explicit zoom / pan controls on the track that operate in a similar way to scroll bars and are designed to look like zoom / pan controls.

By the way, testing https://github.com/LWinterberg/audacity/actions/runs/7011324514 on Linux, because the ""Advanced Vertical Zooming"" option is still available in the menu but non-function in any of the track waveform views, I predict that if Audacity is released like this, there will be a lot of people thinking that it is yet another thing that is broken.

Personally, I think that the way that ""Advanced Vertical Zooming"" was implemented (up to and including 3.4.2) is sub-optimal for the reasons that you describe. I also think that Advanced Vertical Zooming is a very valuable feature for advanced audio editing that must be retained. In my opinion, this pull request should be closed and an ""Enhancement"" issue drafted for a better implementation of current functionality."
1829734581,5685,LWinterberg,2023-11-28T12:21:57Z,"> because the ""Advanced Vertical Zooming"" option is still available in the menu but non-function in any of the track waveform views, I predict that if Audacity is released like this, there will be a lot of people thinking that it is yet another thing that is broken.

https://github.com/audacity/audacity/pull/5675 is the companion PR which removes the preferences."
1831805019,5685,LWinterberg,2023-11-29T12:29:33Z,"The zoom got unbroken now. Using ctrl+scroll and shift+scroll, you can do all the advanced zooming you want now, plus keep the benefit of it centering around 0 if you never offset the view."
1831890186,5685,petersampsonaudacity,2023-11-29T13:23:40Z,"Testing on W10 with latest branch for this:  audacity-win-3.5.0-alpha-20231129+dd45d48-x64

@LWinterberg  
In the Vertical Scale context menu in Spectrogram view what is the difference between **Zoom to Fit** and **Reset Zoom** ?
![image](https://github.com/audacity/audacity/assets/50205984/df6fed54-6c9b-49e1-b329-362fa03a8709)


In contrast, I note that Waveform view only has **Reset Zoom**"
1831918158,5685,SteveDaulton,2023-11-29T13:40:46Z,"I don't need to zoom asymmetrically on the waveform very frequently, but as in the examples above, I do sometimes need to do so. Will I still be able to do that when I need to?"
1831968279,5685,LWinterberg,2023-11-29T14:09:50Z,"> I don't need to zoom asymmetrically on the waveform very frequently, but as in the examples above, I do sometimes need to do so. Will I still be able to do that when I need to?

Definitely yes. Ctrl+scroll zooms in and out, Shift+scroll moves the wave up and down. "
1831975884,5685,SteveDaulton,2023-11-29T14:14:16Z,"> Ctrl+scroll zooms in and out, Shift+scroll moves the wave up and down.

FWIW, I find that a lot more cumbersome than just click and drag, especially with the dB scale where there are three different mouse-wheel actions."
1831989780,5685,LWinterberg,2023-11-29T14:21:36Z,"> In the Vertical Scale context menu in Spectrogram view what is the difference between Zoom to Fit and Reset Zoom ?

One goes to half the sample rate of the track, one goes to ""normal"" zoom (I think 20k?). There's a noticable difference between them if you go into the >48k sample rates, but for 44.1k it's very similar."
1832492012,5685,Paul-Licameli,2023-11-29T18:38:32Z,"> > In the Vertical Scale context menu in Spectrogram view what is the difference between Zoom to Fit and Reset Zoom ?
> 
> One goes to half the sample rate of the track,

Also known as the Nyquist frequency, beyond which, any higher frequency content you might have sampled is aliased.

(Study rising square wave chirps, contrasting Square with Square, no alias.  The overtones of the perfect square wave are ""bouncing off the ceiling"".  But Square, no alias only sums lower terms of the Fourier series, making a wave not exactly square.)

<img width=""1292"" alt=""image"" src=""https://github.com/audacity/audacity/assets/11670369/9a22e4ab-7800-4dc7-af6e-cc604a60e743"">


<img width=""1292"" alt=""image"" src=""https://github.com/audacity/audacity/assets/11670369/36b09064-2122-45cc-82fc-fa917cb0847d"">

Here you see the ""Gibbs Effect"" at the start of the second chirp -- a certain mathematically unavoidable overshooting that happens when you truncate the Fourier series.

<img width=""1292"" alt=""image"" src=""https://github.com/audacity/audacity/assets/11670369/3cc88af6-28e9-4d74-99d3-0ebc48d44429"">

> one goes to ""normal"" zoom (I think 20k?). There's a noticable difference between them if you go into the >48k sample rates, but for 44.1k it's very similar.

"
1832513121,5685,Paul-Licameli,2023-11-29T18:54:04Z,"> > In the Vertical Scale context menu in Spectrogram view what is the difference between Zoom to Fit and Reset Zoom ?
> 
> One goes to half the sample rate of the track, one goes to ""normal"" zoom (I think 20k?). There's a noticable difference between them if you go into the >48k sample rates, but for 44.1k it's very similar.

Oh yeah -- I forgot this commit 3142060 where I changed default Spectrogram preferences according to Martin's wishes.  But for long before that, maximum frequency preference defaulted to 8000 Hz not 20000.

Zoom reset readjusts the top of the scale to whatever that preference is (but strangely, not the bottom -- which will be 0 for linear or 1 for logarithmic).

Zoom to fit goes up to Nyquist.

"
1832518458,5685,Paul-Licameli,2023-11-29T18:58:01Z,"Incidentally too, individual tracks may have differently adjusted spectrogram settings unlike the defaults in Preferences.  But I think it's not wholly satisfactory how all of that works.  There is a ""use Preferences"" checkbox to reset all to defaults.  But maybe you would want to do the opposite?  Assign the settings of THIS track as new defaults?  There is also no way to have a track override just some of the settings but keeping all others the same as the preferences.

Explore this and see what I mean.  Maybe it's matter for another enhancement request.
"
1832582850,5685,Paul-Licameli,2023-11-29T19:36:02Z,"I'm pleased to see you start figuring out more substantial C++ changes, Leo.

About the mouse wheel actions:  there is Shift+wheel, and Ctrl+wheel (or pinch and spread on a touch pad), but did you observe that the latter can also be Shift-modified too?  That causes, for log dB view only, another change:  variation of the bottom of the dB scale.

Consider whether you like that, or want to rebind it, or mention it in tool tips.

I'm also reminded that I find the fineness of mouse wheel control for these things a bit unsatisfactory.
"
1833609398,5685,Paul-Licameli,2023-11-30T11:46:08Z,"> This dispels my doubt about discoverability. Rely on the tooltips.

Actually it's not tooltips, it's status bar messages, which are easier to overlook, but still it is something.
"
1833618156,5685,Paul-Licameli,2023-11-30T11:52:29Z,"Or did you decide otherwise because those shortcuts are not mentioned in the status bar message, which is already long?
"
1833647482,5685,petersampsonaudacity,2023-11-30T12:10:25Z,"Testing on W10 with @LWinterberg 's latest branch:  audacity-win-3.5.0-alpha-20231130+9817f6c-x64

I am somewhat surprised to find that while the Vertical click&drag to define a vertical zoom region - we still have it retained in the Note (MIDI) tracks.

I'm still finding the ability to zoom to a VS click&drag vertical region a loss

Yes you can achieve the same or similar efffect with Ctrl and Shift modified mouse-wheel actions - but I find those a _**lot**_ more fiddly - with more clicking _(if Gale Andrews were still alive he'd be complaining about his RSI)_."
1838725191,5685,SteveDaulton,2023-12-04T14:14:37Z,This is very poor. You have removed functionality that even your own survey indicates is regularly used.
1838759068,5685,LWinterberg,2023-12-04T14:32:22Z,I have not removed functionality. I have removed a certain kind of interaction. 
1838818415,5685,petersampsonaudacity,2023-12-04T14:55:33Z,"Consider this simple project:
![image](https://github.com/audacity/audacity/assets/50205984/94e25eb2-6db2-4736-8a2f-8a1c3612202e)

1) I find it odd and inconsistent that when I hover my cursor over the bottom two, the spectrogram and the note track I get a cursor that allows me to still ckick&drag a spread for the vertical zoom.

2) note that the spready cursor icon is different for both use cases - a further inconsistency
a) the big plus sign for spectrogram
b) the old  magnifying glass for the Note track

I do like the new V-Zoomy menu structure - but I am failing to see why it is really necessary to remove the spready vertocal zoom selection for only the waveform view.

**Audacity has had that click&drag vertical zoom selection for over 20 years in the 1.2.x series.**
"
1838893198,5685,SteveDaulton,2023-12-04T15:32:21Z,"I'll rephrase:
This is very poor. You have removed _a certain kind of interaction_ that even your own survey indicates is regularly used."
1839162342,5685,petersampsonaudacity,2023-12-04T17:47:49Z,I've updated the manual for these changes
1133648532,2957,Paul-Licameli,2022-05-21T15:02:17Z,"I have made some suggestions for change.  Consider this round one of review.

I see this draft pull request is incomplete.  `StoreSettings` is defined but not yet used.

To complete the analogy with the first phase of statelessness for AudioUnits, we should also see SaveSettings and LoadSettings use only the intermediate VST3EffectSettings.
"
1135867008,2957,Paul-Licameli,2022-05-24T12:37:49Z,"None of the boxes in https://github.com/audacity/audacity/issues/2969 are yet ticked off, and some of these small commits are fixes of previous ones.

I think it's time for an interative rebase onto latest master, and also that the sequence of commits should address the checkboxes in the suggested sequence.

And as discussed, let's make a small commit before any others, to fix the error in registry paths that Pietro identified.
"
1141685032,2957,pietro68,2022-05-31T05:34:06Z,"This PR has been superseded by https://github.com/audacity/audacity/pull/3009 too, so I am closing it."
1565311985,4739,petersampsonaudacity,2023-05-27T09:57:31Z,"Testing on W10 with @Paul-Licameli 's branch build:  audacity-win-3.4.0-alpha-20230526+4a8eda0-x64

I confirm that the behavior reported in #4737 is now blocked in this branch build:
![image](https://github.com/audacity/audacity/assets/50205984/ff43a2e2-426b-4835-80e2-a0590d1a0f53)

**Track Format**
But note carefully that this fix does not block the creation of a stereo track from two single tracks each with a different **Sample Format**.

I tried with a 16-bit track and a 32-bit track - they could be merged into a single stereo track at 16-bit _(the 16-bit track was the upper track)._  And when split again they both reverted to their original bit formats 16-bit and 32-bit.
"
1565600100,4739,Paul-Licameli,2023-05-27T17:14:03Z,"> Testing on W10 with @Paul-Licameli 's branch build: audacity-win-3.4.0-alpha-20230526+4a8eda0-x64
> 
> I confirm that the behavior reported in #4737 is now blocked in this branch build: ![image](https://user-images.githubusercontent.com/50205984/241379278-ff43a2e2-426b-4835-80e2-a0590d1a0f53.png)
> 
> **Track Format** But note carefully that this fix does not block the creation of a stereo track from two single tracks each with a different **Sample Format**.
> 
> I tried with a 16-bit track and a 32-bit track - they could be merged into a single stereo track at 16-bit _(the 16-bit track was the upper track)._ And when split again they both reverted to their original bit formats 16-bit and 32-bit.

Thanks.  Yes, I should do other work to disallow mismatch of sample widths.

Did I do the right thing for rates?  An alternative to the prohibition might be a quiet resampling of the lesser rate to the greater.

Likewise for widths:  the narrower might quietly change to match the wider.  No dither would be needed, but storage requirements of the saved project might increase.

So should a join of channels with mismatched formats fail too with an error?

A third possibility (with either rates or channels) would be to ask the user.
"
1566032870,4739,petersampsonaudacity,2023-05-28T09:26:41Z,"> Did I do the right thing for rates? An alternative to the prohibition might be a quiet resampling of the lesser rate to the greater.

Well I like it throwing the error - but I'm no expert in such matters.

_I have written to Dominic to ask if he allowed this deliberately for some reason._


> Likewise for widths: the narrower might quietly change to match the wider. No dither would be needed, but storage requirements of the saved project might increase.

Folk already complain a lot about storage requirements increasing ...


> So should a join of channels with mismatched formats fail too with an error?

I would have thought so

 
> A third possibility (with either rates or channels) would be to ask the user.

That could also work - but would be complex if both rate and format were mismatched.  

But I would suggest that as a first step simple error trap(s) and error report(s) are fine.
But you may need a third message for where both the rate and the format are mismatched.


@LWinterberg @Tantacrul @DilsonsPickles 
_**The preferred approach is really a decision for the Muse design team, deciding if they prefer the simple error(s) or a corrective dialog.**_  

"
1566086136,4739,Tantacrul,2023-05-28T10:59:47Z,"@LWinterberg @DilsonsPickles - can we investigate a little bit what we should do here to be as gracefully and friendly to the user as possible? I feel we should try to make a decision about this.

> Did I do the right thing for rates? An alternative to the prohibition might be a quiet resampling of the lesser rate to the greater.

A part of me thinks that we should just do this and not ask the user any questions. However, there's going to be more to it than that methinks. A discussion for our design meeting, I feel! 
"
1566116715,4739,crsib,2023-05-28T12:12:28Z,"Resampling is generally lossy, I'm not sure that implicit resampling is a good idea"
1566140664,4739,petersampsonaudacity,2023-05-28T13:27:50Z,"> Resampling is generally lossy, I'm not sure that implicit resampling is a good idea

@crsib a VERY good point Dmitry
"
1566151916,4739,Paul-Licameli,2023-05-28T14:06:24Z,"> @LWinterberg @DilsonsPickles - can we investigate a little bit what we should do here to be as gracefully and friendly to the user as possible? I feel we should try to make a decision about this.
> 
> > Did I do the right thing for rates? An alternative to the prohibition might be a quiet resampling of the lesser rate to the greater.
> 
> A part of me thinks that we should just do this and not ask the user any questions. However, there's going to be more to it than that methinks. A discussion for our design meeting, I feel!

Remember the user might attempt to make a stereo track interactively, or there might be files saved before 3.4 that the user tries to load into new Audacity.

Whatever the resolution (disallow, fix quietly, or ask), the work of detecting the condition is necessary and I put that effort in for the rates, but not yet for the formats.

Actually, format mismatch between channels, with no rate mismatch, might be a tolerable thing with all the data restructuring, not presenting significant trouble for the time stretching calculations we need to do, but it's all the same a weird thing to do.
"
1566159151,4739,petersampsonaudacity,2023-05-28T14:36:18Z,"> ... or there might be files saved before 3.4 that the user tries to load into new Audacity.

A good point Paul.

So would you error trap that and offer to fix it by up-sampling to the higher of the two rates?

"
1566167798,4739,Tantacrul,2023-05-28T15:01:52Z,"I'm coming to the conclusion that I cannot solve this with a single sentence :)

Thanks all. We'll need to give it some proper thought. Perhaps explicit prompts are the way to go."
1566193837,4739,Paul-Licameli,2023-05-28T16:35:01Z,"> Resampling is generally lossy, I'm not sure that implicit resampling is a good idea

Is that really so?

If there is in fact no frequency content above 1/2 of the lesser sample rate (the lesser of two Nyquist frequencies), I think the Sampling Theorem tells us that theoretically you could down-sample from the from the higher rate to the lower, then up-sample again, without loss.

Practical calculations would truncate the tails of sinc functions though.
"
1566227637,4739,rbdannenberg,2023-05-28T18:47:21Z,"There's no inherent loss, but calculation is expensive. An old Smith and Gossett paper did an error analysis and said you need something like 50 multiply/adds and 50 accurate estimates of the sinc function to get 16-bit resolution (so even more for 20 or 24 bits). You can estimate the sinc function with interpolated table lookup, but that's two memory accesses, a float to int conversion (usually this is expensive) and additional float operations (times 50 or however many points you use) so it's much worse than just 50 multiply/adds. I don't think there are any tricks to do fast interpolated lookups. On the other hand, I think macOS uses implicit sample rate conversion in core audio so that you can open  an output device at any sample rate even while the device is playing a stream at some other rate. I wouldn't be surprised if they cut corners on conversion, and I strongly believe software sampling synthesizers do not do such high-quality conversion since the worst case numerically (e.g. full amplitude at 20kHz) is not something you'll find in listenable audio, so you can normally get away with fewer points (i.e. a more truncated sync function). I don't know what's common practice, and people I've asked told me the details were trade secrets."
1566315083,4739,Paul-Licameli,2023-05-29T00:02:30Z,"Thanks, Roger!

So, there is theory but then there is practice… and so quiet resampling is probably not a thing we should do and it isn’t what I did in this pull request."
1566728286,4739,crsib,2023-05-29T08:05:45Z,Not to mention that it would further increase the storage requirements!
1566746674,4739,saintmatthieu,2023-05-29T08:20:21Z,"My guess on how most users would feel about the negative side effects of the various solutions :
* Quality loss: unaware, indifferent
* Memory increase: unaware, understanding
* Error pop-up: perplexed, annoyed, clueless

I therefore would favour the silent conversion (both sampling-rate and bit-depth wise). Whatever user is aware of the quality loss is probably tech savy and will find a way around it, or look a default behaviour she could change."
1566753497,4739,crsib,2023-05-29T08:27:14Z,"> Memory increase: unaware, understanding

They are most certainly frustrated by the storage requirements, so definitely aware and not so understanding. Resampling a track will effectively keep the old track on your drive before you close Audacity (or even after, if you are unlucky), followed by a slow (and storage space demanding!) compaction. 

Trying to join two tracks with different sample rates sounds like a very rare corner case. I would much prefer to have a descriptive error message here, probably coupled with ""Resample to xxx"" button. "
1566764608,4739,petersampsonaudacity,2023-05-29T08:37:27Z,"> > Memory increase: unaware, understanding
> 
> They are most certainly frustrated by the storage requirements, so definitely aware and not so understanding.

Dmitry is right here :  we see many cases/complaints on the Forum (and here on GitHub) about the ballooning sizes of projects - so to add to this with hidden automatic resampling seem absolutely not the right thing to do.


>Trying to join two tracks with different sample rates sounds like a very rare corner case. I would much prefer to have a descriptive error message here, probably coupled with ""Resample to xxx"" button.

And in the light of @rbdannenberg  Roger's comments _(and @crsib Dmitry's earlier comments in this thread - and @Tantacrul 's too)_ - I **_fully_** support Dmitry's approach here - which is basically the approach that @Paul-Licameli  was originally pursuing with this PR ""fiix"".

"
1566783322,4739,saintmatthieu,2023-05-29T08:54:20Z,"> Resampling a track will effectively keep the old track on your drive

True, but if a user wants to do this, gets the error message and knows how to solve the problem, she will probably proceed with resampling manually, resulting in the same memory increase, no?"
1566784837,4739,petersampsonaudacity,2023-05-29T08:55:54Z,"> I see no issues with the proposed solution. I think design issues could be solved in a follow up pull requests.

A good decision.

But note that we also have to deal with mis-matched Formats - but @Paul-Licameli  is already aware of that.

And consideration needs to be given to Paul's earlier point about old projects already containing such stereo tracks with mis-matched rates and/or formats.
"
1566786988,4739,crsib,2023-05-29T08:57:14Z,"> resulting in the same memory increase, no

But it won't be implicit. On top of that, the user may want to resample to a lower rate, not to a higher one. Or just to pan tracks accordingly (in case there are no plans to apply a stereo effect)"
1566805943,4739,saintmatthieu,2023-05-29T09:10:05Z,"I like the panning idea, and suggest that the error message one way or another indicates this workaround. "
1567948421,4739,petersampsonaudacity,2023-05-30T07:57:29Z,"I've been discussing this with Dominic Mazzoni, the Godfather of Audacity.

His basic view
>Oh, that's definitely just a bug!   ...   I'm pretty sure I just never thought about that possibility."
1568602678,4739,petersampsonaudacity,2023-05-30T15:03:27Z,"Testing on W10 with @Paul-Licameli 's branch build the use case of ""attempting to load a project (made previously) with mismatching rates in a stereo track"".

I confirm that this is indeed blocked by Paul's branch build as @Ryan-Miller-Audacity reported in #4737 

But, the error message I get is:
![image](https://github.com/audacity/audacity/assets/50205984/26aa0577-655f-4809-996e-4a94a9a090ef)

This message is not helpful at all to the user:

**A) they would need to guess that they could manually fix this:**
1. open it in an earlier version of Audacity
2.  examine each stereo track in turn by splitting to mono, examining the TCP
3. resample requisite tracks to match sample rates
4. rejoin the mono tracks as stereo tracks
5. save the project
6. reopen project in latest Audacity

**B) Audacity offers no repair help**

Most folk are going to struggle to guess or even implement the A) manual fix.

So while we seem to have agreed we should just block such mismatched stereo track creation in 3.4.0 onwards with no automatic resampling - I think a _**good**_ case can be made for offering automatic resampling of channels in stereo tracks as part of the above error message.

Not many users are going to guess/intuit the step required for the A) manual fix - and I'm pretty sure we wouldn't want to put those manual steps in an error message.

"
1570094036,4739,Paul-Licameli,2023-05-31T12:09:22Z,"Rebased onto recent master; one commit added to change error messages; otherwise unchanged.
"
1571706198,4739,Paul-Licameli,2023-06-01T09:43:09Z,"Added one commit to fix the first of two problems described at https://github.com/audacity/audacity/issues/4737#issuecomment-1570799693
"
1571860161,4739,crsib,2023-06-01T11:17:44Z,Should I wait a bit for review this time?)
1571860804,4739,Paul-Licameli,2023-06-01T11:18:20Z,"Two more commits.  One more review, please.

Addressing the other problem in Ryan's comment.

The work to make higher-level file consistency checks work properly, incidental to disallowing the sample rate mismatch -- it wasn't complete.  Thanks @Ryan-Miller-Audacity , and I don't agree with leaving the problem to be fixed later.
"
1571863271,4739,crsib,2023-06-01T11:20:02Z,"> One more review, please.

Absolutely no problem with that :-) I was just joking a bit, sorry :-)"
1571894623,4739,crsib,2023-06-01T11:42:24Z,Please note the build failures. I think the fix is trivial - TentativeConnection should be exported
1571950325,4739,Paul-Licameli,2023-06-01T12:17:51Z,Sorry
1573381835,4739,petersampsonaudacity,2023-06-02T08:48:10Z,">  I think that it could be more helpful, and point users towards Tracks > resample (rather than the rate sub menu on a track's context menu) ...

@DavidBailes  these are the revised error messages that @Tantacrul and Team discussed and agreed on  
and are in @Paul-Licameli 's latest branch build

>So after discussing this with the team, we think this PR is good to go in terms of functionality.
>
>However, we need some copy improvements for the dialogs.
>
>Dialog 1: **Mono tracks must have the same sample rate in order to be combined into a stereo track**
>
>Dialog 2: **This project cannot be opened because it contains a stereo track with different sample rates. This functionality is no longer supported since the release of Audacity version 3.4**


Note that neither method of resampling is discussed here in these messages - it is up to the user tro decide whetherbtoi use te TCP dropdown or Resample Tracks from the menu, nor any other workaround like panning

And I think that is a good and right decision as otherwise the error messages become too long an overburdened and end up being TL;DR."
1573407955,4739,DavidBailes,2023-06-02T09:08:23Z,"> @DavidBailes these are the revised error messages that @Tantacrul and Team discussed and agreed on
> and are in @Paul-Licameli 's latest branch build

OK."
1581453769,4739,Paul-Licameli,2023-06-07T20:20:03Z,"Three added commits!

Not only completing fixes for the problems @Ryan-Miller-Audacity identified with saved files, with non-default sample rate, in a stereo track.

But also fixing (what QA won't detect using release builds) some assertion violations.

@crsib and the rest, one more round of review, please!
"
1582095834,4739,petersampsonaudacity,2023-06-08T08:03:44Z,"Testing on W10 with @Paul-Licameli 's branch:  audacity-win-3.4.0-alpha-20230607+5830faf-x64

### 1. Making a mismatched stereo track
This remains blocked by the revised error message:
![image](https://github.com/audacity/audacity/assets/50205984/6f684fa1-814a-404e-8d13-b867bfaa19bb)

### 2. Splitting a stereo track
Splitting to stereo and mono remain different with 
a) split to stereo producing panned-Left & panned-Right tracks
b) split to mono producing two center-panned tracks

### 3. Project opening with a mismatched stereo track
A project made and saved in 3.3.2 with a stereo track with mis-matched sample rates cannot be opened in Paul's branch:
![image](https://github.com/audacity/audacity/assets/50205984/5e45f338-34d1-465b-ba71-3ba026387671)


### 4. Ryan's issue
@Ryan-Miller-Audacity reported in #4737 

>If you have a stereo track (natively recorded not joined mono tracks, joined 2 mono tracks etc.) and update the sample rate for the track, save the project and attempt to reopen, the different sample rates detector will throw the error message even though there was no misuse/mismatching of rates on the tracks.

I confirm that Paul's new branch also fixes this issue - the project reopens correctly:
a) with no error message
b) with the stereo track at the changed sample rate

I tested by:
i) resampling from the Track Control Panel dropdown menu
ii) Tracks > Resample


### 5. Initial Import still changes the project rate
Audacity still **_silently_** changes the project rate if the first imported track's rate does not match the existing project sample rate.
This is issue  #4448 which is now exacerbated as the Project Sample Rate is no longer displayed on the main Audacity window in the Selection Toolbar.

"
1558767352,2805,saintmatthieu,2023-05-23T08:18:37Z,- [ ] There are track selection commands whose implementation were modified by `264ea9f`. I couldn't find them anywhere in the UI so don't know how to test this but I suppose it is testable.
1558780996,2805,saintmatthieu,2023-05-23T08:27:07Z,"@Paul-Licameli in the test list you mention
> Splitting stereo track to mono replicates name, pan, gain, mute, solo*

- [ ] Why specifically to mono? Selectness should also be replicated."
1558856029,2805,saintmatthieu,2023-05-23T09:01:45Z,Thanks for the `PlayableTrack.h` clean-up.
1558911929,2805,saintmatthieu,2023-05-23T09:35:39Z,"- [x] I built `a95e16c` and crashed it by opening a mono wav file.

![image](https://github.com/audacity/audacity/assets/22740106/9042ce8f-c1eb-492a-91ff-ede2582f2772)

It's 100% reproducible but I can't hit any of the breakpoints I set over writings of `mStates` before it crashes.
Also happens just creating a new empty track."
1558982477,2805,saintmatthieu,2023-05-23T10:14:22Z,"Set status to ""request changes"" essentially for the crash. There's not much I can test until it's fixed. Not sure if the rest of my comments should result in changes yet, awaiting your replies for that."
1559530691,2805,Paul-Licameli,2023-05-23T14:29:19Z,"> @Paul-Licameli in the test list you mention
> 
> > Splitting stereo track to mono replicates name, pan, gain, mute, solo*
> 
> * [ ]  Why specifically to mono? Selectness should also be replicated.

I updated the top comment to mention selected state too.

""Why specifically to mono?""  I don't understand, what other kind of splitting is there?
"
1559720725,2805,Paul-Licameli,2023-05-23T15:53:59Z,"> Set status to ""request changes"" essentially for the crash. There's not much I can test until it's fixed. Not sure if the rest of my comments should result in changes yet, awaiting your replies for that.

We know the fix for the crash now.  I pushed it, and also some of your less important suggested changes.
"
1560484438,2805,saintmatthieu,2023-05-24T05:38:15Z,"> ""Why specifically to mono?"" I don't understand, what other kind of splitting is there?

I meant ""Split Stereo Track"" as opposed to ""Split Stereo to Mono"", but actually the former looks just like the latter, with hard left-right panning. Please ignore."
1560592567,2805,saintmatthieu,2023-05-24T07:28:35Z,"There remains a `WaveTrack::Attachments::RegisteredFactory`, namely in `WaveTrackLocation`. Just glancing at it looks like it has to do with cut lines and merge points. Still not sure what that is and if it makes sense to still have this data on a per-channel basis or if it also should be grouped in `ChannelGroupData`."
1560598168,2805,saintmatthieu,2023-05-24T07:32:50Z,"There remain calls to
* `TrackList::Channels(track).size()` in Normalize.cpp, line 177,
* `TrackList::Channels(pTrack).size()` in WaveTrackControls, line 1031."
1560599168,2805,saintmatthieu,2023-05-24T07:33:41Z,"Sorry, I thought ""Close with comment"" would finalize my review, not close the PR 😅 "
1560859650,2805,Paul-Licameli,2023-05-24T10:28:55Z,"> There remains a `WaveTrack::Attachments::RegisteredFactory`, namely in `WaveTrackLocation`. Just glancing at it looks like it has to do with cut lines and merge points. Still not sure what that is and if it makes sense to still have this data on a per-channel basis or if it also should be grouped in `ChannelGroupData`.

That is a different attachment place, unlike the group data.

Cut line locations are still inherently per-channel rather than per-track, until I really do the reorganization of clips to contain multiple sequences.  Until then, it is possible that cut lines in opposite channels are at different times.

The time to reorganize this is not yet now.
"
1560883322,2805,Paul-Licameli,2023-05-24T10:41:33Z,"> There remain calls to
> 
> * `TrackList::Channels(track).size()` in Normalize.cpp, line 177,
> * `TrackList::Channels(pTrack).size()` in WaveTrackControls, line 1031.

Done.
"
1561358093,2805,Paul-Licameli,2023-05-24T15:19:30Z,"Interactively rebased onto latest master, squashing some fix-ups.  Not expecting anything to behave differently in the next build.
"
1601797624,4795,Paul-Licameli,2023-06-21T22:58:56Z,"Rebased onto recent master, with only minor changes for review feedback
"
1875707276,5839,Paul-Licameli,2024-01-03T17:17:56Z,"See above about the inconsistency of a comment with its function.

I think the code is correct but the comment is not.  Distributor really must begin with trusted distributor.

Correct?
"
1875711292,5839,Paul-Licameli,2024-01-03T17:21:12Z,"> See above about the inconsistency of a comment with its function.
> 
> I think the code is correct but the comment is not. Distributor really must begin with trusted distributor.
> 
> Correct?

OK I see that's outdated.  I approve, up to commit 4f7c6e0b455b28b840ee1048cab37482d55b79f0
"
1877049798,5839,saintmatthieu,2024-01-04T12:52:49Z,"Pushed a commit that creates a test utility, to allow QA edit the ACID and DistributedBy tags of wav files, necessary for testing."
1877119344,5839,Paul-Licameli,2024-01-04T13:45:34Z,"`typedef   struct SNDFILE_tag   SNDFILE ;`
"
1878604317,5839,Paul-Licameli,2024-01-05T12:40:05Z,"Banners should be in recently added files, and the recent commits don't all build, so should be squashed in the final result.  Otherwise, I must examine the new test utility.
"
1878635170,5839,Paul-Licameli,2024-01-05T13:07:14Z,"I caught up reviewing recent commits and made some suggestions but nothing is blocking
"
1883875055,5839,saintmatthieu,2024-01-09T22:05:55Z,@Paul-Licameli another round of review please? The commits I pushed today are not trivial.
1887584813,5839,saintmatthieu,2024-01-11T17:01:21Z,"Thanks @crsib for helping me out! Do you have an idea why the ""Adapt tag-writing utility to support new use cases."" commit broke it? It doesn't add new library dependencies ..."
1340939455,4033,petersampsonaudacity,2022-12-07T13:06:44Z,"Tested this on W10 with @vsverchinsky vVitaly's latest branch build:  audacity-win-3.3.0-alpha-20221206+9c91e83-x64-msvc2022
This works fine when you copy a clip from one project to another
![image](https://user-images.githubusercontent.com/50205984/206185599-6cb5beb9-e3d5-4762-a70e-4d772c11f0f9.png)

a) but can we **_please_** also have this dialog and option when copying clips within a project thereby helping to avoid the over-bloated projects that may users have complained about.

b) It is unclear to me whether or not the user's choice for ""**Selected only**"" or ""**Whole**"" is sticky and retained/remembered if they have ticked the ""**Don't show me this again**"" check-box.

c) if the user has checked the ""**Don't show me this again**"" check-box - then there appears to be no way for the user to set this dialog to be displayed again (except with a **Tools > reset Configuration** which may be way more drastic than the user requires).
_There appears to be no preference setting or command to control the display/hiding pf this dialog_

Flagging both these as UX/design issues to @LWinterberg @Tantacrul @DilsonsPickles 
"
1340947474,4033,petersampsonaudacity,2022-12-07T13:12:49Z,"### UPDATE

The message looks good - but the copy fails to work

If I copy a short selection to another project with this build choosing ""Selected only""

a) the length of the selection is OK for the copy

b) no audio is copied - just a selection 

![image](https://user-images.githubusercontent.com/50205984/206187822-1da8ac2c-50c7-4f2f-9a8e-5c7f94148b62.png)

The Copy works fine if I choose the ""**Whole**"" option
"
1341042674,4033,LWinterberg,2022-12-07T14:24:16Z,"> a) but can we please also have this dialog and option when copying clips within a project thereby helping to avoid the over-bloated projects that may users have complained about.

If you copy within a project, a ""shallow copy"" is created. The copy is still referencing the same data as the original, just displaying it a second time. Making a ""deep copy"" would actually duplicate the data and bloat the project. 

"
1348672621,4033,DavidBailes,2022-12-13T14:21:17Z,"There are some issues for users of screen readers:
1. Concerning the text for the radio buttons using both in preferences and the dialog. For each of the radio buttons, there needs to be a full stop at the end of the first line, otherwise screen readers read it without a pause between the end of the first line and the start of the second. eg it should be:
Selected audio only.
Only the selected portion of the source clip will be pasted.

2. In preferences, the text ""Paste audio from other Audacity project as"" is not automatically read by screen readers. My suggestion is to have this text as the text used by StartStatic (ie the group box), replacing Pasted audio. It will then be read by screen readers.

3. In the dialog box, the two radio buttons and text box need access keys, eg, m, S and R. 

4. In preferences, the three new radio buttons need access keys, eg, a, c, and k."
1424486379,4033,petersampsonaudacity,2023-02-09T16:39:38Z,"Testing on W10- with @vsverchinsky Vitaly's latest branch build for this:   

a)  the copy properly honor's the user's request to either copy the whole smart clip ot just the selection

b) the displayed data size does _**not**_ change when toggling between the two copy forms - I would expect the smart clip data size to be much larger than the simple selection size.

c) the ""**don't ask each time**"" and the ""**ask each time**"" settings work as intended when used fro either the copy dialog or Tracks Behaviors preferences 

d) if Ask every time is ""on"" then the copy dialog properly remembers the users last-used choice for the copy.

e) I note that the default is to set to copy the whole smart clip - is that intentional?

f) At default settings the dialog for Tracks Behaviors preferences is now not quite long enough for the new text:
![image](https://user-images.githubusercontent.com/50205984/217879512-4bde58f4-b40a-472e-91ed-0be591136e4e.png)
"
1425729530,4033,vsverchinsky,2023-02-10T12:14:26Z,"1 commit added that removes 'X' button from progress dialog when hide close and cancel button flags are used.
Accessibility improvements."
1426109468,4033,petersampsonaudacity,2023-02-10T17:17:52Z,"Testing on @vsverchinsky 's latest branch build:  audacity-win-3.3.0-alpha-20230210+429a3c0-x64

I confirm that the Copy dialog no longer has the ""X"" to cancel the process

BUT consider this use case
1. Generate a five hour chirp to simulate a long recording project
2. select a three minute ""song""
3. Ctrl+N to open a new project
4. Ctrl+V to paste the entire smart clip in (the default setting in the dialog)
5. Observe: this takes 2min 24secs on my machine with _**NO**_ longer any ability to interrupt this 

If you make a mistake and intended only to copy in just the selection (which takes less than a second) 0t's like watching paint dry as you wait !

Removing the ""X"" cancel as a ""fix"" seems a very kludgy approach and poor UX."
1429816003,4033,vsverchinsky,2023-02-14T14:15:19Z,"> Testing on @vsverchinsky 's latest branch build: audacity-win-3.3.0-alpha-20230210+429a3c0-x64
> 
> I confirm that the Copy dialog no longer has the ""X"" to cancel the process
> 
> BUT consider this use case
> 
> 1. Generate a five hour chirp to simulate a long recording project
> 2. select a three minute ""song""
> 3. Ctrl+N to open a new project
> 4. Ctrl+V to paste the entire smart clip in (the default setting in the dialog)
> 5. Observe: this takes 2min 24secs on my machine with _**NO**_ longer any ability to interrupt this
> 
> If you make a mistake and intended only to copy in just the selection (which takes less than a second) 0t's like watching paint dry as you wait !
> 
> Removing the ""X"" cancel as a ""fix"" seems a very kludgy approach and poor UX.

And it's been so before dialog was added. The major problem is that I can't suggest a solution that doesn't require deep changes in the code and those changes should be discussed with @crsib and @Paul-Licameli first, I guess "
1429901778,4033,petersampsonaudacity,2023-02-14T15:10:18Z,"> And it's been so before dialog was added. The major problem is that I can't suggest a solution that doesn't require deep changes in the code and those changes should be discussed with @crsib and @Paul-Licameli first, I guess

@vsverchinsky 

For me the lack of a **Cancel** button or **X** is a relatively minor residual.

I will just be **_very_** happy that users who want to copy a small selection from a large clip in one project to a different project will now be able to copy just the selected audio data and _**not**_ the whole shebang of the ""smart clip"".

So I'm _**really**_ hoping that this fix gets pulled into master for 3.3.0

_And then later @Paul-Licameli anf @crsib can worry about how to provide cancel functionality._

"
1434593299,4033,Paul-Licameli,2023-02-17T12:45:53Z,"> > Testing on @vsverchinsky 's latest branch build: audacity-win-3.3.0-alpha-20230210+429a3c0-x64
> > I confirm that the Copy dialog no longer has the ""X"" to cancel the process
> > BUT consider this use case
> > 
> > 1. Generate a five hour chirp to simulate a long recording project
> > 2. select a three minute ""song""
> > 3. Ctrl+N to open a new project
> > 4. Ctrl+V to paste the entire smart clip in (the default setting in the dialog)
> > 5. Observe: this takes 2min 24secs on my machine with _**NO**_ longer any ability to interrupt this
> > 
> > If you make a mistake and intended only to copy in just the selection (which takes less than a second) 0t's like watching paint dry as you wait !
> > Removing the ""X"" cancel as a ""fix"" seems a very kludgy approach and poor UX.
> 
> And it's been so before dialog was added. The major problem is that I can't suggest a solution that doesn't require deep changes in the code and those changes should be discussed with @crsib and @Paul-Licameli first, I guess

See SqliteSampleBlockFactory::OnBeginPurge

Not directly applicable here, but `SampleBlock` has already exposed ways to hook some of its operations.

Perhaps we could temporarily inject a similar callback for creation of blocks, which could poll the cancel button of a progress dialog, then throw an exception.

"
1434687955,4033,Paul-Licameli,2023-02-17T13:58:21Z,"Can you rebase and resolve conflicts first, before I review again?
"
1436960115,4033,petersampsonaudacity,2023-02-20T12:49:01Z,"Testing with @vsverchinsky 's latest branch build:  audacity-win-3.3.0-alpha-20230220+b954cc7-x64

I note that we still have the single word ""**anytime**"" in the clip copy dialog and in Tracks Behaviors prefs - and not ""**any time**"" or ""**at any time**"" as we (@Paul-Licameli ) discussed at the end of last week.


Also note that the Tracks Behaviors prefs dialog is till not long enough vertically:
![image](https://user-images.githubusercontent.com/50205984/220112740-2b3d0b78-6447-4a45-8ab1-36d65c7bada1.png)
"
1437548844,4033,JohnColket,2023-02-20T21:12:26Z,To all who worked on this issue - THANK YOU!  :smiley:
1438748520,4033,petersampsonaudacity,2023-02-21T16:14:37Z,"I have updated the Tracks Behaviors preferences page with the new behavior
https://alphamanual.audacityteam.org/man/Tracks_Behaviors_Preferences#Pasted_audio

![image](https://user-images.githubusercontent.com/50205984/220399682-5fcf352e-4747-4510-9b07-a573ef9f9e32.png)


"
1402461047,4171,Paul-Licameli,2023-01-24T19:14:40Z,"I have finished a round of review.

The Windows builds are still failing, so you must fix that.

The question above about `SetTrack` and `ResetTrack` are the only unresolved doubt I have.

Otherwise all else is just suggestion and so this is *almost* approved.
"
1402463581,4171,Paul-Licameli,2023-01-24T19:16:50Z,"The windows build failure is because of a duplicate symbol:

```
wxmsw31u_core.lib(wxmsw313u_core_vc_custom.dll) : error LNK2005: ""public: virtual __thiscall wxNavigationEnabled<class wxWindow>::~wxNavigationEnabled<class wxWindow>(void)"" (??1?$wxNavigationEnabled@VwxWindow@@@@UAE@XZ) already defined in ListNavigationPanel.obj
```

... which I think you can fix just with one more `extern template` declaration at the second commit.
"
1429753912,4171,vsverchinsky,2023-02-14T13:31:42Z,"Branch was rebased and few new commits were added, starting from [Effects preferences strings change](https://github.com/audacity/audacity/pull/4171/commits/537cecaaeac188f2d514e73ecd12394d9dde180e)"
1453698849,4171,petersampsonaudacity,2023-03-03T15:27:16Z,"Testing on W11 with @vsverchinsky  Vitaly's latest branch build: audacity-win-3.3.0-alpha-20230303+0edee49-x64

I note that the default setttings for the **Effect Menu** and the **Realtime effects** are different.   Is this intentional, by design, or are they supposed to be the same by default?

The functionality of setting various options seems to work, though I have very few additional plugins, just VST and VST3 versions of iZotope Vinyl.

I do like that you can now acess the **Plugin Manager** from this prefs pane.

And I also like the nomenclature change from **Default** to **Category** in the display options list.

_I have added a P1 to the Manual for when this gets pulled into master - but I won't be able to do this over the next 8 days or so as I'm off-grid skiing away from t'interweb mostly._

![image](https://user-images.githubusercontent.com/50205984/222758826-0d06fc71-01cc-4e3a-8137-8ace62f66ff6.png)

"
1453978651,4171,vsverchinsky,2023-03-03T19:01:25Z,"> I note that the default setttings for the Effect Menu and the Realtime effects are different. Is this intentional, by design, or are they supposed to be the same by default?

Yes, they are different by design"
1820733705,5653,Paul-Licameli,2023-11-21T11:25:24Z,"I think you wrote enough to convince me to redraft this.
"
1826827742,5653,Paul-Licameli,2023-11-26T16:25:49Z,"Rebased to recent `audacity/wave-clip-refactoring` and resolved an easy conflict
"
1828272904,5653,Paul-Licameli,2023-11-27T17:11:09Z,"Rebased to updated base branch.  No changes, no conflicts.
"
1829887542,5653,chinakov,2023-11-28T13:51:04Z,"If a User has a **non-default** color for a Stereo track, and then:
1. Swaps Stereo Channels - the audio track reverts back to default color (blue)
2. Splits Stereo Track - the last audio track reverts back to default color (blue)
3. Splts track to Mono - the last audio track reverts back to default color (blue)

This behaviour has been changed from the last release version. 

If a User has non-default colors for 2 Mono tracks, the behaviours for joining and mixing and rendering are not changed from the last release version. 
"
1829945652,5653,chinakov,2023-11-28T14:24:44Z,"> Recording or generating into a track uses the wave track color

Generating indeed does use the wave track color, but recording into said track still preserves the default track color (blue). 

Pictured: Recording preserve default blue color, generated audio preserves custom color defined by the User.
![image](https://github.com/audacity/audacity/assets/139755141/85ef4130-f9bb-476a-8e03-130819019634)

"
1829994677,5653,chinakov,2023-11-28T14:47:33Z,"Another issue: if a User opens a project with differently coloured clips within one track, one of the channels will be reverted back to default color. 

Take a look at the last track in the project. 

How it was saved in your Branch Build:
![image](https://github.com/audacity/audacity/assets/139755141/d68e3701-9b90-4c37-9d5f-0b9e38969af5)


How it was opened in Current Release Version:
![image](https://github.com/audacity/audacity/assets/139755141/0e96b5c8-37a4-4070-90e1-80d244e9cac0)
"
1834035774,5653,Paul-Licameli,2023-11-30T15:47:54Z,"> If a User has a **non-default** color for a Stereo track, and then:
> 
>     1. Swaps Stereo Channels - the audio track reverts back to default color (blue)
> 
>     2. Splits Stereo Track - the last audio track reverts back to default color (blue)
> 
>     3. Splts track to Mono - the last audio track reverts back to default color (blue)
> 
> 
> This behaviour has been changed from the last release version.
> 
> If a User has non-default colors for 2 Mono tracks, the behaviours for joining and mixing and rendering are not changed from the last release version.

Considering this problem, I now realize that this issue must depend first on fixing #5530 
"
1935857683,5653,Paul-Licameli,2024-02-09T12:38:42Z,"As you understood, ""Cache"" is now a misnomer and the next commit renames them as ""Attachments"" to WaveClip.  The are attached data on the clip getting certain notifications of events in the clip's lifetime.

Some attachment on WaveClip removes the irrelevant mention of color from lib-wave-track which shouldn't be there.

I did reuse existing WaveClipWaveformCache to define the override of WriteXMLAttrubutes.  If you don't like it, it's easily done to make another class just to hold the color with its own registered factory.  I didn't see that as necessary.

I don't like it that clips are now mentioning stretches and pitch shifts (also serialized data) and would put them in WaveClip attachments too.

"
1936693456,5653,Paul-Licameli,2024-02-09T22:35:42Z,"Force pushed with changes that separate the attachments for colors, from the other attachments that really perform only caching.
"
1940777854,5653,crsib,2024-02-13T08:46:00Z,Looks like you forgot to push.
1946601526,5653,Paul-Licameli,2024-02-15T17:04:07Z,"Rebased without change to updated wave-clip-refactoring branch
"
1948277239,5653,Paul-Licameli,2024-02-16T12:11:24Z,"Doing this hard work once will make it easier the next time for the application to decorate WaveClip non-intrusively with other information not essential the clip's purpose as a container of samples.

Already since I prepared this, WaveClip got polluted with pitch shifting stuff that should instead use this mechanism.
"
1948788253,5653,Paul-Licameli,2024-02-16T16:19:32Z,"Rebased without changes
"
1950066416,5653,Paul-Licameli,2024-02-17T12:39:21Z,"One new commit for review
"
1950071573,5653,Paul-Licameli,2024-02-17T12:41:50Z,"Rebased onto updated dependency branch
"
1952943179,5653,Paul-Licameli,2024-02-19T17:44:13Z,"Rather than simply rewriting SetWaveColorIndex as interval-major, better to remove completely from lib-wave-track, any mention of extraneous display related things.

Some surprisingly roundabout solutions are needed with attached objects on WaveTrack and WaveClip, but they may prove useful in future to attach other extra information to tracks and clips non-intrusively.
"
2653068252,8211,DavidBailes,2025-02-12T09:09:15Z,"@LWinterberg . In https://forum.audacityteam.org/t/introducing-a-uuid-system-in-audacity-here-s-what-you-need-to-know/128561
it states that ""It’s important to note that UUIDs, while random, are considered ‘personal information’ under GDPR.""
However, in this PR, both on the opt in/out dialog, and in application preferences it states that Audacity does not store any personal information.
I'm confused.
"
2653091115,8211,DavidBailes,2025-02-12T09:19:12Z,Anonimous is not the correct spelling of anonymous.
2653102668,8211,DavidBailes,2025-02-12T09:23:38Z,"In Application preferences, the Send anonimous (anonymous) usage info check box is inside an ""update notifications"" group box, which having nothing to do with updates.
Also, this check box does not have an access key."
2653647525,8211,kryksyh,2025-02-12T13:00:49Z,"
> In Application preferences, the Send anonimous (anonymous) usage info check box is inside an ""update notifications"" group box, which having nothing to do with updates. Also, this check box does not have an access key.

That's a good point. we should group it differently or rename the group box."
2654254185,8211,kryksyh,2025-02-12T16:33:16Z,"@DavidBailes thanks for the feedback!

> However, in this PR, both on the opt in/out dialog, and in application preferences it states that Audacity does not store any personal information.

I have updated the message to be more correct: `Audacity does not collect any personally identifiable information about you.`

> Anonimous is not the correct spelling of anonymous.

Indeed!

> In Application preferences, the Send anonimous (anonymous) usage info check box is inside an ""update notifications"" group box, which having nothing to do with updates.

Group name was renamed to ""Network communications""

> Also, this check box does not have an access key.

I fixed this too."
2655908475,8211,DavidBailes,2025-02-13T08:50:43Z,"This is comment is about wording, rather than code, and so is probably principally directed at @LWinterberg  This is part of the dialog about updates and sending  anonymous data:
![image](https://github.com/user-attachments/assets/c71554a7-98b8-438f-8e92-ff775d3d6122)

In plain language, the question being asked of the user is whether they are happy to send anonymous usage data. That Audacity is using a UUID is a technical detail that explains for those who are interested how the data is kept anonymous. But Audacity could generate an UUID and send no data.
A button with the name ""Disable sending anonymous usage data"" rather than ""Disable UUID"" would be much more easily understood by most users.
"
2656034038,8211,LWinterberg,2025-02-13T09:39:31Z,"> A button with the name ""Disable sending anonymous usage data"" rather than ""Disable UUID"" would be much more easily understood by most users.

It unfortunately also would be incorrect as update checking would remain enabled."
2656069318,8211,DavidBailes,2025-02-13T09:54:27Z,"> > A button with the name ""Disable sending anonymous usage data"" rather than ""Disable UUID"" would be much more easily understood by most users.
> 
> It unfortunately also would be incorrect as update checking would remain enabled.

You mean because update checking also provides anonymous usage data?"
2656190613,8211,dozzzzer,2025-02-13T10:41:08Z,Tested
2656806560,8211,Tantacrul,2025-02-13T14:41:04Z,"@DavidBailes We could change it to 'Don't send anonymous UUID', however, I kind of feel it won't make sense to anyone until they've read the description at the top, so we went for this more simplified version.

Although, in both cases, the option won't make sense to just about anyone if they don't read the text.

Also, just in case you were wondering - we decided to keep these notifications for Update Checking and UUID together because we think it'd get super annoying to have multiple back-to-back dialogs. Most likely, the user would just spam the 'OK' button if we did that and be even less inclined to read each dialog.

I guess I'm leaning towards leaving the button as is. There's also the issue of space / the buttons being really massive too.

Thoughts?"
2658720469,8211,DavidBailes,2025-02-14T09:25:44Z,"> I guess I'm leaning towards leaving the button as is. There's also the issue of space / the buttons being really massive too.
> 
> Thoughts?

@Tantacrul . Having the two options in one dialog makes sense.
Often opting in/out of options such as these is done using check boxes, rather than buttons. This removes the issue of problems of size of buttons whilst trying to make their purpose clearly understandable.
My understanding is that the new option you are introducing is whether the user is happy with sending the information of how often this particular copy of Audacity is being used, where this information is being sent anonymously.
What I definitely don't understand is the section in the privacy document relating to Audio.com:

> Audio.com integration insights – for users already registered with Audio.com, this system will help us understand how often Audacity users take advantage of Audio.com. We will not be sharing any other kinds of information with Audio.com, apart from the UUID itself.

If a user is signed into Audio.com, then they already know how often that user is using the service don't they. So I don't know what the purpose is. Linking an UUID with personal information so that the UUID is no longer anonymous doesn't sound like a good idea to me.

Currently, if a user upgrades to 3.7.2 from a previous version, then this dialog doesn't open. I'm not sure whether this is by design or not. But if it did, then I think the user would be puzzled about why they are being asked about update checking again.

"
2659236947,8211,Tantacrul,2025-02-14T12:39:41Z,"First, given how we got buzzed a few years ago, we take a lot of time to be squeaky clean when it comes to GDPR and such, so if you spot any more unclear wording in the PP, please keep it coming. I'll send this to our lawyer to suggest a rewording for clarity.

To your question, if you're on Audio.com, you're obviously already signed in with your email and password. The UUID doesn't provide any additional personally identifying info because it's a randomly generated number. All it does is give us a better sense of overall retention and helps us understand the overall % of Audacity sessions that include usage of Audio.com. This simple detail tells us whether the combined service is healthy or not on a macro level.

And just to be clear (for anyone reading who perhaps hasn't read the whole thread) - this is only if you choose to register on Audio.com.

---

About buttons VS checkbox: I have a lot of very boring things to say here about the inherent imbalance they cause one way or the other. We prefer a simple 'Agree' 'Don't agree' binary choice.
"
2659304834,8211,DavidBailes,2025-02-14T13:10:35Z,"> To your question, if you're on Audio.com, you're obviously already signed in with your email and password. The UUID doesn't provide any additional personally identifying info because it's a randomly generated number. All it does is give us a better sense of overall retention and helps us understand the overall % of Audacity sessions that include usage of Audio.com.

@Tantacrul  It would be helpful if you could explain exactly how you are going to calculate the overall % of Audacity sessions that include usage of Audio.com."
2659877585,8211,Tantacrul,2025-02-14T17:20:30Z,Let me rephrase - the overall % of those who opt in to the UUID. We can't know about those that don't.
2660934828,8211,DavidBailes,2025-02-15T13:55:42Z,"> Let me rephrase - the overall % of those who opt in to the UUID. We can't know about those that don't.

So is this right: you are wanting to calculate, for those who opt in to the UUID, the overall % of Audacity sessions that include the usage of Audio.com?
As I've said above, an explanation of how you are going to calculate this would be helpful.
If, for example, this involved Audio.com being sent the UUID at the start of each session, then for those with an Audio.com account that usage information would not be anonymous."
2660966190,8211,Tantacrul,2025-02-15T15:14:06Z,"**One quick point on terminology:**

Regarding the message about UUIDs: Under GDPR, a UUID alone is not classified as 'anonymous' data, even if collected without an IP address (and to clarify, we do not store an IP address with it). Instead, it is considered pseudonymous data. For that reason, we avoid using the term ""anonymous"" when discussing the UUID. What we do state—accurately and in alignment with GDPR—is that we do not collect any personally identifying information (PII).

**Regarding the message itself:**

The message is accurate for standard Audacity usage. Introducing details about what happens if a user later chooses to register on Audio.com would overcomplicate the message to the point of making it very lengthy and unclear.

Instead, it makes more sense to provide additional details only when a user is introduced to an Audio.com feature, by including a link to the Audio.com Privacy Policy in all relevant places—which we already do.

Incidentally, we're expecting the revised Audio.com privacy policy to be published next week. We're expecting to release at the end of this month."
2660988032,8211,Tantacrul,2025-02-15T16:15:13Z,"Ah, hold on, I see what you're saying now. The text in this build is including the word 'anonymous' still. That's a mistake.

@kryksyh - we need to revise that. I think the Figma mockup had outdated text in it. I can't seem to get this PR working but I see its merged, so let me grab master and see what the text actually says now and we'll replace the 'anonymous' parts with a correct description."
2663367636,8211,DavidBailes,2025-02-17T14:57:56Z,"In section 6 of the PP, it states that:
We delete: UUID data immediately if you choose to disable it at any point

I understand by that: if I disable the option of sending usage information in Preferences, then all of my prior usage data held by you will be deleted immediately.
Is that actually going to be true? "
2663427153,8211,Tantacrul,2025-02-17T15:21:36Z,"Hmmm. It seems unlikely to me that it would delete all historical data immediately if the feature was simply disabled in the UI. I'd just expect the UUID to no longer be sent from that point onwards.

I've reached out to the folk who wrote the policy to confirm this."
1914325959,5899,crsib,2024-01-29T09:47:26Z,"> At least ... on one computer, with the averages of a few before-and-after trials, with 6 cores and hyperthreading.

You have 12 threads and just a 5x speedup. The good question is why, but I probably need to examine the rest of the PR."
1914367720,5899,Paul-Licameli,2024-01-29T10:10:34Z,"> Judging by the code style you are pulling in some of your older work.
> 
> I have only looked on `lib-concurrency`. I think there few changes needed, but they are rather minor.

Two old files were simply moved into lib-concurrency.  The rest of the work is very recent.  But it abstracts out for reuse the pattern that was applied in this experiment a year ago. https://github.com/audacity/audacity/pull/4141"
1914408727,5899,Paul-Licameli,2024-01-29T10:34:01Z,"> > At least ... on one computer, with the averages of a few before-and-after trials, with 6 cores and hyperthreading.
> 
> You have 12 threads and just a 5x speedup. The good question is why, but I probably need to examine the rest of the PR.

Speedup won't be ideal.  There should be some serial component.  Or less than fully parallel, as in is the final merging step in which not all threads are doing work and there is inter-thread communication.

You pointed out some cache ping-pong from false sharing.

There is thread creation and destruction overhead because I didn't bother yet to invent or reuse a thread pool.

There might be contention for a shared resource like the main memory bus or I/O.

The estimated speedup was from @saintmatthieu 's regression test for tempo detection.  In fact that test pulls entire files into big memory buffers first, then used to go sequentially through the memory, but now that can be fetched in a random-access way.

The real-world tempo detection first creates a WaveClip object, and then this parallelized version through the `MirAudioReader` subclass will fetch sample blocks out of it, requiring database access.



"
880305007,1295,Paul-Licameli,2021-07-15T00:50:31Z,"I force-pushed the branch in your origin!  Sorry if that was rude.

But I permuted things in the file back to their original order, so there is a much smaller diff that is easier to review and understand.

One difference I notice is the change of ""information"" to ""info"".  But as with ""app"", I question whether we should use short colloquialisms.  Yet, not my call.

"
880305297,1295,Paul-Licameli,2021-07-15T00:51:15Z,"I'm now satisfied with AboutDialog.cpp, and you addressed the other points I raised.  Approved.  And, I would like to merge this back to master soon.
"
1857833850,5789,lededev,2023-12-15T12:49:22Z,"Code modification completed, please review again."
1857974671,5789,lededev,2023-12-15T14:30:00Z,"Code reduce to 45 lines, please review."
1859200170,5789,petersampsonaudacity,2023-12-17T15:19:46Z,"Testing on W10 with @lededev 's latest branch:  audacity-win-3.5.0-alpha-20231215+5c2f507-x64

@LWinterberg  

1)  I note that this is **_NOT_** ""_does what it says on the tin_"" as expressed in the title of this thread.  Rather than pasting start and end selection time to the clipboard it actually pastes the two values in the Selection toolbar - and these vary according to the display format the user has chosen
a) start and end (default)
b) start and length
c) length and end
d) length and center


2) I have managed somehow to extract enough samples to be able to post this test - BUT I am really none the wiser as to whet the UI is for pasting these values to the clipboard - not really ""discoverable"" at all AFAICT"
1859203761,5789,lededev,2023-12-17T15:34:49Z,"That's not all, if you press the right mouse button on the time control, a menu will appear allowing you to choose more output formats. I counted 19 output formats. But don’t worry too much about side effects, because this small function only reads the string from the time control and writes it to the clipboard. The only side effect is that it will overwrite the current data of the clipboard, so I added a floating window in the system prompt bar. To prompt the user that the current data in the clipboard has changed.
What you see in the time selection bar of the user interface is what you get in the clipboard, what you see is what you get, there are no implicit changes.
"
1859208695,5789,petersampsonaudacity,2023-12-17T15:55:15Z,"> That's not all, if you press the right mouse button on the time control, a menu will appear allowing you to choose more output formats

@lededev   Or left click on the little  downward-pointing black triangle - _know colloquially as the LDPBT_ ;-)

>The only side effect is that it will overwrite the current data of the clipboard, so I added a floating window in the system prompt bar.

Yes, I observed the message.  Are you overwriting 
a) the system clipboard or,
b) the Audacity clipboard?

_And can you explain what the UI actually is to this confused person please._"
1859210092,5789,petersampsonaudacity,2023-12-17T16:01:14Z,"@lededev 
Another way you could capture the start and end time of a selection is to give it a range label and then export labels to a text file.

_Possibly not so good of you already have a lot of labels._"
1860068325,5789,lededev,2023-12-18T10:35:37Z,"@petersampsonaudacity You can press Win+V shortcuts on windows 10 to see them in system clipboard but not paste them.

I want to simplify my steps rather than make things more complicated, so exporting a text file and opening it in an editor is contrary to my idea. If I need to save the data, I'll paste it into my notepad and then Ctrl+S to save.
In fact, I have already done this. In my modified version Notepad3 with name NotepadEE, I only need to press Alt+2, and the contents of the audacity time selection box will be inserted into my notepad text. I can then save the data or perform time expression calculations.
![1ntee](https://github.com/audacity/audacity/assets/30518126/9580b8ee-c916-4fd7-bab1-a326887ceb83)
"
1860232667,5789,petersampsonaudacity,2023-12-18T11:35:12Z,"> @petersampsonaudacity You can press Win+V shortcuts on windows 10 to see them in system clipboard but not paste them.

@lededev    what I mean is what do I have to do in Audacity to get the selection toolbar contents copied to the clipboard?"
1860266465,5789,lededev,2023-12-18T11:49:40Z,"> > @petersampsonaudacity You can press Win+V shortcuts on windows 10 to see them in system clipboard but not paste them.
> 
> @lededev what I mean is what do I have to do in Audacity to get the selection toolbar contents copied to the clipboard?

There are 3 ways currently:
1. Main menu -> Select -> Copy Selection Timestamp
2. Right click label ""Selection"" on selection toolbar
3. Ctrl+P open Preferences, click Shortcuts, Search ""times"", Set a shortcut to ""Copy Selection Timestamp"".
"
1860661517,5789,petersampsonaudacity,2023-12-18T14:34:20Z,"> 2\. Right click label ""Selection"" on selection toolbar

Rather than ""hiding"" it there - why not add it as an extra item to the menu you get when left-clicking the cog-wheel?

@LWinterberg  does that seem sensible to you?   Apart from any other consideration right-click is more normally used as a gesture to summon a context menu.
_It's certainly where I first went looking for it ..._

![image](https://github.com/audacity/audacity/assets/50205984/e65d9e8c-3834-4ff1-af55-1638e42769c3)

"
1861059785,5789,lededev,2023-12-18T16:59:17Z,"> > 2. Right click label ""Selection"" on selection toolbar
> 
> Rather than ""hiding"" it there - why not add it as an extra item to the menu you get when left-clicking the cog-wheel?
> 
> @LWinterberg does that seem sensible to you? Apart from any other consideration right-click is more normally used as a gesture to summon a context menu. _It's certainly where I first went looking for it ..._

If you put it there, you need 4 actions to complete this operation. Move, click, move, click. And it will make the audio selection area lose focus. Might as well click on the main menu to do this.
My method is faster and requires only 2 actions, move and right click.

Considering that I also need to copy it to Notepad, there are 4 keys including Alt+TAB and Ctrl+V, or pure mouse actions also 4: move to notepad insert location, click, hold right mouse button and down gresture(paste), which require a total of 6 actions (8 actions using your method). Since my NotepadEE has added the Alt+2 function to do this, it only requires 4 actions in total, Alt+TAB, Alt+2.

I feel that if the operation is made too complex, I will be less interested in adding this small feature."
1862481335,5789,LWinterberg,2023-12-19T10:14:48Z,"I think the issue we're running into here is that there's a discontinuity between ""feature which makes my life easier"" and ""feature which fits into Audacity"". I totally see your point that right-clicking the label makes things very fast for you.

However, in the context of Audacity and its millions of users, there are different constraints in place, which require compromise. One of these constraints is learnability and intuitiveness of the app. Peter had the intuitive sense to look inside the selections gear to look for a copy option, so that could be argued as a sensible place to put this option. There would be other places too which would work intuitively for some people (ie Ctrl+C - except that it clashes with us not having scoped shortcuts for most things, selection menu, context menu on the time display itself), and unfortunately, right-clicking or double-clicking *the label* to copy something else is just not something intuitive. And it's also not learnable as it's completely invisible and also the only place in the entire app that would do right-click copy. In fact, it would be unique among all apps I'm aware of; the only thing that comes close is some terminals using right-click to *paste*.

So unfortunately, right-click copy is blocking the merge here.

Again, the feature itself is a good fit for Audacity, and if put on a shortcut, it's be pretty fast as well."
1862520964,5789,lededev,2023-12-19T10:40:44Z,"@LWinterberg xterm use right click copy select text, cmd.exe also use right click copy select text. Therefore, right-click copying is also a habitual operation for many users."
1862540392,5789,LWinterberg,2023-12-19T10:54:18Z,"Audacity is not a terminal program though, and most of its users have never opened a terminal. "
1862551360,5789,lededev,2023-12-19T11:01:57Z,"> Audacity is not a terminal program though, and most of its users have never opened a terminal.

I am not sure about this, but I think the right-click is no harm with the uses who do not use right-click copy, But it can bring convenience to users who are used to this kind of operation. It is harmless to one party and beneficial to the other party, so I prefer to retain this feature rather than remove it.
"
1862890382,5789,petersampsonaudacity,2023-12-19T14:44:19Z,"> It is harmless to one party and beneficial to the other party, so I prefer to retain this feature rather than remove it.

Yes, it's harmless there - but as Leo says it ain't ""discoverable there, especially limited to the ""Selection"" text in the toolbar.

Perhaps if you increased the target for the right click then users who may think to try for a context menu will stumble across it
![image](https://github.com/audacity/audacity/assets/50205984/ef25fcb9-d597-4f4f-acdd-b8d1504067c4)

That's something I certainly tried and failed - it was only when I happened to be over the ""Selection"" text when I right-clicked that I got to copy dialog - but I failed to infer that that was the small target area.

=================================================

You can't extend the right-click target further rightwards in the tool as as right-clicking in the two number zones brings up a context menu for display type
![image](https://github.com/audacity/audacity/assets/50205984/db0f7d56-e233-4fe3-a3a4-4d091c975ef9)
"
1862995379,5789,lededev,2023-12-19T15:35:40Z,"@petersampsonaudacity Regarding the problem that it is difficult for users to find this right-click function, I think a mouse hover prompt can be added. When the mouse hovers over the ""Selection"" label for a period of time, a floating tooltip will be given to prompt the user to right click to copy the timestamp.
![rtooltip](https://github.com/audacity/audacity/assets/30518126/e000831f-a3fd-41a9-b65c-986c921b422c)
"
1996991730,5789,Pavelrst,2024-03-14T09:17:41Z,"@lededev Hi, where is it possible to get a version of Audacity that has this feature?

as a Audacity user I completely agree with all your suggestions btw. "
1998866286,5789,lededev,2024-03-15T03:17:10Z,"> Hi, where is it possible to get a version of Audacity that has this feature?
> 
> as a Audacity user I completely agree with all your suggestions btw.

You can download official audacity 3.4.2 Windows x64 [zip](https://github.com/audacity/audacity/releases/download/Audacity-3.4.2/audacity-win-3.4.2-64bit.zip), and overwrite Audacity.exe with my [patch](https://github.com/lededev/audacity/releases/download/3.4.2-seltmcp/Audacity-3.4.2-seltmcp.zip), but this patch only have right/double click label ""Selection"" on selection toolbar copy time string to clipboard feature, no menuitem and shortcut. I will make new patch if 3.5 release without this feature."
2413257370,5789,LWinterberg,2024-10-15T08:41:17Z,Hello! We just [switched master to 4.0.0](https://forum.audacityteam.org/t/master-has-been-switched-to-4-0-0-development/120444) which makes this PR incompatible and/or obsolete as we're switching UI framework and reorganizing large parts of the codebase. 
852393374,948,Paul-Licameli,2021-06-01T19:35:27Z,"I'm done.  Fix that one doc comment and I'm happy.  Squash it and merge it.
"
891482662,1323,Paul-Licameli,2021-08-03T03:08:09Z,"Squash these commits into one.  Then address my recent suggestions for checking that you re-enable update checking on all possible failure paths.

That is all the change I will request.
"
992701692,2261,Paul-Licameli,2021-12-13T17:24:06Z,"Please rebase it once more, then create a merge commit.
"
992783284,2261,vsverchinsky,2021-12-13T19:09:17Z,"> Please rebase it once more, then create a merge commit.

Rebased, but I need an approve for this PR to merge"
992921881,2261,Paul-Licameli,2021-12-13T21:21:34Z,"> > Please rebase it once more, then create a merge commit.
> 
> Rebased, but I need an approve for this PR to merge

I'm sorry, I thought I had done that already.
"
992923714,2261,crsib,2021-12-13T21:23:56Z,"> > > Please rebase it once more, then create a merge commit.
> > 
> > 
> > Rebased, but I need an approve for this PR to merge
> 
> I'm sorry, I thought I had done that already.

That's my fault! I will probably remove the ""push invalidates review"" rule from branch protection rules"
992927890,2261,Paul-Licameli,2021-12-13T21:29:26Z,"> > > > Please rebase it once more, then create a merge commit.
> > > 
> > > 
> > > Rebased, but I need an approve for this PR to merge
> > 
> > 
> > I'm sorry, I thought I had done that already.
> 
> That's my fault! I will probably remove the ""push invalidates review"" rule from branch protection rules

Was it that, or was it a dismissal of my stale review by Vitaly, above?
"
992928952,2261,crsib,2021-12-13T21:31:00Z,Vitaly pushed and that invalidated the review
1141974472,3009,Paul-Licameli,2022-05-31T10:48:05Z,"There is one more checkbox in the list, not corresponding to a commit."
1141975658,3009,Paul-Licameli,2022-05-31T10:49:34Z,"The PR is failing to build on all operating systems.  Are you sure you disabled precompiled headers?
"
1147159135,3009,pietro68,2022-06-06T07:58:09Z,"Closing this, as a new PR at https://github.com/audacity/audacity/pull/3030 was opened to address the comments here."
2277503921,7017,saintmatthieu,2024-08-09T09:08:33Z,"> One suggestion. I looked into `EffectsManager` implemenation and to me it seem that actually there are two interfaces combined: one for effects and the second one for commands. Attempt to extract `IAudacityCommand` results in massive changes that are unlikely useful for Audacity 4 progress (but if so, what I suggest does not prevent us from future refactroing). Alternative solution is to define abstract command interface inside EffectManager:
> 
> ```
> class EffectsManager {
> public:
> 
> class BasicCommandsInterface
> {
> public:
> 
>    virtual bool HasCommand(const PluginID& id) = 0;
>    virtual bool Do(const PluginID& id) = 0;
>    virtual wxString GetURL(const PluginID& id) = 0;
>    virtual wxString GetDescription(const PluginID& id) = 0;
>    ...
> };
> 
> struct PREFERENCES_API CommandsInterface final : GlobalHook<CommandsInterface, BasicCommandsInterface&()> { };
> 
> ...
> };
> 
> ...
> //Inject commands interface
> static EffectsManager::CommandsInterface::Scope audacityCommandsInterfaceScope {
>    []{ 
>        static AudacityWxCommandsInterface commandsInterface;
>        return commandsInterface;
>       }
> };
> ```
> 
> I expect that that would require very few trivial changes in `EffectsManager`

I don't understand:
`BasicCommandsInterface` is the equivalent to my proposed `IAudacityCommand`, right ?
Then you propose this global `AudacityWxCommandsInterface` ; but there are many implementations of `AudacityCommand` and these aren't instantiated as singletons."
2277641725,7017,vsverchinsky,2024-08-09T10:27:21Z,"> BasicCommandsInterface is the equivalent to my proposed IAudacityCommand, right ?

No. With that approach no changes to `AudacityCommand` is required. There will be only few changes in `EffectsManager` interface that remove dependency on ui framework, and command related logic should be moved into `AudacityWxCommandsInterface`. Example:
```cpp
bool EffectManager::DoAudacityCommand(const PluginID & ID,
                             const CommandContext &context,
                             bool shouldPrompt /* = true */)

{
   this->SetSkipStateFlag(false);
   //Below is the old implementation that makes EffectManager depend 
   //in AudacityCommand (or IAudacityCommand):
   /*AudacityCommand *command = GetAudacityCommand(ID);
   if (!command)
   {
      return false;
   }
   bool res = command->DoAudacityCommand(parent, context, shouldPrompt);
   return res;*/
   
   //With BasicCommandInterface that dependency is removed. All command-related logic should
   //be extracted into AudacityWxCommandsInterface 
   return CommandsInterface::Call().Do(context, ID, shouldPrompt);
}
```"
2284301436,7017,saintmatthieu,2024-08-12T15:34:38Z,"I pushed a better fix for that problem.
`DoEffect` is in fact only concerned with the application of plugins of type `PluginTypeEffect`. Review of the places where it is used confirms this. Hence, plugins of type `PluginTypeAudacityCommand` should have no mention in `DoEffect` whatsoever.
You were the first to observe that `EffectManager` was concerned with plugins of both type `Effect` and `AudacityCommand`. In the commits I just pushed, I extract the methods that look for both effects and commands in another class, `EffectAndCommandManager`, which can go in `src`.
Now there's no mention of commands in `lib-audacity-application-logic` anymore."
1346050695,4053,Paul-Licameli,2022-12-12T08:08:50Z,"@vsverchinsky your attention, please, for the last commit of this sequence.  I don't ask you to review all of this.
"
1378702444,4053,Paul-Licameli,2023-01-11T12:51:06Z,"Wait!  You are reviewing the part 2 PR before part 1!
"
1378703206,4053,Paul-Licameli,2023-01-11T12:51:44Z,"I order the PRs in the column of the project board to show which I want reviewed sooner.
"
1378710456,4053,crsib,2023-01-11T12:58:13Z,I am reviewing both because Part 1 makes very little sense to me by itself. I wanted to see if further work will clarify my previous confusions - it did not.
1378713296,4053,crsib,2023-01-11T13:00:37Z,And as I have mentioned earlier I find chains of PRs to be much harder to review. Chaining usually simply hides the final intention and causes confusion. 
1042867735,2561,Paul-Licameli,2022-02-17T11:49:20Z,"I'm done reviewing.

Please reconsider what happens to the audible track name for the screen reader.

Otherwise nothing is wrong with this, but I don't know from reading the issue, who specified or agreed to this change of behavior.  Please tell.

"
1046800532,2561,Paul-Licameli,2022-02-21T11:59:01Z,"I approve the new changes that I see, with one suggestion for eliminating some repetition.

But I'm not sure what is decided about the right thing to do for the screen reader, or if that is meant to be treated in another issue.  I don't see a change in that part since the last discussion.

Was this supposed to be review ready?
"
1047285299,2561,vsverchinsky,2022-02-21T23:05:57Z,"Eleminated code repetitions, and improved text for screen readers"
1047670383,2561,DavidBailes,2022-02-22T10:53:06Z,"> and improved text for screen readers

Thanks for removing the initial ""Track"" from the accessibility name - that's much better.
However, the accessibility name for label tracks needs improving, as it contains too much repetition, which can be very annoying.
Using 3.1.3 or earlier, the acc name of a label track with a default name would be something like ""Track 4 Label track""
Using your branch the acc name of a newly created label track is something like ""4 Labels1 Label track"". In this case ""Label track"" does not need appending, as the name of the track makes it clear that it contains labels.
Using your branch, if a project is opened which was created with 3.1.3 or earlier, and there are existing label tracks, then the acc name of one of these label tracks is something like ""4 Label track Label track"". Again, ""Label track"" does not need appending.
So the appending of ""Label track"" should be conditional. Something like ""Label track"" is appended except in the cases where the track name contains the string ""label"" or the string ""labels"" (not sure if the second case has to be included, I'm not sure how some non-english languages handle plurals)."
1047724714,2561,vsverchinsky,2022-02-22T12:00:42Z,">So the appending of ""Label track"" should be conditional. Something like ""Label track"" is appended except in the cases where the track name contains the string ""label"" or the string ""labels"" (not sure if the second case has to be included, I'm not sure how some non-english languages handle plurals).

@DavidBailes 
We can conditionally append ""Label Track"" to the name if it does not contain default name as its part.
""Labels 1"" => ""Labels 1""
""My Label"" => ""My Label Label Track""
""Labels Voice"" => ""Labels Voice""
Is it ok? Considering plural forms might overcomplicate things right now I believe.

"
1047815397,2561,DavidBailes,2022-02-22T13:49:12Z,"> Is it ok? Considering plural forms might overcomplicate things right now I believe.

It's just about OK, but it would be better if label tracks created using 3.1.3 and earlier were not read as something like ""4 Label Track Label Track"". I'm not sure why you think it will overcomplicate things. The additional rule could just be if the name is ""Label Track"", then ""Label Track"" is not appended."
1047829571,2561,Paul-Licameli,2022-02-22T14:04:55Z,"> > Is it ok? Considering plural forms might overcomplicate things right now I believe.
> 
> It's just about OK, but it would be better if label tracks created using 3.1.3 and earlier were not read as something like ""4 Label Track Label Track"". I'm not sure why you think it will overcomplicate things. The additional rule could just be if the name is ""Label Track"", then ""Label Track"" is not appended.

To avoid overcomplication and implement something that works for all languages -- I would say scan for a singular string only, using the translation of the old internationalized strings formerly appended to the names if the migration from older Audacity versions matters.

This would miss ""Labels"".  There could be some special English only logic for that.  Doing plurals in every language would be hard.

"
1048542648,2561,DavidBailes,2022-02-23T08:25:31Z,"The accessibility name of a label track is now fine - for both current and previous versions of the default track name, ""Label Track"" is not appended. Thanks."
1159098127,3070,Paul-Licameli,2022-06-17T17:35:09Z,"That's a round of review.  I understand this is still incomplete.  Two other boxes at least still to check off.
"
1168769609,3070,Paul-Licameli,2022-06-28T14:03:19Z,"The commit that inserts calls to `FetchSettings` should also insert one at the end of `LoadUserPreset`.

I overlooked that in earlier rounds of review.
"
1170174990,3070,Paul-Licameli,2022-06-29T16:03:42Z,"The latest version of the branch still has these omissions:

- The commit that introduces call to `FetchSettings` still needs a call in `LoadUserPreset`.
- The `Define MakeSettings` commit is only adding one boolen data member.  (There was a more complete commit at 3af23e931425a532e790924ab8fcd8ae936aa661 in an earlier rebasing.  Something got lost.)
"
1825568327,5675,Paul-Licameli,2023-11-24T11:54:57Z,"Coincidentally preferences are a part of the program getting my attention now as a next frontier of refactoring to libraries.

Our drafts may conflict.
"
1825596557,5675,petersampsonaudacity,2023-11-24T12:18:53Z,">Hides ""Enable scrolling left of zero"". 

But note that audio can still be shifted left of zero.

In fact one can shift it to be completely left of zero such that it now becomes irretrievable!
"
1825613644,5675,petersampsonaudacity,2023-11-24T12:33:15Z,I have set P1s in the alpha manual for these potential changes
1825646100,5675,SteveDaulton,2023-11-24T13:01:21Z,"> * Hides ""Advanced Vertical Zooming"". If there's some use of this, it can stay until ultimately being replaced by a zoom which keeps 0 at center (or at bottom, in case of half-waves)

So will ""Advanced Vertical Zooming"" be ""always enabled"", or ""always disabled""?

(I use ""Advanced Vertical Zooming"" very frequently, especially in spectrogram view, and would consider it a serious usability regression if it were permanently disabled.)"
1825667794,5675,SteveDaulton,2023-11-24T13:19:11Z,"> * ""Type to create a label""

If I recall correctly, about 4 years ago, this feature was accidentally broken during refactoring, and there was an outcry from users that the loss of typing to create labels severely impacted their workflow. The feature is important for workflows such as transcribing."
1825676586,5675,petersampsonaudacity,2023-11-24T13:26:41Z,">* Hides ""Enable scrolling left of zero""

You could, while doing this also make it impossible to shift audio left of zero either
a) just block it happening
b) trim the clip from the left as a smart clip as it gets ""pushed past zero""

See this discussion thread:
**Why do we have negative time in Audacity - do we need it? #4188**"
1825734929,5675,petersampsonaudacity,2023-11-24T14:14:21Z,"> So will ""Advanced Vertical Zooming"" be ""always enabled"", or ""always disabled""?

@SteveDaulton  testing shows that it retains the value that was set in earlier Audacity usage.

If you set it ""on"" in 3.4.2 and then upgrade to @LWinterberg 's branch build then int will remain ""on"" and available in that branch build.

BTW the same is true for the other ""hidden"" settings - and even the Removed ""Solo"" button which also retains its ""None"" state in the branch if previously set that way in 3.4.2 or earlier."
1825755535,5675,petersampsonaudacity,2023-11-24T14:31:33Z,"@LWinterberg   while you're at it Leo, in **Interface** Preferences

a) I think **Show Timeline tooltips** is redundant these days - it doesn't seem to do any thing.
The Manual says of it
> **Show Timeline Tooltips:** Timeline tooltips are visible when hovering over the Timeline. These tooltips are enabled by default. They are useful for indicating whether Timeline Quick-Play is enabled. Experienced users may find that the Timeline tooltips get in the way, so this option allows these tooltips to be disabled. 

But Timeline Quickplay is always on these days AFAICT - and I only see **Click and drag to define a looping region** when I hover over the Timeline - and that is regardless of the setting for this pref

_@SteveDaulton  you are (or were) the Timeline king - does this make sense to you?_

-------------------------------------------------------

b) **Show Scrub Ruler:** The [Scrub Ruler](https://alphamanual.audacityteam.org/man/Scrubbing_and_Seeking#scrubruler) can be displayed or hidden using this setting.

This is a very obscure bit of Audacity functionality - and only one of three ways to access Audacity's scrubbing.  We could probably ""remove"" or ""hide"" it as part of this prefs trimming exercise _(note that it eats valuable screen real-estate)_.

@Paul-Licameli may disagree

--------------------------------------------------------------------------------

I have added a P1 to the Manual in case either of both of this is ""removed"" or ""hidden"""
1825762634,5675,petersampsonaudacity,2023-11-24T14:37:24Z,"@LWinterberg 

And in **Warnings** preferences isn't **Missing file name extension during export** redundant now?

As I believe that in 3.4.2 you now always automatically add the appropriate extension if none is supplied?

-----------------------------------------------------
I have added a P1 to the Manual in case either of both of this is ""removed"" or ""hidden"""
1825783146,5675,LWinterberg,2023-11-24T14:54:09Z,"NB, a reason this is a draft and most settings are merely hidden is for this to gauge interest and have it be easily reversible in the case that it's not . I wanted to do some more surveys about these next week, 

@petersampsonaudacity thanks for the pointers to the other things, I'll add them into this later"
1825796684,5675,petersampsonaudacity,2023-11-24T15:05:20Z,"> NB, a reason this is a draft and most settings are merely hidden is for this to gauge interest and have it be easily reversible in the case that it's not . I wanted to do some more surveys about these next week,

@LWinterberg I had guessed that to be the case  (from the ""hidden"")

_But note the persistence of these hidden settings from their use in earlier versions of Audacity before upgrading._

> ... the other things, I'll add them into this later

Thanks Leo.

-----------------------------------------------------------------------------------

BTW I throughly approve of

a) removing the ""**None**"" setting for the Solo button

b) removing **Enable dragging selection edges**  -  I can see no use case for having that turned off

With regard to **Enable scrolling left of zero** I think it is dangerous to hide/remove that while the user can still push audio into negative time.

I can see both **Advanced Vertical Zooming** and **Type to create a label** potentially being contentious.  
_Don't forget the current furore over the removal of a command/shortcut for **Export Selected Audio** in 3.4.2_

"
1825911356,5675,SteveDaulton,2023-11-24T16:47:28Z,"> But Timeline Quickplay is always on these days AFAICT - and I only see **Click and drag to define a looping region** when I hover over the Timeline - and that is regardless of the setting for this pref
> 
> _@SteveDaulton you are (or were) the Timeline king - does this make sense to you?_

Very much past tense ;-)

The ""Show Timeline Tooltips"" setting in Preferences is broken. (Tested on Linux with 3.4.2 AppImage)"
1825916838,5675,petersampsonaudacity,2023-11-24T16:53:55Z,"> The ""Show Timeline Tooltips"" setting in Preferences is broken. (Tested on Linux with 3.4.2 AppImage)

I seem to recall that it was totally changed when new looping was introduced."
1826009161,5675,Paul-Licameli,2023-11-24T19:12:53Z,"> > * Hides ""Advanced Vertical Zooming"". If there's some use of this, it can stay until ultimately being replaced by a zoom which keeps 0 at center (or at bottom, in case of half-waves)
> 
> So will ""Advanced Vertical Zooming"" be ""always enabled"", or ""always disabled""?
> 
> (I use ""Advanced Vertical Zooming"" very frequently, especially in spectrogram view, and would consider it a serious usability regression if it were permanently disabled.)

I agree with Steve that if this is removed from Preferences, I would rather default it on not off.

There is a checkbox to turn in on also in one of the View submenus, but that is less obvious.

Some very useful scrolling and zooming of the vertical rulers of waveform and spectrogram views are governed by this.

It used to be just the default until James decided otherwise.  Which I never really liked, as a user.
"
1826018103,5675,Paul-Licameli,2023-11-24T19:24:55Z,"> @LWinterberg while you're at it Leo, in **Interface** Preferences
> 
> a) I think **Show Timeline tooltips** is redundant these days - it doesn't seem to do any thing. The Manual says of it
> 
> > **Show Timeline Tooltips:** Timeline tooltips are visible when hovering over the Timeline. These tooltips are enabled by default. They are useful for indicating whether Timeline Quick-Play is enabled. Experienced users may find that the Timeline tooltips get in the way, so this option allows these tooltips to be disabled.
> 
> But Timeline Quickplay is always on these days AFAICT - and I only see **Click and drag to define a looping region** when I hover over the Timeline - and that is regardless of the setting for this pref
> 
> _@SteveDaulton you are (or were) the Timeline king - does this make sense to you?_
> 
> b) **Show Scrub Ruler:** The Scrub Ruler can be displayed or hidden using this setting.
> 
> This is a very obscure bit of Audacity functionality - and only one of three ways to access Audacity's scrubbing. We could probably ""remove"" or ""hide"" it as part of this prefs trimming exercise _(note that it eats valuable screen real-estate)_.
> 
> @Paul-Licameli may disagree
> 
> I have added a P1 to the Manual in case either of both of this is ""removed"" or ""hidden""

As for scrubbing, I’m proud of making it work in the audio engine, but I’m not attached to the UI design that never pleased everyone.

Actually Scrubbing made code dependency tangles that I regret now…

"
1826051521,5675,LWinterberg,2023-11-24T20:06:12Z,"@Paul-Licameli @SteveDaulton I see a good use case for advanced vertical scrolling in spectrogram view. I do not see a good use case for it in the waveform. In what situation do you not want 0 at the center in a waveform, or at the bottom in a half-wave?"
1826063003,5675,Paul-Licameli,2023-11-24T20:23:08Z,"> @Paul-Licameli @SteveDaulton I see a good use case for advanced vertical scrolling in spectrogram view. I do not see a good use case for it in the waveform. In what situation do you not want 0 at the center in a waveform, or at the bottom in a half-wave?

If that is your opinion, which I  might agree with. and you want to realize that in 3.5, it will need more work."
1829396124,5675,LWinterberg,2023-11-28T09:13:00Z,"As it turns out, type-to-create-label is scoped to work only when a label track is in focus. Given that's the case, I have absolutely no trouble with just having that functionality, without any setting for turning it off."
1829420182,5675,DavidBailes,2023-11-28T09:26:49Z,"> As it turns out, type-to-create-label is scoped to work only when a label track is in focus. Given that's the case, I have absolutely no trouble with just having that functionality, without any setting for turning it off.

But for users who don't wish to make use of the type to create a label functionality, it's much more convenient for them to have an option to turn it off so that they can use all the single character and shift + single character shortcuts when a label track is the focus."
1829500421,5675,LWinterberg,2023-11-28T10:10:47Z,"> users who don't wish to make use of the type to create a label functionality

Do these users exist? I saw the mail threads regarding the introduction of direct typing in 2007 and then again a review in 2010 which introduced the preference, with you, peter, james and gale involved. Between those dates, I see some talks about labels in the forum archives and some bug reports where the capture didn't work (for the letter z specifically), but I don't see any user complaints for the reverse - where they want to use a shortcut but get annoyed that a label appears instead. 

In the scope of this PR, I think it's useful to simply enable it by default and wait to see if anyone asks for it to be disabled. If a non-negligible amount of people appear, we can simply reinstate it for 3.5.1"
1829609318,5675,DavidBailes,2023-11-28T11:12:56Z,"> Do these users exist?

Users of screen readers?

> but I don't see any user complaints for the reverse - where they want to use a shortcut but get annoyed that a label appears instead.

The option has been off by default since 2.3.2, over 4 years ago. The default was changed in this commit: f4aa75f4fc7b3e5c"
1829716442,5675,LWinterberg,2023-11-28T12:10:03Z,"> >Do these users exist?

> Users of screen readers?

I was unable to find complaints about this in the audacity4blind archive. Maybe freelist's search function let me down here though. The discussion in audacity-quality that lead to this change also appears mostly academical.

That said, type to create labels does feel awkward together with the ""use dialogs for labels"" setting and I'm tempted to tie it to that instead. "
1829758990,5675,petersampsonaudacity,2023-11-28T12:37:03Z,"> type to create labels does feel awkward together with the ""use dialogs for labels"" setting and I'm tempted to tie it to that instead.

@LWinterberg  -  so how do you see that working Leo?"
1829768598,5675,LWinterberg,2023-11-28T12:43:07Z,"If you use the ""use dialogs"" setting, you have to summon the dialog via ctrl+B. If you don't have the setting active, then type to create labels is active."
1831782048,5675,LWinterberg,2023-11-29T12:14:28Z,"After further consideration, I'll just not touch the type to create labels preference for the time being. A ""transscription workspace"" may have some merit down the line."
1832337986,5675,Paul-Licameli,2023-11-29T16:59:12Z,"> shift

Is it planned to disable the shifting of clips left of zero?

But maybe that would impair your ability to make small latency corrections.  Maybe @SteveDaulton would support that opinion?

If we simply disable the scrolling of the view left of zero, are we certain that really resolves all the issues linked above that relate to negative time?  I don't know how the change of scrolling behavior would fix a bug in playback.  But I have not yet reviewed changes.

"
1832382328,5675,petersampsonaudacity,2023-11-29T17:24:48Z,"> But maybe that would impair your ability to make small latency corrections

@Paul-Licameli 

In this discussion thread: **Why do we have negative time in Audacity - do we need it? #4188**

@LWinterberg wrote:
>I see two potential solutions here: 
>
>1. Remove negative time altogether, and accept that trimming now is a 2-step operation when it used to be one.
>2. Remove negative time altogether but attempting to drag a clip before 0 automatically trims the beginning (after a bit of resistance).

Of those two I would tend to favor option 2

And note that that would similarly allow for the ""small latency corrections""  that Paul raises as a use-case - and in a non-destructive way **_BUT_** without the necessity for audio in negative time _(which will now be forever invisible to the user form 3.5.0 onwards)_.

Leo also wrote at the time, in that Discussion thread:
>I am strongly in favor of getting rid of negative time. It causes a bunch of problems, and the main benefit I can see (being able to non-destructively trim the beginning of an audio clip) got obsoleted with 3.1.

And I remain _**strongly**_ minded to agree with him"
1832390943,5675,SteveDaulton,2023-11-29T17:30:14Z,"> But maybe that would impair your ability to make small latency corrections.

Personally I think that it would be better to allow ""zero"" on the timeline to be offset. Not only would this allow ""small latency corrections"" to be made easily, but would also be handy for adding a ""count in"" before the start of the track.

Effectively you would have an ""absolute"" zero, which is the beginning of the track, and nothing is allowed before absolute zero, and there would be a ""local"" zero, which is where ""zero seconds"" / the ""start of the first bar"" are marked on the timeline.

```
                    logical
                     zero
                       |
     |    -2    -1     0     1     2     3 ...
     |
 Absolute
 zero
```

The amount of offset would be set by the user.
For the benefit of novice users, the default offset could be zero, so that ""logical"" zero and ""absolute"" zero both occur at the start of the timeline.
The minimum offset would be zero (""logical"" zero and ""absolute"" zero both occur at the start of the timeline).

If the offset is adjusted, audio remains tied to the ""logical"" time.
(This would mean that the offset can only be reduced when doing so does not put clips, notes or labels before absolute zero.)"
2095469553,6306,DavidBailes,2024-05-06T08:42:27Z,"@saintmatthieu . In LimiterEditor::PopulateOrExchange, it would be better if the accessibility names of the sliders were just the names of the properties, rather than also including the units, eg, just Threshold, Knee width, etc. For these sliders, screen readers read a percentage value between 0 and 100. If units are included in the accessibility name, eg db, then the user may mistakenly assume that the percentage value is the value in db."
2097702272,6306,saintmatthieu,2024-05-07T08:08:54Z,"@DavidBailes thanks for pointing this out.
On the other hand, the visual indication of the unit would be gone, and I haven't found an easy way of placing it somewhere else without affecting my current layout too much.
I propose to keep an eye on this until the first version is merged and create a ticket then."
2097709650,6306,saintmatthieu,2024-05-07T08:12:45Z,Closing in favour of #6395
2097769443,6306,DavidBailes,2024-05-07T08:44:45Z,"> @DavidBailes thanks for pointing this out. On the other hand, the visual indication of the unit would be gone, and I haven't found an easy way of placing it somewhere else without affecting my current layout too much. I propose to keep an eye on this until the first version is merged and create a ticket then.

I think the code I was referring to may have changed, so I'll have another look when the first version is merged, as you suggested."
2126508871,6306,DavidBailes,2024-05-23T08:18:14Z,"> @DavidBailes thanks for pointing this out. On the other hand, the visual indication of the unit would be gone, and I haven't found an easy way of placing it somewhere else without affecting my current layout too much. I propose to keep an eye on this until the first version is merged and create a ticket then.

@saintmatthieu . Now that it is merged, I've created an issue for this: https://github.com/audacity/audacity/issues/6475"
2569028352,7978,grliszas14,2025-01-03T10:44:32Z,"I took a look at the build, in this scenario widget should say 1 bar 1 beat 1 tick I believe
<img width=""668"" alt=""timecode"" src=""https://github.com/user-attachments/assets/3afd6479-b9b3-45ce-bacc-3e2497a8efd7"" />
"
2569037469,7978,saintmatthieu,2025-01-03T10:51:42Z,"https://github.com/audacity/audacity/pull/7978#issuecomment-2569028352

Yes, I think the `TimecodeModel` class must allow the `BeatsFormatterMode` to be settable, probably as a Q_PROPERTY. Then the playback-toolbar instance should set it to time-point, and the instances in the different generators should set it to duration.

Then I guess @embarc-gabriel in the unit test, you could probably keep the existing case (which assumes time-point) after setting time-point, and add your new one after having set it to duration."
2569046289,7978,embarc-gabriel,2025-01-03T10:59:00Z,"> [#7978 (comment)](https://github.com/audacity/audacity/pull/7978#issuecomment-2569028352)
> 
> Yes, I think the `TimecodeModel` class must allow the `BeatsFormatterMode` to be settable, probably as a Q_PROPERTY. Then the playback-toolbar instance should set it to time-point, and the instances in the different generators should set it to duration.
> 
> Then I guess @embarc-gabriel in the unit test, you could probably keep the existing case (which assumes time-point) after setting time-point, and add your new one after having set it to duration.

Yes! I will rework this.
Thx."
2569495807,7978,embarc-gabriel,2025-01-03T16:25:20Z,"@grliszas14 @saintmatthieu 
I addressed the comments above.

![image](https://github.com/user-attachments/assets/3ae77dd2-ee7e-42bc-9de4-fb33a71e49fd)
 
![image](https://github.com/user-attachments/assets/1a42c7e7-6950-473a-a942-ec2cdd01d821)

![image](https://github.com/user-attachments/assets/26c90d0d-c665-4020-9d26-02e5fda31e84)
"
942839786,1865,Paul-Licameli,2021-10-14T01:02:12Z,Done reviewing
947285284,1865,Paul-Licameli,2021-10-20T03:16:09Z,"Maybe the generality is okay for Ctrl+A and Ctrl+C which do not need to push new undo items.  But I have shown definite problems in case of paste.  Are there other problems to demonstrate with cut, too?  Maybe, I didn't experiment enough to decide that.
"
947293997,1865,Paul-Licameli,2021-10-20T03:30:39Z,"Some experiments with Ctrl+X when text is selected in a label track box, will easily show that proper undo/redo handling was already an omission even in 3.0.3 and earlier.  Was paste already badly handled too?

"
947297039,1865,Paul-Licameli,2021-10-20T03:37:39Z,"Actually, DoPasteText() used to handle the case of insertion of text at the edit cursor of a label, always correctly pushing the undo stack.  But this PR causes a definite regression of that behavior, preempting DoPasteText().
"
947566015,1865,vsverchinsky,2021-10-20T11:14:13Z,"> Actually, DoPasteText() used to handle the case of insertion of text at the edit cursor of a label, always correctly pushing the undo stack. But this PR causes a definite regression of that behavior, preempting DoPasteText().

Yet another thing I overlooked, but the fix seems to be quite simple: move project history modification code to `LabelTrackView::PasteText` and remove it from `OnPasteNewLabel`, `LabelTrackView::OnContextMenu` (though history item text will change) and `DoPasteText` becomes unneeded, so it can be removed. Also, I've noticed that there is some GTK-specific code that does not modify undo history as well
```
if (evt.MiddleDown()) {
         // Paste text, making a NEW label if none is selected.
         wxTheClipboard->UsePrimarySelection(true);
         view.PasteSelectedText(project, newSel.t0(), newSel.t1());
         wxTheClipboard->UsePrimarySelection(false);
      }
```
And it will be fixed too if the history modification code is moved to `LabelTrackView::PasteText`, also `LabelTrackView::CutSelectedText` may be fixed same way.

Do you think it would be better now to avoid changing existing code for labels, and add some workarounds to handle text shortcuts in Wave Track?"
1415849594,3996,Paul-Licameli,2023-02-03T13:09:04Z,"I'm done reviewing.  Mostly good.  But I had some questions.
"
1419024084,3996,DavidBailes,2023-02-06T12:44:25Z,"@vsverchinsky . It's great to see that this is being worked on so that keyboard users can access the factory presets of vst3 plugins:
https://github.com/audacity/audacity/issues/3414

I've tested the plugin mentioned by that issue: https://www.auburnsounds.com/products/Couture.html, and can confirm that the factory presets are now available.
However, I've also tested with TDR Kotelnikov  (https://www.tokyodawn.net/tdr-kotelnikov/), and TDR VOS SlickEQ (https://www.tokyodawn.net/tdr-vos-slickeq/), and the presets are still not available for these. (They are using Reaper.)"
1419041128,3996,Paul-Licameli,2023-02-06T12:59:50Z,"All my questions are resolve now, BUT, the latest run failed to build for Ubuntu.

But those looked like spurious failures caused by intermittent network problems, so just started a rerun of the failed jobs.  If that passes, then this can be merge.
"
1419396094,3996,vsverchinsky,2023-02-06T16:47:48Z,"> @vsverchinsky . It's great to see that this is being worked on so that keyboard users can access the factory presets of vst3 plugins: #3414
> 
> I've tested the plugin mentioned by that issue: https://www.auburnsounds.com/products/Couture.html, and can confirm that the factory presets are now available. However, I've also tested with TDR Kotelnikov (https://www.tokyodawn.net/tdr-kotelnikov/), and TDR VOS SlickEQ (https://www.tokyodawn.net/tdr-vos-slickeq/), and the presets are still not available for these. (They are using Reaper.)

Thanks! Turns out that according to spec there is a violation of call sequence, and also it seems like plugin do not fully initialize parameter info structures, I'll try to workaround this"
1419902732,3996,p0nce,2023-02-06T22:59:34Z,"You can use Graillon free VST3 for VST3 program lists, we are actually getting support issues from Audacity users :) https://www.auburnsounds.com/products/Graillon.html (EDIT: oh, if Couture worked then Graillon will too)"
1421106655,3996,vsverchinsky,2023-02-07T16:59:20Z,"> @vsverchinsky . It's great to see that this is being worked on so that keyboard users can access the factory presets of vst3 plugins: #3414
> 
> I've tested the plugin mentioned by that issue: https://www.auburnsounds.com/products/Couture.html, and can confirm that the factory presets are now available. However, I've also tested with TDR Kotelnikov (https://www.tokyodawn.net/tdr-kotelnikov/), and TDR VOS SlickEQ (https://www.tokyodawn.net/tdr-vos-slickeq/), and the presets are still not available for these. (They are using Reaper.)

@DavidBailes I've updated PR and plugins mentioned should also list factory programs in the ""settings & presets"" menu. Though one issue remains - there could be more than one menu entry named 'Defaults', and moreover they could be same, but I'm not sure what to do about it right now (the problem is that for some plugins that may be not true, I think)"
1423924506,3996,DavidBailes,2023-02-09T10:01:56Z,"> @DavidBailes I've updated PR and plugins mentioned should also list factory programs in the ""settings & presets"" menu. Though one issue remains - there could be more than one menu entry named 'Defaults', and moreover they could be same, but I'm not sure what to do about it right now (the problem is that for some plugins that may be not true, I think)

@vsverchinsky . Thanks, I can confirm that the problem with those two plugins is fixed.
The issue with entries for defaults and default is a minor issue (I notice that it also occurs for vst2 plugins)."
1733507270,5239,crsib,2023-09-25T11:48:08Z,@LWinterberg @DilsonsPickles quick design review won't hurt :-)
1733552743,5239,Paul-Licameli,2023-09-25T12:07:28Z,"I only skimmed this PR.

I have mentioned that the Pan and Gain sliders show a dialog when you double-click on the slider thumb and that maybe that code could be reused, but I see this didn't happen.

Maybe they should be unified, replacing that old stuff with the new dialog, if it is in some way better?
"
1733576101,5239,crsib,2023-09-25T12:13:18Z,"> I have mentioned that the Pan and Gain sliders show a dialog when you double-click on the slider thumb and that maybe that code could be reused, but I see this didn't happen

In the original design, this dialog was quite a bit more complex:

1. It had ""Apply Destructively"" button, which is now a menu entry instead
2. There was a check box ""Adjust clip when changing project tempo"", but it is not a priority now. So, probably the dialog will be extended even for 3.4, if UX testing proves that this feature is important. 

I would've done it using the dialog used now, but there was some miscommunication with the design team and I have implemented the ""Apply Destructively"" button before I was told it should be done differently."
1733615364,5239,LWinterberg,2023-09-25T12:29:01Z,"Some feedback: 

* Render Clip Stretching should be greyed out when the clip isn't stretched yet
* When selecting partial or multiple stretched clips, the render option appears inoperable. In the case of multiple selected clips, I'd expect all to be rendered, in the case of a partial selection, I'd expect it to apply the stretching within the selection. As a fallback, having them greyed out when it can't apply works as well. "
1733645270,5239,crsib,2023-09-25T12:48:15Z,"> When selecting partial or multiple stretched clips, the render option appears inoperable

This is the same issue as with the ""rename clip"", I'm happy to discuss it after the SU"
1733710433,5239,DavidBailes,2023-09-25T13:26:16Z,"@crib. Thanks for the new commands on Audio clips submenu.
Just a few minor points:
1. In the change speed dialog, the text box doesn't have an accessibility name. Easily fixed.
In void ChangeClipSpeedDialog::PopulateOrExchange(ShuttleGui& s), just add the lines:
```
         s.Name(XO(""Clip speed""));
         s.NameSuffix(XO(""%""));
```
before the line s.TieNumericTextBox(......
(though I'm not sure whether ""%"" needs translating.)

2. In the Change speed dialog, there is no visual indication of which is the default button (and the Jaws screen reader doesn't know which button is the default). 
3. The new entries on the Audio clips submenu all need access keys.

David."
1733781178,5239,saintmatthieu,2023-09-25T14:05:34Z,Really looking forward to enjoying all this on master!
1733784527,5239,saintmatthieu,2023-09-25T14:07:23Z,"If I have clips A and B one next to another, and slow-down A, I'd expect B (and all subsequent clips) to be shifted backwards if the ""Editing a clip can move other clips"" preference is checked, right? Currently I get the not-enough-room message."
1733816425,5239,crsib,2023-09-25T14:24:02Z,"> I'd expect B (and all subsequent clips) to be shifted backwards if the ""Editing a clip can move other clips"" preference is checked, right?

This wasn't specified anywhere; probably you are right (@LWinterberg)

>  I'd expect it to apply the stretching within the selection. As a fallback, having them greyed out when it can't apply works as well

If you want ""Render selection"", not ""Render clip"" - I will just drop that part from the PR. I'm not sure if we will include it in 3.4 (or ever).

There was a bug in a predicate that controls menu visibility, it is corrected now."
1733950297,5239,crsib,2023-09-25T15:26:00Z,Two minor commits were added @vsverchinsky 
1734995942,5239,saintmatthieu,2023-09-26T07:39:01Z,"Hi!
Trying to change a clip's speed to 200%, nothing happens."
1734999390,5239,saintmatthieu,2023-09-26T07:41:33Z,"I see there's a shortcut to rename clips, I'm jealous `:P` Could we get one for speed changes, too? Not necessarily in this PR, although that'd be convenient for testing. @LWinterberg "
1735002686,5239,crsib,2023-09-26T07:43:40Z,I think you can assign the shortcut in preferences 
1735004644,5239,saintmatthieu,2023-09-26T07:44:59Z,"I'm getting weird results: 

![image](https://github.com/audacity/audacity/assets/22740106/05482b63-5a13-45ad-b649-2cf29846e41f)

then press enter and the clip gets 600%: 
![image](https://github.com/audacity/audacity/assets/22740106/97fa984b-58e5-4a95-9750-33718dd94c28)
"
1735019271,5239,crsib,2023-09-26T07:55:10Z,I will take a look. 
1735094768,5239,saintmatthieu,2023-09-26T08:43:44Z,"First review iteration complete. Please let me know when the speed-change not taking clip offset problem has a fix.
As for the possibility of moving clips right when expanding, I hope @LWinterberg gets back to us soon, but I won't block QA if he doesn't."
1735097733,5239,saintmatthieu,2023-09-26T08:45:30Z,"Oh well, it's an easy fix, let's prevent disturbance during my pizza break :D"
1735122256,5239,crsib,2023-09-26T09:00:20Z,"A fix is added, rebased on the latest master unchanged otherwise"
1735335058,5239,chinakov,2023-09-26T11:19:57Z,"Just an update on how 'Render clip stretching' works with multiple stretched clips and selection within stretched clips. 

If a User has selected multiple stretched clips, and then accesses the Clip Menu - only one of the clips will be selected. 

If a User has selected a region within a clip, but not the entire clip, the User is forbidden from pressing 'Render clip stretching'.

Hope this helps, somehow."
1735336716,5239,chinakov,2023-09-26T11:21:09Z,"@LWinterberg - please advise if this is fine, and this functionality can be considered to be behaving correctly. "
1735351944,5239,chinakov,2023-09-26T11:32:05Z,Advised with @crsib - he has said that the acceptance criteria is fulfilled as defined. Moving [#5238](https://github.com/audacity/audacity/issues/5238) to Ready to Merge. Thanks!
1735416354,5239,chinakov,2023-09-26T12:08:14Z,"Checks for this MR has been completed, you can merge it! "
1191705618,3271,Paul-Licameli,2022-07-21T16:36:02Z,"I have examined every commit in the sequence and I'm almost done with review of this draft.  Now, general comments.
"
1191745287,3271,Paul-Licameli,2022-07-21T17:20:10Z,"Moving `Load` without `LoadCommon` into the wrapper seems wrong.  Why were you trying to do it?  I think the answer is that you wanted to avoid moving some data members into the wrapper.  But I don't think it is necessary to avoid that.

The wrapper class contains an AEffect handle, and that is right.  Each instance needs a different handle, and there is another scratch handle for the plug-in itself.

The later part of `LoadCommon` assigns mVstVersion, mName, mVendor, mInteractive, mAudioIns, mAudioOuts, mMidiIns, mMidiOuts, and mAutomatable.  These things are all ""metadata"" about the plug-in itself, not state of instances of plug-ins.

The first two are already in the wrapper class, but now you skip the assignment of them for the plug-in -- another reason this PR is in error.  For the rest, there is no reason why they can't be in the wrapper too, like mName.

What about the early part of LoadCommon?

It assigns mRealPath, mCurrentEffectID, mPluginMain in the wrapper, and mPath, mBundleRef, mResource, mModule in the effect.  The latter things are (platform specific) resource handles that keep the shared library of foreign code loaded into the process for as long as necessary.

Again, either you miss the assignment of things that were already in the wrapper, or else, you avoid moving things into the wrapper that are not part of Instance state.

So, I simply don't see your purpose of the splitting of Load().

Keep this work:  there could be this benefit of this reexamination of Load(), though I don't think it is necessary for VST2 statelessness.

The things assigned inside LoadCommon() really need to be assigned only once.  They could be moved into a structure managed by a `shared_ptr` and that pointer can be in the Wrapper.  The Effect object does the work of LoadCommon only once.  When the Effect makes an Instance, or the Instance makes a slave, then the shared pointer can simply be copied, and the discovery of things inside LoadCommon would not need to be repeated.


"
900234508,1482,Paul-Licameli,2021-08-17T11:59:41Z,"Const-correctness is the wrong word -- I'm not cheating with C style casts or const_cast.

Unnecessarily non-const arguments is what you mean, for some predicates.  Fair point.
"
